"use strict";(self.webpackChunkrin_ng=self.webpackChunkrin_ng||[]).push([[179],{369:(Ru,nr,Iu)=>{function Ct(n){return"function"==typeof n}function hs(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const pn=hs(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function ie(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Q{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Ct(i))try{i()}catch(s){e=s instanceof pn?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{vt(s)}catch(o){e=null!=e?e:[],o instanceof pn?e=[...e,...o.errors]:e.push(o)}}if(e)throw new pn(e)}}add(e){var t;if(e&&e!==this)if(this.closed)vt(e);else{if(e instanceof Q){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ie(t,e)}remove(e){const{_finalizers:t}=this;t&&ie(t,e),e instanceof Q&&e._removeParent(this)}}Q.EMPTY=(()=>{const n=new Q;return n.closed=!0,n})();const We=Q.EMPTY;function qe(n){return n instanceof Q||n&&"closed"in n&&Ct(n.remove)&&Ct(n.add)&&Ct(n.unsubscribe)}function vt(n){Ct(n)?n():n.unsubscribe()}const Pe={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},lt={setTimeout(n,e,...t){const{delegate:i}=lt;return(null==i?void 0:i.setTimeout)?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=lt;return((null==e?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function Ut(n){lt.setTimeout(()=>{const{onUnhandledError:e}=Pe;if(!e)throw n;e(n)})}function hi(){}const Fi=Nu("C",void 0,void 0);function Nu(n,e,t){return{kind:n,value:e,error:t}}let ir=null;function sf(n){if(Pe.useDeprecatedSynchronousErrorHandling){const e=!ir;if(e&&(ir={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=ir;if(ir=null,t)throw i}}else n()}class d_ extends Q{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,qe(e)&&e.add(this)):this.destination=Y2}static create(e,t,i){return new af(e,t,i)}next(e){this.isStopped?f_(function rf(n){return Nu("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?f_(function sn(n){return Nu("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?f_(Fi,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const j2=Function.prototype.bind;function h_(n,e){return j2.call(n,e)}class $2{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){lf(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){lf(i)}else lf(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){lf(t)}}}class af extends d_{constructor(e,t,i){let r;if(super(),Ct(e)||!e)r={next:null!=e?e:void 0,error:null!=t?t:void 0,complete:null!=i?i:void 0};else{let s;this&&Pe.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&h_(e.next,s),error:e.error&&h_(e.error,s),complete:e.complete&&h_(e.complete,s)}):r=e}this.destination=new $2(r)}}function lf(n){Pe.useDeprecatedSynchronousErrorHandling?function W2(n){Pe.useDeprecatedSynchronousErrorHandling&&ir&&(ir.errorThrown=!0,ir.error=n)}(n):Ut(n)}function f_(n,e){const{onStoppedNotification:t}=Pe;t&&lt.setTimeout(()=>t(n,e))}const Y2={closed:!0,next:hi,error:function q2(n){throw n},complete:hi},p_="function"==typeof Symbol&&Symbol.observable||"@@observable";function zs(n){return n}let Kt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function X2(n){return n&&n instanceof d_||function Z2(n){return n&&Ct(n.next)&&Ct(n.error)&&Ct(n.complete)}(n)&&qe(n)}(t)?t:new af(t,i,r);return sf(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Nw(i))((r,s)=>{const o=new af({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[p_](){return this}pipe(...t){return function Iw(n){return 0===n.length?zs:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=Nw(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function Nw(n){var e;return null!==(e=null!=n?n:Pe.Promise)&&void 0!==e?e:Promise}const K2=hs(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let on=(()=>{class n extends Kt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Pw(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new K2}next(t){sf(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){sf(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){sf(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?We:(this.currentObservers=null,s.push(t),new Q(()=>{this.currentObservers=null,ie(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Kt;return t.source=this,t}}return n.create=(e,t)=>new Pw(e,t),n})();class Pw extends on{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:We}}function Ow(n){return Ct(null==n?void 0:n.lift)}function Cn(n){return e=>{if(Ow(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function an(n,e,t,i,r){return new J2(n,e,t,i,r)}class J2 extends d_{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function St(n,e){return Cn((t,i)=>{let r=0;t.subscribe(an(i,s=>{i.next(n.call(e,s,r++))}))})}function _a(n){return this instanceof _a?(this.v=n,this):new _a(n)}function tF(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(g,p){s.push([h,f,g,p])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof _a?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(i[h](f))}catch(g){d(s[0][3],g)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function nF(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Lw(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}const m_=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Bw(n){return Ct(null==n?void 0:n.then)}function Vw(n){return Ct(n[p_])}function Uw(n){return Symbol.asyncIterator&&Ct(null==n?void 0:n[Symbol.asyncIterator])}function Hw(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const zw=function rF(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Gw(n){return Ct(null==n?void 0:n[zw])}function Ww(n){return tF(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield _a(t.read());if(r)return yield _a(void 0);yield yield _a(i)}}finally{t.releaseLock()}})}function jw(n){return Ct(null==n?void 0:n.getReader)}function xi(n){if(n instanceof Kt)return n;if(null!=n){if(Vw(n))return function sF(n){return new Kt(e=>{const t=n[p_]();if(Ct(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(m_(n))return function oF(n){return new Kt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Bw(n))return function aF(n){return new Kt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ut)})}(n);if(Uw(n))return $w(n);if(Gw(n))return function lF(n){return new Kt(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(jw(n))return function cF(n){return $w(Ww(n))}(n)}throw Hw(n)}function $w(n){return new Kt(e=>{(function uF(n,e){var t,i,r,s;return function Q2(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=nF(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Gs(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function Vn(n,e,t=1/0){return Ct(e)?Vn((i,r)=>St((s,o)=>e(i,s,r,o))(xi(n(i,r))),t):("number"==typeof e&&(t=e),Cn((i,r)=>function dF(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=p=>c<i?g(p):l.push(p),g=p=>{s&&e.next(p),c++;let m=!1;xi(t(p,u++)).subscribe(an(e,v=>{null==r||r(v),s?f(v):e.next(v)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;l.length&&c<i;){const v=l.shift();o?Gs(e,o,()=>g(v)):g(v)}h()}catch(v){e.error(v)}}))};return n.subscribe(an(e,f,()=>{d=!0,h()})),()=>{null==a||a()}}(i,r,n,t)))}function Pu(n=1/0){return Vn(zs,n)}const Vr=new Kt(n=>n.complete());function qw(n){return n&&Ct(n.schedule)}function __(n){return n[n.length-1]}function cf(n){return Ct(__(n))?n.pop():void 0}function Ou(n){return qw(__(n))?n.pop():void 0}function Yw(n,e=0){return Cn((t,i)=>{t.subscribe(an(i,r=>Gs(i,n,()=>i.next(r),e),()=>Gs(i,n,()=>i.complete(),e),r=>Gs(i,n,()=>i.error(r),e)))})}function Zw(n,e=0){return Cn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function Xw(n,e){if(!n)throw new Error("Iterable cannot be null");return new Kt(t=>{Gs(t,e,()=>{const i=n[Symbol.asyncIterator]();Gs(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function li(n,e){return e?function yF(n,e){if(null!=n){if(Vw(n))return function pF(n,e){return xi(n).pipe(Zw(e),Yw(e))}(n,e);if(m_(n))return function mF(n,e){return new Kt(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Bw(n))return function gF(n,e){return xi(n).pipe(Zw(e),Yw(e))}(n,e);if(Uw(n))return Xw(n,e);if(Gw(n))return function _F(n,e){return new Kt(t=>{let i;return Gs(t,e,()=>{i=n[zw](),Gs(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Ct(null==i?void 0:i.return)&&i.return()})}(n,e);if(jw(n))return function vF(n,e){return Xw(Ww(n),e)}(n,e)}throw Hw(n)}(n,e):xi(n)}function fi(n){return n<=0?()=>Vr:Cn((e,t)=>{let i=0;e.subscribe(an(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function v_(n,e,...t){return!0===e?(n(),null):!1===e?null:e(...t).pipe(fi(1)).subscribe(()=>n())}function Jt(n){for(let e in n)if(n[e]===Jt)return e;throw Error("Could not find renamed property on target object.")}function y_(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Ht(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Ht).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function b_(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const xF=Jt({__forward_ref__:Jt});function It(n){return n.__forward_ref__=It,n.toString=function(){return Ht(this())},n}function ct(n){return Kw(n)?n():n}function Kw(n){return"function"==typeof n&&n.hasOwnProperty(xF)&&n.__forward_ref__===It}class Et extends Error{constructor(e,t){super(function w_(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function it(n){return"string"==typeof n?n:null==n?"":String(n)}function pi(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():it(n)}function uf(n,e){const t=e?` in ${e}`:"";throw new Et(-201,`No provider for ${pi(n)} found${t}`)}function sr(n,e){null==n&&function gn(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ke(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Pt(n){return{providers:n.providers||[],imports:n.imports||[]}}function x_(n){return Jw(n,df)||Jw(n,ex)}function Jw(n,e){return n.hasOwnProperty(e)?n[e]:null}function Qw(n){return n&&(n.hasOwnProperty(M_)||n.hasOwnProperty(AF))?n[M_]:null}const df=Jt({\u0275prov:Jt}),M_=Jt({\u0275inj:Jt}),ex=Jt({ngInjectableDef:Jt}),AF=Jt({ngInjectorDef:Jt});var tt=(()=>((tt=tt||{})[tt.Default=0]="Default",tt[tt.Host=1]="Host",tt[tt.Self=2]="Self",tt[tt.SkipSelf=4]="SkipSelf",tt[tt.Optional=8]="Optional",tt))();let S_;function So(n){const e=S_;return S_=n,e}function tx(n,e,t){const i=x_(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&tt.Optional?null:void 0!==e?e:void uf(Ht(n),"Injector")}function Do(n){return{toString:n}.toString()}var Ur=(()=>((Ur=Ur||{})[Ur.OnPush=0]="OnPush",Ur[Ur.Default=1]="Default",Ur))(),fs=(()=>{return(n=fs||(fs={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",fs;var n})();const IF="undefined"!=typeof globalThis&&globalThis,NF="undefined"!=typeof window&&window,PF="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,jt=IF||"undefined"!=typeof global&&global||NF||PF,vl={},Qt=[],hf=Jt({\u0275cmp:Jt}),D_=Jt({\u0275dir:Jt}),C_=Jt({\u0275pipe:Jt}),nx=Jt({\u0275mod:Jt}),js=Jt({\u0275fac:Jt}),Fu=Jt({__NG_ELEMENT_ID__:Jt});let OF=0;function ln(n){return Do(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ur.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Qt,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||fs.Emulated,id:"c",styles:n.styles||Qt,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=OF++,i.inputs=ox(n.inputs,t),i.outputs=ox(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(ix):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(rx):null,i})}function ix(n){return Mi(n)||function Co(n){return n[D_]||null}(n)}function rx(n){return function va(n){return n[C_]||null}(n)}const sx={};function Lt(n){return Do(()=>{const e={type:n.type,bootstrap:n.bootstrap||Qt,declarations:n.declarations||Qt,imports:n.imports||Qt,exports:n.exports||Qt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(sx[n.id]=n.type),e})}function ox(n,e){if(null==n)return vl;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const pe=ln;function Mi(n){return n[hf]||null}function xr(n,e){const t=n[nx]||null;if(!t&&!0===e)throw new Error(`Type ${Ht(n)} does not have '\u0275mod' property.`);return t}function ps(n){return Array.isArray(n)&&"object"==typeof n[1]}function zr(n){return Array.isArray(n)&&!0===n[1]}function A_(n){return 0!=(8&n.flags)}function mf(n){return 2==(2&n.flags)}function _f(n){return 1==(1&n.flags)}function Gr(n){return null!==n.template}function UF(n){return 0!=(512&n[2])}function xa(n,e){return n.hasOwnProperty(js)?n[js]:null}class GF{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function ki(){return lx}function lx(n){return n.type.prototype.ngOnChanges&&(n.setInput=jF),WF}function WF(){const n=ux(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===vl)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function jF(n,e,t,i){const r=ux(n)||function $F(n,e){return n[cx]=e}(n,{previous:vl,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new GF(l&&l.currentValue,e,o===vl),n[i]=e}ki.ngInherit=!0;const cx="__ngSimpleChanges__";function ux(n){return n[cx]||null}let O_;function En(n){return!!n.listen}const dx={createRenderer:(n,e)=>function F_(){return void 0!==O_?O_:"undefined"!=typeof document?document:void 0}()};function Un(n){for(;Array.isArray(n);)n=n[0];return n}function vf(n,e){return Un(e[n])}function Dr(n,e){return Un(e[n.index])}function k_(n,e){return n.data[e]}function ar(n,e){const t=e[n];return ps(t)?t:t[0]}function hx(n){return 4==(4&n[2])}function L_(n){return 128==(128&n[2])}function Eo(n,e){return null==e?null:n[e]}function fx(n){n[18]=0}function B_(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Je={lFrame:wx(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function px(){return Je.bindingsEnabled}function ne(){return Je.lFrame.lView}function Tt(){return Je.lFrame.tView}function gi(n){return Je.lFrame.contextLView=n,n[8]}function Jn(){let n=gx();for(;null!==n&&64===n.type;)n=n.parent;return n}function gx(){return Je.lFrame.currentTNode}function gs(n,e){const t=Je.lFrame;t.currentTNode=n,t.isParent=e}function V_(){return Je.lFrame.isParent}function U_(){Je.lFrame.isParent=!1}function yf(){return Je.isInCheckNoChangesMode}function bf(n){Je.isInCheckNoChangesMode=n}function Li(){const n=Je.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Sl(){return Je.lFrame.bindingIndex++}function qs(n){const e=Je.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function ck(n,e){const t=Je.lFrame;t.bindingIndex=t.bindingRootIndex=n,H_(e)}function H_(n){Je.lFrame.currentDirectiveIndex=n}function vx(){return Je.lFrame.currentQueryIndex}function G_(n){Je.lFrame.currentQueryIndex=n}function dk(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function yx(n,e,t){if(t&tt.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&tt.Host||(r=dk(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Je.lFrame=bx();return i.currentTNode=e,i.lView=n,!0}function wf(n){const e=bx(),t=n[1];Je.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function bx(){const n=Je.lFrame,e=null===n?null:n.child;return null===e?wx(n):e}function wx(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function xx(){const n=Je.lFrame;return Je.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Mx=xx;function xf(){const n=xx();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Bi(){return Je.lFrame.selectedIndex}function To(n){Je.lFrame.selectedIndex=n}function Tn(){const n=Je.lFrame;return k_(n.tView,n.selectedIndex)}function Mf(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function Sf(n,e,t){Sx(n,e,3,t)}function Df(n,e,t,i){(3&n[2])===t&&Sx(n,e,t,i)}function W_(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function Sx(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(bk(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function bk(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class Uu{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Cf(n,e,t){const i=En(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];$_(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function Dx(n){return 3===n||4===n||6===n}function $_(n){return 64===n.charCodeAt(0)}function Ef(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||Cx(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function Cx(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function Ex(n){return-1!==n}function Dl(n){return 32767&n}function Cl(n,e){let t=function Dk(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let q_=!0;function Tf(n){const e=q_;return q_=n,e}let Ck=0;function zu(n,e){const t=Z_(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,Y_(i.data,n),Y_(e,null),Y_(i.blueprint,null));const r=Af(n,e),s=n.injectorIndex;if(Ex(r)){const o=Dl(r),a=Cl(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function Y_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Z_(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Af(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function Rf(n,e,t){!function Ek(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Fu)&&(i=t[Fu]),null==i&&(i=t[Fu]=Ck++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function Rx(n,e,t){if(t&tt.Optional)return n;uf(e,"NodeInjector")}function Ix(n,e,t,i){if(t&tt.Optional&&void 0===i&&(i=null),0==(t&(tt.Self|tt.Host))){const r=n[9],s=So(void 0);try{return r?r.get(e,i,t&tt.Optional):tx(e,i,t&tt.Optional)}finally{So(s)}}return Rx(i,e,t)}function Nx(n,e,t,i=tt.Default,r){if(null!==n){const s=function Ik(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Fu)?n[Fu]:void 0;return"number"==typeof e?e>=0?255&e:Ak:e}(t);if("function"==typeof s){if(!yx(e,n,i))return i&tt.Host?Rx(r,t,i):Ix(e,t,i,r);try{const o=s(i);if(null!=o||i&tt.Optional)return o;uf(t)}finally{Mx()}}else if("number"==typeof s){let o=null,a=Z_(n,e),l=-1,c=i&tt.Host?e[16][6]:null;for((-1===a||i&tt.SkipSelf)&&(l=-1===a?Af(n,e):e[a+8],-1!==l&&Fx(i,!1)?(o=e[1],a=Dl(l),e=Cl(l,e)):a=-1);-1!==a;){const u=e[1];if(Ox(s,a,u.data)){const d=Rk(a,e,t,o,i,c);if(d!==Px)return d}l=e[a+8],-1!==l&&Fx(i,e[1].data[a+8]===c)&&Ox(s,a,e)?(o=u,a=Dl(l),e=Cl(l,e)):a=-1}}}return Ix(e,t,i,r)}const Px={};function Ak(){return new El(Jn(),ne())}function Rk(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=If(a,o,t,null==i?mf(a)&&q_:i!=o&&0!=(3&a.type),r&tt.Host&&s===a);return null!==u?Gu(e,o,u,a):Px}function If(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const g=o[f];if(f<l&&t===g||f>=l&&g.type===t)return f}if(r){const f=o[l];if(f&&Gr(f)&&f.type===t)return l}return null}function Gu(n,e,t,i){let r=n[t];const s=e.data;if(function wk(n){return n instanceof Uu}(r)){const o=r;o.resolving&&function MF(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Et(-200,`Circular dependency in DI detected for ${n}${t}`)}(pi(s[t]));const a=Tf(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?So(o.injectImpl):null;yx(n,i,tt.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function yk(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=lx(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&So(l),Tf(a),o.resolving=!1,Mx()}}return r}function Ox(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Fx(n,e){return!(n&tt.Self||n&tt.Host&&e)}class El{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return Nx(this._tNode,this._lView,e,i,t)}}function Di(n){return Do(()=>{const e=n.prototype.constructor,t=e[js]||X_(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[js]||X_(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function X_(n){return Kw(n)?()=>{const e=X_(ct(n));return e&&e()}:xa(n)}function Ma(n){return function Tk(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(Dx(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Jn(),n)}const Al="__parameters__";function Il(n,e,t){return Do(()=>{const i=function K_(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(Al)?l[Al]:Object.defineProperty(l,Al,{value:[]})[Al];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class ft{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ke({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const Pk=new ft("AnalyzeForEntryComponents");function Cr(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),Cr(i,e)):e!==n&&e.push(i)}return e}function ms(n,e){n.forEach(t=>Array.isArray(t)?ms(t,e):e(t))}function Lx(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Nf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function $u(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function lr(n,e,t){let i=Nl(n,e);return i>=0?n[1|i]=t:(i=~i,function kk(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Q_(n,e){const t=Nl(n,e);if(t>=0)return n[1|t]}function Nl(n,e){return function Ux(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const qu={},t0="__NG_DI_FLAG__",Of="ngTempTokenPath",Gk=/\n/gm,zx="__source",jk=Jt({provide:String,useValue:Jt});let Yu;function Gx(n){const e=Yu;return Yu=n,e}function $k(n,e=tt.Default){if(void 0===Yu)throw new Et(203,"");return null===Yu?tx(n,void 0,e):Yu.get(n,e&tt.Optional?null:void 0,e)}function Ne(n,e=tt.Default){return(function RF(){return S_}()||$k)(ct(n),e)}const qk=Ne;function n0(n){const e=[];for(let t=0;t<n.length;t++){const i=ct(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Et(900,"");let r,s=tt.Default;for(let o=0;o<i.length;o++){const a=i[o],l=Yk(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(Ne(r,s))}else e.push(Ne(i))}return e}function Zu(n,e){return n[t0]=e,n.prototype[t0]=e,n}function Yk(n){return n[t0]}const Ff=Zu(Il("Inject",n=>({token:n})),-1),Ro=Zu(Il("Optional"),8),Xu=Zu(Il("SkipSelf"),4);function Io(n){return n instanceof class Jx{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}const lM="__ngContext__";function Ci(n,e){n[lM]=e}function f0(n){const e=function td(n){return n[lM]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function g0(n){return n.ngOriginalError}function UL(n,...e){n.error(...e)}class nd{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=function VL(n){return n&&n.ngErrorLogger||UL}(e);i(this._console,"ERROR",e),t&&i(this._console,"ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&g0(e);for(;t&&g0(t);)t=g0(t);return t||null}}const XL=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(jt))();function fM(n){return n.ownerDocument.defaultView}function vs(n){return n instanceof Function?n():n}var cr=(()=>((cr=cr||{})[cr.Important=1]="Important",cr[cr.DashCase=2]="DashCase",cr))();function _0(n,e){return undefined(n,e)}function id(n){const e=n[3];return zr(e)?e[3]:e}function v0(n){return vM(n[13])}function y0(n){return vM(n[4])}function vM(n){for(;null!==n&&!zr(n);)n=n[4];return n}function kl(n,e,t,i,r){if(null!=i){let s,o=!1;zr(i)?s=i:ps(i)&&(o=!0,i=i[0]);const a=Un(i);0===n&&null!==t?null==r?SM(e,t,a):Sa(e,t,a,r||null,!0):1===n&&null!==t?Sa(e,t,a,r||null,!0):2===n?function IM(n,e,t){const i=Hf(n,e);i&&function u3(n,e,t,i){En(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function f3(n,e,t,i,r){const s=t[7];s!==Un(t)&&kl(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];rd(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function w0(n,e,t){if(En(n))return n.createElement(e,t);{const i=null!==t?function XF(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(t):null;return null===i?n.createElement(e):n.createElementNS(i,e)}}function bM(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,B_(r,-1)),t.splice(i,1)}function x0(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&bM(r,i),e>0&&(n[t-1][4]=i[4]);const s=Nf(n,10+e);!function t3(n,e){rd(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function wM(n,e){if(!(256&e[2])){const t=e[11];En(t)&&t.destroyNode&&rd(n,e,t,3,null,null),function s3(n){let e=n[13];if(!e)return M0(n[1],n);for(;e;){let t=null;if(ps(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)ps(e)&&M0(e[1],e),e=e[3];null===e&&(e=n),ps(e)&&M0(e[1],e),t=e&&e[4]}e=t}}(e)}}function M0(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function c3(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Uu)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function l3(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):Un(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&En(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&zr(e[3])){t!==e[3]&&bM(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function xM(n,e,t){return function MM(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===fs.None||r===fs.Emulated)return null}return Dr(i,t)}(n,e.parent,t)}function Sa(n,e,t,i,r){En(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function SM(n,e,t){En(n)?n.appendChild(e,t):e.appendChild(t)}function DM(n,e,t,i,r){null!==i?Sa(n,e,t,i,r):SM(n,e,t)}function Hf(n,e){return En(n)?n.parentNode(e):e.parentNode}function CM(n,e,t){return TM(n,e,t)}let TM=function EM(n,e,t){return 40&n.type?Dr(n,t):null};function zf(n,e,t,i){const r=xM(n,i,e),s=e[11],a=CM(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)DM(s,r,t[l],a,!1);else DM(s,r,t,a,!1)}function Gf(n,e){if(null!==e){const t=e.type;if(3&t)return Dr(e,n);if(4&t)return D0(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Gf(n,i);{const r=n[e.index];return zr(r)?D0(-1,r):Un(r)}}if(32&t)return _0(e,n)()||Un(n[e.index]);{const i=RM(n,e);return null!==i?Array.isArray(i)?i[0]:Gf(id(n[16]),i):Gf(n,e.next)}}return null}function RM(n,e){return null!==e?n[16][6].projection[e.projection]:null}function D0(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return Gf(i,r)}return e[7]}function C0(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Ci(Un(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)C0(n,e,t.child,i,r,s,!1),kl(e,n,r,a,s);else if(32&l){const c=_0(t,i);let u;for(;u=c();)kl(e,n,r,u,s);kl(e,n,r,a,s)}else 16&l?NM(n,e,i,t,r,s):kl(e,n,r,a,s);t=o?t.projectionNext:t.next}}function rd(n,e,t,i,r,s){C0(t,i,n.firstChild,e,r,s,!1)}function NM(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)kl(e,n,r,l[c],s);else C0(n,e,l,o[3],r,s,!0)}function PM(n,e,t){En(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function E0(n,e,t){En(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function OM(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const FM="ng-template";function g3(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==OM(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function kM(n){return 4===n.type&&n.value!==FM}function m3(n,e,t){return e===(4!==n.type||t?n.value:FM)}function _3(n,e,t){let i=4;const r=n.attrs||[],s=function b3(n){for(let e=0;e<n.length;e++)if(Dx(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!m3(n,l,t)||""===l&&1===e.length){if(Wr(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!g3(n.attrs,c,t)){if(Wr(i))return!1;o=!0}continue}const d=v3(8&i?"class":l,r,kM(n),t);if(-1===d){if(Wr(i))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==OM(f,c,0)||2&i&&c!==h){if(Wr(i))return!1;o=!0}}}}else{if(!o&&!Wr(i)&&!Wr(l))return!1;if(o&&Wr(l))continue;o=!1,i=l|1&i}}return Wr(i)||o}function Wr(n){return 0==(1&n)}function v3(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function w3(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function LM(n,e,t=!1){for(let i=0;i<e.length;i++)if(_3(n,e[i],t))return!0;return!1}function x3(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function BM(n,e){return n?":not("+e.trim()+")":e}function M3(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Wr(o)&&(e+=BM(s,r),r=""),i=o,s=s||!Wr(i);t++}return""!==r&&(e+=BM(s,r)),e}const rt={};function oe(n){VM(Tt(),ne(),Bi()+n,yf())}function VM(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&Sf(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Df(e,s,0,t)}To(t)}function Wf(n,e){return n<<17|e<<2}function jr(n){return n>>17&32767}function T0(n){return 2|n}function Ys(n){return(131068&n)>>2}function A0(n,e){return-131069&n|e<<2}function R0(n){return 1|n}function XM(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];G_(r),o.contentQueries(2,e[s],s)}}}function sd(n,e,t,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,fx(u),u[3]=u[15]=n,u[8]=t,u[10]=o||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=s,u[16]=2==e.type?n[16]:u,u}function Ll(n,e,t,i,r){let s=n.data[e];if(null===s)s=function V0(n,e,t,i,r){const s=gx(),o=V_(),l=n.data[e]=function H3(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),function lk(){return Je.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Vu(){const n=Je.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return gs(s,!0),s}function Bl(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function od(n,e,t){wf(e);try{const i=n.viewQuery;null!==i&&Y0(1,i,t);const r=n.template;null!==r&&KM(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&XM(n,e),n.staticViewQueries&&Y0(2,n.viewQuery,t);const s=n.components;null!==s&&function B3(n,e){for(let t=0;t<e.length;t++)sB(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,xf()}}function Vl(n,e,t,i){const r=e[2];if(256==(256&r))return;wf(e);const s=yf();try{fx(e),function mx(n){return Je.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&KM(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&Sf(e,c,null)}else{const c=n.preOrderHooks;null!==c&&Df(e,c,0,null),W_(e,0)}if(function iB(n){for(let e=v0(n);null!==e;e=y0(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&B_(s,1),r[2]|=1024}}}(e),function nB(n){for(let e=v0(n);null!==e;e=y0(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];L_(i)&&Vl(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&XM(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&Sf(e,c)}else{const c=n.contentHooks;null!==c&&Df(e,c,1),W_(e,1)}!function k3(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)To(~r);else{const s=r,o=t[++i],a=t[++i];ck(o,s),a(2,e[s])}}}finally{To(-1)}}(n,e);const a=n.components;null!==a&&function L3(n,e){for(let t=0;t<e.length;t++)rB(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&Y0(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&Sf(e,c)}else{const c=n.viewHooks;null!==c&&Df(e,c,2),W_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,B_(e[3],-1))}finally{xf()}}function V3(n,e,t,i){const r=e[10],s=!yf(),o=hx(e);try{s&&!o&&r.begin&&r.begin(),o&&od(n,e,i),Vl(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function KM(n,e,t,i,r){const s=Bi(),o=2&i;try{To(-1),o&&e.length>20&&VM(n,e,20,yf()),t(i,r)}finally{To(s)}}function JM(n,e,t){if(A_(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function U0(n,e,t){!px()||(function Y3(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||zu(t,e),Ci(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Gr(l);c&&Q3(e,t,l);const u=Gu(e,n,a,t);Ci(u,e),null!==o&&eB(0,a-r,u,l,0,o),c&&(ar(t.index,e)[8]=u)}}(n,e,t,Dr(t,e)),128==(128&t.flags)&&function Z3(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=function uk(){return Je.lFrame.currentDirectiveIndex}();try{To(o);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];H_(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&oS(c,u)}}finally{To(-1),H_(a)}}(n,e,t))}function H0(n,e,t=Dr){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function QM(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=qf(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function qf(n,e,t,i,r,s,o,a,l,c){const u=20+i,d=u+r,h=function U3(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:rt);return t}(u,d),f="function"==typeof c?c():c;return h[1]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function nS(n,e,t,i){const r=hS(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&fS(n).push(i,r.length-1))}function iS(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function ur(n,e,t,i,r,s,o,a){const l=Dr(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(mS(n,t,u,i,r),mf(e)&&function W3(n,e){const t=ar(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function G3(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,En(s)?s.setProperty(l,i,r):$_(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function z0(n,e,t,i){let r=!1;if(px()){const s=function X3(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];LM(t,o.selectors,!1)&&(r||(r=[]),Rf(zu(t,e),n,o.type),Gr(o)?(aS(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,lS(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const d=s[u];d.providersResolver&&d.providersResolver(d)}let a=!1,l=!1,c=Bl(n,e,s.length,null);for(let u=0;u<s.length;u++){const d=s[u];t.mergedAttrs=Ef(t.mergedAttrs,d.hostAttrs),cS(n,t,e,c,d),J3(c,d,o),null!==d.contentQueries&&(t.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=128);const h=d.type.prototype;!a&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function z3(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],d=u.inputs,h=null===s||kM(e)?null:tB(d,s);o.push(h),a=iS(d,c,a),l=iS(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function K3(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Et(-301,!1);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Ef(t.mergedAttrs,t.attrs),r}function sS(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function q3(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function oS(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function aS(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function J3(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Gr(e)&&(t[""]=n)}}function lS(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function cS(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=xa(r.type)),o=new Uu(s,Gr(r),null);n.blueprint[i]=o,t[i]=o,sS(n,e,0,i,Bl(n,t,r.hostVars,rt),r)}function Q3(n,e,t){const i=Dr(e,n),r=QM(t),s=n[10],o=Yf(n,sd(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function ys(n,e,t,i,r,s){const o=Dr(n,e);!function G0(n,e,t,i,r,s,o){if(null==s)En(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?it(s):o(s,i||"",r);En(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function eB(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],d=o[l++];null!==a?i.setInput(t,d,c,u):t[u]=d}}}function tB(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function uS(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function rB(n,e){const t=ar(e,n);if(L_(t)){const i=t[1];80&t[2]?Vl(i,t,i.template,t[8]):t[5]>0&&W0(t)}}function W0(n){for(let i=v0(n);null!==i;i=y0(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Vl(o,s,o.template,s[8])}else s[5]>0&&W0(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=ar(t[i],n);L_(r)&&r[5]>0&&W0(r)}}function sB(n,e){const t=ar(e,n),i=t[1];(function oB(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),od(i,t,t[8])}function Yf(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function j0(n){for(;n;){n[2]|=64;const e=id(n);if(UF(n)&&!e)return n;n=e}return null}function q0(n,e,t){const i=e[10];i.begin&&i.begin();try{Vl(n,e,n.template,t)}catch(r){throw gS(e,r),r}finally{i.end&&i.end()}}function dS(n){!function $0(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=f0(t),r=i[1];V3(r,i,r.template,t)}}(n[8])}function Y0(n,e,t){G_(0),e(n,t)}const uB=(()=>Promise.resolve(null))();function hS(n){return n[7]||(n[7]=[])}function fS(n){return n.cleanup||(n.cleanup=[])}function gS(n,e){const t=n[9],i=t?t.get(nd,null):null;i&&i.handleError(e)}function mS(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Zs(n,e,t){const i=vf(e,n);!function yM(n,e,t){En(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function Zf(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=b_(r,a):2==s&&(i=b_(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Z0=new ft("INJECTOR",-1);class _S{get(e,t=qu){if(t===qu){const i=new Error(`NullInjectorError: No provider for ${Ht(e)}!`);throw i.name="NullInjectorError",i}return t}}const X0=new ft("Set Injector scope."),ad={},fB={};let K0;function vS(){return void 0===K0&&(K0=new _S),K0}function yS(n,e=null,t=null,i){const r=bS(n,e,t,i);return r._resolveInjectorDefTypes(),r}function bS(n,e=null,t=null,i){return new pB(n,t,e||vS(),i)}class pB{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&ms(t,a=>this.processProvider(a,e,t)),ms([e],a=>this.processInjectorType(a,[],s)),this.records.set(Z0,Ul(void 0,this));const o=this.records.get(X0);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:Ht(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=qu,i=tt.Default){this.assertNotDestroyed();const r=Gx(this),s=So(void 0);try{if(!(i&tt.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function xB(n){return"function"==typeof n||"object"==typeof n&&n instanceof ft}(e)&&x_(e);a=l&&this.injectableDefInScope(l)?Ul(J0(e),ad):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&tt.Self?vS():this.parent).get(e,t=i&tt.Optional&&t===qu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Of]=o[Of]||[]).unshift(Ht(e)),r)throw o;return function Zk(n,e,t,i){const r=n[Of];throw e[zx]&&r.unshift(e[zx]),n.message=function Xk(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=Ht(e);if(Array.isArray(e))r=e.map(Ht).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Ht(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(Gk,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Of]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{So(s),Gx(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(Ht(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Et(205,!1)}processInjectorType(e,t,i){if(!(e=ct(e)))return!1;let r=Qw(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Qw(s)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(o);try{ms(r.imports,d=>{this.processInjectorType(d,t,i)&&(void 0===u&&(u=[]),u.push(d))})}finally{}if(void 0!==u)for(let d=0;d<u.length;d++){const{ngModule:h,providers:f}=u[d];ms(f,g=>this.processProvider(g,h,f||Qt))}}this.injectorDefTypes.add(o);const l=xa(o)||(()=>new o);this.records.set(o,Ul(l,ad));const c=r.providers;if(null!=c&&!a){const u=e;ms(c,d=>this.processProvider(d,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=Hl(e=ct(e))?e:ct(e&&e.provide);const s=function mB(n,e,t){return xS(n)?Ul(void 0,n.useValue):Ul(wS(n),ad)}(e);if(Hl(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Ul(void 0,ad,!0),o.factory=()=>n0(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===ad&&(t.value=fB,t.value=t.factory()),"object"==typeof t.value&&t.value&&function wB(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ct(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function J0(n){const e=x_(n),t=null!==e?e.factory:xa(n);if(null!==t)return t;if(n instanceof ft)throw new Et(204,!1);if(n instanceof Function)return function gB(n){const e=n.length;if(e>0)throw $u(e,"?"),new Et(204,!1);const t=function EF(n){const e=n&&(n[df]||n[ex]);if(e){const t=function TF(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Et(204,!1)}function wS(n,e,t){let i;if(Hl(n)){const r=ct(n);return xa(r)||J0(r)}if(xS(n))i=()=>ct(n.useValue);else if(function vB(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...n0(n.deps||[]));else if(function _B(n){return!(!n||!n.useExisting)}(n))i=()=>Ne(ct(n.useExisting));else{const r=ct(n&&(n.useClass||n.provide));if(!function bB(n){return!!n.deps}(n))return xa(r)||J0(r);i=()=>new r(...n0(n.deps))}return i}function Ul(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function xS(n){return null!==n&&"object"==typeof n&&jk in n}function Hl(n){return"function"==typeof n}let mi=(()=>{class n{static create(t,i){var r;if(Array.isArray(t))return yS({name:""},i,t,"");{const s=null!==(r=t.name)&&void 0!==r?r:"";return yS({name:s},t.parent,t.providers,s)}}}return n.THROW_IF_NOT_FOUND=qu,n.NULL=new _S,n.\u0275prov=Ke({token:n,providedIn:"any",factory:()=>Ne(Z0)}),n.__NG_ELEMENT_ID__=-1,n})();function RB(n,e){Mf(f0(n)[1],Jn())}function Bt(n){let e=function OS(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Gr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Et(903,"");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=tv(n.inputs),o.declaredInputs=tv(n.declaredInputs),o.outputs=tv(n.outputs);const a=r.hostBindings;a&&OB(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&NB(n,l),c&&PB(n,c),y_(n.inputs,r.inputs),y_(n.declaredInputs,r.declaredInputs),y_(n.outputs,r.outputs),Gr(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===Bt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function IB(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Ef(r.hostAttrs,t=Ef(t,r.hostAttrs))}}(i)}function tv(n){return n===vl?{}:n===Qt?[]:n}function NB(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function PB(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function OB(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}let Xf=null;function zl(){if(!Xf){const n=jt.Symbol;if(n&&n.iterator)Xf=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Xf=i)}}}return Xf}function ld(n){return!!nv(n)&&(Array.isArray(n)||!(n instanceof Map)&&zl()in n)}function nv(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function bs(n,e,t){return n[e]=t}function Ei(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function Da(n,e,t,i){const r=Ei(n,e,t);return Ei(n,e+1,i)||r}function $t(n,e,t,i){const r=ne();return Ei(r,Sl(),e)&&(Tt(),ys(Tn(),r,n,e,t,i)),$t}function Wl(n,e,t,i){return Ei(n,Sl(),t)?e+it(t)+i:rt}function jl(n,e,t,i,r,s){const a=Da(n,function $s(){return Je.lFrame.bindingIndex}(),t,r);return qs(2),a?e+it(t)+i+it(r)+s:rt}function Oe(n,e,t,i,r,s,o,a){const l=ne(),c=Tt(),u=n+20,d=c.firstCreatePass?function HB(n,e,t,i,r,s,o,a,l){const c=e.consts,u=Ll(e,n,4,o||null,Eo(c,a));z0(e,t,u,Eo(c,l)),Mf(e,u);const d=u.tViews=qf(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];gs(d,!1);const h=l[11].createComment("");zf(c,l,h,d),Ci(h,l),Yf(l,l[u]=uS(h,l,h,d)),_f(d)&&U0(c,l,d),null!=o&&H0(l,d,a)}function Xi(n){return function Ml(n,e){return n[e]}(function ak(){return Je.lFrame.contextLView}(),20+n)}function L(n,e=tt.Default){const t=ne();return null===t?Ne(n,e):Nx(Jn(),t,ct(n),e)}function av(){throw new Error("invalid")}function ce(n,e,t){const i=ne();return Ei(i,Sl(),e)&&ur(Tt(),Tn(),i,n,e,i[11],t,!1),ce}function lv(n,e,t,i,r){const o=r?"class":"style";mS(n,t,e.inputs[o],o,i)}function Ee(n,e,t,i){const r=ne(),s=Tt(),o=20+n,a=r[11],l=r[o]=w0(a,e,function vk(){return Je.lFrame.currentNamespace}()),c=s.firstCreatePass?function lV(n,e,t,i,r,s,o){const a=e.consts,c=Ll(e,n,2,r,Eo(a,s));return z0(e,t,c,Eo(a,o)),null!==c.attrs&&Zf(c,c.attrs,!1),null!==c.mergedAttrs&&Zf(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];gs(c,!0);const u=c.mergedAttrs;null!==u&&Cf(a,l,u);const d=c.classes;null!==d&&E0(a,l,d);const h=c.styles;return null!==h&&PM(a,l,h),64!=(64&c.flags)&&zf(s,r,l,c),0===function nk(){return Je.lFrame.elementDepthCount}()&&Ci(l,r),function ik(){Je.lFrame.elementDepthCount++}(),_f(c)&&(U0(s,r,c),JM(s,c,r)),null!==i&&H0(r,c),Ee}function Ae(){let n=Jn();V_()?U_():(n=n.parent,gs(n,!1));const e=n;!function rk(){Je.lFrame.elementDepthCount--}();const t=Tt();return t.firstCreatePass&&(Mf(t,n),A_(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function Mk(n){return 0!=(16&n.flags)}(e)&&lv(t,e,ne(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Sk(n){return 0!=(32&n.flags)}(e)&&lv(t,e,ne(),e.stylesWithoutHost,!1),Ae}function un(n,e,t,i){return Ee(n,e,t,i),Ae(),un}function Xs(n,e,t){const i=ne(),r=Tt(),s=n+20,o=r.firstCreatePass?function cV(n,e,t,i,r){const s=e.consts,o=Eo(s,i),a=Ll(e,n,8,"ng-container",o);return null!==o&&Zf(a,o,!0),z0(e,t,a,Eo(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];gs(o,!0);const a=i[s]=i[11].createComment("");return zf(r,i,a,o),Ci(a,i),_f(o)&&(U0(r,i,o),JM(r,o,i)),null!=t&&H0(i,o),Xs}function Ks(){let n=Jn();const e=Tt();return V_()?U_():(n=n.parent,gs(n,!1)),e.firstCreatePass&&(Mf(e,n),A_(n)&&e.queries.elementEnd(n)),Ks}function ud(n,e,t){return Xs(n,e,t),Ks(),ud}function dr(){return ne()}function dd(n){return!!n&&"function"==typeof n.then}const cv=function eD(n){return!!n&&"function"==typeof n.subscribe};function Qe(n,e,t,i){const r=ne(),s=Tt(),o=Jn();return function nD(n,e,t,i,r,s,o,a){const l=_f(i),u=n.firstCreatePass&&fS(n),d=e[8],h=hS(e);let f=!0;if(3&i.type||a){const m=Dr(i,e),v=a?a(m):m,_=h.length,y=a?b=>a(Un(b[i.index])):i.index;if(En(t)){let b=null;if(!a&&l&&(b=function uV(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,f=!1;else{s=uv(i,e,d,s,!1);const w=t.listen(v,r,s);h.push(s,w),u&&u.push(r,y,_,_+1)}}else s=uv(i,e,d,s,!0),v.addEventListener(r,s,o),h.push(s),u&&u.push(r,y,_,o)}else s=uv(i,e,d,s,!1);const g=i.outputs;let p;if(f&&null!==g&&(p=g[r])){const m=p.length;if(m)for(let v=0;v<m;v+=2){const S=e[p[v]][p[v+1]].subscribe(s),C=h.length;h.push(s,S),u&&u.push(r,i.index,C,-(C+1))}}}(s,r,r[11],o,n,e,!!t,i),Qe}function iD(n,e,t,i){try{return!1!==t(i)}catch(r){return gS(n,r),!1}}function uv(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?ar(n.index,e):e;0==(32&e[2])&&j0(a);let l=iD(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=iD(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function He(n=1){return function hk(n){return(Je.lFrame.contextLView=function fk(n,e){for(;n>0;)e=e[15],n--;return e}(n,Je.lFrame.contextLView))[8]}(n)}function dV(n,e){let t=null;const i=function y3(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?LM(n,s,!0):x3(i,s))return r}else t=r}return t}function hd(n){const e=ne()[16][6];if(!e.projection){const i=e.projection=$u(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?dV(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function fd(n,e=0,t){const i=ne(),r=Tt(),s=Ll(r,20+n,16,null,t||null);null===s.projection&&(s.projection=e),U_(),64!=(64&s.flags)&&function h3(n,e,t){NM(e[11],0,e,t,xM(n,t,e),CM(t.parent||e[6],t,e))}(r,i,s)}function Ca(n,e,t){return Qf(n,"",e,"",t),Ca}function Qf(n,e,t,i,r){const s=ne(),o=Wl(s,e,t,i);return o!==rt&&ur(Tt(),Tn(),s,n,o,s[11],r,!1),Qf}function hD(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?jr(s):Ys(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];pV(n[a],e)&&(l=!0,n[a+1]=i?R0(u):T0(u)),a=i?jr(u):Ys(u)}l&&(n[t+1]=i?T0(s):R0(s))}function pV(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Nl(n,e)>=0}const ei={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function fD(n){return n.substring(ei.key,ei.keyEnd)}function pD(n,e){const t=ei.textEnd;return t===e?-1:(e=ei.keyEnd=function vV(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,ei.key=e,t),Ql(n,e,t))}function Ql(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function pd(n,e,t){return qr(n,e,t,!1),pd}function zt(n,e){return qr(n,e,null,!0),zt}function Oo(n){!function Yr(n,e,t,i){const r=Tt(),s=qs(2);r.firstUpdatePass&&bD(r,null,s,i);const o=ne();if(t!==rt&&Ei(o,s,t)){const a=r.data[Bi()];if(SD(a,i)&&!yD(r,s)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=b_(l,t||"")),lv(r,a,o,t,i)}else!function EV(n,e,t,i,r,s,o,a){r===rt&&(r=Qt);let l=0,c=0,u=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;null!==u||null!==d;){const h=l<r.length?r[l+1]:void 0,f=c<s.length?s[c+1]:void 0;let p,g=null;u===d?(l+=2,c+=2,h!==f&&(g=d,p=f)):null===d||null!==u&&u<d?(l+=2,g=u):(c+=2,g=d,p=f),null!==g&&xD(n,e,t,i,g,p,o,a),u=l<r.length?r[l]:null,d=c<s.length?s[c]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function CV(n,e,t){if(null==t||""===t)return Qt;const i=[],r=Io(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,s)}}(lr,xs,n,!0)}function xs(n,e){for(let t=function mV(n){return function mD(n){ei.key=0,ei.keyEnd=0,ei.value=0,ei.valueEnd=0,ei.textEnd=n.length}(n),pD(n,Ql(n,0,ei.textEnd))}(e);t>=0;t=pD(e,t))lr(n,fD(e),!0)}function qr(n,e,t,i){const r=ne(),s=Tt(),o=qs(2);s.firstUpdatePass&&bD(s,n,o,i),e!==rt&&Ei(r,o,e)&&xD(s,s.data[Bi()],r,r[11],n,r[o+1]=function TV(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Ht(Io(n)))),n}(e,t),i,o)}function yD(n,e){return e>=n.expandoStartIndex}function bD(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[Bi()],o=yD(n,t);SD(s,i)&&null===e&&!o&&(e=!1),e=function xV(n,e,t,i){const r=function z_(n){const e=Je.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=gd(t=dv(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=dv(r,n,e,t,i),null===s){let l=function MV(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Ys(i))return n[jr(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=dv(null,n,e,l[1],i),l=gd(l,e.attrs,i),function SV(n,e,t,i){n[jr(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function DV(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=gd(i,n[s].hostAttrs,t);return gd(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function hV(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=jr(o),l=Ys(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const d=t;u=d[1],(null===u||Nl(d,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const h=jr(n[a+1]);n[i+1]=Wf(h,a),0!==h&&(n[h+1]=A0(n[h+1],i)),n[a+1]=function C3(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Wf(a,0),0!==a&&(n[a+1]=A0(n[a+1],i)),a=i;else n[i+1]=Wf(l,0),0===a?a=i:n[l+1]=A0(n[l+1],i),l=i;c&&(n[i+1]=T0(n[i+1])),hD(n,u,i,!0),hD(n,u,i,!1),function fV(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Nl(s,e)>=0&&(t[i+1]=R0(t[i+1]))}(e,u,n,i,s),o=Wf(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}function dv(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=gd(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function gd(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),lr(n,o,!!t||e[++s]))}return void 0===n?null:n}function xD(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];ep(function zM(n){return 1==(1&n)}(c)?MD(l,e,t,r,Ys(c),o):void 0)||(ep(s)||function HM(n){return 2==(2&n)}(c)&&(s=MD(l,null,t,r,a,o)),function p3(n,e,t,i,r){const s=En(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:cr.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=cr.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,vf(Bi(),t),r,s))}function MD(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=t[r+1];h===rt&&(h=d?Qt:void 0);let f=d?Q_(h,i):u===i?h:void 0;if(c&&!ep(f)&&(f=Q_(l,i)),ep(f)&&(a=f,o))return a;const g=n[r+1];r=o?jr(g):Ys(g)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=Q_(l,i))}return a}function ep(n){return void 0!==n}function SD(n,e){return 0!=(n.flags&(e?16:32))}function _i(n,e=""){const t=ne(),i=Tt(),r=n+20,s=i.firstCreatePass?Ll(i,r,1,e,null):i.data[r],o=t[r]=function b0(n,e){return En(n)?n.createText(e):n.createTextNode(e)}(t[11],e);zf(i,t,o,s),gs(s,!1)}function ec(n){return Ea("",n,""),ec}function Ea(n,e,t){const i=ne(),r=Wl(i,n,e,t);return r!==rt&&Zs(i,Bi(),r),Ea}function hv(n,e,t,i,r){const s=ne(),o=jl(s,n,e,t,i,r);return o!==rt&&Zs(s,Bi(),o),hv}function Fo(n,e,t){const i=ne();return Ei(i,Sl(),e)&&ur(Tt(),Tn(),i,n,e,i[11],t,!0),Fo}const tp="en-US";let WD=tp;function mv(n,e,t,i,r){if(n=ct(n),Array.isArray(n))for(let s=0;s<n.length;s++)mv(n[s],e,t,i,r);else{const s=Tt(),o=ne();let a=Hl(n)?n:ct(n.provide),l=wS(n);const c=Jn(),u=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(Hl(n)||!n.multi){const f=new Uu(l,r,L),g=vv(a,e,r?u:u+h,d);-1===g?(Rf(zu(c,o),s,a),_v(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[g]=f,o[g]=f)}else{const f=vv(a,e,u+h,d),g=vv(a,e,u,u+h),p=f>=0&&t[f],m=g>=0&&t[g];if(r&&!m||!r&&!p){Rf(zu(c,o),s,a);const v=function jU(n,e,t,i,r){const s=new Uu(n,t,L);return s.multi=[],s.index=e,s.componentProviders=0,pC(s,r,i&&!t),s}(r?WU:GU,t.length,r,i,l);!r&&m&&(t[g].providerFactory=v),_v(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(v),o.push(v)}else _v(s,n,f>-1?f:g,pC(t[r?g:f],l,!r&&i));!r&&i&&m&&t[g].componentProviders++}}}function _v(n,e,t,i){const r=Hl(e),s=function yB(n){return!!n.useClass}(e);if(r||s){const l=(s?ct(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[i,l]):c[u+1].push(i,l)}else c.push(t,l)}}}function pC(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function vv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function GU(n,e,t,i){return yv(this.multi,[])}function WU(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Gu(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),yv(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],yv(r,s);return s}function yv(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function en(n,e=[]){return t=>{t.providersResolver=(i,r)=>function zU(n,e,t){const i=Tt();if(i.firstCreatePass){const r=Gr(n);mv(t,i.data,i.blueprint,r,!0),mv(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class gC{}class YU{resolveComponentFactory(e){throw function qU(n){const e=Error(`No component factory found for ${Ht(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let ic=(()=>{class n{}return n.NULL=new YU,n})();function ZU(){return rc(Jn(),ne())}function rc(n,e){return new qt(Dr(n,e))}let qt=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=ZU,n})();function XU(n){return n instanceof qt?n.nativeElement:n}class bv{}let Ki=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function JU(){const n=ne(),t=ar(Jn().index,n);return function KU(n){return n[11]}(ps(t)?t:n)}(),n})(),QU=(()=>{class n{}return n.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>null}),n})();class bd{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const eH=new bd("13.3.4"),wv={};function op(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(Un(s)),zr(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&op(l[1],l,c,i)}const o=t.type;if(8&o)op(n,e,t.child,i);else if(32&o){const a=_0(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=RM(e,t);if(Array.isArray(a))i.push(...a);else{const l=id(e[16]);op(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class wd{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return op(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(zr(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(x0(e,i),Nf(t,i))}this._attachedToViewContainer=!1}wM(this._lView[1],this._lView)}onDestroy(e){nS(this._lView[1],this._lView,null,e)}markForCheck(){j0(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){q0(this._lView[1],this._lView,this.context)}checkNoChanges(){!function lB(n,e,t){bf(!0);try{q0(n,e,t)}finally{bf(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Et(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function r3(n,e){rd(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Et(902,"");this._appRef=e}}class tH extends wd{constructor(e){super(e),this._view=e}detectChanges(){dS(this._view)}checkNoChanges(){!function cB(n){bf(!0);try{dS(n)}finally{bf(!1)}}(this._view)}get context(){return null}}class _C extends ic{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Mi(e);return new xv(t,this.ngModule)}}function vC(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class xv extends gC{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function S3(n){return n.map(M3).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return vC(this.componentDef.inputs)}get outputs(){return vC(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function iH(n,e){return{get:(t,i,r)=>{const s=n.get(t,wv,r);return s!==wv||i===wv?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(bv,dx),a=s.get(QU,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function tS(n,e,t){if(En(n))return n.selectRootElement(e,t===fs.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):w0(o.createRenderer(null,this.componentDef),c,function nH(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(c)),d=this.componentDef.onPush?576:528,h=function PS(n,e){return{components:[],scheduler:n||XL,clean:uB,playerHandler:e||null,flags:0}}(),f=qf(0,null,null,1,0,null,null,null,null,null),g=sd(null,f,h,d,null,null,o,l,a,s);let p,m;wf(g);try{const v=function IS(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=Ll(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(Zf(l,c,!0),null!==n&&(Cf(r,n,c),null!==l.classes&&E0(r,n,l.classes),null!==l.styles&&PM(r,n,l.styles)));const u=i.createRenderer(n,e),d=sd(t,QM(e),null,e.onPush?64:16,t[20],l,i,u,s||null,null);return o.firstCreatePass&&(Rf(zu(l,t),o,e.type),aS(o,l),lS(l,t.length,1)),Yf(t,d),t[20]=d}(u,this.componentDef,g,o,l);if(u)if(i)Cf(l,u,["ng-version",eH.full]);else{const{attrs:_,classes:y}=function D3(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Wr(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);_&&Cf(l,u,_),y&&y.length>0&&E0(l,u,y.join(" "))}if(m=k_(f,20),void 0!==t){const _=m.projection=[];for(let y=0;y<this.ngContentSelectors.length;y++){const b=t[y];_.push(null!=b?Array.from(b):null)}}p=function NS(n,e,t,i,r){const s=t[1],o=function $3(n,e,t){const i=Jn();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),cS(n,i,e,Bl(n,e,1,null),t));const r=Gu(e,n,i.directiveStart,i);Ci(r,e);const s=Dr(i,e);return s&&Ci(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=Jn();e.contentQueries(1,o,l.directiveStart)}const a=Jn();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(To(a.index),sS(t[1],a,0,a.directiveStart,a.directiveEnd,e),oS(e,o)),o}(v,this.componentDef,g,h,[RB]),od(f,g,null)}finally{xf()}return new sH(this.componentType,p,rc(m,g),g,m)}}class sH extends class $U{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new tH(r),this.componentType=e}get injector(){return new El(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class Js{}class yC{}const sc=new Map;class xC extends Js{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new _C(this);const i=xr(e);this._bootstrapComponents=vs(i.bootstrap),this._r3Injector=bS(e,t,[{provide:Js,useValue:this},{provide:ic,useValue:this.componentFactoryResolver}],Ht(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=mi.THROW_IF_NOT_FOUND,i=tt.Default){return e===mi||e===Js||e===Z0?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Mv extends yC{constructor(e){super(),this.moduleType=e,null!==xr(e)&&function aH(n){const e=new Set;!function t(i){const r=xr(i,!0),s=r.id;null!==s&&(function bC(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${Ht(e)} vs ${Ht(e.name)}`)}(s,sc.get(s),i),sc.set(s,i));const o=vs(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new xC(this.moduleType,e)}}function ap(n,e,t,i){return function MC(n,e,t,i,r,s){const o=e+t;return Ei(n,o,r)?bs(n,o+1,s?i.call(s,r):i(r)):xd(n,o+1)}(ne(),Li(),n,e,t,i)}function Aa(n,e,t,i,r){return function SC(n,e,t,i,r,s,o){const a=e+t;return Da(n,a,r,s)?bs(n,a+2,o?i.call(o,r,s):i(r,s)):xd(n,a+2)}(ne(),Li(),n,e,t,i,r)}function lp(n,e,t,i,r,s){return function DC(n,e,t,i,r,s,o,a){const l=e+t;return function Kf(n,e,t,i,r){const s=Da(n,e,t,i);return Ei(n,e+2,r)||s}(n,l,r,s,o)?bs(n,l+3,a?i.call(a,r,s,o):i(r,s,o)):xd(n,l+3)}(ne(),Li(),n,e,t,i,r,s)}function xd(n,e){const t=n[e];return t===rt?void 0:t}function Sv(n){return e=>{setTimeout(n,void 0,e)}}const et=class xH extends on{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const d=e;a=null===(r=d.next)||void 0===r?void 0:r.bind(d),l=null===(s=d.error)||void 0===s?void 0:s.bind(d),c=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}this.__isAsync&&(l=Sv(l),a&&(a=Sv(a)),c&&(c=Sv(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof Q&&e.add(u),u}};function MH(){return this._results[zl()]()}class Dv{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=zl(),i=Dv.prototype;i[t]||(i[t]=MH)}get changes(){return this._changes||(this._changes=new et)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=Cr(e);(this._changesDetected=!function Ok(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let xn=(()=>{class n{}return n.__NG_ELEMENT_ID__=CH,n})();const SH=xn,DH=class extends SH{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=sd(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),od(t,i,e),new wd(i)}};function CH(){return cp(Jn(),ne())}function cp(n,e){return 4&n.type?new DH(e,n,rc(n,e)):null}let Zr=(()=>{class n{}return n.__NG_ELEMENT_ID__=EH,n})();function EH(){return RC(Jn(),ne())}const TH=Zr,TC=class extends TH{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return rc(this._hostTNode,this._hostLView)}get injector(){return new El(this._hostTNode,this._hostLView)}get parentInjector(){const e=Af(this._hostTNode,this._hostLView);if(Ex(e)){const t=Cl(e,this._hostLView),i=Dl(e);return new El(t[1].data[i+8],t)}return new El(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=AC(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=e&&!function ju(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const d=t||{};a=d.index,i=d.injector,r=d.projectableNodes,s=d.ngModuleRef}const l=o?e:new xv(Mi(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const h=(o?c:this.parentInjector).get(Js,null);h&&(s=h)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[1];if(function tk(n){return zr(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=i[3],h=new TC(d,d[6],d[3]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function o3(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],Lx(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function a3(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=D0(s,o),l=i[11],c=Hf(l,o[7]);return null!==c&&function n3(n,e,t,i,r,s){i[0]=r,i[6]=e,rd(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),Lx(Cv(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=AC(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=x0(this._lContainer,t);i&&(Nf(Cv(this._lContainer),t),wM(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=x0(this._lContainer,t);return i&&null!=Nf(Cv(this._lContainer),t)?new wd(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function AC(n){return n[8]}function Cv(n){return n[8]||(n[8]=[])}function RC(n,e){let t;const i=e[n.index];if(zr(i))t=i;else{let r;if(8&n.type)r=Un(i);else{const s=e[11];r=s.createComment("");const o=Dr(n,e);Sa(s,Hf(s,o),r,function d3(n,e){return En(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=uS(i,e,r,n),Yf(e,t)}return new TC(t,n,e)}class Ev{constructor(e){this.queryList=e,this.matches=null}clone(){return new Ev(this.queryList)}setDirty(){this.queryList.setDirty()}}class Tv{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Tv(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==FC(e,t).matches&&this.queries[t].setDirty()}}class IC{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Av{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new Av(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Rv{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Rv(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,IH(t,s)),this.matchTNodeWithReadOption(e,t,If(t,e,s,!1,!1))}else i===xn?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,If(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===qt||r===Zr||r===xn&&4&t.type)this.addMatch(t.index,-2);else{const s=If(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function IH(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function PH(n,e,t,i){return-1===t?function NH(n,e){return 11&n.type?rc(n,e):4&n.type?cp(n,e):null}(e,n):-2===t?function OH(n,e,t){return t===qt?rc(e,n):t===xn?cp(e,n):t===Zr?RC(e,n):void 0}(n,e,i):Gu(n,n[1],t,e)}function NC(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:PH(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function Iv(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=NC(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let d=10;d<u.length;d++){const h=u[d];h[17]===h[3]&&Iv(h[1],h,c,i)}if(null!==u[9]){const d=u[9];for(let h=0;h<d.length;h++){const f=d[h];Iv(f[1],f,c,i)}}}}}return i}function tn(n){const e=ne(),t=Tt(),i=vx();G_(i+1);const r=FC(t,i);if(n.dirty&&hx(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?Iv(t,e,i,[]):NC(t,e,r,i);n.reset(s,XU),n.notifyOnChanges()}return!0}return!1}function oc(n,e,t){const i=Tt();i.firstCreatePass&&(OC(i,new IC(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),PC(i,ne(),e)}function Rn(n,e,t,i){const r=Tt();if(r.firstCreatePass){const s=Jn();OC(r,new IC(e,t,i),s.index),function kH(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}PC(r,ne(),t)}function nn(){return function FH(n,e){return n[19].queries[e].queryList}(ne(),vx())}function PC(n,e,t){const i=new Dv(4==(4&t));nS(n,e,i,i.destroy),null===e[19]&&(e[19]=new Tv),e[19].queries.push(new Ev(i))}function OC(n,e,t){null===n.queries&&(n.queries=new Av),n.queries.track(new Rv(e,t))}function FC(n,e){return n.queries.getByIndex(e)}function Xr(n,e){return cp(n,e)}function hp(...n){}const Lv=new ft("Application Initializer");let Bv=(()=>{class n{constructor(t){this.appInits=t,this.resolve=hp,this.reject=hp,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(dd(s))t.push(s);else if(cv(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Ne(Lv,8))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Dd=new ft("AppId",{providedIn:"root",factory:function JC(){return`${Vv()}${Vv()}${Vv()}`}});function Vv(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const QC=new ft("Platform Initializer"),Uv=new ft("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),eE=new ft("appBootstrapListener");let QH=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Lo=new ft("LocaleId",{providedIn:"root",factory:()=>qk(Lo,tt.Optional|tt.SkipSelf)||function ez(){return"undefined"!=typeof $localize&&$localize.locale||tp}()});class nz{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let tE=(()=>{class n{compileModuleSync(t){return new Mv(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=vs(xr(t).declarations).reduce((o,a)=>{const l=Mi(a);return l&&o.push(new xv(l)),o},[]);return new nz(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const rz=(()=>Promise.resolve(0))();function Hv(n){"undefined"==typeof Zone?rz.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class dn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new et(!1),this.onMicrotaskEmpty=new et(!1),this.onStable=new et(!1),this.onError=new et(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function sz(){let n=jt.requestAnimationFrame,e=jt.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function lz(n){const e=()=>{!function az(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(jt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Gv(n),n.isCheckStableRunning=!0,zv(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Gv(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return nE(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),iE(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return nE(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),iE(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,Gv(n),zv(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!dn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(dn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,oz,hp,hp);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const oz={};function zv(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Gv(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function nE(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function iE(n){n._nesting--,zv(n)}class cz{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new et,this.onMicrotaskEmpty=new et,this.onStable=new et,this.onError=new et}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let Wv=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{dn.assertNotInAngularZone(),Hv(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Hv(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Ne(dn))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})(),uz=(()=>{class n{constructor(){this._applications=new Map,jv.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return jv.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();class dz{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let jv=new dz,Ra=null;const rE=new ft("AllowMultipleToken"),sE=new ft("PlatformOnDestroy");class oE{constructor(e,t){this.name=e,this.token=t}}function aE(n,e,t=[]){const i=`Platform: ${e}`,r=new ft(i);return(s=[])=>{let o=$v();if(!o||o.injector.get(rE,!1)){const a=[...t,...s,{provide:r,useValue:!0}];n?n(a):function gz(n){if(Ra&&!Ra.get(rE,!1))throw new Et(400,"");Ra=n;const e=n.get(lE),t=n.get(QC,null);t&&t.forEach(i=>i())}(function _z(n=[],e){return mi.create({name:e,providers:[{provide:X0,useValue:"platform"},{provide:sE,useValue:()=>Ra=null},...n]})}(a,i))}return function mz(n){const e=$v();if(!e)throw new Et(401,"");return e}()}}function $v(){var n;return null!==(n=null==Ra?void 0:Ra.get(lE))&&void 0!==n?n:null}let lE=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function vz(n,e){let t;return t="noop"===n?new cz:("zone.js"===n?void 0:n)||new dn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:dn,useValue:a}];return a.run(()=>{const c=mi.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),d=u.injector.get(nd,null);if(!d)throw new Et(402,"");return a.runOutsideAngular(()=>{const h=a.onError.subscribe({next:f=>{d.handleError(f)}});u.onDestroy(()=>{qv(this._modules,u),h.unsubscribe()})}),function yz(n,e,t){try{const i=t();return dd(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(d,a,()=>{const h=u.injector.get(Bv);return h.runInitializers(),h.donePromise.then(()=>(function QV(n){sr(n,"Expected localeId to be defined"),"string"==typeof n&&(WD=n.toLowerCase().replace(/_/g,"-"))}(u.injector.get(Lo,tp)||tp),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=cE({},i);return function fz(n,e,t){const i=new Mv(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(fp);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Et(403,"");t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Et(404,"");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(sE,null);null==t||t(),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Ne(mi))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function cE(n,e){return Array.isArray(e)?e.reduce(cE,n):Object.assign(Object.assign({},n),e)}let fp=(()=>{class n{constructor(t,i,r,s){this._zone=t,this._injector=i,this._exceptionHandler=r,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new Kt(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),a=new Kt(l=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{dn.assertNotInAngularZone(),Hv(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const u=this._zone.onUnstable.subscribe(()=>{dn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{c.unsubscribe(),u.unsubscribe()}});this.isStable=function bF(...n){const e=Ou(n),t=function fF(n,e){return"number"==typeof __(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?xi(i[0]):Pu(t)(li(i,e)):Vr}(o,a.pipe(function wF(n={}){const{connector:e=(()=>new on),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o=null,a=null,l=null,c=0,u=!1,d=!1;const h=()=>{null==a||a.unsubscribe(),a=null},f=()=>{h(),o=l=null,u=d=!1},g=()=>{const p=o;f(),null==p||p.unsubscribe()};return Cn((p,m)=>{c++,!d&&!u&&h();const v=l=null!=l?l:e();m.add(()=>{c--,0===c&&!d&&!u&&(a=v_(g,r))}),v.subscribe(m),o||(o=new af({next:_=>v.next(_),error:_=>{d=!0,h(),a=v_(f,t,_),v.error(_)},complete:()=>{u=!0,h(),a=v_(f,i),v.complete()}}),li(p).subscribe(o))})(s)}}()))}bootstrap(t,i){if(!this._initStatus.done)throw new Et(405,"");let r;r=t instanceof gC?t:this._injector.get(ic).resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function pz(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Js),a=r.create(mi.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(Wv,null),u=c&&a.injector.get(uz);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),qv(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Et(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;qv(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(eE,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(Ne(dn),Ne(mi),Ne(nd),Ne(Bv))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function qv(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let dE=!0,Tr=(()=>{class n{}return n.__NG_ELEMENT_ID__=xz,n})();function xz(n){return function Mz(n,e,t){if(mf(n)&&!t){const i=ar(n.index,e);return new wd(i,i)}return 47&n.type?new wd(e[16],e):null}(Jn(),ne(),16==(16&n))}class mE{constructor(){}supports(e){return ld(e)}create(e){return new Az(e)}}const Tz=(n,e)=>e;class Az{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Tz}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<vE(i,r,s)?t:i,a=vE(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,g=f+h;u<=g&&g<c&&(s[h]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!ld(e))throw new Et(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function UB(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[zl()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new Rz(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new _E),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new _E),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Rz{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Iz{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class _E{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new Iz,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function vE(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class yE{constructor(){}supports(e){return e instanceof Map||nv(e)}create(){return new Nz}}class Nz{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||nv(e)))throw new Et(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new Pz(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class Pz{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function bE(){return new mp([new mE])}let mp=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||bE()),deps:[[n,new Xu,new Ro]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Et(901,"")}}return n.\u0275prov=Ke({token:n,providedIn:"root",factory:bE}),n})();function wE(){return new Cd([new yE])}let Cd=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||wE()),deps:[[n,new Xu,new Ro]]}}find(t){const i=this.factories.find(s=>s.supports(t));if(i)return i;throw new Et(901,"")}}return n.\u0275prov=Ke({token:n,providedIn:"root",factory:wE}),n})();const kz=aE(null,"core",[]);let Lz=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Ne(fp))},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({}),n})(),_p=null;function Ms(){return _p}const vi=new ft("DocumentToken");let Na=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ke({token:n,factory:function(){return function Hz(){return Ne(xE)}()},providedIn:"platform"}),n})();const zz=new ft("Location Initialized");let xE=(()=>{class n extends Na{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ms().getBaseHref(this._doc)}onPopState(t){const i=Ms().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Ms().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){ME()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){ME()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Ne(vi))},n.\u0275prov=Ke({token:n,factory:function(){return function Gz(){return new xE(Ne(vi))}()},providedIn:"platform"}),n})();function ME(){return!!window.history.pushState}function Jv(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function SE(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Qs(n){return n&&"?"!==n[0]?"?"+n:n}let lc=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ke({token:n,factory:function(){return function Wz(n){const e=Ne(vi).location;return new DE(Ne(Na),e&&e.origin||"")}()},providedIn:"root"}),n})();const Qv=new ft("appBaseHref");let DE=(()=>{class n extends lc{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Jv(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Qs(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Qs(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Qs(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Ne(Na),Ne(Qv,8))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})(),jz=(()=>{class n extends lc{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=Jv(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Qs(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Qs(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Ne(Na),Ne(Qv,8))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})(),ey=(()=>{class n{constructor(t,i){this._subject=new et,this._urlChangeListeners=[],this._platformStrategy=t;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=SE(CE(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Qs(i))}normalize(t){return n.stripTrailingSlash(function qz(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,CE(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._platformStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Qs(i)),r)}replaceState(t,i="",r=null){this._platformStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Qs(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=Qs,n.joinWithSlash=Jv,n.stripTrailingSlash=SE,n.\u0275fac=function(t){return new(t||n)(Ne(lc),Ne(Na))},n.\u0275prov=Ke({token:n,factory:function(){return function $z(){return new ey(Ne(lc),Ne(Na))}()},providedIn:"root"}),n})();function CE(n){return n.replace(/\/index.html$/,"")}let uy=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(ld(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Ht(i.item)}`);this._toggleClass(i.item,!0)}),t.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!0)):Object.keys(t).forEach(i=>this._toggleClass(i,!!t[i])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!1)):Object.keys(t).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(t,i){(t=t.trim())&&t.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)(L(mp),L(Cd),L(qt),L(Ki))},n.\u0275dir=pe({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class NG{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ss=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new NG(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),FE(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{FE(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(L(Zr),L(xn),L(mp))},n.\u0275dir=pe({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function FE(n,e){n.context.$implicit=e.item}let Bo=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new PG,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){kE("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){kE("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(L(Zr),L(xn))},n.\u0275dir=pe({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class PG{constructor(){this.$implicit=null,this.ngIf=null}}function kE(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Ht(e)}'.`)}class dy{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let Ep=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const i=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(t)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=pe({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),n})(),LE=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new dy(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(t){return new(t||n)(L(Zr),L(xn),L(Ep,9))},n.\u0275dir=pe({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),n})(),Pa=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(t){if(t.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(t){return new(t||n)(L(Zr))},n.\u0275dir=pe({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[ki]}),n})(),Qi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({}),n})();let l4=(()=>{class n{}return n.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>new c4(Ne(vi),window)}),n})();class c4{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function u4(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=HE(this.window.history)||HE(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function HE(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class py extends class h4 extends class Uz{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Vz(n){_p||(_p=n)}(new py)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function f4(){return Ad=Ad||document.querySelector("base"),Ad?Ad.getAttribute("href"):null}();return null==t?null:function p4(n){Tp=Tp||document.createElement("a"),Tp.setAttribute("href",n);const e=Tp.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Ad=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function RG(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Tp,Ad=null;const zE=new ft("TRANSITION_ID"),m4=[{provide:Lv,useFactory:function g4(n,e,t){return()=>{t.get(Bv).donePromise.then(()=>{const i=Ms(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[zE,vi,mi],multi:!0}];class gy{static init(){!function hz(n){jv=n}(new gy)}addToWindow(e){jt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},jt.getAllAngularTestabilities=()=>e.getAllTestabilities(),jt.getAllAngularRootElements=()=>e.getAllRootElements(),jt.frameworkStabilizers||(jt.frameworkStabilizers=[]),jt.frameworkStabilizers.push(i=>{const r=jt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Ms().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let _4=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();const Ap=new ft("EventManagerPlugins");let Rp=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Ne(Ap),Ne(dn))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();class GE{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Ms().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let WE=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})(),Rd=(()=>{class n extends WE{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(jE),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(jE))}}return n.\u0275fac=function(t){return new(t||n)(Ne(vi))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();function jE(n){Ms().remove(n)}const my={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},_y=/%COMP%/g;function Ip(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?Ip(n,r,t):(r=r.replace(_y,n),t.push(r))}return t}function YE(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let vy=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new yy(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case fs.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new M4(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case fs.ShadowDom:return new S4(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=Ip(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Ne(Rp),Ne(Rd),Ne(Dd))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();class yy{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(my[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=my[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=my[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(cr.DashCase|cr.Important)?e.style.setProperty(t,i,r&cr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&cr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,YE(i)):this.eventManager.addEventListener(e,t,YE(i))}}class M4 extends yy{constructor(e,t,i,r){super(e),this.component=i;const s=Ip(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function b4(n){return"_ngcontent-%COMP%".replace(_y,n)}(r+"-"+i.id),this.hostAttr=function w4(n){return"_nghost-%COMP%".replace(_y,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class S4 extends yy{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Ip(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let D4=(()=>{class n extends GE{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Ne(vi))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();const XE=["alt","control","meta","shift"],E4={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},KE={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},T4={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let A4=(()=>{class n extends GE{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ms().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(XE.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function R4(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&KE.hasOwnProperty(e)&&(e=KE[e]))}return E4[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),XE.forEach(s=>{s!=r&&T4[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(Ne(vi))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();const O4=aE(kz,"browser",[{provide:Uv,useValue:"browser"},{provide:QC,useValue:function I4(){py.makeCurrent(),gy.init()},multi:!0},{provide:vi,useFactory:function P4(){return function KF(n){O_=n}(document),document},deps:[]}]),F4=[{provide:X0,useValue:"root"},{provide:nd,useFactory:function N4(){return new nd},deps:[]},{provide:Ap,useClass:D4,multi:!0,deps:[vi,dn,Uv]},{provide:Ap,useClass:A4,multi:!0,deps:[vi]},{provide:vy,useClass:vy,deps:[Rp,Rd,Dd]},{provide:bv,useExisting:vy},{provide:WE,useExisting:Rd},{provide:Rd,useClass:Rd,deps:[vi]},{provide:Wv,useClass:Wv,deps:[dn]},{provide:Rp,useClass:Rp,deps:[Ap,dn]},{provide:class d4{},useClass:_4,deps:[]}];let JE=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:Dd,useValue:t.appId},{provide:zE,useExisting:Dd},m4]}}}return n.\u0275fac=function(t){return new(t||n)(Ne(n,12))},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({providers:F4,imports:[Qi,Lz]}),n})();function st(...n){return li(n,Ou(n))}"undefined"!=typeof window&&window;class Wn extends on{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const{isArray:$4}=Array,{getPrototypeOf:q4,prototype:Y4,keys:Z4}=Object;function tT(n){if(1===n.length){const e=n[0];if($4(e))return{args:e,keys:null};if(function X4(n){return n&&"object"==typeof n&&q4(n)===Y4}(e)){const t=Z4(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:K4}=Array;function wy(n){return St(e=>function J4(n,e){return K4(e)?n(...e):n(e)}(n,e))}function nT(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function iT(n,e,t){n?Gs(t,n,e):e()}function Np(n,e){const t=Ct(n)?n:()=>n,i=r=>r.error(t());return new Kt(e?r=>e.schedule(i,0,r):i)}const Pp=hs(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function Id(...n){return function e5(){return Pu(1)}()(li(n,Ou(n)))}function rT(n){return new Kt(e=>{xi(n()).subscribe(e)})}function sT(){return Cn((n,e)=>{let t=null;n._refCount++;const i=an(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class t5 extends Kt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ow(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Q;const t=this.getSubject();e.add(this.source.subscribe(an(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Q.EMPTY)}return e}refCount(){return sT()(this)}}function to(n,e){return Cn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(an(i,l=>{null==r||r.unsubscribe();let c=0;const u=s++;xi(n(l,u)).subscribe(r=an(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Op(...n){const e=Ou(n);return Cn((t,i)=>{(e?Id(n,t,e):Id(n,t)).subscribe(i)})}function n5(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(an(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function oT(n,e){return Cn(n5(n,e,arguments.length>=2,!0))}function hr(n,e){return Cn((t,i)=>{let r=0;t.subscribe(an(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Uo(n){return Cn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(an(t,void 0,void 0,o=>{s=xi(n(o,Uo(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Nd(n,e){return Ct(e)?Vn(n,e,1):Vn(n,1)}function My(n){return n<=0?()=>Vr:Cn((e,t)=>{let i=[];e.subscribe(an(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function aT(n=i5){return Cn((e,t)=>{let i=!1;e.subscribe(an(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function i5(){return new Pp}function lT(n){return Cn((e,t)=>{let i=!1;e.subscribe(an(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function cc(n,e){const t=arguments.length>=2;return i=>i.pipe(n?hr((r,s)=>n(r,s,i)):zs,fi(1),t?lT(e):aT(()=>new Pp))}function zi(n,e,t){const i=Ct(n)||e||t?{next:n,error:e,complete:t}:n;return i?Cn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(an(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):zs}class no{constructor(e,t){this.id=e,this.url=t}}class Sy extends no{constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Pd extends no{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class cT extends no{constructor(e,t,i){super(e,t),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class o5 extends no{constructor(e,t,i){super(e,t),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class a5 extends no{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class l5 extends no{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class c5 extends no{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class u5 extends no{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class d5 extends no{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class uT{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class dT{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class h5{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class f5{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class p5{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class g5{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hT{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const mt="primary";class m5{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function uc(n){return new m5(n)}const fT="ngNavigationCancelingError";function Dy(n){const e=Error("NavigationCancelingError: "+n);return e[fT]=!0,e}function v5(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Ds(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!pT(n[r],e[r]))return!1;return!0}function pT(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function gT(n){return Array.prototype.concat.apply([],n)}function mT(n){return n.length>0?n[n.length-1]:null}function yi(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function Cs(n){return cv(n)?n:dd(n)?li(Promise.resolve(n)):st(n)}const w5={exact:function yT(n,e,t){if(!Fa(n.segments,e.segments)||!Fp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!yT(n.children[i],e.children[i],t))return!1;return!0},subset:bT},_T={exact:function x5(n,e){return Ds(n,e)},subset:function M5(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>pT(n[t],e[t]))},ignored:()=>!0};function vT(n,e,t){return w5[t.paths](n.root,e.root,t.matrixParams)&&_T[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function bT(n,e,t){return wT(n,e,e.segments,t)}function wT(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Fa(r,t)||e.hasChildren()||!Fp(r,t,i))}if(n.segments.length===t.length){if(!Fa(n.segments,t)||!Fp(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!bT(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Fa(n.segments,r)&&Fp(n.segments,r,i)&&n.children[mt])&&wT(n.children[mt],e,s,i)}}function Fp(n,e,t){return e.every((i,r)=>_T[t](n[r].parameters,i.parameters))}class Oa{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=uc(this.queryParams)),this._queryParamMap}toString(){return C5.serialize(this)}}class xt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,yi(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return kp(this)}}class Od{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=uc(this.parameters)),this._parameterMap}toString(){return CT(this)}}function Fa(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}class xT{}class MT{parse(e){const t=new F5(e);return new Oa(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Fd(e.root,!0)}`,i=function A5(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Lp(t)}=${Lp(r)}`).join("&"):`${Lp(t)}=${Lp(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function E5(n){return encodeURI(n)}(e.fragment)}`:""}`}}const C5=new MT;function kp(n){return n.segments.map(e=>CT(e)).join("/")}function Fd(n,e){if(!n.hasChildren())return kp(n);if(e){const t=n.children[mt]?Fd(n.children[mt],!1):"",i=[];return yi(n.children,(r,s)=>{s!==mt&&i.push(`${s}:${Fd(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function D5(n,e){let t=[];return yi(n.children,(i,r)=>{r===mt&&(t=t.concat(e(i,r)))}),yi(n.children,(i,r)=>{r!==mt&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===mt?[Fd(n.children[mt],!1)]:[`${r}:${Fd(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[mt]?`${kp(n)}/${t[0]}`:`${kp(n)}/(${t.join("//")})`}}function ST(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Lp(n){return ST(n).replace(/%3B/gi,";")}function Cy(n){return ST(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Bp(n){return decodeURIComponent(n)}function DT(n){return Bp(n.replace(/\+/g,"%20"))}function CT(n){return`${Cy(n.path)}${function T5(n){return Object.keys(n).map(e=>`;${Cy(e)}=${Cy(n[e])}`).join("")}(n.parameters)}`}const R5=/^[^\/()?;=#]+/;function Vp(n){const e=n.match(R5);return e?e[0]:""}const I5=/^[^=?&#]+/,P5=/^[^&#]+/;class F5{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new xt([],{}):new xt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[mt]=new xt(e,t)),i}parseSegment(){const e=Vp(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Od(Bp(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Vp(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Vp(this.remaining);r&&(i=r,this.capture(i))}e[Bp(t)]=Bp(i)}parseQueryParam(e){const t=function N5(n){const e=n.match(I5);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function O5(n){const e=n.match(P5);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=DT(t),s=DT(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Vp(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=mt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[mt]:new xt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class ET{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Ey(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Ey(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Ty(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Ty(e,this._root).map(t=>t.value)}}function Ey(n,e){if(n===e.value)return e;for(const t of e.children){const i=Ey(n,t);if(i)return i}return null}function Ty(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Ty(n,t);if(i.length)return i.unshift(e),i}return[]}class io{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function dc(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class TT extends ET{constructor(e,t){super(e),this.snapshot=t,Ay(this,e)}toString(){return this.snapshot.toString()}}function AT(n,e){const t=function k5(n,e){const o=new Up([],{},{},"",{},mt,e,null,n.root,-1,{});return new IT("",new io(o,[]))}(n,e),i=new Wn([new Od("",{})]),r=new Wn({}),s=new Wn({}),o=new Wn({}),a=new Wn(""),l=new hc(i,r,o,a,s,mt,e,t.root);return l.snapshot=t.root,new TT(new io(l,[]),t)}class hc{constructor(e,t,i,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(St(e=>uc(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(St(e=>uc(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function RT(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function L5(n){return n.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Up{constructor(e,t,i,r,s,o,a,l,c,u,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=uc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=uc(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class IT extends ET{constructor(e,t){super(t),this.url=e,Ay(this,t)}toString(){return NT(this._root)}}function Ay(n,e){e.value._routerState=n,e.children.forEach(t=>Ay(n,t))}function NT(n){const e=n.children.length>0?` { ${n.children.map(NT).join(", ")} } `:"";return`${n.value}${e}`}function Ry(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ds(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Ds(e.params,t.params)||n.params.next(t.params),function y5(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ds(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Ds(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Iy(n,e){const t=Ds(n.params,e.params)&&function S5(n,e){return Fa(n,e)&&n.every((t,i)=>Ds(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Iy(n.parent,e.parent))}function kd(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function V5(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return kd(n,i,r);return kd(n,i)})}(n,e,t);return new io(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>kd(n,a)),o}}const i=function U5(n){return new hc(new Wn(n.url),new Wn(n.params),new Wn(n.queryParams),new Wn(n.fragment),new Wn(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>kd(n,s));return new io(i,r)}}function Hp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Ld(n){return"object"==typeof n&&null!=n&&n.outlets}function Ny(n,e,t,i,r){let s={};if(i&&yi(i,(a,l)=>{s[l]=Array.isArray(a)?a.map(c=>`${c}`):`${a}`}),n===e)return new Oa(t,s,r);const o=PT(n,e,t);return new Oa(o,s,r)}function PT(n,e,t){const i={};return yi(n.children,(r,s)=>{i[s]=r===e?t:PT(r,e,t)}),new xt(n.segments,i)}class OT{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Hp(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(Ld);if(r&&r!==mT(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Py{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function FT(n,e,t){if(n||(n=new xt([],{})),0===n.segments.length&&n.hasChildren())return zp(n,e,t);const i=function $5(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(Ld(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!LT(l,c,o))return s;i+=2}else{if(!LT(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new xt(n.segments.slice(0,i.pathIndex),{});return s.children[mt]=new xt(n.segments.slice(i.pathIndex),n.children),zp(s,0,r)}return i.match&&0===r.length?new xt(n.segments,{}):i.match&&!n.hasChildren()?Oy(n,e,t):i.match?zp(n,0,r):Oy(n,e,t)}function zp(n,e,t){if(0===t.length)return new xt(n.segments,{});{const i=function j5(n){return Ld(n[0])?n[0].outlets:{[mt]:n}}(t),r={};return yi(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=FT(n.children[o],e,s))}),yi(n.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new xt(n.segments,r)}}function Oy(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Ld(s)){const l=q5(s.outlets);return new xt(i,l)}if(0===r&&Hp(t[0])){i.push(new Od(n.segments[e].path,kT(t[0]))),r++;continue}const o=Ld(s)?s.outlets[mt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Hp(a)?(i.push(new Od(o,kT(a))),r+=2):(i.push(new Od(o,{})),r++)}return new xt(i,{})}function q5(n){const e={};return yi(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Oy(new xt([],{}),0,t))}),e}function kT(n){const e={};return yi(n,(t,i)=>e[i]=`${t}`),e}function LT(n,e,t){return n==t.path&&Ds(e,t.parameters)}class Z5{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Ry(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=dc(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),yi(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=dc(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=dc(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=dc(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new g5(s.value.snapshot))}),e.children.length&&this.forwardEvent(new f5(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(Ry(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Ry(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=function X5(n){for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class Fy{constructor(e,t){this.routes=e,this.module=t}}function Ho(n){return"function"==typeof n}function ka(n){return n instanceof Oa}const Bd=Symbol("INITIAL_VALUE");function Vd(){return to(n=>function xy(...n){const e=Ou(n),t=cf(n),{args:i,keys:r}=tT(n);if(0===i.length)return li([],e);const s=new Kt(function Q4(n,e,t=zs){return i=>{iT(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)iT(e,()=>{const c=li(n[l],e);let u=!1;c.subscribe(an(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>nT(r,o):zs));return t?s.pipe(wy(t)):s}(n.map(e=>e.pipe(fi(1),Op(Bd)))).pipe(oT((e,t)=>{let i=!1;return t.reduce((r,s,o)=>r!==Bd?r:(s===Bd&&(i=!0),i||!1!==s&&o!==t.length-1&&!ka(s)?r:s),e)},Bd),hr(e=>e!==Bd),St(e=>ka(e)?e:!0===e),fi(1)))}class n8{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Ud,this.attachRef=null}}class Ud{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new n8,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let ky=(()=>{class n{constructor(t,i,r,s,o){this.parentContexts=t,this.location=i,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new et,this.deactivateEvents=new et,this.attachEvents=new et,this.detachEvents=new et,this.name=s||mt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const o=(i=i||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new i8(t,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(L(Ud),L(Zr),L(ic),Ma("name"),L(Tr))},n.\u0275dir=pe({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class i8{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===hc?this.route:e===Ud?this.childContexts:this.parent.get(e,t)}}let BT=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,i){1&t&&un(0,"router-outlet")},directives:[ky],encapsulation:2}),n})();function VT(n,e=""){for(let t=0;t<n.length;t++){const i=n[t];r8(i,s8(e,i))}}function r8(n,e){n.children&&VT(n.children,e)}function s8(n,e){return e?n||e.path?n&&!e.path?`${n}/`:!n&&e.path?e.path:`${n}/${e.path}`:"":n}function Ly(n){const e=n.children&&n.children.map(Ly),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==mt&&(t.component=BT),t}function Ir(n){return n.outlet||mt}function UT(n,e){const t=n.filter(i=>Ir(i)===e);return t.push(...n.filter(i=>Ir(i)!==e)),t}const HT={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Gp(n,e,t){var i;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},HT):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const s=(e.matcher||v5)(t,n,e);if(!s)return Object.assign({},HT);const o={};yi(s.posParams,(l,c)=>{o[c]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:a,positionalParamSegments:null!==(i=s.posParams)&&void 0!==i?i:{}}}function Wp(n,e,t,i,r="corrected"){if(t.length>0&&function l8(n,e,t){return t.some(i=>jp(n,e,i)&&Ir(i)!==mt)}(n,t,i)){const o=new xt(e,function a8(n,e,t,i){const r={};r[mt]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Ir(s)!==mt){const o=new xt([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,r[Ir(s)]=o}return r}(n,e,i,new xt(t,n.children)));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function c8(n,e,t){return t.some(i=>jp(n,e,i))}(n,t,i)){const o=new xt(n.segments,function o8(n,e,t,i,r,s){const o={};for(const a of i)if(jp(n,t,a)&&!r[Ir(a)]){const l=new xt([],{});l._sourceSegment=n,l._segmentIndexShift="legacy"===s?n.segments.length:e.length,o[Ir(a)]=l}return Object.assign(Object.assign({},r),o)}(n,e,t,i,n.children,r));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const s=new xt(n.segments,n.children);return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function jp(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function zT(n,e,t,i){return!!(Ir(n)===i||i!==mt&&jp(e,t,n))&&("**"===n.path||Gp(e,n,t).matched)}function GT(n,e,t){return 0===e.length&&!n.children[t]}class $p{constructor(e){this.segmentGroup=e||null}}class WT{constructor(e){this.urlTree=e}}function Hd(n){return Np(new $p(n))}function jT(n){return Np(new WT(n))}class f8{constructor(e,t,i,r,s){this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(Js)}apply(){const e=Wp(this.urlTree.root,[],[],this.config).segmentGroup,t=new xt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,mt).pipe(St(s=>this.createUrlTree(By(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Uo(s=>{if(s instanceof WT)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof $p?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,mt).pipe(St(r=>this.createUrlTree(By(r),e.queryParams,e.fragment))).pipe(Uo(r=>{throw r instanceof $p?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,i){const r=e.segments.length>0?new xt([],{[mt]:e}):e;return new Oa(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(St(s=>new xt([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return li(r).pipe(Nd(s=>{const o=i.children[s],a=UT(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(St(l=>({segment:l,outlet:s})))}),oT((s,o)=>(s[o.outlet]=o.segment,s),{}),function r5(n,e){const t=arguments.length>=2;return i=>i.pipe(n?hr((r,s)=>n(r,s,i)):zs,My(1),t?lT(e):aT(()=>new Pp))}())}expandSegment(e,t,i,r,s,o){return li(i).pipe(Nd(a=>this.expandSegmentAgainstRoute(e,t,i,a,r,s,o).pipe(Uo(c=>{if(c instanceof $p)return st(null);throw c}))),cc(a=>!!a),Uo((a,l)=>{if(a instanceof Pp||"EmptyError"===a.name)return GT(t,r,s)?st(new xt([],{})):Hd(t);throw a}))}expandSegmentAgainstRoute(e,t,i,r,s,o,a){return zT(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o):Hd(t):Hd(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?jT(s):this.lineralizeSegments(i,s).pipe(Vn(o=>{const a=new xt(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=Gp(t,r,s);if(!a)return Hd(t);const d=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?jT(d):this.lineralizeSegments(r,d).pipe(Vn(h=>this.expandSegment(e,t,i,h.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?st(i._loadedConfig):this.configLoader.load(e.injector,i)).pipe(St(d=>(i._loadedConfig=d,new xt(r,{})))):st(new xt(r,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=Gp(t,i,r);return o?this.getChildConfig(e,i,r).pipe(Vn(u=>{const d=u.module,h=u.routes,{segmentGroup:f,slicedSegments:g}=Wp(t,a,l,h),p=new xt(f.segments,f.children);if(0===g.length&&p.hasChildren())return this.expandChildren(d,h,p).pipe(St(y=>new xt(a,y)));if(0===h.length&&0===g.length)return st(new xt(a,{}));const m=Ir(i)===s;return this.expandSegment(d,p,h,g,m?mt:s,!0).pipe(St(_=>new xt(a.concat(_.segments),_.children)))})):Hd(t)}getChildConfig(e,t,i){return t.children?st(new Fy(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?st(t._loadedConfig):this.runCanLoadGuards(e.injector,t,i).pipe(Vn(r=>r?this.configLoader.load(e.injector,t).pipe(St(s=>(t._loadedConfig=s,s))):function d8(n){return Np(Dy(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`))}(t))):st(new Fy([],e))}runCanLoadGuards(e,t,i){const r=t.canLoad;return r&&0!==r.length?st(r.map(o=>{const a=e.get(o);let l;if(function J5(n){return n&&Ho(n.canLoad)}(a))l=a.canLoad(t,i);else{if(!Ho(a))throw new Error("Invalid CanLoad guard");l=a(t,i)}return Cs(l)})).pipe(Vd(),zi(o=>{if(!ka(o))return;const a=Dy(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),St(o=>!0===o)):st(!0)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return st(i);if(r.numberOfChildren>1||!r.children[mt])return Np(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));r=r.children[mt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreatreUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Oa(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return yi(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=t[a]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return yi(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,i,r)}),new xt(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}function By(n){const e={};for(const i of Object.keys(n.children)){const s=By(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function p8(n){if(1===n.numberOfChildren&&n.children[mt]){const e=n.children[mt];return new xt(n.segments.concat(e.segments),e.children)}return n}(new xt(n.segments,e))}class $T{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class qp{constructor(e,t){this.component=e,this.route=t}}function m8(n,e,t){const i=n._root;return zd(i,e?e._root:null,t,[i.value])}function Yp(n,e,t){const i=function v8(n){if(!n)return null;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(i?i.module.injector:t).get(n)}function zd(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=dc(e);return n.children.forEach(o=>{(function y8(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function b8(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Fa(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Fa(n.url,e.url)||!Ds(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Iy(n,e)||!Ds(n.queryParams,e.queryParams);default:return!Iy(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new $T(i)):(s.data=o.data,s._resolvedData=o._resolvedData),zd(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new qp(a.outlet.component,o))}else o&&Gd(e,a,r),r.canActivateChecks.push(new $T(i)),zd(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),yi(s,(o,a)=>Gd(o,t.getContext(a),r)),r}function Gd(n,e,t){const i=dc(n),r=n.value;yi(i,(s,o)=>{Gd(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new qp(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class A8{}function qT(n){return new Kt(e=>e.error(n))}class I8{constructor(e,t,i,r,s,o){this.rootComponentType=e,this.config=t,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const e=Wp(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,mt);if(null===t)return null;const i=new Up([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},mt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new io(i,t),s=new IT(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,i=RT(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}processChildren(e,t){const i=[];for(const s of Object.keys(t.children)){const o=t.children[s],a=UT(e,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;i.push(...l)}const r=YT(i);return function N8(n){n.sort((e,t)=>e.value.outlet===mt?-1:t.value.outlet===mt?1:e.value.outlet.localeCompare(t.value.outlet))}(r),r}processSegment(e,t,i,r){for(const s of e){const o=this.processSegmentAgainstRoute(s,t,i,r);if(null!==o)return o}return GT(t,i,r)?[]:null}processSegmentAgainstRoute(e,t,i,r){if(e.redirectTo||!zT(e,t,i,r))return null;let s,o=[],a=[];if("**"===e.path){const f=i.length>0?mT(i).parameters:{};s=new Up(i,f,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,KT(e),Ir(e),e.component,e,ZT(t),XT(t)+i.length,JT(e))}else{const f=Gp(t,e,i);if(!f.matched)return null;o=f.consumedSegments,a=f.remainingSegments,s=new Up(o,f.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,KT(e),Ir(e),e.component,e,ZT(t),XT(t)+o.length,JT(e))}const l=function P8(n){return n.children?n.children:n.loadChildren?n._loadedConfig.routes:[]}(e),{segmentGroup:c,slicedSegments:u}=Wp(t,o,a,l.filter(f=>void 0===f.redirectTo),this.relativeLinkResolution);if(0===u.length&&c.hasChildren()){const f=this.processChildren(l,c);return null===f?null:[new io(s,f)]}if(0===l.length&&0===u.length)return[new io(s,[])];const d=Ir(e)===r,h=this.processSegment(l,c,u,d?mt:r);return null===h?null:[new io(s,h)]}}function O8(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function YT(n){const e=[],t=new Set;for(const i of n){if(!O8(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=YT(i.children);e.push(new io(i.value,r))}return e.filter(i=>!t.has(i))}function ZT(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function XT(n){let e=n,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function KT(n){return n.data||{}}function JT(n){return n.resolve||{}}function QT(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Vy(n){return to(e=>{const t=n(e);return t?li(t).pipe(St(()=>e)):st(e)})}class z8 extends class H8{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Uy=new ft("ROUTES");class eA{constructor(e,t,i,r){this.injector=e,this.compiler=t,this.onLoadStartListener=i,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const r=this.loadModuleFactory(t.loadChildren).pipe(St(s=>{this.onLoadEndListener&&this.onLoadEndListener(t);const o=s.create(e);return new Fy(gT(o.injector.get(Uy,void 0,tt.Self|tt.Optional)).map(Ly),o)}),Uo(s=>{throw t._loader$=void 0,s}));return t._loader$=new t5(r,()=>new on).pipe(sT()),t._loader$}loadModuleFactory(e){return Cs(e()).pipe(Vn(t=>t instanceof yC?st(t):li(this.compiler.compileModuleAsync(t))))}}class W8{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function j8(n){throw n}function $8(n,e,t){return e.parse("/")}function tA(n,e){return st(null)}const q8={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Y8={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let fr=(()=>{class n{constructor(t,i,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new on,this.errorHandler=j8,this.malformedUriErrorHandler=$8,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:tA,afterPreactivation:tA},this.urlHandlingStrategy=new W8,this.routeReuseStrategy=new z8,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(Js),this.console=o.get(QH);const d=o.get(dn);this.isNgZoneEnabled=d instanceof dn&&dn.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function b5(){return new Oa(new xt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new eA(o,a,h=>this.triggerEvent(new uT(h)),h=>this.triggerEvent(new dT(h))),this.routerState=AT(this.currentUrlTree,this.rootComponentType),this.transitions=new Wn({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const i=this.events;return t.pipe(hr(r=>0!==r.id),St(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),to(r=>{let s=!1,o=!1;return st(r).pipe(zi(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),to(a=>{const l=this.browserUrlTree.toString(),c=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return nA(a.source)&&(this.browserUrlTree=a.extractedUrl),st(a).pipe(to(d=>{const h=this.transitions.getValue();return i.next(new Sy(d.id,this.serializeUrl(d.extractedUrl),d.source,d.restoredState)),h!==this.transitions.getValue()?Vr:Promise.resolve(d)}),function g8(n,e,t,i){return to(r=>function h8(n,e,t,i,r){return new f8(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(St(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),zi(d=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:d.urlAfterRedirects})}),function F8(n,e,t,i,r){return Vn(s=>function R8(n,e,t,i,r="emptyOnly",s="legacy"){try{const o=new I8(n,e,t,i,r,s).recognize();return null===o?qT(new A8):st(o)}catch(o){return qT(o)}}(n,e,s.urlAfterRedirects,t(s.urlAfterRedirects),i,r).pipe(St(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,d=>this.serializeUrl(d),this.paramsInheritanceStrategy,this.relativeLinkResolution),zi(d=>{if("eager"===this.urlUpdateStrategy){if(!d.extras.skipLocationChange){const f=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);this.setBrowserUrl(f,d)}this.browserUrlTree=d.urlAfterRedirects}const h=new a5(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);i.next(h)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:h,extractedUrl:f,source:g,restoredState:p,extras:m}=a,v=new Sy(h,this.serializeUrl(f),g,p);i.next(v);const _=AT(f,this.rootComponentType).snapshot;return st(Object.assign(Object.assign({},a),{targetSnapshot:_,urlAfterRedirects:f,extras:Object.assign(Object.assign({},m),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),Vr}),Vy(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:d,extras:{skipLocationChange:h,replaceUrl:f}}=a;return this.hooks.beforePreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:d,skipLocationChange:!!h,replaceUrl:!!f})}),zi(a=>{const l=new l5(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),St(a=>Object.assign(Object.assign({},a),{guards:m8(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function w8(n,e){return Vn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?st(Object.assign(Object.assign({},t),{guardsResult:!0})):function x8(n,e,t,i){return li(n).pipe(Vn(r=>function T8(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?st(s.map(a=>{const l=Yp(a,e,r);let c;if(function t8(n){return n&&Ho(n.canDeactivate)}(l))c=Cs(l.canDeactivate(n,e,t,i));else{if(!Ho(l))throw new Error("Invalid CanDeactivate guard");c=Cs(l(n,e,t,i))}return c.pipe(cc())})).pipe(Vd()):st(!0)}(r.component,r.route,t,e,i)),cc(r=>!0!==r,!0))}(o,i,r,n).pipe(Vn(a=>a&&function K5(n){return"boolean"==typeof n}(a)?function M8(n,e,t,i){return li(e).pipe(Nd(r=>Id(function D8(n,e){return null!==n&&e&&e(new h5(n)),st(!0)}(r.route.parent,i),function S8(n,e){return null!==n&&e&&e(new p5(n)),st(!0)}(r.route,i),function E8(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function _8(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>rT(()=>st(o.guards.map(l=>{const c=Yp(l,o.node,t);let u;if(function e8(n){return n&&Ho(n.canActivateChild)}(c))u=Cs(c.canActivateChild(i,n));else{if(!Ho(c))throw new Error("Invalid CanActivateChild guard");u=Cs(c(i,n))}return u.pipe(cc())})).pipe(Vd())));return st(s).pipe(Vd())}(n,r.path,t),function C8(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return st(!0);const r=i.map(s=>rT(()=>{const o=Yp(s,e,t);let a;if(function Q5(n){return n&&Ho(n.canActivate)}(o))a=Cs(o.canActivate(e,n));else{if(!Ho(o))throw new Error("Invalid CanActivate guard");a=Cs(o(e,n))}return a.pipe(cc())}));return st(r).pipe(Vd())}(n,r.route,t))),cc(r=>!0!==r,!0))}(i,s,n,e):st(a)),St(a=>Object.assign(Object.assign({},t),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),zi(a=>{if(ka(a.guardsResult)){const c=Dy(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw c.url=a.guardsResult,c}const l=new c5(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),hr(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),Vy(a=>{if(a.guards.canActivateChecks.length)return st(a).pipe(zi(l=>{const c=new u5(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),to(l=>{let c=!1;return st(l).pipe(function k8(n,e){return Vn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return st(t);let s=0;return li(r).pipe(Nd(o=>function L8(n,e,t,i){return function B8(n,e,t,i){const r=QT(n);if(0===r.length)return st({});const s={};return li(r).pipe(Vn(o=>function V8(n,e,t,i){const r=Yp(n,e,i);return Cs(r.resolve?r.resolve(e,t):r(e,t))}(n[o],e,t,i).pipe(zi(a=>{s[o]=a}))),My(1),Vn(()=>QT(s).length===r.length?st(s):Vr))}(n._resolve,n,e,i).pipe(St(s=>(n._resolvedData=s,n.data=Object.assign(Object.assign({},n.data),RT(n,t).resolve),null)))}(o.route,i,n,e)),zi(()=>s++),My(1),Vn(o=>s===r.length?st(t):Vr))})}(this.paramsInheritanceStrategy,this.ngModule.injector),zi({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),zi(l=>{const c=new d5(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}))}),Vy(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:d,extras:{skipLocationChange:h,replaceUrl:f}}=a;return this.hooks.afterPreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:d,skipLocationChange:!!h,replaceUrl:!!f})}),St(a=>{const l=function B5(n,e,t){const i=kd(n,e._root,t?t._root:void 0);return new TT(i,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),zi(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((n,e,t)=>St(i=>(new Z5(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),zi({next(){s=!0},complete(){s=!0}}),function s5(n){return Cn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}(()=>{var a;s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===r.id&&(this.currentNavigation=null)}),Uo(a=>{if(o=!0,function _5(n){return n&&n[fT]}(a)){const l=ka(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const c=new cT(r.id,this.serializeUrl(r.extractedUrl),a.message);i.next(c),l?setTimeout(()=>{const u=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),d={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||nA(r.source)};this.scheduleNavigation(u,"imperative",null,d,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new o5(r.id,this.serializeUrl(r.extractedUrl),a);i.next(l);try{r.resolve(this.errorHandler(a))}catch(c){r.reject(c)}}return Vr}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var r;const s={replaceUrl:!0},o=(null===(r=t.state)||void 0===r?void 0:r.navigationId)?t.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t.url);this.scheduleNavigation(a,i,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){VT(t),this.config=t.map(Ly),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=r||this.routerState.root,u=l?this.currentUrlTree.fragment:o;let d=null;switch(a){case"merge":d=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}return null!==d&&(d=this.removeEmptyProps(d)),function H5(n,e,t,i,r){if(0===t.length)return Ny(e.root,e.root,e.root,i,r);const s=function z5(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new OT(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return yi(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new OT(t,e,i)}(t);if(s.toRoot())return Ny(e.root,e.root,new xt([],{}),i,r);const o=function G5(n,e,t){if(n.isAbsolute)return new Py(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const s=t.snapshot._urlSegment;return new Py(s,s===e.root,0)}const i=Hp(n.commands[0])?0:1;return function W5(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new Py(i,!1,r-s)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+i,n.numberOfDoubleDots)}(s,e,n),a=o.processChildren?zp(o.segmentGroup,o.index,s.commands):FT(o.segmentGroup,o.index,s.commands);return Ny(e.root,o.segmentGroup,a,i,r)}(c,this.currentUrlTree,t,d,null!=u?u:null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=ka(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(t,i={skipLocationChange:!1}){return function Z8(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?Object.assign({},q8):!1===i?Object.assign({},Y8):i,ka(t))return vT(this.currentUrlTree,t,r);const s=this.parseUrl(t);return vT(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Pd(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,i,r,s,o){var a,l;if(this.disposed)return Promise.resolve(!1);let c,u,d;o?(c=o.resolve,u=o.reject,d=o.promise):d=new Promise((g,p)=>{c=g,u=p});const h=++this.navigationId;let f;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),f=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):f=0,this.setTransition({id:h,targetPageId:f,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:c,reject:u,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(g=>Promise.reject(g))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){var r,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,i){const r=new cT(t.id,this.serializeUrl(t.extractedUrl),i);this.triggerEvent(r),t.resolve(!1)}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){av()},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();function nA(n){return"imperative"!==n}class iA{}class rA{preload(e,t){return st(null)}}let sA=(()=>{class n{constructor(t,i,r,s){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=new eA(r,i,l=>t.triggerEvent(new uT(l)),l=>t.triggerEvent(new dT(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(hr(t=>t instanceof Pd),Nd(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Js);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(t,s)):s.children&&r.push(this.processRoutes(t,s.children));return li(r).pipe(Pu(),St(s=>{}))}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?st(i._loadedConfig):this.loader.load(t.injector,i)).pipe(Vn(s=>(i._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return n.\u0275fac=function(t){return new(t||n)(Ne(fr),Ne(tE),Ne(mi),Ne(iA))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})(),Gy=(()=>{class n{constructor(t,i,r={}){this.router=t,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Sy?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Pd&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof hT&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.router.triggerEvent(new hT(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){av()},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();const La=new ft("ROUTER_CONFIGURATION"),oA=new ft("ROUTER_FORROOT_GUARD"),Q8=[ey,{provide:xT,useClass:MT},{provide:fr,useFactory:function rW(n,e,t,i,r,s,o={},a,l){const c=new fr(null,n,e,t,i,r,gT(s));return a&&(c.urlHandlingStrategy=a),l&&(c.routeReuseStrategy=l),function sW(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(o,c),o.enableTracing&&c.events.subscribe(u=>{var d,h;null===(d=console.group)||void 0===d||d.call(console,`Router Event: ${u.constructor.name}`),console.log(u.toString()),console.log(u),null===(h=console.groupEnd)||void 0===h||h.call(console)}),c},deps:[xT,Ud,ey,mi,tE,Uy,La,[class G8{},new Ro],[class U8{},new Ro]]},Ud,{provide:hc,useFactory:function oW(n){return n.routerState.root},deps:[fr]},sA,rA,class J8{preload(e,t){return t().pipe(Uo(()=>st(null)))}},{provide:La,useValue:{enableTracing:!1}}];function eW(){return new oE("Router",fr)}let aA=(()=>{class n{constructor(t,i){}static forRoot(t,i){return{ngModule:n,providers:[Q8,lA(t),{provide:oA,useFactory:iW,deps:[[fr,new Ro,new Xu]]},{provide:La,useValue:i||{}},{provide:lc,useFactory:nW,deps:[Na,[new Ff(Qv),new Ro],La]},{provide:Gy,useFactory:tW,deps:[fr,l4,La]},{provide:iA,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:rA},{provide:oE,multi:!0,useFactory:eW},[Wy,{provide:Lv,multi:!0,useFactory:aW,deps:[Wy]},{provide:cA,useFactory:lW,deps:[Wy]},{provide:eE,multi:!0,useExisting:cA}]]}}static forChild(t){return{ngModule:n,providers:[lA(t)]}}}return n.\u0275fac=function(t){return new(t||n)(Ne(oA,8),Ne(fr,8))},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({}),n})();function tW(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new Gy(n,e,t)}function nW(n,e,t={}){return t.useHash?new jz(n,e):new DE(n,e)}function iW(n){return"guarded"}function lA(n){return[{provide:Pk,multi:!0,useValue:n},{provide:Uy,multi:!0,useValue:n}]}let Wy=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new on}appInitializer(){return this.injector.get(zz,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(a=>i=a),s=this.injector.get(fr),o=this.injector.get(La);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?st(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),r})}bootstrapListener(t){const i=this.injector.get(La),r=this.injector.get(sA),s=this.injector.get(Gy),o=this.injector.get(fr),a=this.injector.get(fp);t===a.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(Ne(mi))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();function aW(n){return n.appInitializer.bind(n)}function lW(n){return n.bootstrapListener.bind(n)}const cA=new ft("Router Initializer");function uA(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Zp(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){uA(s,i,r,o,a,"next",l)}function a(l){uA(s,i,r,o,a,"throw",l)}o(void 0)})}}const yc=1e3,Ti=1001,ni=1003,jn=1006,Ha=1009,qd=1012,Go=1015,wc=1016,xc=1020,Pr=1023,za=1026,Mc=1027,Sc=2400,Dc=2401,so=3e3,Yt=3001,oo="srgb",Ga="srgb-linear",Yd=35044,Zd=35048;class Wo{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const bi=[];for(let n=0;n<256;n++)bi[n]=(n<16?"0":"")+n.toString(16);let jA=1234567;const Wa=Math.PI/180,Xd=180/Math.PI;function pr(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(bi[255&n]+bi[n>>8&255]+bi[n>>16&255]+bi[n>>24&255]+"-"+bi[255&e]+bi[e>>8&255]+"-"+bi[e>>16&15|64]+bi[e>>24&255]+"-"+bi[63&t|128]+bi[t>>8&255]+"-"+bi[t>>16&255]+bi[t>>24&255]+bi[255&i]+bi[i>>8&255]+bi[i>>16&255]+bi[i>>24&255]).toLowerCase()}function kn(n,e,t){return Math.max(e,Math.min(t,n))}function rb(n,e){return(n%e+e)%e}function Kd(n,e,t){return(1-t)*n+t*e}function sb(n){return 0==(n&n-1)&&0!==n}function $A(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function ig(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}var Es=Object.freeze({__proto__:null,DEG2RAD:Wa,RAD2DEG:Xd,generateUUID:pr,clamp:kn,euclideanModulo:rb,mapLinear:function lj(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},inverseLerp:function cj(n,e,t){return n!==e?(t-n)/(e-n):0},lerp:Kd,damp:function uj(n,e,t,i){return Kd(n,e,1-Math.exp(-t*i))},pingpong:function dj(n,e=1){return e-Math.abs(rb(n,2*e)-e)},smoothstep:function hj(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)},smootherstep:function fj(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},randInt:function pj(n,e){return n+Math.floor(Math.random()*(e-n+1))},randFloat:function gj(n,e){return n+Math.random()*(e-n)},randFloatSpread:function mj(n){return n*(.5-Math.random())},seededRandom:function _j(n){void 0!==n&&(jA=n);let e=jA+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function vj(n){return n*Wa},radToDeg:function yj(n){return n*Xd},isPowerOfTwo:sb,ceilPowerOfTwo:$A,floorPowerOfTwo:ig,setQuaternionFromProperEuler:function bj(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+i)/2),u=o((e+i)/2),d=s((e-i)/2),h=o((e-i)/2),f=s((i-e)/2),g=o((i-e)/2);switch(r){case"XYX":n.set(a*u,l*d,l*h,a*c);break;case"YZY":n.set(l*h,a*u,l*d,a*c);break;case"ZXZ":n.set(l*d,l*h,a*u,a*c);break;case"XZX":n.set(a*u,l*g,l*f,a*c);break;case"YXY":n.set(l*f,a*u,l*g,a*c);break;case"ZYZ":n.set(l*g,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:function xj(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}},denormalize:function wj(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}});class K{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}K.prototype.isVector2=!0;class ii{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],g=i[8],p=r[0],m=r[3],v=r[6],_=r[1],y=r[4],b=r[7],w=r[2],S=r[5],C=r[8];return s[0]=o*p+a*_+l*w,s[3]=o*m+a*y+l*S,s[6]=o*v+a*b+l*C,s[1]=c*p+u*_+d*w,s[4]=c*m+u*y+d*S,s[7]=c*v+u*b+d*C,s[2]=h*p+f*_+g*w,s[5]=h*m+f*y+g*S,s[8]=h*v+f*b+g*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,g=t*d+i*h+r*f;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);const p=1/g;return e[0]=d*p,e[1]=(r*c-u*i)*p,e[2]=(a*i-r*o)*p,e[3]=h*p,e[4]=(u*t-r*l)*p,e[5]=(r*s-a*t)*p,e[6]=f*p,e[7]=(i*l-c*t)*p,e[8]=(o*t-i*s)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7];return r[0]=t*s+i*l,r[3]=t*o+i*c,r[6]=t*a+i*u,r[1]=-i*s+t*l,r[4]=-i*o+t*c,r[7]=-i*a+t*u,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function qA(n){for(let e=n.length-1;e>=0;--e)if(n[e]>65535)return!0;return!1}function Jd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function ja(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function rg(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}ii.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const ob={[oo]:{[Ga]:ja},[Ga]:{[oo]:rg}},Qr={legacyMode:!0,get workingColorSpace(){return Ga},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(ob[e]&&void 0!==ob[e][t]){const i=ob[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},YA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ri={r:0,g:0,b:0},es={h:0,s:0,l:0},sg={h:0,s:0,l:0};function ab(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}function og(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}let Tc,de=(()=>{class n{constructor(t,i,r){return void 0===i&&void 0===r?this.set(t):this.setRGB(t,i,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,i=oo){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Qr.toWorkingColorSpace(this,i),this}setRGB(t,i,r,s=Ga){return this.r=t,this.g=i,this.b=r,Qr.toWorkingColorSpace(this,s),this}setHSL(t,i,r,s=Ga){if(t=rb(t,1),i=kn(i,0,1),r=kn(r,0,1),0===i)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+i):r+i-r*i,a=2*r-o;this.r=ab(a,o,t+1/3),this.g=ab(a,o,t),this.b=ab(a,o,t-1/3)}return Qr.toWorkingColorSpace(this,s),this}setStyle(t,i=oo){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const l=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,Qr.toWorkingColorSpace(this,i),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,Qr.toWorkingColorSpace(this,i),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const c=parseFloat(o[1])/360,u=parseInt(o[2],10)/100,d=parseInt(o[3],10)/100;return r(o[4]),this.setHSL(c,u,d,i)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,Qr.toWorkingColorSpace(this,i),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,Qr.toWorkingColorSpace(this,i),this}return t&&t.length>0?this.setColorName(t,i):this}setColorName(t,i=oo){const r=YA[t.toLowerCase()];return void 0!==r?this.setHex(r,i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=ja(t.r),this.g=ja(t.g),this.b=ja(t.b),this}copyLinearToSRGB(t){return this.r=rg(t.r),this.g=rg(t.g),this.b=rg(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=oo){return Qr.fromWorkingColorSpace(og(this,ri),t),kn(255*ri.r,0,255)<<16^kn(255*ri.g,0,255)<<8^kn(255*ri.b,0,255)<<0}getHexString(t=oo){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,i=Ga){Qr.fromWorkingColorSpace(og(this,ri),i);const r=ri.r,s=ri.g,o=ri.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,u;const d=(l+a)/2;if(l===a)c=0,u=0;else{const h=a-l;switch(u=d<=.5?h/(a+l):h/(2-a-l),a){case r:c=(s-o)/h+(s<o?6:0);break;case s:c=(o-r)/h+2;break;case o:c=(r-s)/h+4}c/=6}return t.h=c,t.s=u,t.l=d,t}getRGB(t,i=Ga){return Qr.fromWorkingColorSpace(og(this,ri),i),t.r=ri.r,t.g=ri.g,t.b=ri.b,t}getStyle(t=oo){return Qr.fromWorkingColorSpace(og(this,ri),t),t!==oo?`color(${t} ${ri.r} ${ri.g} ${ri.b})`:`rgb(${255*ri.r|0},${255*ri.g|0},${255*ri.b|0})`}offsetHSL(t,i,r){return this.getHSL(es),es.h+=t,es.s+=i,es.l+=r,this.setHSL(es.h,es.s,es.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,r){return this.r=t.r+(i.r-t.r)*r,this.g=t.g+(i.g-t.g)*r,this.b=t.b+(i.b-t.b)*r,this}lerpHSL(t,i){this.getHSL(es),t.getHSL(sg);const r=Kd(es.h,sg.h,i),s=Kd(es.s,sg.s,i),o=Kd(es.l,sg.l,i);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return n.NAMES=YA,n})();de.prototype.isColor=!0,de.prototype.r=1,de.prototype.g=1,de.prototype.b=1;class $a{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Tc&&(Tc=Jd("canvas")),Tc.width=e.width,Tc.height=e.height;const i=Tc.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Tc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Jd("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*ja(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*ja(t[i]/255)):ja(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Ac{constructor(e=null){this.uuid=pr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(lb(r[o].isDataTexture?r[o].image:r[o]))}else s=lb(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function lb(n){return"undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&n instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?$a.getDataURL(n):n.data?{data:Array.prototype.slice.call(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Ac.prototype.isSource=!0;let Sj=0,Ai=(()=>{class n extends Wo{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Ti,s=Ti,o=jn,a=1008,l=Pr,c=Ha,u=1,d=so){super(),Object.defineProperty(this,"id",{value:Sj++}),this.uuid=pr(),this.name="",this.source=new Ac(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new K(0,0),this.repeat=new K(1,1),this.center=new K(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ii,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case yc:t.x=t.x-Math.floor(t.x);break;case Ti:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case yc:t.y=t.y-Math.floor(t.y);break;case Ti:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n})();Ai.prototype.isTexture=!0;class Ot{constructor(e=0,t=0,i=0,r=1){this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],g=l[9],p=l[2],m=l[6],v=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-p)<.01&&Math.abs(g-m)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+p)<.1&&Math.abs(g+m)<.1&&Math.abs(c+f+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(c+1)/2,b=(f+1)/2,w=(v+1)/2,S=(u+h)/4,C=(d+p)/4,E=(g+m)/4;return y>b&&y>w?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=S/i,s=C/i):b>w?b<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),i=S/r,s=E/r):w<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),i=C/s,r=E/s),this.set(i,r,s,t),this}let _=Math.sqrt((m-g)*(m-g)+(d-p)*(d-p)+(h-u)*(h-u));return Math.abs(_)<.001&&(_=1),this.x=(m-g)/_,this.y=(d-p)/_,this.z=(h-u)/_,this.w=Math.acos((c+f+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Ot.prototype.isVector4=!0;class gr extends Wo{constructor(e,t,i={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Ot(0,0,e,t),this.scissorTest=!1,this.viewport=new Ot(0,0,e,t),this.texture=new Ai({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:jn,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0,this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}gr.prototype.isWebGLRenderTarget=!0;class ag extends Ai{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=ni,this.minFilter=ni,this.wrapR=Ti,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}ag.prototype.isDataArrayTexture=!0,class Dj extends gr{constructor(e,t,i){super(e,t),this.depth=i,this.texture=new ag(null,e,t,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGLArrayRenderTarget=!0;class cb extends Ai{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=ni,this.minFilter=ni,this.wrapR=Ti,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}cb.prototype.isData3DTexture=!0,class Cj extends gr{constructor(e,t,i){super(e,t),this.depth=i,this.texture=new cb(null,e,t,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGL3DRenderTarget=!0,class Ej extends gr{constructor(e,t,i,r={}){super(e,t,r);const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class Ft{constructor(e=0,t=0,i=0,r=1){this._x=e,this._y=t,this._z=i,this._w=r}static slerp(e,t,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,r)}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],g=s[o+2],p=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=g,void(e[t+3]=p);if(d!==p||l!==h||c!==f||u!==g){let m=1-a;const v=l*h+c*f+u*g+d*p,_=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){const w=Math.sqrt(y),S=Math.atan2(w,v*_);m=Math.sin(m*S)/w,a=Math.sin(a*S)/w}const b=a*_;if(l=l*m+h*b,c=c*m+f*b,u=u*m+g*b,d=d*m+p*b,m===1-a){const w=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=w,c*=w,u*=w,d*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],g=s[o+3];return e[t]=a*g+u*d+l*f-c*h,e[t+1]=l*g+u*h+c*d-a*f,e[t+2]=c*g+u*f+a*h-l*d,e[t+3]=u*g-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),f=l(r/2),g=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*g,this._y=c*f*d-h*u*g,this._z=c*u*g+h*f*d,this._w=c*u*d-h*f*g;break;case"YXZ":this._x=h*u*d+c*f*g,this._y=c*f*d-h*u*g,this._z=c*u*g-h*f*d,this._w=c*u*d+h*f*g;break;case"ZXY":this._x=h*u*d-c*f*g,this._y=c*f*d+h*u*g,this._z=c*u*g+h*f*d,this._w=c*u*d-h*f*g;break;case"ZYX":this._x=h*u*d-c*f*g,this._y=c*f*d+h*u*g,this._z=c*u*g-h*f*d,this._w=c*u*d+h*f*g;break;case"YZX":this._x=h*u*d+c*f*g,this._y=c*f*d+h*u*g,this._z=c*u*g-h*f*d,this._w=c*u*d-h*f*g;break;case"XZY":this._x=h*u*d-c*f*g,this._y=c*f*d-h*u*g,this._z=c*u*g+h*f*d,this._w=c*u*d+h*f*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(kn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Ft.prototype.isQuaternion=!0;class M{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(ZA.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ZA.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,d=l*r+s*i-o*t,h=-s*t-o*i-a*r;return this.x=c*l+h*-s+u*-a-d*-o,this.y=u*l+h*-o+d*-s-c*-a,this.z=d*l+h*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return ub.copy(this).projectOnVector(e),this.sub(ub)}reflect(e){return this.sub(ub.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(kn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}M.prototype.isVector3=!0;const ub=new M,ZA=new Ft;class Or{constructor(e=new M(1/0,1/0,1/0),t=new M(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],d=e[l+1],h=e[l+2];u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),d=e.getY(l),h=e.getZ(l);u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>s&&(s=u),d>o&&(o=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=qa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)qa.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(qa)}else null===i.boundingBox&&i.computeBoundingBox(),db.copy(i.boundingBox),db.applyMatrix4(e.matrixWorld),this.union(db);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,qa),qa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Qd),lg.subVectors(this.max,Qd),Rc.subVectors(e.a,Qd),Ic.subVectors(e.b,Qd),Nc.subVectors(e.c,Qd),jo.subVectors(Ic,Rc),$o.subVectors(Nc,Ic),Ya.subVectors(Rc,Nc);let t=[0,-jo.z,jo.y,0,-$o.z,$o.y,0,-Ya.z,Ya.y,jo.z,0,-jo.x,$o.z,0,-$o.x,Ya.z,0,-Ya.x,-jo.y,jo.x,0,-$o.y,$o.x,0,-Ya.y,Ya.x,0];return!(!hb(t,Rc,Ic,Nc,lg)||(t=[1,0,0,0,1,0,0,0,1],!hb(t,Rc,Ic,Nc,lg)))&&(cg.crossVectors(jo,$o),t=[cg.x,cg.y,cg.z],hb(t,Rc,Ic,Nc,lg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qa.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(qa).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(ao[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ao[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ao[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ao[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ao[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ao[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ao[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ao[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ao)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Or.prototype.isBox3=!0;const ao=[new M,new M,new M,new M,new M,new M,new M,new M],qa=new M,db=new Or,Rc=new M,Ic=new M,Nc=new M,jo=new M,$o=new M,Ya=new M,Qd=new M,lg=new M,cg=new M,Za=new M;function hb(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Za.fromArray(n,s);const a=r.x*Math.abs(Za.x)+r.y*Math.abs(Za.y)+r.z*Math.abs(Za.z),l=e.dot(Za),c=t.dot(Za),u=i.dot(Za);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const Tj=new Or,XA=new M,ug=new M,fb=new M;class Xa{constructor(e=new M,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):Tj.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){fb.subVectors(e,this.center);const t=fb.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.add(fb.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?ug.set(0,0,1).multiplyScalar(e.radius):ug.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(XA.copy(e.center).add(ug)),this.expandByPoint(XA.copy(e.center).sub(ug)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const lo=new M,pb=new M,dg=new M,qo=new M,gb=new M,hg=new M,mb=new M;class Ka{constructor(e=new M,t=new M(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,lo)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=lo.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(lo.copy(this.direction).multiplyScalar(t).add(this.origin),lo.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){pb.copy(e).add(t).multiplyScalar(.5),dg.copy(t).sub(e).normalize(),qo.copy(this.origin).sub(pb);const s=.5*e.distanceTo(t),o=-this.direction.dot(dg),a=qo.dot(this.direction),l=-qo.dot(dg),c=qo.lengthSq(),u=Math.abs(1-o*o);let d,h,f,g;if(u>0)if(d=o*l-a,h=o*a-l,g=s*u,d>=0)if(h>=-g)if(h<=g){const p=1/u;d*=p,h*=p,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-g?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=g?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.direction).multiplyScalar(d).add(this.origin),r&&r.copy(dg).multiplyScalar(h).add(pb),f}intersectSphere(e,t){lo.subVectors(e.center,this.origin);const i=lo.dot(this.direction),r=lo.dot(lo)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||i!=i)&&(i=s),(o<r||r!=r)&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,lo)}intersectTriangle(e,t,i,r,s){gb.subVectors(t,e),hg.subVectors(i,e),mb.crossVectors(gb,hg);let a,o=this.direction.dot(mb);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}qo.subVectors(this.origin,e);const l=a*this.direction.dot(hg.crossVectors(qo,hg));if(l<0)return null;const c=a*this.direction.dot(gb.cross(qo));if(c<0||l+c>o)return null;const u=-a*qo.dot(mb);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ue{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,s,o,a,l,c,u,d,h,f,g,p,m){const v=this.elements;return v[0]=e,v[4]=t,v[8]=i,v[12]=r,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=c,v[6]=u,v[10]=d,v[14]=h,v[3]=f,v[7]=g,v[11]=p,v[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ue).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Pc.setFromMatrixColumn(e,0).length(),s=1/Pc.setFromMatrixColumn(e,1).length(),o=1/Pc.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,g=a*u,p=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+g*c,t[5]=h-p*c,t[9]=-a*l,t[2]=p-h*c,t[6]=g+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*u,f=l*d,g=c*u,p=c*d;t[0]=h+p*a,t[4]=g*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-g,t[6]=p+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*u,f=l*d,g=c*u,p=c*d;t[0]=h-p*a,t[4]=-o*d,t[8]=g+f*a,t[1]=f+g*a,t[5]=o*u,t[9]=p-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*u,f=o*d,g=a*u,p=a*d;t[0]=l*u,t[4]=g*c-f,t[8]=h*c+p,t[1]=l*d,t[5]=p*c+h,t[9]=f*c-g,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,g=a*l,p=a*c;t[0]=l*u,t[4]=p-h*d,t[8]=g*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+g,t[10]=h-p*d}else if("XZY"===e.order){const h=o*l,f=o*c,g=a*l,p=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+p,t[5]=o*u,t[9]=f*d-g,t[2]=g*d-f,t[6]=a*u,t[10]=p*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Aj,e,Rj)}lookAt(e,t,i){const r=this.elements;return mr.subVectors(e,t),0===mr.lengthSq()&&(mr.z=1),mr.normalize(),Yo.crossVectors(i,mr),0===Yo.lengthSq()&&(1===Math.abs(i.z)?mr.x+=1e-4:mr.z+=1e-4,mr.normalize(),Yo.crossVectors(i,mr)),Yo.normalize(),fg.crossVectors(mr,Yo),r[0]=Yo.x,r[4]=fg.x,r[8]=mr.x,r[1]=Yo.y,r[5]=fg.y,r[9]=mr.y,r[2]=Yo.z,r[6]=fg.z,r[10]=mr.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],g=i[2],p=i[6],m=i[10],v=i[14],_=i[3],y=i[7],b=i[11],w=i[15],S=r[0],C=r[4],E=r[8],B=r[12],N=r[1],x=r[5],R=r[9],z=r[13],P=r[2],V=r[6],k=r[10],U=r[14],F=r[3],G=r[7],q=r[11],ee=r[15];return s[0]=o*S+a*N+l*P+c*F,s[4]=o*C+a*x+l*V+c*G,s[8]=o*E+a*R+l*k+c*q,s[12]=o*B+a*z+l*U+c*ee,s[1]=u*S+d*N+h*P+f*F,s[5]=u*C+d*x+h*V+f*G,s[9]=u*E+d*R+h*k+f*q,s[13]=u*B+d*z+h*U+f*ee,s[2]=g*S+p*N+m*P+v*F,s[6]=g*C+p*x+m*V+v*G,s[10]=g*E+p*R+m*k+v*q,s[14]=g*B+p*z+m*U+v*ee,s[3]=_*S+y*N+b*P+w*F,s[7]=_*C+y*x+b*V+w*G,s[11]=_*E+y*R+b*k+w*q,s[15]=_*B+y*z+b*U+w*ee,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*f-s*o*d+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],g=e[12],p=e[13],m=e[14],v=e[15],_=d*m*c-p*h*c+p*l*f-a*m*f-d*l*v+a*h*v,y=g*h*c-u*m*c-g*l*f+o*m*f+u*l*v-o*h*v,b=u*p*c-g*d*c+g*a*f-o*p*f-u*a*v+o*d*v,w=g*d*l-u*p*l-g*a*h+o*p*h+u*a*m-o*d*m,S=t*_+i*y+r*b+s*w;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/S;return e[0]=_*C,e[1]=(p*h*s-d*m*s-p*r*f+i*m*f+d*r*v-i*h*v)*C,e[2]=(a*m*s-p*l*s+p*r*c-i*m*c-a*r*v+i*l*v)*C,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*f-i*l*f)*C,e[4]=y*C,e[5]=(u*m*s-g*h*s+g*r*f-t*m*f-u*r*v+t*h*v)*C,e[6]=(g*l*s-o*m*s-g*r*c+t*m*c+o*r*v-t*l*v)*C,e[7]=(o*h*s-u*l*s+u*r*c-t*h*c-o*r*f+t*l*f)*C,e[8]=b*C,e[9]=(g*d*s-u*p*s-g*i*f+t*p*f+u*i*v-t*d*v)*C,e[10]=(o*p*s-g*a*s+g*i*c-t*p*c-o*i*v+t*a*v)*C,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*f-t*a*f)*C,e[12]=w*C,e[13]=(u*p*r-g*d*r+g*i*h-t*p*h-u*i*m+t*d*m)*C,e[14]=(g*a*r-o*p*r-g*i*l+t*p*l+o*i*m-t*a*m)*C,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*h+t*a*h)*C,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,g=s*d,p=o*u,m=o*d,v=a*d,_=l*c,y=l*u,b=l*d,w=i.x,S=i.y,C=i.z;return r[0]=(1-(p+v))*w,r[1]=(f+b)*w,r[2]=(g-y)*w,r[3]=0,r[4]=(f-b)*S,r[5]=(1-(h+v))*S,r[6]=(m+_)*S,r[7]=0,r[8]=(g+y)*C,r[9]=(m-_)*C,r[10]=(1-(h+p))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Pc.set(r[0],r[1],r[2]).length();const o=Pc.set(r[4],r[5],r[6]).length(),a=Pc.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ts.copy(this);const c=1/s,u=1/o,d=1/a;return ts.elements[0]*=c,ts.elements[1]*=c,ts.elements[2]*=c,ts.elements[4]*=u,ts.elements[5]*=u,ts.elements[6]*=u,ts.elements[8]*=d,ts.elements[9]*=d,ts.elements[10]*=d,t.setFromRotationMatrix(ts),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*s/(i-r),u=(t+e)/(t-e),d=(i+r)/(i-r),h=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,s,o){const a=this.elements,l=1/(t-e),c=1/(i-r),u=1/(o-s),d=(t+e)*l,h=(i+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}ue.prototype.isMatrix4=!0;const Pc=new M,ts=new ue,Aj=new M(0,0,0),Rj=new M(1,1,1),Yo=new M,fg=new M,mr=new M,KA=new ue,JA=new Ft;class _r{constructor(e=0,t=0,i=0,r=_r.DefaultOrder){this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],d=r[2],h=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(kn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-kn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(kn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-kn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(kn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-kn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===i&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return KA.makeRotationFromQuaternion(e),this.setFromRotationMatrix(KA,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return JA.setFromEuler(this),this.setFromQuaternion(JA,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}_r.prototype.isEuler=!0,_r.DefaultOrder="XYZ",_r.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class _b{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Ij=0;const QA=new M,Oc=new Ft,co=new ue,pg=new M,eh=new M,Nj=new M,Pj=new Ft,eR=new M(1,0,0),tR=new M(0,1,0),nR=new M(0,0,1),Oj={type:"added"},iR={type:"removed"};class Mt extends Wo{constructor(){super(),Object.defineProperty(this,"id",{value:Ij++}),this.uuid=pr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Mt.DefaultUp.clone();const e=new M,t=new _r,i=new Ft,r=new M(1,1,1);t._onChange(function s(){i.setFromEuler(t,!1)}),i._onChange(function o(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ue},normalMatrix:{value:new ii}}),this.matrix=new ue,this.matrixWorld=new ue,this.matrixAutoUpdate=Mt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new _b,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Oc.setFromAxisAngle(e,t),this.quaternion.multiply(Oc),this}rotateOnWorldAxis(e,t){return Oc.setFromAxisAngle(e,t),this.quaternion.premultiply(Oc),this}rotateX(e){return this.rotateOnAxis(eR,e)}rotateY(e){return this.rotateOnAxis(tR,e)}rotateZ(e){return this.rotateOnAxis(nR,e)}translateOnAxis(e,t){return QA.copy(e).applyQuaternion(this.quaternion),this.position.add(QA.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(eR,e)}translateY(e){return this.translateOnAxis(tR,e)}translateZ(e){return this.translateOnAxis(nR,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(co.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?pg.copy(e):pg.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),eh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?co.lookAt(eh,pg,this.up):co.lookAt(pg,eh,this.up),this.quaternion.setFromRotationMatrix(co),r&&(co.extractRotation(r.matrixWorld),Oc.setFromRotationMatrix(co),this.quaternion.premultiply(Oc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Oj)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(iR)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(iR)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),co.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),co.multiply(e.parent.matrixWorld)),e.applyMatrix4(co),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(void 0!==o)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eh,e,Nj),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eh,Pj,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function s(a,l){return void 0===a[l.uuid]&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++)s(e.shapes,l[c]);else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++)r.animations.push(s(e.animations,this.animations[a]))}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),d=o(e.shapes),h=o(e.skeletons),f=o(e.animations),g=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),d.length>0&&(i.shapes=d),h.length>0&&(i.skeletons=h),f.length>0&&(i.animations=f),g.length>0&&(i.nodes=g)}return i.object=r,i;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let i=0;i<e.children.length;i++)this.add(e.children[i].clone());return this}}Mt.DefaultUp=new M(0,1,0),Mt.DefaultMatrixAutoUpdate=!0,Mt.prototype.isObject3D=!0;const ns=new M,uo=new M,vb=new M,ho=new M,Fc=new M,kc=new M,rR=new M,yb=new M,bb=new M,wb=new M;class $n{constructor(e=new M,t=new M,i=new M){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ns.subVectors(e,t),r.cross(ns);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){ns.subVectors(r,t),uo.subVectors(i,t),vb.subVectors(e,t);const o=ns.dot(ns),a=ns.dot(uo),l=ns.dot(vb),c=uo.dot(uo),u=uo.dot(vb),d=o*c-a*a;if(0===d)return s.set(-2,-1,-1);const h=1/d,f=(c*l-a*u)*h,g=(o*u-a*l)*h;return s.set(1-f-g,g,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,ho),ho.x>=0&&ho.y>=0&&ho.x+ho.y<=1}static getUV(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,ho),l.set(0,0),l.addScaledVector(s,ho.x),l.addScaledVector(o,ho.y),l.addScaledVector(a,ho.z),l}static isFrontFacing(e,t,i,r){return ns.subVectors(i,t),uo.subVectors(e,t),ns.cross(uo).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ns.subVectors(this.c,this.b),uo.subVectors(this.a,this.b),.5*ns.cross(uo).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return $n.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return $n.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return $n.getUV(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return $n.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return $n.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Fc.subVectors(r,i),kc.subVectors(s,i),yb.subVectors(e,i);const l=Fc.dot(yb),c=kc.dot(yb);if(l<=0&&c<=0)return t.copy(i);bb.subVectors(e,r);const u=Fc.dot(bb),d=kc.dot(bb);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(Fc,o);wb.subVectors(e,s);const f=Fc.dot(wb),g=kc.dot(wb);if(g>=0&&f<=g)return t.copy(s);const p=f*c-l*g;if(p<=0&&c>=0&&g<=0)return a=c/(c-g),t.copy(i).addScaledVector(kc,a);const m=u*g-f*d;if(m<=0&&d-u>=0&&f-g>=0)return rR.subVectors(s,r),a=(d-u)/(d-u+(f-g)),t.copy(r).addScaledVector(rR,a);const v=1/(m+p+h);return o=p*v,a=h*v,t.copy(i).addScaledVector(Fc,o).addScaledVector(kc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Fj=0;class qn extends Wo{constructor(){super(),Object.defineProperty(this,"id",{value:Fj++}),this.uuid=pr(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}qn.prototype.isMaterial=!0,qn.fromType=function(){return null};class Ts extends qn{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new de(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Ts.prototype.isMeshBasicMaterial=!0;const Yn=new M,gg=new K;class fn{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.usage=Yd,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new de),t[i++]=o.r,t[i++]=o.g,t[i++]=o.b}return this}copyVector2sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new K),t[i++]=o.x,t[i++]=o.y}return this}copyVector3sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new M),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z}return this}copyVector4sArray(e){const t=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Ot),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z,t[i++]=o.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)gg.fromBufferAttribute(this,t),gg.applyMatrix3(e),this.setXY(t,gg.x,gg.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)Yn.fromBufferAttribute(this,t),Yn.applyMatrix3(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Yn.fromBufferAttribute(this,t),Yn.applyMatrix4(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Yn.fromBufferAttribute(this,t),Yn.applyNormalMatrix(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Yn.fromBufferAttribute(this,t),Yn.transformDirection(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Yd&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}fn.prototype.isBufferAttribute=!0;class xb extends fn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class sR extends fn{constructor(e,t,i){super(new Uint32Array(e),t,i)}}(class kj extends fn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}).prototype.isFloat16BufferAttribute=!0;class Te extends fn{constructor(e,t,i){super(new Float32Array(e),t,i)}}let Lj=0;const Fr=new ue,Mb=new Mt,Lc=new M,vr=new Or,th=new Or,ui=new M;class Ue extends Wo{constructor(){super(),Object.defineProperty(this,"id",{value:Lj++}),this.uuid=pr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(qA(e)?sR:xb)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new ii).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Fr.makeRotationFromQuaternion(e),this.applyMatrix4(Fr),this}rotateX(e){return Fr.makeRotationX(e),this.applyMatrix4(Fr),this}rotateY(e){return Fr.makeRotationY(e),this.applyMatrix4(Fr),this}rotateZ(e){return Fr.makeRotationZ(e),this.applyMatrix4(Fr),this}translate(e,t,i){return Fr.makeTranslation(e,t,i),this.applyMatrix4(Fr),this}scale(e,t,i){return Fr.makeScale(e,t,i),this.applyMatrix4(Fr),this}lookAt(e){return Mb.lookAt(e),Mb.updateMatrix(),this.applyMatrix4(Mb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Lc).negate(),this.translate(Lc.x,Lc.y,Lc.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Te(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Or);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new M(-1/0,-1/0,-1/0),new M(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)vr.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(ui.addVectors(this.boundingBox.min,vr.min),this.boundingBox.expandByPoint(ui),ui.addVectors(this.boundingBox.max,vr.max),this.boundingBox.expandByPoint(ui)):(this.boundingBox.expandByPoint(vr.min),this.boundingBox.expandByPoint(vr.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Xa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new M,1/0);if(e){const i=this.boundingSphere.center;if(vr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)th.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(ui.addVectors(vr.min,th.min),vr.expandByPoint(ui),ui.addVectors(vr.max,th.max),vr.expandByPoint(ui)):(vr.expandByPoint(th.min),vr.expandByPoint(th.max));vr.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)ui.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(ui));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)ui.fromBufferAttribute(a,c),l&&(Lc.fromBufferAttribute(e,c),ui.add(Lc)),r=Math.max(r,i.distanceToSquared(ui))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new fn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let N=0;N<a;N++)c[N]=new M,u[N]=new M;const d=new M,h=new M,f=new M,g=new K,p=new K,m=new K,v=new M,_=new M;function y(N,x,R){d.fromArray(r,3*N),h.fromArray(r,3*x),f.fromArray(r,3*R),g.fromArray(o,2*N),p.fromArray(o,2*x),m.fromArray(o,2*R),h.sub(d),f.sub(d),p.sub(g),m.sub(g);const z=1/(p.x*m.y-m.x*p.y);!isFinite(z)||(v.copy(h).multiplyScalar(m.y).addScaledVector(f,-p.y).multiplyScalar(z),_.copy(f).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(z),c[N].add(v),c[x].add(v),c[R].add(v),u[N].add(_),u[x].add(_),u[R].add(_))}let b=this.groups;0===b.length&&(b=[{start:0,count:i.length}]);for(let N=0,x=b.length;N<x;++N){const R=b[N],z=R.start;for(let V=z,k=z+R.count;V<k;V+=3)y(i[V+0],i[V+1],i[V+2])}const w=new M,S=new M,C=new M,E=new M;function B(N){C.fromArray(s,3*N),E.copy(C);const x=c[N];w.copy(x),w.sub(C.multiplyScalar(C.dot(x))).normalize(),S.crossVectors(E,x);const z=S.dot(u[N])<0?-1:1;l[4*N]=w.x,l[4*N+1]=w.y,l[4*N+2]=w.z,l[4*N+3]=z}for(let N=0,x=b.length;N<x;++N){const R=b[N],z=R.start;for(let V=z,k=z+R.count;V<k;V+=3)B(i[V+0]),B(i[V+1]),B(i[V+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new fn(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new M,s=new M,o=new M,a=new M,l=new M,c=new M,u=new M,d=new M;if(e)for(let h=0,f=e.count;h<f;h+=3){const g=e.getX(h+0),p=e.getX(h+1),m=e.getX(h+2);r.fromBufferAttribute(t,g),s.fromBufferAttribute(t,p),o.fromBufferAttribute(t,m),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,g),l.fromBufferAttribute(i,p),c.fromBufferAttribute(i,m),a.add(u),l.add(u),c.add(u),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(p,l.x,l.y,l.z),i.setXYZ(m,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const r in i){if(void 0===e.attributes[r])continue;const o=i[r].array,a=e.attributes[r],l=a.array,c=a.itemSize*t,u=Math.min(l.length,o.length-c);for(let d=0,h=c;d<u;d++,h++)o[h]=l[d]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)ui.fromBufferAttribute(e,t),ui.normalize(),e.setXYZ(t,ui.x,ui.y,ui.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,g=0;for(let p=0,m=l.length;p<m;p++){f=a.isInterleavedBufferAttribute?l[p]*a.data.stride+a.offset:l[p]*u;for(let v=0;v<u;v++)h[g++]=c[f++]}return new fn(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ue,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Ue.prototype.isBufferGeometry=!0;const oR=new ue,Bc=new Ka,Sb=new Xa,Zo=new M,Xo=new M,Ko=new M,Db=new M,Cb=new M,Eb=new M,mg=new M,_g=new M,vg=new M,yg=new K,bg=new K,wg=new K,Tb=new M,xg=new M;class ge extends Mt{constructor(e=new Ue,t=new Ts){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),Sb.copy(i.boundingSphere),Sb.applyMatrix4(s),!1===e.ray.intersectsSphere(Sb))||(oR.copy(s).invert(),Bc.copy(e.ray).applyMatrix4(oR),null!==i.boundingBox&&!1===Bc.intersectsBox(i.boundingBox)))return;let o;if(i.isBufferGeometry){const a=i.index,l=i.attributes.position,c=i.morphAttributes.position,u=i.morphTargetsRelative,d=i.attributes.uv,h=i.attributes.uv2,f=i.groups,g=i.drawRange;if(null!==a)if(Array.isArray(r))for(let p=0,m=f.length;p<m;p++){const v=f[p],_=r[v.materialIndex];for(let w=Math.max(v.start,g.start),S=Math.min(a.count,Math.min(v.start+v.count,g.start+g.count));w<S;w+=3){const C=a.getX(w),E=a.getX(w+1),B=a.getX(w+2);o=Mg(this,_,e,Bc,l,c,u,d,h,C,E,B),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=v.materialIndex,t.push(o))}}else for(let v=Math.max(0,g.start),_=Math.min(a.count,g.start+g.count);v<_;v+=3){const y=a.getX(v),b=a.getX(v+1),w=a.getX(v+2);o=Mg(this,r,e,Bc,l,c,u,d,h,y,b,w),o&&(o.faceIndex=Math.floor(v/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let p=0,m=f.length;p<m;p++){const v=f[p],_=r[v.materialIndex];for(let w=Math.max(v.start,g.start),S=Math.min(l.count,Math.min(v.start+v.count,g.start+g.count));w<S;w+=3)o=Mg(this,_,e,Bc,l,c,u,d,h,w,w+1,w+2),o&&(o.faceIndex=Math.floor(w/3),o.face.materialIndex=v.materialIndex,t.push(o))}else for(let v=Math.max(0,g.start),_=Math.min(l.count,g.start+g.count);v<_;v+=3)o=Mg(this,r,e,Bc,l,c,u,d,h,v,v+1,v+2),o&&(o.faceIndex=Math.floor(v/3),t.push(o))}else i.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Mg(n,e,t,i,r,s,o,a,l,c,u,d){Zo.fromBufferAttribute(r,c),Xo.fromBufferAttribute(r,u),Ko.fromBufferAttribute(r,d);const h=n.morphTargetInfluences;if(s&&h){mg.set(0,0,0),_g.set(0,0,0),vg.set(0,0,0);for(let g=0,p=s.length;g<p;g++){const m=h[g],v=s[g];0!==m&&(Db.fromBufferAttribute(v,c),Cb.fromBufferAttribute(v,u),Eb.fromBufferAttribute(v,d),o?(mg.addScaledVector(Db,m),_g.addScaledVector(Cb,m),vg.addScaledVector(Eb,m)):(mg.addScaledVector(Db.sub(Zo),m),_g.addScaledVector(Cb.sub(Xo),m),vg.addScaledVector(Eb.sub(Ko),m)))}Zo.add(mg),Xo.add(_g),Ko.add(vg)}n.isSkinnedMesh&&(n.boneTransform(c,Zo),n.boneTransform(u,Xo),n.boneTransform(d,Ko));const f=function Bj(n,e,t,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,2!==e.side,a),null===l)return null;xg.copy(a),xg.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(xg);return c<t.near||c>t.far?null:{distance:c,point:xg.clone(),object:n}}(n,e,t,i,Zo,Xo,Ko,Tb);if(f){a&&(yg.fromBufferAttribute(a,c),bg.fromBufferAttribute(a,u),wg.fromBufferAttribute(a,d),f.uv=$n.getUV(Tb,Zo,Xo,Ko,yg,bg,wg,new K)),l&&(yg.fromBufferAttribute(l,c),bg.fromBufferAttribute(l,u),wg.fromBufferAttribute(l,d),f.uv2=$n.getUV(Tb,Zo,Xo,Ko,yg,bg,wg,new K));const g={a:c,b:u,c:d,normal:new M,materialIndex:0};$n.getNormal(Zo,Xo,Ko,g.normal),f.face=g}return f}ge.prototype.isMesh=!0;class In extends Ue{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;function g(p,m,v,_,y,b,w,S,C,E,B){const N=b/C,x=w/E,R=b/2,z=w/2,P=S/2,V=C+1,k=E+1;let U=0,F=0;const G=new M;for(let q=0;q<k;q++){const ee=q*x-z;for(let X=0;X<V;X++)G[p]=(X*N-R)*_,G[m]=ee*y,G[v]=P,c.push(G.x,G.y,G.z),G[p]=0,G[m]=0,G[v]=S>0?1:-1,u.push(G.x,G.y,G.z),d.push(X/C),d.push(1-q/E),U+=1}for(let q=0;q<E;q++)for(let ee=0;ee<C;ee++){const xe=h+ee+V*(q+1),Re=h+(ee+1)+V*(q+1),Me=h+(ee+1)+V*q;l.push(h+ee+V*q,xe,Me),l.push(xe,Re,Me),F+=6}a.addGroup(f,F,B),f+=F,h+=U}g("z","y","x",-1,-1,i,t,e,o,s,0),g("z","y","x",1,-1,i,t,-e,o,s,1),g("x","z","y",1,1,e,i,t,r,o,2),g("x","z","y",1,-1,e,i,-t,r,o,3),g("x","y","z",1,-1,e,t,i,r,s,4),g("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Te(c,3)),this.setAttribute("normal",new Te(u,3)),this.setAttribute("uv",new Te(d,2))}static fromJSON(e){return new In(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Vc(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function Ri(n){const e={};for(let t=0;t<n.length;t++){const i=Vc(n[t]);for(const r in i)e[r]=i[r]}return e}const Vj={clone:Vc,merge:Ri};class is extends qn{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Vc(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}is.prototype.isShaderMaterial=!0;class Sg extends Mt{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new ue,this.projectionMatrix=new ue,this.projectionMatrixInverse=new ue}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Sg.prototype.isCamera=!0;class Zn extends Sg{constructor(e=50,t=1,i=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Xd*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Wa*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Xd*Math.atan(Math.tan(.5*Wa*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Wa*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}Zn.prototype.isPerspectiveCamera=!0;class Ab extends Mt{constructor(e,t,i){if(super(),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const r=new Zn(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new M(1,0,0)),this.add(r);const s=new Zn(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new M(-1,0,0)),this.add(s);const o=new Zn(90,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new M(0,1,0)),this.add(o);const a=new Zn(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new M(0,-1,0)),this.add(a);const l=new Zn(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new M(0,0,1)),this.add(l);const c=new Zn(90,1,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new M(0,0,-1)),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),d=e.outputEncoding,h=e.toneMapping,f=e.xr.enabled;e.outputEncoding=so,e.toneMapping=0,e.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,o),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=g,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(u),e.outputEncoding=d,e.toneMapping=h,e.xr.enabled=f,i.texture.needsPMREMUpdate=!0}}class nh extends Ai{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:301,i,r,s,o,a,l,c,u),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}nh.prototype.isCubeTexture=!0;class aR extends gr{constructor(e,t={}){super(e,e,t);const i={width:e,height:e,depth:1};this.texture=new nh([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:jn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new In(5,5,5),s=new is({name:"CubemapFromEquirect",uniforms:Vc(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new ge(r,s),a=t.minFilter;return 1008===t.minFilter&&(t.minFilter=jn),new Ab(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}aR.prototype.isWebGLCubeRenderTarget=!0;const Rb=new M,zj=new M,Gj=new ii;class fo{constructor(e=new M(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=Rb.subVectors(i,t).cross(zj.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(Rb),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Gj.getNormalMatrix(e),r=this.coplanarPoint(Rb).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}fo.prototype.isPlane=!0;const zc=new Xa,Dg=new M;class Cg{constructor(e=new fo,t=new fo,i=new fo,r=new fo,s=new fo,o=new fo){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7],h=i[8],f=i[9],g=i[10],p=i[11],m=i[12],v=i[13],_=i[14],y=i[15];return t[0].setComponents(a-r,d-l,p-h,y-m).normalize(),t[1].setComponents(a+r,d+l,p+h,y+m).normalize(),t[2].setComponents(a+s,d+c,p+f,y+v).normalize(),t[3].setComponents(a-s,d-c,p-f,y-v).normalize(),t[4].setComponents(a-o,d-u,p-g,y-_).normalize(),t[5].setComponents(a+o,d+u,p+g,y+_).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),zc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(zc)}intersectsSprite(e){return zc.center.set(0,0,0),zc.radius=.7071067811865476,zc.applyMatrix4(e.matrixWorld),this.intersectsSphere(zc)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Dg.x=r.normal.x>0?e.max.x:e.min.x,Dg.y=r.normal.y>0?e.max.y:e.min.y,Dg.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Dg)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function lR(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function Wj(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const h=i.get(c);return void((!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,h=c.usage,f=n.createBuffer();let g;if(n.bindBuffer(u,f),n.bufferData(u,d,h),c.onUploadCallback(),d instanceof Float32Array)g=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");g=5131}else g=5123;else if(d instanceof Int16Array)g=5122;else if(d instanceof Uint32Array)g=5125;else if(d instanceof Int32Array)g=5124;else if(d instanceof Int8Array)g=5120;else if(d instanceof Uint8Array)g=5121;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);g=5121}return{buffer:f,type:g,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function s(c,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,c),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1)}(d.buffer,c,u),d.version=c.version)}}}class Gc extends Ue{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],g=[],p=[],m=[];for(let v=0;v<u;v++){const _=v*h-o;for(let y=0;y<c;y++)g.push(y*d-s,-_,0),p.push(0,0,1),m.push(y/a),m.push(1-v/l)}for(let v=0;v<l;v++)for(let _=0;_<a;_++){const b=_+c*(v+1),w=_+1+c*(v+1),S=_+1+c*v;f.push(_+c*v,b,S),f.push(b,w,S)}this.setIndex(f),this.setAttribute("position",new Te(g,3)),this.setAttribute("normal",new Te(p,3)),this.setAttribute("uv",new Te(m,2))}static fromJSON(e){return new Gc(e.width,e.height,e.widthSegments,e.heightSegments)}}const bt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},be={common:{diffuse:{value:new de(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ii},uv2Transform:{value:new ii},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new K(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new de(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new de(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ii}},sprite:{diffuse:{value:new de(16777215)},opacity:{value:1},center:{value:new K(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ii}}},As={basic:{uniforms:Ri([be.common,be.specularmap,be.envmap,be.aomap,be.lightmap,be.fog]),vertexShader:bt.meshbasic_vert,fragmentShader:bt.meshbasic_frag},lambert:{uniforms:Ri([be.common,be.specularmap,be.envmap,be.aomap,be.lightmap,be.emissivemap,be.fog,be.lights,{emissive:{value:new de(0)}}]),vertexShader:bt.meshlambert_vert,fragmentShader:bt.meshlambert_frag},phong:{uniforms:Ri([be.common,be.specularmap,be.envmap,be.aomap,be.lightmap,be.emissivemap,be.bumpmap,be.normalmap,be.displacementmap,be.fog,be.lights,{emissive:{value:new de(0)},specular:{value:new de(1118481)},shininess:{value:30}}]),vertexShader:bt.meshphong_vert,fragmentShader:bt.meshphong_frag},standard:{uniforms:Ri([be.common,be.envmap,be.aomap,be.lightmap,be.emissivemap,be.bumpmap,be.normalmap,be.displacementmap,be.roughnessmap,be.metalnessmap,be.fog,be.lights,{emissive:{value:new de(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:bt.meshphysical_vert,fragmentShader:bt.meshphysical_frag},toon:{uniforms:Ri([be.common,be.aomap,be.lightmap,be.emissivemap,be.bumpmap,be.normalmap,be.displacementmap,be.gradientmap,be.fog,be.lights,{emissive:{value:new de(0)}}]),vertexShader:bt.meshtoon_vert,fragmentShader:bt.meshtoon_frag},matcap:{uniforms:Ri([be.common,be.bumpmap,be.normalmap,be.displacementmap,be.fog,{matcap:{value:null}}]),vertexShader:bt.meshmatcap_vert,fragmentShader:bt.meshmatcap_frag},points:{uniforms:Ri([be.points,be.fog]),vertexShader:bt.points_vert,fragmentShader:bt.points_frag},dashed:{uniforms:Ri([be.common,be.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:bt.linedashed_vert,fragmentShader:bt.linedashed_frag},depth:{uniforms:Ri([be.common,be.displacementmap]),vertexShader:bt.depth_vert,fragmentShader:bt.depth_frag},normal:{uniforms:Ri([be.common,be.bumpmap,be.normalmap,be.displacementmap,{opacity:{value:1}}]),vertexShader:bt.meshnormal_vert,fragmentShader:bt.meshnormal_frag},sprite:{uniforms:Ri([be.sprite,be.fog]),vertexShader:bt.sprite_vert,fragmentShader:bt.sprite_frag},background:{uniforms:{uvTransform:{value:new ii},t2D:{value:null}},vertexShader:bt.background_vert,fragmentShader:bt.background_frag},cube:{uniforms:Ri([be.envmap,{opacity:{value:1}}]),vertexShader:bt.cube_vert,fragmentShader:bt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:bt.equirect_vert,fragmentShader:bt.equirect_frag},distanceRGBA:{uniforms:Ri([be.common,be.displacementmap,{referencePosition:{value:new M},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:bt.distanceRGBA_vert,fragmentShader:bt.distanceRGBA_frag},shadow:{uniforms:Ri([be.lights,be.fog,{color:{value:new de(0)},opacity:{value:1}}]),vertexShader:bt.shadow_vert,fragmentShader:bt.shadow_frag}};function U$(n,e,t,i,r,s){const o=new de(0);let l,c,a=!0===r?0:1,u=null,d=0,h=null;function g(p,m){t.buffers.color.setClear(p.r,p.g,p.b,m,s)}return{getClearColor:function(){return o},setClearColor:function(p,m=1){o.set(p),a=m,g(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(p){a=p,g(o,a)},render:function f(p,m){let v=!1,_=!0===m.isScene?m.background:null;_&&_.isTexture&&(_=e.get(_));const y=n.xr,b=y.getSession&&y.getSession();b&&"additive"===b.environmentBlendMode&&(_=null),null===_?g(o,a):_&&_.isColor&&(g(_,1),v=!0),(n.autoClear||v)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),_&&(_.isCubeTexture||306===_.mapping)?(void 0===c&&(c=new ge(new In(1,1,1),new is({name:"BackgroundCubeMaterial",uniforms:Vc(As.cube.uniforms),vertexShader:As.cube.vertexShader,fragmentShader:As.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(w,S,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=_,c.material.uniforms.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,(u!==_||d!==_.version||h!==n.toneMapping)&&(c.material.needsUpdate=!0,u=_,d=_.version,h=n.toneMapping),p.unshift(c,c.geometry,c.material,0,0,null)):_&&_.isTexture&&(void 0===l&&(l=new ge(new Gc(2,2),new is({name:"BackgroundMaterial",uniforms:Vc(As.background.uniforms),vertexShader:As.background.vertexShader,fragmentShader:As.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=_,!0===_.matrixAutoUpdate&&_.updateMatrix(),l.material.uniforms.uvTransform.value.copy(_.matrix),(u!==_||d!==_.version||h!==n.toneMapping)&&(l.material.needsUpdate=!0,u=_,d=_.version,h=n.toneMapping),p.unshift(l,l.geometry,l.material,0,0,null))}}}function H$(n,e,t,i){const r=n.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=m(null);let c=l,u=!1;function f(P){return i.isWebGL2?n.bindVertexArray(P):s.bindVertexArrayOES(P)}function g(P){return i.isWebGL2?n.deleteVertexArray(P):s.deleteVertexArrayOES(P)}function m(P){const V=[],k=[],U=[];for(let F=0;F<r;F++)V[F]=0,k[F]=0,U[F]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:V,enabledAttributes:k,attributeDivisors:U,object:P,attributes:{},index:null}}function y(){const P=c.newAttributes;for(let V=0,k=P.length;V<k;V++)P[V]=0}function b(P){w(P,0)}function w(P,V){const U=c.enabledAttributes,F=c.attributeDivisors;c.newAttributes[P]=1,0===U[P]&&(n.enableVertexAttribArray(P),U[P]=1),F[P]!==V&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](P,V),F[P]=V)}function S(){const P=c.newAttributes,V=c.enabledAttributes;for(let k=0,U=V.length;k<U;k++)V[k]!==P[k]&&(n.disableVertexAttribArray(k),V[k]=0)}function C(P,V,k,U,F,G){!0!==i.isWebGL2||5124!==k&&5125!==k?n.vertexAttribPointer(P,V,k,U,F,G):n.vertexAttribIPointer(P,V,k,F,G)}function R(){z(),u=!0,c!==l&&(c=l,f(c.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function d(P,V,k,U,F){let G=!1;if(o){const q=function p(P,V,k){const U=!0===k.wireframe;let F=a[P.id];void 0===F&&(F={},a[P.id]=F);let G=F[V.id];void 0===G&&(G={},F[V.id]=G);let q=G[U];return void 0===q&&(q=m(function h(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}()),G[U]=q),q}(U,k,V);c!==q&&(c=q,f(c.object)),G=function v(P,V){const k=c.attributes,U=P.attributes;let F=0;for(const G in U){const q=k[G],ee=U[G];if(void 0===q||q.attribute!==ee||q.data!==ee.data)return!0;F++}return c.attributesNum!==F||c.index!==V}(U,F),G&&function _(P,V){const k={},U=P.attributes;let F=0;for(const G in U){const q=U[G],ee={};ee.attribute=q,q.data&&(ee.data=q.data),k[G]=ee,F++}c.attributes=k,c.attributesNum=F,c.index=V}(U,F)}else{const q=!0===V.wireframe;(c.geometry!==U.id||c.program!==k.id||c.wireframe!==q)&&(c.geometry=U.id,c.program=k.id,c.wireframe=q,G=!0)}!0===P.isInstancedMesh&&(G=!0),null!==F&&t.update(F,34963),(G||u)&&(u=!1,function E(P,V,k,U){if(!1===i.isWebGL2&&(P.isInstancedMesh||U.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;y();const F=U.attributes,G=k.getAttributes(),q=V.defaultAttributeValues;for(const ee in G){const X=G[ee];if(X.location>=0){let xe=F[ee];if(void 0===xe&&("instanceMatrix"===ee&&P.instanceMatrix&&(xe=P.instanceMatrix),"instanceColor"===ee&&P.instanceColor&&(xe=P.instanceColor)),void 0!==xe){const Re=xe.normalized,Me=xe.itemSize,Y=t.get(xe);if(void 0===Y)continue;const ot=Y.buffer,Fe=Y.type,$e=Y.bytesPerElement;if(xe.isInterleavedBufferAttribute){const le=xe.data,Ze=le.stride,Z=xe.offset;if(le.isInstancedInterleavedBuffer){for(let J=0;J<X.locationSize;J++)w(X.location+J,le.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===U._maxInstanceCount&&(U._maxInstanceCount=le.meshPerAttribute*le.count)}else for(let J=0;J<X.locationSize;J++)b(X.location+J);n.bindBuffer(34962,ot);for(let J=0;J<X.locationSize;J++)C(X.location+J,Me/X.locationSize,Fe,Re,Ze*$e,(Z+Me/X.locationSize*J)*$e)}else{if(xe.isInstancedBufferAttribute){for(let le=0;le<X.locationSize;le++)w(X.location+le,xe.meshPerAttribute);!0!==P.isInstancedMesh&&void 0===U._maxInstanceCount&&(U._maxInstanceCount=xe.meshPerAttribute*xe.count)}else for(let le=0;le<X.locationSize;le++)b(X.location+le);n.bindBuffer(34962,ot);for(let le=0;le<X.locationSize;le++)C(X.location+le,Me/X.locationSize,Fe,Re,Me*$e,Me/X.locationSize*le*$e)}}else if(void 0!==q){const Re=q[ee];if(void 0!==Re)switch(Re.length){case 2:n.vertexAttrib2fv(X.location,Re);break;case 3:n.vertexAttrib3fv(X.location,Re);break;case 4:n.vertexAttrib4fv(X.location,Re);break;default:n.vertexAttrib1fv(X.location,Re)}}}}S()}(P,V,k,U),null!==F&&n.bindBuffer(34963,t.get(F).buffer))},reset:R,resetDefaultState:z,dispose:function B(){R();for(const P in a){const V=a[P];for(const k in V){const U=V[k];for(const F in U)g(U[F].object),delete U[F];delete V[k]}delete a[P]}},releaseStatesOfGeometry:function N(P){if(void 0===a[P.id])return;const V=a[P.id];for(const k in V){const U=V[k];for(const F in U)g(U[F].object),delete U[F];delete V[k]}delete a[P.id]},releaseStatesOfProgram:function x(P){for(const V in a){const k=a[V];if(void 0===k[P.id])continue;const U=k[P.id];for(const F in U)g(U[F].object),delete U[F];delete k[P.id]}},initAttributes:y,enableAttribute:b,disableUnusedAttributes:S}}function z$(n,e,t,i){const r=i.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](s,c,u,d),t.update(u,s,d)}}function G$(n,e,t){let i;function s(C){if("highp"===C){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";C="mediump"}return"mediump"===C&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&n instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(34930),h=n.getParameter(35660),f=n.getParameter(3379),g=n.getParameter(34076),p=n.getParameter(34921),m=n.getParameter(36347),v=n.getParameter(36348),_=n.getParameter(36349),y=h>0,b=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const C=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:g,maxAttributes:p,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:_,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:o?n.getParameter(36183):0}}function W$(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new fo,a=new ii,l={value:null,needsUpdate:!1};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(d,h,f,g){const p=null!==d?d.length:0;let m=null;if(0!==p){if(m=l.value,!0!==g||null===m){const v=f+4*p,_=h.matrixWorldInverse;a.getNormalMatrix(_),(null===m||m.length<v)&&(m=new Float32Array(v));for(let y=0,b=f;y!==p;++y,b+=4)o.copy(d[y]).applyMatrix4(_,a),o.normal.toArray(m,b),m[b+3]=o.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=p,e.numIntersection=0,m}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h,f){const g=0!==d.length||h||0!==i||r;return r=h,t=u(d,f,0),i=d.length,g},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(d,h,f){const g=d.clippingPlanes,p=d.clipIntersection,m=d.clipShadows,v=n.get(d);if(!r||null===g||0===g.length||s&&!m)s?u(null):c();else{const _=s?0:i,y=4*_;let b=v.clippingState||null;l.value=b,b=u(g,h,y,f);for(let w=0;w!==y;++w)b[w]=t[w];v.clippingState=b,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=_}}}function j$(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=301:304===a&&(o.mapping=302),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new aR(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}As.physical={uniforms:Ri([As.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new K(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new de(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new K},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new de(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new de(1,1,1)},specularColorMap:{value:null}}]),vertexShader:bt.meshphysical_vert,fragmentShader:bt.meshphysical_frag};class ih extends Sg{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}ih.prototype.isOrthographicCamera=!0;const cR=[.125,.215,.35,.446,.526,.582],Ib=new ih,uR=new de;let Nb=null;const Qa=(1+Math.sqrt(5))/2,jc=1/Qa,dR=[new M(1,1,1),new M(-1,1,1),new M(1,1,-1),new M(-1,1,-1),new M(0,Qa,jc),new M(0,Qa,-jc),new M(jc,0,Qa),new M(-jc,0,Qa),new M(Qa,jc,0),new M(-Qa,jc,0)];class hR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){Nb=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=gR(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=pR(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Nb),e.scissorTest=!1,Eg(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Nb=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize-32,i={magFilter:jn,minFilter:jn,generateMipmaps:!1,type:wc,format:Pr,encoding:so,depthBuffer:!1},r=fR(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=fR(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function $$(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+cR.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=cR[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-1),u=-c/2,d=1+c/2,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,g=6,p=3,m=2,v=1,_=new Float32Array(p*g*f),y=new Float32Array(m*g*f),b=new Float32Array(v*g*f);for(let S=0;S<f;S++){const C=S%3*2/3-1,E=S>2?0:-1;_.set([C,E,0,C+2/3,E,0,C+2/3,E+1,0,C,E,0,C+2/3,E+1,0,C,E+1,0],p*g*S),y.set(h,m*g*S),b.set([S,S,S,S,S,S],v*g*S)}const w=new Ue;w.setAttribute("position",new fn(_,p)),w.setAttribute("uv",new fn(y,m)),w.setAttribute("faceIndex",new fn(b,v)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function q$(n,e,t){const i=new Float32Array(20),r=new M(0,1,0);return new is({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new ge(this._lodPlanes[0],e);this._renderer.compile(t,Ib)}_sceneToCubeUV(e,t,i,r){const a=new Zn(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(uR),u.toneMapping=0,u.autoClear=!1;const f=new Ts({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),g=new ge(new In,f);let p=!1;const m=e.background;m?m.isColor&&(f.color.copy(m),e.background=null,p=!0):(f.color.copy(uR),p=!0);for(let v=0;v<6;v++){const _=v%3;0===_?(a.up.set(0,l[v],0),a.lookAt(c[v],0,0)):1===_?(a.up.set(0,0,l[v]),a.lookAt(0,c[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,c[v]));const y=this._cubeSize;Eg(r,_*y,v>2?y:0,y,y),u.setRenderTarget(r),p&&u.render(g,a),u.render(e,a)}g.geometry.dispose(),g.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=m}_textureToCubeUV(e,t){const i=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=gR()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=pR());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new ge(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;Eg(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,Ib)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,dR[(r-1)%dR.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new ge(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,g=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,p=s/g,m=isFinite(s)?1+Math.floor(3*p):20;m>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const v=[];let _=0;for(let C=0;C<20;++C){const E=C/p,B=Math.exp(-E*E/2);v.push(B),0===C?_+=B:C<m&&(_+=2*B)}for(let C=0;C<v.length;C++)v[C]=v[C]/_;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=v,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:y}=this;h.dTheta.value=g,h.mipInt.value=y-i;const b=this._sizeLods[r];Eg(t,3*b*(r>y-4?r-y+4:0),4*(this._cubeSize-b),3*b,2*b),l.setRenderTarget(t),l.render(d,Ib)}}function fR(n,e,t){const i=new gr(n,e,t);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Eg(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function pR(){return new is({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function gR(){return new is({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Y$(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,u=301===l||302===l;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new hR(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new hR(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Z$(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function X$(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const g in h.attributes)e.remove(h.attributes[g]);h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,g=d.attributes.position;let p=0;if(null!==f){const _=f.array;p=f.version;for(let y=0,b=_.length;y<b;y+=3){const w=_[y+0],S=_[y+1],C=_[y+2];h.push(w,S,S,C,C,w)}}else{p=g.version;for(let y=0,b=g.array.length/3-1;y<b;y+=3){const w=y+0,S=y+1,C=y+2;h.push(w,S,S,C,C,w)}}const m=new(qA(h)?sR:xb)(h,1);m.version=p;const v=s.get(d);v&&e.remove(v),s.set(d,m)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const g in h)e.update(h[g],34962);const f=d.morphAttributes;for(const g in f){const p=f[g];for(let m=0,v=p.length;m<v;m++)e.update(p[m],34962)}},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return s.get(d)}}}function K$(n,e,t,i){const r=i.isWebGL2;let s,a,l;this.setMode=function o(h){s=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function u(h,f){n.drawElements(s,f,a,h*l),t.update(f,s,1)},this.renderInstances=function d(h,f,g){if(0===g)return;let p,m;if(r)p=n,m="drawElementsInstanced";else if(p=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",null===p)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[m](s,f,a,h*l,g),t.update(f,s,g)}}function J$(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function Q$(n,e){return n[0]-e[0]}function e7(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Ob(n,e){let t=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?t=127:i instanceof Int16Array?t=32767:i instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),n.divideScalar(t)}function t7(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new Ot,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d,h){const f=c.morphTargetInfluences;if(!0===e.isWebGL2){const g=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==g?g.length:0;let m=s.get(u);if(void 0===m||m.count!==p){let V=function(){z.dispose(),s.delete(u),u.removeEventListener("dispose",V)};void 0!==m&&m.texture.dispose();const y=void 0!==u.morphAttributes.position,b=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,S=u.morphAttributes.position||[],C=u.morphAttributes.normal||[],E=u.morphAttributes.color||[];let B=0;!0===y&&(B=1),!0===b&&(B=2),!0===w&&(B=3);let N=u.attributes.position.count*B,x=1;N>e.maxTextureSize&&(x=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);const R=new Float32Array(N*x*4*p),z=new ag(R,N,x,p);z.type=Go,z.needsUpdate=!0;const P=4*B;for(let k=0;k<p;k++){const U=S[k],F=C[k],G=E[k],q=N*x*4*k;for(let ee=0;ee<U.count;ee++){const X=ee*P;!0===y&&(o.fromBufferAttribute(U,ee),!0===U.normalized&&Ob(o,U),R[q+X+0]=o.x,R[q+X+1]=o.y,R[q+X+2]=o.z,R[q+X+3]=0),!0===b&&(o.fromBufferAttribute(F,ee),!0===F.normalized&&Ob(o,F),R[q+X+4]=o.x,R[q+X+5]=o.y,R[q+X+6]=o.z,R[q+X+7]=0),!0===w&&(o.fromBufferAttribute(G,ee),!0===G.normalized&&Ob(o,G),R[q+X+8]=o.x,R[q+X+9]=o.y,R[q+X+10]=o.z,R[q+X+11]=4===G.itemSize?o.w:1)}}m={count:p,texture:z,size:new K(N,x)},s.set(u,m),u.addEventListener("dispose",V)}let v=0;for(let y=0;y<f.length;y++)v+=f[y];const _=u.morphTargetsRelative?1:1-v;h.getUniforms().setValue(n,"morphTargetBaseInfluence",_),h.getUniforms().setValue(n,"morphTargetInfluences",f),h.getUniforms().setValue(n,"morphTargetsTexture",m.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",m.size)}else{const g=void 0===f?0:f.length;let p=i[u.id];if(void 0===p||p.length!==g){p=[];for(let b=0;b<g;b++)p[b]=[b,0];i[u.id]=p}for(let b=0;b<g;b++){const w=p[b];w[0]=b,w[1]=f[b]}p.sort(e7);for(let b=0;b<8;b++)b<g&&p[b][1]?(a[b][0]=p[b][0],a[b][1]=p[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(Q$);const m=u.morphAttributes.position,v=u.morphAttributes.normal;let _=0;for(let b=0;b<8;b++){const w=a[b],S=w[0],C=w[1];S!==Number.MAX_SAFE_INTEGER&&C?(m&&u.getAttribute("morphTarget"+b)!==m[S]&&u.setAttribute("morphTarget"+b,m[S]),v&&u.getAttribute("morphNormal"+b)!==v[S]&&u.setAttribute("morphNormal"+b,v[S]),r[b]=C,_+=C):(m&&!0===u.hasAttribute("morphTarget"+b)&&u.deleteAttribute("morphTarget"+b),v&&!0===u.hasAttribute("morphNormal"+b)&&u.deleteAttribute("morphNormal"+b),r[b]=0)}const y=u.morphTargetsRelative?1:1-_;h.getUniforms().setValue(n,"morphTargetBaseInfluence",y),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function n7(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);return r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),d},dispose:function o(){r=new WeakMap}}}const mR=new Ai,_R=new ag,vR=new cb,yR=new nh,bR=[],wR=[],xR=new Float32Array(16),MR=new Float32Array(9),SR=new Float32Array(4);function $c(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=bR[r];if(void 0===s&&(s=new Float32Array(r),bR[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Gi(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Ii(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function Tg(n,e){let t=wR[e];void 0===t&&(t=new Int32Array(e),wR[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function i7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function r7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gi(t,e))return;n.uniform2fv(this.addr,e),Ii(t,e)}}function s7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Gi(t,e))return;n.uniform3fv(this.addr,e),Ii(t,e)}}function o7(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gi(t,e))return;n.uniform4fv(this.addr,e),Ii(t,e)}}function a7(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Gi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Ii(t,e)}else{if(Gi(t,i))return;SR.set(i),n.uniformMatrix2fv(this.addr,!1,SR),Ii(t,i)}}function l7(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Gi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Ii(t,e)}else{if(Gi(t,i))return;MR.set(i),n.uniformMatrix3fv(this.addr,!1,MR),Ii(t,i)}}function c7(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(Gi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Ii(t,e)}else{if(Gi(t,i))return;xR.set(i),n.uniformMatrix4fv(this.addr,!1,xR),Ii(t,i)}}function u7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function d7(n,e){const t=this.cache;Gi(t,e)||(n.uniform2iv(this.addr,e),Ii(t,e))}function h7(n,e){const t=this.cache;Gi(t,e)||(n.uniform3iv(this.addr,e),Ii(t,e))}function f7(n,e){const t=this.cache;Gi(t,e)||(n.uniform4iv(this.addr,e),Ii(t,e))}function p7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function g7(n,e){const t=this.cache;Gi(t,e)||(n.uniform2uiv(this.addr,e),Ii(t,e))}function m7(n,e){const t=this.cache;Gi(t,e)||(n.uniform3uiv(this.addr,e),Ii(t,e))}function _7(n,e){const t=this.cache;Gi(t,e)||(n.uniform4uiv(this.addr,e),Ii(t,e))}function v7(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||mR,r)}function y7(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||vR,r)}function b7(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||yR,r)}function w7(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||_R,r)}function M7(n,e){n.uniform1fv(this.addr,e)}function S7(n,e){const t=$c(e,this.size,2);n.uniform2fv(this.addr,t)}function D7(n,e){const t=$c(e,this.size,3);n.uniform3fv(this.addr,t)}function C7(n,e){const t=$c(e,this.size,4);n.uniform4fv(this.addr,t)}function E7(n,e){const t=$c(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function T7(n,e){const t=$c(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function A7(n,e){const t=$c(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function R7(n,e){n.uniform1iv(this.addr,e)}function I7(n,e){n.uniform2iv(this.addr,e)}function N7(n,e){n.uniform3iv(this.addr,e)}function P7(n,e){n.uniform4iv(this.addr,e)}function O7(n,e){n.uniform1uiv(this.addr,e)}function F7(n,e){n.uniform2uiv(this.addr,e)}function k7(n,e){n.uniform3uiv(this.addr,e)}function L7(n,e){n.uniform4uiv(this.addr,e)}function B7(n,e,t){const i=e.length,r=Tg(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2D(e[s]||mR,r[s])}function V7(n,e,t){const i=e.length,r=Tg(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture3D(e[s]||vR,r[s])}function U7(n,e,t){const i=e.length,r=Tg(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTextureCube(e[s]||yR,r[s])}function H7(n,e,t){const i=e.length,r=Tg(t,i);n.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)t.setTexture2DArray(e[s]||_R,r[s])}function G7(n,e,t){this.id=n,this.addr=t,this.cache=[],this.setValue=function x7(n){switch(n){case 5126:return i7;case 35664:return r7;case 35665:return s7;case 35666:return o7;case 35674:return a7;case 35675:return l7;case 35676:return c7;case 5124:case 35670:return u7;case 35667:case 35671:return d7;case 35668:case 35672:return h7;case 35669:case 35673:return f7;case 5125:return p7;case 36294:return g7;case 36295:return m7;case 36296:return _7;case 35678:case 36198:case 36298:case 36306:case 35682:return v7;case 35679:case 36299:case 36307:return y7;case 35680:case 36300:case 36308:case 36293:return b7;case 36289:case 36303:case 36311:case 36292:return w7}}(e.type)}function DR(n,e,t){this.id=n,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function z7(n){switch(n){case 5126:return M7;case 35664:return S7;case 35665:return D7;case 35666:return C7;case 35674:return E7;case 35675:return T7;case 35676:return A7;case 5124:case 35670:return R7;case 35667:case 35671:return I7;case 35668:case 35672:return N7;case 35669:case 35673:return P7;case 5125:return O7;case 36294:return F7;case 36295:return k7;case 36296:return L7;case 35678:case 36198:case 36298:case 36306:case 35682:return B7;case 35679:case 36299:case 36307:return V7;case 35680:case 36300:case 36308:case 36293:return U7;case 36289:case 36303:case 36311:case 36292:return H7}}(e.type)}function CR(n){this.id=n,this.seq=[],this.map={}}DR.prototype.updateCache=function(n){const e=this.cache;n instanceof Float32Array&&e.length!==n.length&&(this.cache=new Float32Array(n.length)),Ii(e,n)},CR.prototype.setValue=function(n,e,t){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const o=i[r];o.setValue(n,e[o.id],t)}};const Fb=/(\w+)(\])?(\[|\.)?/g;function ER(n,e){n.seq.push(e),n.map[e.id]=e}function W7(n,e,t){const i=n.name,r=i.length;for(Fb.lastIndex=0;;){const s=Fb.exec(i),o=Fb.lastIndex;let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&o+2===r){ER(t,void 0===c?new G7(a,n,e):new DR(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new CR(a),ER(t,d)),t=d}}}function Jo(n,e){this.seq=[],this.map={};const t=n.getProgramParameter(e,35718);for(let i=0;i<t;++i){const r=n.getActiveUniform(e,i);W7(r,n.getUniformLocation(e,r.name),this)}}function TR(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}Jo.prototype.setValue=function(n,e,t,i){const r=this.map[e];void 0!==r&&r.setValue(n,t,i)},Jo.prototype.setOptional=function(n,e,t){const i=e[t];void 0!==i&&this.setValue(n,t,i)},Jo.upload=function(n,e,t,i){for(let r=0,s=e.length;r!==s;++r){const o=e[r],a=t[o.id];!1!==a.needsUpdate&&o.setValue(n,a.value,i)}},Jo.seqWithValue=function(n,e){const t=[];for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.id in e&&t.push(s)}return t};let j7=0;function AR(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=parseInt(/ERROR: 0:(\d+)/.exec(r)[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function $7(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++)i.push(o+1+": "+t[o]);return i.join("\n")}(n.getShaderSource(e),s)}function Y7(n,e){const t=function q7(n){switch(n){case so:return["Linear","( value )"];case Yt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Z7(n,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function rh(n){return""!==n}function RR(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function IR(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Q7=/^[ \t]*#include +<([\w\d./]+)>/gm;function kb(n){return n.replace(Q7,e9)}function e9(n,e){const t=bt[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return kb(t)}const t9=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,n9=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function NR(n){return n.replace(n9,PR).replace(t9,i9)}function i9(n,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),PR(0,e,t,i)}function PR(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function OR(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function c9(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function r9(n){let e="SHADOWMAP_TYPE_BASIC";return 1===n.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===n.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===n.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function s9(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function o9(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&302===n.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function a9(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function l9(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e/32+1)+3,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function X7(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(rh).join("\n")}(t),g=function K7(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),p=r.createProgram();let m,v,_=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(m=[g].filter(rh).join("\n"),m.length>0&&(m+="\n"),v=[f,g].filter(rh).join("\n"),v.length>0&&(v+="\n")):(m=[OR(t),"#define SHADER_NAME "+t.shaderName,g,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(rh).join("\n"),v=[f,OR(t),"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?bt.tonemapping_pars_fragment:"",0!==t.toneMapping?Z7("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",bt.encodings_pars_fragment,Y7("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(rh).join("\n")),o=kb(o),o=RR(o,t),o=IR(o,t),a=kb(a),a=RR(a,t),a=IR(a,t),o=NR(o),a=NR(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(_="#version 300 es\n",m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,v=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const b=_+v+a,w=TR(r,35633,_+m+o),S=TR(r,35632,b);if(r.attachShader(p,w),r.attachShader(p,S),void 0!==t.index0AttributeName?r.bindAttribLocation(p,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(p,0,"position"),r.linkProgram(p),n.debug.checkShaderErrors){const B=r.getProgramInfoLog(p).trim(),N=r.getShaderInfoLog(w).trim(),x=r.getShaderInfoLog(S).trim();let R=!0,z=!0;if(!1===r.getProgramParameter(p,35714)){R=!1;const P=AR(r,w,"vertex"),V=AR(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(p,35715)+"\n\nProgram Info Log: "+B+"\n"+P+"\n"+V)}else""!==B?console.warn("THREE.WebGLProgram: Program Info Log:",B):(""===N||""===x)&&(z=!1);z&&(this.diagnostics={runnable:R,programLog:B,vertexShader:{log:N,prefix:m},fragmentShader:{log:x,prefix:v}})}let C,E;return r.deleteShader(w),r.deleteShader(S),this.getUniforms=function(){return void 0===C&&(C=new Jo(r,p)),C},this.getAttributes=function(){return void 0===E&&(E=function J7(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,p)),E},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(p),this.program=void 0},this.name=t.shaderName,this.id=j7++,this.cacheKey=e,this.usedTimes=1,this.program=p,this.vertexShader=w,this.fragmentShader=S,this}let u9=0;class d9{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const i=new h9(e);t.set(e,i)}return t.get(e)}}class h9{constructor(e){this.id=u9++,this.code=e,this.usedTimes=0}}function f9(n,e,t,i,r,s,o){const a=new _b,l=new d9,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.floatVertexTextures,f=r.maxVertexUniforms,g=r.vertexTextures;let p=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function _(x,R,z,P,V){const k=P.fog,U=V.geometry,G=(x.isMeshStandardMaterial?t:e).get(x.envMap||(x.isMeshStandardMaterial?P.environment:null)),q=G&&306===G.mapping?G.image.height:null,ee=m[x.type],X=V.isSkinnedMesh?function v(x){const z=x.skeleton.bones;if(h)return 1024;{const V=Math.floor((f-20)/4),k=Math.min(V,z.length);return k<z.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+z.length+" bones. This GPU supports "+k+"."),0):k}}(V):0;null!==x.precision&&(p=r.getMaxPrecision(x.precision),p!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",p,"instead."));const xe=U.morphAttributes.position||U.morphAttributes.normal||U.morphAttributes.color,Re=void 0!==xe?xe.length:0;let Y,ot,Fe,$e,Me=0;if(void 0!==U.morphAttributes.position&&(Me=1),void 0!==U.morphAttributes.normal&&(Me=2),void 0!==U.morphAttributes.color&&(Me=3),ee){const se=As[ee];Y=se.vertexShader,ot=se.fragmentShader}else Y=x.vertexShader,ot=x.fragmentShader,l.update(x),Fe=l.getVertexShaderID(x),$e=l.getFragmentShaderID(x);const le=n.getRenderTarget(),Z=x.clearcoat>0;return{isWebGL2:u,shaderID:ee,shaderName:x.type,vertexShader:Y,fragmentShader:ot,defines:x.defines,customVertexShaderID:Fe,customFragmentShaderID:$e,isRawShaderMaterial:!0===x.isRawShaderMaterial,glslVersion:x.glslVersion,precision:p,instancing:!0===V.isInstancedMesh,instancingColor:!0===V.isInstancedMesh&&null!==V.instanceColor,supportsVertexTextures:g,outputEncoding:null===le?n.outputEncoding:!0===le.isXRRenderTarget?le.texture.encoding:so,map:!!x.map,matcap:!!x.matcap,envMap:!!G,envMapMode:G&&G.mapping,envMapCubeUVHeight:q,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:1===x.normalMapType,tangentSpaceNormalMap:0===x.normalMapType,decodeVideoTexture:!!x.map&&!0===x.map.isVideoTexture&&x.map.encoding===Yt,clearcoat:Z,clearcoatMap:Z&&!!x.clearcoatMap,clearcoatRoughnessMap:Z&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:Z&&!!x.clearcoatNormalMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:!1===x.transparent&&1===x.blending,alphaMap:!!x.alphaMap,alphaTest:x.alphaTest>0,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!U.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:!0===x.vertexColors&&!!U.attributes.color&&4===U.attributes.color.itemSize,vertexUvs:!!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatMap||x.clearcoatRoughnessMap||x.clearcoatNormalMap||x.displacementMap||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheenColorMap||x.sheenRoughnessMap),uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap||!x.displacementMap),fog:!!k,useFog:x.fog,fogExp2:k&&k.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===V.isSkinnedMesh&&X>0,maxBones:X,useVertexTexture:h,morphTargets:void 0!==U.morphAttributes.position,morphNormals:void 0!==U.morphAttributes.normal,morphColors:void 0!==U.morphAttributes.color,morphTargetsCount:Re,morphTextureStride:Me,numDirLights:R.directional.length,numPointLights:R.point.length,numSpotLights:R.spot.length,numRectAreaLights:R.rectArea.length,numHemiLights:R.hemi.length,numDirLightShadows:R.directionalShadowMap.length,numPointLightShadows:R.pointShadowMap.length,numSpotLightShadows:R.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:x.dithering,shadowMapEnabled:n.shadowMap.enabled&&z.length>0,shadowMapType:n.shadowMap.type,toneMapping:x.toneMapped?n.toneMapping:0,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:2===x.side,flipSided:1===x.side,depthPacking:void 0!==x.depthPacking&&x.depthPacking,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function y(x){const R=[];if(x.shaderID?R.push(x.shaderID):(R.push(x.customVertexShaderID),R.push(x.customFragmentShaderID)),void 0!==x.defines)for(const z in x.defines)R.push(z),R.push(x.defines[z]);return!1===x.isRawShaderMaterial&&(function b(x,R){x.push(R.precision),x.push(R.outputEncoding),x.push(R.envMapMode),x.push(R.envMapCubeUVHeight),x.push(R.combine),x.push(R.vertexUvs),x.push(R.fogExp2),x.push(R.sizeAttenuation),x.push(R.maxBones),x.push(R.morphTargetsCount),x.push(R.morphAttributeCount),x.push(R.numDirLights),x.push(R.numPointLights),x.push(R.numSpotLights),x.push(R.numHemiLights),x.push(R.numRectAreaLights),x.push(R.numDirLightShadows),x.push(R.numPointLightShadows),x.push(R.numSpotLightShadows),x.push(R.shadowMapType),x.push(R.toneMapping),x.push(R.numClippingPlanes),x.push(R.numClipIntersection)}(R,x),function w(x,R){a.disableAll(),R.isWebGL2&&a.enable(0),R.supportsVertexTextures&&a.enable(1),R.instancing&&a.enable(2),R.instancingColor&&a.enable(3),R.map&&a.enable(4),R.matcap&&a.enable(5),R.envMap&&a.enable(6),R.lightMap&&a.enable(7),R.aoMap&&a.enable(8),R.emissiveMap&&a.enable(9),R.bumpMap&&a.enable(10),R.normalMap&&a.enable(11),R.objectSpaceNormalMap&&a.enable(12),R.tangentSpaceNormalMap&&a.enable(13),R.clearcoat&&a.enable(14),R.clearcoatMap&&a.enable(15),R.clearcoatRoughnessMap&&a.enable(16),R.clearcoatNormalMap&&a.enable(17),R.displacementMap&&a.enable(18),R.specularMap&&a.enable(19),R.roughnessMap&&a.enable(20),R.metalnessMap&&a.enable(21),R.gradientMap&&a.enable(22),R.alphaMap&&a.enable(23),R.alphaTest&&a.enable(24),R.vertexColors&&a.enable(25),R.vertexAlphas&&a.enable(26),R.vertexUvs&&a.enable(27),R.vertexTangents&&a.enable(28),R.uvsVertexOnly&&a.enable(29),R.fog&&a.enable(30),x.push(a.mask),a.disableAll(),R.useFog&&a.enable(0),R.flatShading&&a.enable(1),R.logarithmicDepthBuffer&&a.enable(2),R.skinning&&a.enable(3),R.useVertexTexture&&a.enable(4),R.morphTargets&&a.enable(5),R.morphNormals&&a.enable(6),R.morphColors&&a.enable(7),R.premultipliedAlpha&&a.enable(8),R.shadowMapEnabled&&a.enable(9),R.physicallyCorrectLights&&a.enable(10),R.doubleSided&&a.enable(11),R.flipSided&&a.enable(12),R.depthPacking&&a.enable(13),R.dithering&&a.enable(14),R.specularIntensityMap&&a.enable(15),R.specularColorMap&&a.enable(16),R.transmission&&a.enable(17),R.transmissionMap&&a.enable(18),R.thicknessMap&&a.enable(19),R.sheen&&a.enable(20),R.sheenColorMap&&a.enable(21),R.sheenRoughnessMap&&a.enable(22),R.decodeVideoTexture&&a.enable(23),R.opaque&&a.enable(24),x.push(a.mask)}(R,x),R.push(n.outputEncoding)),R.push(x.customProgramCacheKey),R.join()},getUniforms:function S(x){const R=m[x.type];let z;return z=R?Vj.clone(As[R].uniforms):x.uniforms,z},acquireProgram:function C(x,R){let z;for(let P=0,V=c.length;P<V;P++){const k=c[P];if(k.cacheKey===R){z=k,++z.usedTimes;break}}return void 0===z&&(z=new c9(n,R,x,s),c.push(z)),z},releaseProgram:function E(x){if(0==--x.usedTimes){const R=c.indexOf(x);c[R]=c[c.length-1],c.pop(),x.destroy()}},releaseShaderCache:function B(x){l.remove(x)},programs:c,dispose:function N(){l.dispose()}}}function p9(){let n=new WeakMap;return{get:function e(s){let o=n.get(s);return void 0===o&&(o={},n.set(s,o)),o},remove:function t(s){n.delete(s)},update:function i(s,o,a){n.get(s)[o]=a},dispose:function r(){n=new WeakMap}}}function g9(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function FR(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function kR(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,g,p,m){let v=n[e];return void 0===v?(v={id:d.id,object:d,geometry:h,material:f,groupOrder:g,renderOrder:d.renderOrder,z:p,group:m},n[e]=v):(v.id=d.id,v.object=d,v.geometry=h,v.material=f,v.groupOrder=g,v.renderOrder=d.renderOrder,v.z=p,v.group=m),e++,v}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,g,p,m){const v=o(d,h,f,g,p,m);f.transmission>0?i.push(v):!0===f.transparent?r.push(v):t.push(v)},unshift:function l(d,h,f,g,p,m){const v=o(d,h,f,g,p,m);f.transmission>0?i.unshift(v):!0===f.transparent?r.unshift(v):t.unshift(v)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||g9),i.length>1&&i.sort(h||FR),r.length>1&&r.sort(h||FR)}}}function m9(){let n=new WeakMap;return{get:function e(i,r){let s;return!1===n.has(i)?(s=new kR,n.set(i,[s])):r>=n.get(i).length?(s=new kR,n.get(i).push(s)):s=n.get(i)[r],s},dispose:function t(){n=new WeakMap}}}function _9(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new M,color:new de};break;case"SpotLight":t={position:new M,direction:new M,color:new de,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new M,color:new de,distance:0,decay:0};break;case"HemisphereLight":t={direction:new M,skyColor:new de,groundColor:new de};break;case"RectAreaLight":t={color:new de,position:new M,halfWidth:new M,halfHeight:new M}}return n[e.id]=t,t}}}let y9=0;function b9(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function w9(n,e){const t=new _9,i=function v9(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new K,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new M);const s=new M,o=new ue,a=new ue;return{setup:function l(u,d){let h=0,f=0,g=0;for(let B=0;B<9;B++)r.probe[B].set(0,0,0);let p=0,m=0,v=0,_=0,y=0,b=0,w=0,S=0;u.sort(b9);const C=!0!==d?Math.PI:1;for(let B=0,N=u.length;B<N;B++){const x=u[B],R=x.color,z=x.intensity,P=x.distance,V=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)h+=R.r*z*C,f+=R.g*z*C,g+=R.b*z*C;else if(x.isLightProbe)for(let k=0;k<9;k++)r.probe[k].addScaledVector(x.sh.coefficients[k],z);else if(x.isDirectionalLight){const k=t.get(x);if(k.color.copy(x.color).multiplyScalar(x.intensity*C),x.castShadow){const U=x.shadow,F=i.get(x);F.shadowBias=U.bias,F.shadowNormalBias=U.normalBias,F.shadowRadius=U.radius,F.shadowMapSize=U.mapSize,r.directionalShadow[p]=F,r.directionalShadowMap[p]=V,r.directionalShadowMatrix[p]=x.shadow.matrix,b++}r.directional[p]=k,p++}else if(x.isSpotLight){const k=t.get(x);if(k.position.setFromMatrixPosition(x.matrixWorld),k.color.copy(R).multiplyScalar(z*C),k.distance=P,k.coneCos=Math.cos(x.angle),k.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),k.decay=x.decay,x.castShadow){const U=x.shadow,F=i.get(x);F.shadowBias=U.bias,F.shadowNormalBias=U.normalBias,F.shadowRadius=U.radius,F.shadowMapSize=U.mapSize,r.spotShadow[v]=F,r.spotShadowMap[v]=V,r.spotShadowMatrix[v]=x.shadow.matrix,S++}r.spot[v]=k,v++}else if(x.isRectAreaLight){const k=t.get(x);k.color.copy(R).multiplyScalar(z),k.halfWidth.set(.5*x.width,0,0),k.halfHeight.set(0,.5*x.height,0),r.rectArea[_]=k,_++}else if(x.isPointLight){const k=t.get(x);if(k.color.copy(x.color).multiplyScalar(x.intensity*C),k.distance=x.distance,k.decay=x.decay,x.castShadow){const U=x.shadow,F=i.get(x);F.shadowBias=U.bias,F.shadowNormalBias=U.normalBias,F.shadowRadius=U.radius,F.shadowMapSize=U.mapSize,F.shadowCameraNear=U.camera.near,F.shadowCameraFar=U.camera.far,r.pointShadow[m]=F,r.pointShadowMap[m]=V,r.pointShadowMatrix[m]=x.shadow.matrix,w++}r.point[m]=k,m++}else if(x.isHemisphereLight){const k=t.get(x);k.skyColor.copy(x.color).multiplyScalar(z*C),k.groundColor.copy(x.groundColor).multiplyScalar(z*C),r.hemi[y]=k,y++}}_>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=be.LTC_FLOAT_1,r.rectAreaLTC2=be.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=be.LTC_HALF_1,r.rectAreaLTC2=be.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=g;const E=r.hash;(E.directionalLength!==p||E.pointLength!==m||E.spotLength!==v||E.rectAreaLength!==_||E.hemiLength!==y||E.numDirectionalShadows!==b||E.numPointShadows!==w||E.numSpotShadows!==S)&&(r.directional.length=p,r.spot.length=v,r.rectArea.length=_,r.point.length=m,r.hemi.length=y,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=w,r.spotShadowMatrix.length=S,E.directionalLength=p,E.pointLength=m,E.spotLength=v,E.rectAreaLength=_,E.hemiLength=y,E.numDirectionalShadows=b,E.numPointShadows=w,E.numSpotShadows=S,r.version=y9++)},setupView:function c(u,d){let h=0,f=0,g=0,p=0,m=0;const v=d.matrixWorldInverse;for(let _=0,y=u.length;_<y;_++){const b=u[_];if(b.isDirectionalLight){const w=r.directional[h];w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(v),h++}else if(b.isSpotLight){const w=r.spot[g];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(v),w.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(s),w.direction.transformDirection(v),g++}else if(b.isRectAreaLight){const w=r.rectArea[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(v),a.identity(),o.copy(b.matrixWorld),o.premultiply(v),a.extractRotation(o),w.halfWidth.set(.5*b.width,0,0),w.halfHeight.set(0,.5*b.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),p++}else if(b.isPointLight){const w=r.point[f];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(v),f++}else if(b.isHemisphereLight){const w=r.hemi[m];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(v),w.direction.normalize(),m++}}},state:r}}function LR(n,e){const t=new w9(n,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function o(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function x9(n,e){let t=new WeakMap;return{get:function i(s,o=0){let a;return!1===t.has(s)?(a=new LR(n,e),t.set(s,[a])):o>=t.get(s).length?(a=new LR(n,e),t.get(s).push(a)):a=t.get(s)[o],a},dispose:function r(){t=new WeakMap}}}class Lb extends qn{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Lb.prototype.isMeshDepthMaterial=!0;class Bb extends qn{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new M,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function BR(n,e,t){let i=new Cg;const r=new K,s=new K,o=new Ot,a=new Lb({depthPacking:3201}),l=new Bb,c={},u=t.maxTextureSize,d={0:1,1:0,2:2},h=new is({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new K},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const g=new Ue;g.setAttribute("position",new fn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new ge(g,h),m=this;function v(b,w){const S=e.update(p);h.defines.VSM_SAMPLES!==b.blurSamples&&(h.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),h.uniforms.shadow_pass.value=b.map.texture,h.uniforms.resolution.value=b.mapSize,h.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(w,null,S,h,p,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(w,null,S,f,p,null)}function _(b,w,S,C,E,B){let N=null;const x=!0===S.isPointLight?b.customDistanceMaterial:b.customDepthMaterial;if(N=void 0!==x?x:!0===S.isPointLight?l:a,n.localClippingEnabled&&!0===w.clipShadows&&0!==w.clippingPlanes.length||w.displacementMap&&0!==w.displacementScale||w.alphaMap&&w.alphaTest>0){const R=N.uuid,z=w.uuid;let P=c[R];void 0===P&&(P={},c[R]=P);let V=P[z];void 0===V&&(V=N.clone(),P[z]=V),N=V}return N.visible=w.visible,N.wireframe=w.wireframe,N.side=3===B?null!==w.shadowSide?w.shadowSide:w.side:null!==w.shadowSide?w.shadowSide:d[w.side],N.alphaMap=w.alphaMap,N.alphaTest=w.alphaTest,N.clipShadows=w.clipShadows,N.clippingPlanes=w.clippingPlanes,N.clipIntersection=w.clipIntersection,N.displacementMap=w.displacementMap,N.displacementScale=w.displacementScale,N.displacementBias=w.displacementBias,N.wireframeLinewidth=w.wireframeLinewidth,N.linewidth=w.linewidth,!0===S.isPointLight&&!0===N.isMeshDistanceMaterial&&(N.referencePosition.setFromMatrixPosition(S.matrixWorld),N.nearDistance=C,N.farDistance=E),N}function y(b,w,S,C,E){if(!1===b.visible)return;if(b.layers.test(w.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&3===E)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,b.matrixWorld);const x=e.update(b),R=b.material;if(Array.isArray(R)){const z=x.groups;for(let P=0,V=z.length;P<V;P++){const k=z[P],U=R[k.materialIndex];if(U&&U.visible){const F=_(b,U,C,S.near,S.far,E);n.renderBufferDirect(S,null,x,F,b,k)}}}else if(R.visible){const z=_(b,R,C,S.near,S.far,E);n.renderBufferDirect(S,null,x,z,b,null)}}const N=b.children;for(let x=0,R=N.length;x<R;x++)y(N[x],w,S,C,E)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(b,w,S){if(!1===m.enabled||!1===m.autoUpdate&&!1===m.needsUpdate||0===b.length)return;const C=n.getRenderTarget(),E=n.getActiveCubeFace(),B=n.getActiveMipmapLevel(),N=n.state;N.setBlending(0),N.buffers.color.setClear(1,1,1,1),N.buffers.depth.setTest(!0),N.setScissorTest(!1);for(let x=0,R=b.length;x<R;x++){const z=b[x],P=z.shadow;if(void 0===P){console.warn("THREE.WebGLShadowMap:",z,"has no shadow.");continue}if(!1===P.autoUpdate&&!1===P.needsUpdate)continue;r.copy(P.mapSize);const V=P.getFrameExtents();r.multiply(V),s.copy(P.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/V.x),r.x=s.x*V.x,P.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/V.y),r.y=s.y*V.y,P.mapSize.y=s.y)),null===P.map&&!P.isPointLightShadow&&3===this.type&&(P.map=new gr(r.x,r.y),P.map.texture.name=z.name+".shadowMap",P.mapPass=new gr(r.x,r.y),P.camera.updateProjectionMatrix()),null===P.map&&(P.map=new gr(r.x,r.y,{minFilter:ni,magFilter:ni,format:Pr}),P.map.texture.name=z.name+".shadowMap",P.camera.updateProjectionMatrix()),n.setRenderTarget(P.map),n.clear();const k=P.getViewportCount();for(let U=0;U<k;U++){const F=P.getViewport(U);o.set(s.x*F.x,s.y*F.y,s.x*F.z,s.y*F.w),N.viewport(o),P.updateMatrices(z,U),i=P.getFrustum(),y(w,S,P.camera,z,this.type)}!P.isPointLightShadow&&3===this.type&&v(P,S),P.needsUpdate=!1}m.needsUpdate=!1,n.setRenderTarget(C,E,B)}}function D9(n,e,t){const i=t.isWebGL2,a=new function r(){let O=!1;const fe=new Ot;let he=null;const Ye=new Ot(0,0,0,0);return{setMask:function(De){he!==De&&!O&&(n.colorMask(De,De,De,De),he=De)},setLocked:function(De){O=De},setClear:function(De,Be,ve,at,_n){!0===_n&&(De*=at,Be*=at,ve*=at),fe.set(De,Be,ve,at),!1===Ye.equals(fe)&&(n.clearColor(De,Be,ve,at),Ye.copy(fe))},reset:function(){O=!1,he=null,Ye.set(-1,0,0,0)}}},l=new function s(){let O=!1,fe=null,he=null,Ye=null;return{setTest:function(De){De?Me(2929):Y(2929)},setMask:function(De){fe!==De&&!O&&(n.depthMask(De),fe=De)},setFunc:function(De){if(he!==De){if(De)switch(De){case 0:n.depthFunc(512);break;case 1:n.depthFunc(519);break;case 2:n.depthFunc(513);break;case 3:default:n.depthFunc(515);break;case 4:n.depthFunc(514);break;case 5:n.depthFunc(518);break;case 6:n.depthFunc(516);break;case 7:n.depthFunc(517)}else n.depthFunc(515);he=De}},setLocked:function(De){O=De},setClear:function(De){Ye!==De&&(n.clearDepth(De),Ye=De)},reset:function(){O=!1,fe=null,he=null,Ye=null}}},c=new function o(){let O=!1,fe=null,he=null,Ye=null,De=null,Be=null,ve=null,at=null,_n=null;return{setTest:function(Rt){O||(Rt?Me(2960):Y(2960))},setMask:function(Rt){fe!==Rt&&!O&&(n.stencilMask(Rt),fe=Rt)},setFunc:function(Rt,Bs,Vs){(he!==Rt||Ye!==Bs||De!==Vs)&&(n.stencilFunc(Rt,Bs,Vs),he=Rt,Ye=Bs,De=Vs)},setOp:function(Rt,Bs,Vs){(Be!==Rt||ve!==Bs||at!==Vs)&&(n.stencilOp(Rt,Bs,Vs),Be=Rt,ve=Bs,at=Vs)},setLocked:function(Rt){O=Rt},setClear:function(Rt){_n!==Rt&&(n.clearStencil(Rt),_n=Rt)},reset:function(){O=!1,fe=null,he=null,Ye=null,De=null,Be=null,ve=null,at=null,_n=null}}};let u={},d={},h=new WeakMap,f=[],g=null,p=!1,m=null,v=null,_=null,y=null,b=null,w=null,S=null,C=!1,E=null,B=null,N=null,x=null,R=null;const z=n.getParameter(35661);let P=!1,V=0;const k=n.getParameter(7938);-1!==k.indexOf("WebGL")?(V=parseFloat(/^WebGL (\d)/.exec(k)[1]),P=V>=1):-1!==k.indexOf("OpenGL ES")&&(V=parseFloat(/^OpenGL ES (\d)/.exec(k)[1]),P=V>=2);let U=null,F={};const G=n.getParameter(3088),q=n.getParameter(2978),ee=(new Ot).fromArray(G),X=(new Ot).fromArray(q);function xe(O,fe,he){const Ye=new Uint8Array(4),De=n.createTexture();n.bindTexture(O,De),n.texParameteri(O,10241,9728),n.texParameteri(O,10240,9728);for(let Be=0;Be<he;Be++)n.texImage2D(fe+Be,0,6408,1,1,0,6408,5121,Ye);return De}const Re={};function Me(O){!0!==u[O]&&(n.enable(O),u[O]=!0)}function Y(O){!1!==u[O]&&(n.disable(O),u[O]=!1)}Re[3553]=xe(3553,3553,1),Re[34067]=xe(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Me(2929),l.setFunc(3),se(!1),Ie(1),Me(2884),Z(0);const le={100:32774,101:32778,102:32779};if(i)le[103]=32775,le[104]=32776;else{const O=e.get("EXT_blend_minmax");null!==O&&(le[103]=O.MIN_EXT,le[104]=O.MAX_EXT)}const Ze={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function Z(O,fe,he,Ye,De,Be,ve,at){if(0!==O){if(!1===p&&(Me(3042),p=!0),5===O)De=De||fe,Be=Be||he,ve=ve||Ye,(fe!==v||De!==b)&&(n.blendEquationSeparate(le[fe],le[De]),v=fe,b=De),(he!==_||Ye!==y||Be!==w||ve!==S)&&(n.blendFuncSeparate(Ze[he],Ze[Ye],Ze[Be],Ze[ve]),_=he,y=Ye,w=Be,S=ve),m=O,C=null;else if(O!==m||at!==C){if((100!==v||100!==b)&&(n.blendEquation(32774),v=100,b=100),at)switch(O){case 1:n.blendFuncSeparate(1,771,1,771);break;case 2:n.blendFunc(1,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}else switch(O){case 1:n.blendFuncSeparate(770,771,1,771);break;case 2:n.blendFunc(770,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",O)}_=null,y=null,w=null,S=null,m=O,C=at}}else!0===p&&(Y(3042),p=!1)}function se(O){E!==O&&(n.frontFace(O?2304:2305),E=O)}function Ie(O){0!==O?(Me(2884),O!==B&&n.cullFace(1===O?1029:2===O?1028:1032)):Y(2884),B=O}function Xe(O,fe,he){O?(Me(32823),(x!==fe||R!==he)&&(n.polygonOffset(fe,he),x=fe,R=he)):Y(32823)}function Ve(O){void 0===O&&(O=33984+z-1),U!==O&&(n.activeTexture(O),U=O)}return{buffers:{color:a,depth:l,stencil:c},enable:Me,disable:Y,bindFramebuffer:function ot(O,fe){return d[O]!==fe&&(n.bindFramebuffer(O,fe),d[O]=fe,i&&(36009===O&&(d[36160]=fe),36160===O&&(d[36009]=fe)),!0)},drawBuffers:function Fe(O,fe){let he=f,Ye=!1;if(O)if(he=h.get(fe),void 0===he&&(he=[],h.set(fe,he)),O.isWebGLMultipleRenderTargets){const De=O.texture;if(he.length!==De.length||36064!==he[0]){for(let Be=0,ve=De.length;Be<ve;Be++)he[Be]=36064+Be;he.length=De.length,Ye=!0}}else 36064!==he[0]&&(he[0]=36064,Ye=!0);else 1029!==he[0]&&(he[0]=1029,Ye=!0);Ye&&(t.isWebGL2?n.drawBuffers(he):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(he))},useProgram:function $e(O){return g!==O&&(n.useProgram(O),g=O,!0)},setBlending:Z,setMaterial:function J(O,fe){2===O.side?Y(2884):Me(2884);let he=1===O.side;fe&&(he=!he),se(he),1===O.blending&&!1===O.transparent?Z(0):Z(O.blending,O.blendEquation,O.blendSrc,O.blendDst,O.blendEquationAlpha,O.blendSrcAlpha,O.blendDstAlpha,O.premultipliedAlpha),l.setFunc(O.depthFunc),l.setTest(O.depthTest),l.setMask(O.depthWrite),a.setMask(O.colorWrite);const Ye=O.stencilWrite;c.setTest(Ye),Ye&&(c.setMask(O.stencilWriteMask),c.setFunc(O.stencilFunc,O.stencilRef,O.stencilFuncMask),c.setOp(O.stencilFail,O.stencilZFail,O.stencilZPass)),Xe(O.polygonOffset,O.polygonOffsetFactor,O.polygonOffsetUnits),!0===O.alphaToCoverage?Me(32926):Y(32926)},setFlipSided:se,setCullFace:Ie,setLineWidth:function ye(O){O!==N&&(P&&n.lineWidth(O),N=O)},setPolygonOffset:Xe,setScissorTest:function Ge(O){O?Me(3089):Y(3089)},activeTexture:Ve,bindTexture:function At(O,fe){null===U&&Ve();let he=F[U];void 0===he&&(he={type:void 0,texture:void 0},F[U]=he),(he.type!==O||he.texture!==fe)&&(n.bindTexture(O,fe||Re[O]),he.type=O,he.texture=fe)},unbindTexture:function Dt(){const O=F[U];void 0!==O&&void 0!==O.type&&(n.bindTexture(O.type,null),O.type=void 0,O.texture=void 0)},compressedTexImage2D:function I(){try{n.compressedTexImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage2D:function Le(){try{n.texImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texImage3D:function T(){try{n.texImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texStorage2D:function me(){try{n.texStorage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texStorage3D:function Ce(){try{n.texStorage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage2D:function D(){try{n.texSubImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},texSubImage3D:function j(){try{n.texSubImage3D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},compressedTexSubImage2D:function re(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(O){console.error("THREE.WebGLState:",O)}},scissor:function ae(O){!1===ee.equals(O)&&(n.scissor(O.x,O.y,O.z,O.w),ee.copy(O))},viewport:function ke(O){!1===X.equals(O)&&(n.viewport(O.x,O.y,O.z,O.w),X.copy(O))},reset:function _e(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},U=null,F={},d={},h=new WeakMap,f=[],g=null,p=!1,m=null,v=null,_=null,y=null,b=null,w=null,S=null,C=!1,E=null,B=null,N=null,x=null,R=null,ee.set(0,0,n.canvas.width,n.canvas.height),X.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function C9(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let p;const m=new WeakMap;let v=!1;try{v="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(I){}function _(I,D){return v?new OffscreenCanvas(I,D):Jd("canvas")}function y(I,D,j,re){let me=1;if((I.width>re||I.height>re)&&(me=re/Math.max(I.width,I.height)),me<1||!0===D){if("undefined"!=typeof HTMLImageElement&&I instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&I instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&I instanceof ImageBitmap){const Ce=D?ig:Math.floor,Le=Ce(me*I.width),T=Ce(me*I.height);void 0===p&&(p=_(Le,T));const ae=j?_(Le,T):p;return ae.width=Le,ae.height=T,ae.getContext("2d").drawImage(I,0,0,Le,T),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+I.width+"x"+I.height+") to ("+Le+"x"+T+")."),ae}return"data"in I&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+I.width+"x"+I.height+")."),I}return I}function b(I){return sb(I.width)&&sb(I.height)}function S(I,D){return I.generateMipmaps&&D&&I.minFilter!==ni&&I.minFilter!==jn}function C(I){n.generateMipmap(I)}function E(I,D,j,re,me=!1){if(!1===a)return D;if(null!==I){if(void 0!==n[I])return n[I];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let Ce=D;return 6403===D&&(5126===j&&(Ce=33326),5131===j&&(Ce=33325),5121===j&&(Ce=33321)),33319===D&&(5126===j&&(Ce=33328),5131===j&&(Ce=33327),5121===j&&(Ce=33323)),6408===D&&(5126===j&&(Ce=34836),5131===j&&(Ce=34842),5121===j&&(Ce=re===Yt&&!1===me?35907:32856),32819===j&&(Ce=32854),32820===j&&(Ce=32855)),(33325===Ce||33326===Ce||33327===Ce||33328===Ce||34842===Ce||34836===Ce)&&e.get("EXT_color_buffer_float"),Ce}function B(I,D,j){return!0===S(I,j)||I.isFramebufferTexture&&I.minFilter!==ni&&I.minFilter!==jn?Math.log2(Math.max(D.width,D.height))+1:void 0!==I.mipmaps&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?D.mipmaps.length:1}function N(I){return I===ni||1004===I||1005===I?9728:9729}function x(I){const D=I.target;D.removeEventListener("dispose",x),function z(I){const D=i.get(I);if(void 0===D.__webglInit)return;const j=I.source,re=m.get(j);if(re){const me=re[D.__cacheKey];me.usedTimes--,0===me.usedTimes&&P(I),0===Object.keys(re).length&&m.delete(j)}i.remove(I)}(D),D.isVideoTexture&&g.delete(D)}function R(I){const D=I.target;D.removeEventListener("dispose",R),function V(I){const D=I.texture,j=i.get(I),re=i.get(D);if(void 0!==re.__webglTexture&&(n.deleteTexture(re.__webglTexture),o.memory.textures--),I.depthTexture&&I.depthTexture.dispose(),I.isWebGLCubeRenderTarget)for(let me=0;me<6;me++)n.deleteFramebuffer(j.__webglFramebuffer[me]),j.__webglDepthbuffer&&n.deleteRenderbuffer(j.__webglDepthbuffer[me]);else n.deleteFramebuffer(j.__webglFramebuffer),j.__webglDepthbuffer&&n.deleteRenderbuffer(j.__webglDepthbuffer),j.__webglMultisampledFramebuffer&&n.deleteFramebuffer(j.__webglMultisampledFramebuffer),j.__webglColorRenderbuffer&&n.deleteRenderbuffer(j.__webglColorRenderbuffer),j.__webglDepthRenderbuffer&&n.deleteRenderbuffer(j.__webglDepthRenderbuffer);if(I.isWebGLMultipleRenderTargets)for(let me=0,Ce=D.length;me<Ce;me++){const Le=i.get(D[me]);Le.__webglTexture&&(n.deleteTexture(Le.__webglTexture),o.memory.textures--),i.remove(D[me])}i.remove(D),i.remove(I)}(D)}function P(I){const D=i.get(I);n.deleteTexture(D.__webglTexture),delete m.get(I.source)[D.__cacheKey],o.memory.textures--}let k=0;function q(I,D){const j=i.get(I);if(I.isVideoTexture&&function At(I){const D=o.render.frame;g.get(I)!==D&&(g.set(I,D),I.update())}(I),!1===I.isRenderTargetTexture&&I.version>0&&j.__version!==I.version){const re=I.image;if(null===re)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==re.complete)return void Fe(j,I,D);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+D),t.bindTexture(3553,j.__webglTexture)}const Re={[yc]:10497,[Ti]:33071,1002:33648},Me={[ni]:9728,1004:9984,1005:9986,[jn]:9729,1007:9985,1008:9987};function Y(I,D,j){if(j?(n.texParameteri(I,10242,Re[D.wrapS]),n.texParameteri(I,10243,Re[D.wrapT]),(32879===I||35866===I)&&n.texParameteri(I,32882,Re[D.wrapR]),n.texParameteri(I,10240,Me[D.magFilter]),n.texParameteri(I,10241,Me[D.minFilter])):(n.texParameteri(I,10242,33071),n.texParameteri(I,10243,33071),(32879===I||35866===I)&&n.texParameteri(I,32882,33071),(D.wrapS!==Ti||D.wrapT!==Ti)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(I,10240,N(D.magFilter)),n.texParameteri(I,10241,N(D.minFilter)),D.minFilter!==ni&&D.minFilter!==jn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const re=e.get("EXT_texture_filter_anisotropic");if(D.type===Go&&!1===e.has("OES_texture_float_linear")||!1===a&&D.type===wc&&!1===e.has("OES_texture_half_float_linear"))return;(D.anisotropy>1||i.get(D).__currentAnisotropy)&&(n.texParameterf(I,re.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(D.anisotropy,r.getMaxAnisotropy())),i.get(D).__currentAnisotropy=D.anisotropy)}}function ot(I,D){let j=!1;void 0===I.__webglInit&&(I.__webglInit=!0,D.addEventListener("dispose",x));const re=D.source;let me=m.get(re);void 0===me&&(me={},m.set(re,me));const Ce=function G(I){const D=[];return D.push(I.wrapS),D.push(I.wrapT),D.push(I.magFilter),D.push(I.minFilter),D.push(I.anisotropy),D.push(I.internalFormat),D.push(I.format),D.push(I.type),D.push(I.generateMipmaps),D.push(I.premultiplyAlpha),D.push(I.flipY),D.push(I.unpackAlignment),D.push(I.encoding),D.join()}(D);if(Ce!==I.__cacheKey){void 0===me[Ce]&&(me[Ce]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,j=!0),me[Ce].usedTimes++;const Le=me[I.__cacheKey];void 0!==Le&&(me[I.__cacheKey].usedTimes--,0===Le.usedTimes&&P(D)),I.__cacheKey=Ce,I.__webglTexture=me[Ce].texture}return j}function Fe(I,D,j){let re=3553;D.isDataArrayTexture&&(re=35866),D.isData3DTexture&&(re=32879);const me=ot(I,D),Ce=D.source;if(t.activeTexture(33984+j),t.bindTexture(re,I.__webglTexture),Ce.version!==Ce.__currentVersion||!0===me){n.pixelStorei(37440,D.flipY),n.pixelStorei(37441,D.premultiplyAlpha),n.pixelStorei(3317,D.unpackAlignment),n.pixelStorei(37443,0);const Le=function w(I){return!a&&(I.wrapS!==Ti||I.wrapT!==Ti||I.minFilter!==ni&&I.minFilter!==jn)}(D)&&!1===b(D.image);let T=y(D.image,Le,!1,u);T=Dt(D,T);const ae=b(T)||a,ke=s.convert(D.format,D.encoding);let fe,_e=s.convert(D.type),O=E(D.internalFormat,ke,_e,D.encoding,D.isVideoTexture);Y(re,D,ae);const he=D.mipmaps,Ye=a&&!0!==D.isVideoTexture,De=void 0===I.__version,Be=B(D,T,ae);if(D.isDepthTexture)O=6402,a?O=D.type===Go?36012:1014===D.type?33190:D.type===xc?35056:33189:D.type===Go&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),D.format===za&&6402===O&&D.type!==qd&&1014!==D.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),D.type=qd,_e=s.convert(D.type)),D.format===Mc&&6402===O&&(O=34041,D.type!==xc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),D.type=xc,_e=s.convert(D.type))),Ye&&De?t.texStorage2D(3553,1,O,T.width,T.height):t.texImage2D(3553,0,O,T.width,T.height,0,ke,_e,null);else if(D.isDataTexture)if(he.length>0&&ae){Ye&&De&&t.texStorage2D(3553,Be,O,he[0].width,he[0].height);for(let ve=0,at=he.length;ve<at;ve++)fe=he[ve],Ye?t.texSubImage2D(3553,ve,0,0,fe.width,fe.height,ke,_e,fe.data):t.texImage2D(3553,ve,O,fe.width,fe.height,0,ke,_e,fe.data);D.generateMipmaps=!1}else Ye?(De&&t.texStorage2D(3553,Be,O,T.width,T.height),t.texSubImage2D(3553,0,0,0,T.width,T.height,ke,_e,T.data)):t.texImage2D(3553,0,O,T.width,T.height,0,ke,_e,T.data);else if(D.isCompressedTexture){Ye&&De&&t.texStorage2D(3553,Be,O,he[0].width,he[0].height);for(let ve=0,at=he.length;ve<at;ve++)fe=he[ve],D.format!==Pr?null!==ke?Ye?t.compressedTexSubImage2D(3553,ve,0,0,fe.width,fe.height,ke,fe.data):t.compressedTexImage2D(3553,ve,O,fe.width,fe.height,0,fe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ye?t.texSubImage2D(3553,ve,0,0,fe.width,fe.height,ke,_e,fe.data):t.texImage2D(3553,ve,O,fe.width,fe.height,0,ke,_e,fe.data)}else if(D.isDataArrayTexture)Ye?(De&&t.texStorage3D(35866,Be,O,T.width,T.height,T.depth),t.texSubImage3D(35866,0,0,0,0,T.width,T.height,T.depth,ke,_e,T.data)):t.texImage3D(35866,0,O,T.width,T.height,T.depth,0,ke,_e,T.data);else if(D.isData3DTexture)Ye?(De&&t.texStorage3D(32879,Be,O,T.width,T.height,T.depth),t.texSubImage3D(32879,0,0,0,0,T.width,T.height,T.depth,ke,_e,T.data)):t.texImage3D(32879,0,O,T.width,T.height,T.depth,0,ke,_e,T.data);else if(D.isFramebufferTexture)Ye&&De?t.texStorage2D(3553,Be,O,T.width,T.height):t.texImage2D(3553,0,O,T.width,T.height,0,ke,_e,null);else if(he.length>0&&ae){Ye&&De&&t.texStorage2D(3553,Be,O,he[0].width,he[0].height);for(let ve=0,at=he.length;ve<at;ve++)fe=he[ve],Ye?t.texSubImage2D(3553,ve,0,0,ke,_e,fe):t.texImage2D(3553,ve,O,ke,_e,fe);D.generateMipmaps=!1}else Ye?(De&&t.texStorage2D(3553,Be,O,T.width,T.height),t.texSubImage2D(3553,0,0,0,ke,_e,T)):t.texImage2D(3553,0,O,ke,_e,T);S(D,ae)&&C(re),Ce.__currentVersion=Ce.version,D.onUpdate&&D.onUpdate(D)}I.__version=D.version}function le(I,D,j,re,me){const Ce=s.convert(j.format,j.encoding),Le=s.convert(j.type),T=E(j.internalFormat,Ce,Le,j.encoding);i.get(D).__hasExternalTextures||(32879===me||35866===me?t.texImage3D(me,0,T,D.width,D.height,D.depth,0,Ce,Le,null):t.texImage2D(me,0,T,D.width,D.height,0,Ce,Le,null)),t.bindFramebuffer(36160,I),Ve(D)?h.framebufferTexture2DMultisampleEXT(36160,re,me,i.get(j).__webglTexture,0,Ge(D)):n.framebufferTexture2D(36160,re,me,i.get(j).__webglTexture,0),t.bindFramebuffer(36160,null)}function Ze(I,D,j){if(n.bindRenderbuffer(36161,I),D.depthBuffer&&!D.stencilBuffer){let re=33189;if(j||Ve(D)){const me=D.depthTexture;me&&me.isDepthTexture&&(me.type===Go?re=36012:1014===me.type&&(re=33190));const Ce=Ge(D);Ve(D)?h.renderbufferStorageMultisampleEXT(36161,Ce,re,D.width,D.height):n.renderbufferStorageMultisample(36161,Ce,re,D.width,D.height)}else n.renderbufferStorage(36161,re,D.width,D.height);n.framebufferRenderbuffer(36160,36096,36161,I)}else if(D.depthBuffer&&D.stencilBuffer){const re=Ge(D);j&&!1===Ve(D)?n.renderbufferStorageMultisample(36161,re,35056,D.width,D.height):Ve(D)?h.renderbufferStorageMultisampleEXT(36161,re,35056,D.width,D.height):n.renderbufferStorage(36161,34041,D.width,D.height),n.framebufferRenderbuffer(36160,33306,36161,I)}else{const re=!0===D.isWebGLMultipleRenderTargets?D.texture[0]:D.texture,me=s.convert(re.format,re.encoding),Ce=s.convert(re.type),Le=E(re.internalFormat,me,Ce,re.encoding),T=Ge(D);j&&!1===Ve(D)?n.renderbufferStorageMultisample(36161,T,Le,D.width,D.height):Ve(D)?h.renderbufferStorageMultisampleEXT(36161,T,Le,D.width,D.height):n.renderbufferStorage(36161,Le,D.width,D.height)}n.bindRenderbuffer(36161,null)}function J(I){const D=i.get(I),j=!0===I.isWebGLCubeRenderTarget;if(I.depthTexture&&!D.__autoAllocateDepthBuffer){if(j)throw new Error("target.depthTexture not supported in Cube render targets");!function Z(I,D){if(D&&D.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,I),!D.depthTexture||!D.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(D.depthTexture).__webglTexture||D.depthTexture.image.width!==D.width||D.depthTexture.image.height!==D.height)&&(D.depthTexture.image.width=D.width,D.depthTexture.image.height=D.height,D.depthTexture.needsUpdate=!0),q(D.depthTexture,0);const re=i.get(D.depthTexture).__webglTexture,me=Ge(D);if(D.depthTexture.format===za)Ve(D)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,re,0,me):n.framebufferTexture2D(36160,36096,3553,re,0);else{if(D.depthTexture.format!==Mc)throw new Error("Unknown depthTexture format");Ve(D)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,re,0,me):n.framebufferTexture2D(36160,33306,3553,re,0)}}(D.__webglFramebuffer,I)}else if(j){D.__webglDepthbuffer=[];for(let re=0;re<6;re++)t.bindFramebuffer(36160,D.__webglFramebuffer[re]),D.__webglDepthbuffer[re]=n.createRenderbuffer(),Ze(D.__webglDepthbuffer[re],I,!1)}else t.bindFramebuffer(36160,D.__webglFramebuffer),D.__webglDepthbuffer=n.createRenderbuffer(),Ze(D.__webglDepthbuffer,I,!1);t.bindFramebuffer(36160,null)}function Ge(I){return Math.min(d,I.samples)}function Ve(I){const D=i.get(I);return a&&I.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==D.__useRenderToTexture}function Dt(I,D){const j=I.encoding,re=I.format,me=I.type;return!0===I.isCompressedTexture||!0===I.isVideoTexture||1035===I.format||j!==so&&(j===Yt?!1===a?!0===e.has("EXT_sRGB")&&re===Pr?(I.format=1035,I.minFilter=jn,I.generateMipmaps=!1):D=$a.sRGBToLinear(D):(re!==Pr||me!==Ha)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",j)),D}this.allocateTextureUnit=function F(){const I=k;return I>=l&&console.warn("THREE.WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+l),k+=1,I},this.resetTextureUnits=function U(){k=0},this.setTexture2D=q,this.setTexture2DArray=function ee(I,D){const j=i.get(I);I.version>0&&j.__version!==I.version?Fe(j,I,D):(t.activeTexture(33984+D),t.bindTexture(35866,j.__webglTexture))},this.setTexture3D=function X(I,D){const j=i.get(I);I.version>0&&j.__version!==I.version?Fe(j,I,D):(t.activeTexture(33984+D),t.bindTexture(32879,j.__webglTexture))},this.setTextureCube=function xe(I,D){const j=i.get(I);I.version>0&&j.__version!==I.version?function $e(I,D,j){if(6!==D.image.length)return;const re=ot(I,D),me=D.source;if(t.activeTexture(33984+j),t.bindTexture(34067,I.__webglTexture),me.version!==me.__currentVersion||!0===re){n.pixelStorei(37440,D.flipY),n.pixelStorei(37441,D.premultiplyAlpha),n.pixelStorei(3317,D.unpackAlignment),n.pixelStorei(37443,0);const Ce=D.isCompressedTexture||D.image[0].isCompressedTexture,Le=D.image[0]&&D.image[0].isDataTexture,T=[];for(let ve=0;ve<6;ve++)T[ve]=Ce||Le?Le?D.image[ve].image:D.image[ve]:y(D.image[ve],!1,!0,c),T[ve]=Dt(D,T[ve]);const ae=T[0],ke=b(ae)||a,_e=s.convert(D.format,D.encoding),O=s.convert(D.type),fe=E(D.internalFormat,_e,O,D.encoding),he=a&&!0!==D.isVideoTexture,Ye=void 0===I.__version;let Be,De=B(D,ae,ke);if(Y(34067,D,ke),Ce){he&&Ye&&t.texStorage2D(34067,De,fe,ae.width,ae.height);for(let ve=0;ve<6;ve++){Be=T[ve].mipmaps;for(let at=0;at<Be.length;at++){const _n=Be[at];D.format!==Pr?null!==_e?he?t.compressedTexSubImage2D(34069+ve,at,0,0,_n.width,_n.height,_e,_n.data):t.compressedTexImage2D(34069+ve,at,fe,_n.width,_n.height,0,_n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):he?t.texSubImage2D(34069+ve,at,0,0,_n.width,_n.height,_e,O,_n.data):t.texImage2D(34069+ve,at,fe,_n.width,_n.height,0,_e,O,_n.data)}}}else{Be=D.mipmaps,he&&Ye&&(Be.length>0&&De++,t.texStorage2D(34067,De,fe,T[0].width,T[0].height));for(let ve=0;ve<6;ve++)if(Le){he?t.texSubImage2D(34069+ve,0,0,0,T[ve].width,T[ve].height,_e,O,T[ve].data):t.texImage2D(34069+ve,0,fe,T[ve].width,T[ve].height,0,_e,O,T[ve].data);for(let at=0;at<Be.length;at++){const Rt=Be[at].image[ve].image;he?t.texSubImage2D(34069+ve,at+1,0,0,Rt.width,Rt.height,_e,O,Rt.data):t.texImage2D(34069+ve,at+1,fe,Rt.width,Rt.height,0,_e,O,Rt.data)}}else{he?t.texSubImage2D(34069+ve,0,0,0,_e,O,T[ve]):t.texImage2D(34069+ve,0,fe,_e,O,T[ve]);for(let at=0;at<Be.length;at++){const _n=Be[at];he?t.texSubImage2D(34069+ve,at+1,0,0,_e,O,_n.image[ve]):t.texImage2D(34069+ve,at+1,fe,_e,O,_n.image[ve])}}}S(D,ke)&&C(34067),me.__currentVersion=me.version,D.onUpdate&&D.onUpdate(D)}I.__version=D.version}(j,I,D):(t.activeTexture(33984+D),t.bindTexture(34067,j.__webglTexture))},this.rebindTextures=function se(I,D,j){const re=i.get(I);void 0!==D&&le(re.__webglFramebuffer,I,I.texture,36064,3553),void 0!==j&&J(I)},this.setupRenderTarget=function Ie(I){const D=I.texture,j=i.get(I),re=i.get(D);I.addEventListener("dispose",R),!0!==I.isWebGLMultipleRenderTargets&&(void 0===re.__webglTexture&&(re.__webglTexture=n.createTexture()),re.__version=D.version,o.memory.textures++);const me=!0===I.isWebGLCubeRenderTarget,Ce=!0===I.isWebGLMultipleRenderTargets,Le=b(I)||a;if(me){j.__webglFramebuffer=[];for(let T=0;T<6;T++)j.__webglFramebuffer[T]=n.createFramebuffer()}else if(j.__webglFramebuffer=n.createFramebuffer(),Ce)if(r.drawBuffers){const T=I.texture;for(let ae=0,ke=T.length;ae<ke;ae++){const _e=i.get(T[ae]);void 0===_e.__webglTexture&&(_e.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(a&&I.samples>0&&!1===Ve(I)){j.__webglMultisampledFramebuffer=n.createFramebuffer(),j.__webglColorRenderbuffer=n.createRenderbuffer(),n.bindRenderbuffer(36161,j.__webglColorRenderbuffer);const T=s.convert(D.format,D.encoding),ae=s.convert(D.type),ke=E(D.internalFormat,T,ae,D.encoding),_e=Ge(I);n.renderbufferStorageMultisample(36161,_e,ke,I.width,I.height),t.bindFramebuffer(36160,j.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064,36161,j.__webglColorRenderbuffer),n.bindRenderbuffer(36161,null),I.depthBuffer&&(j.__webglDepthRenderbuffer=n.createRenderbuffer(),Ze(j.__webglDepthRenderbuffer,I,!0)),t.bindFramebuffer(36160,null)}if(me){t.bindTexture(34067,re.__webglTexture),Y(34067,D,Le);for(let T=0;T<6;T++)le(j.__webglFramebuffer[T],I,D,36064,34069+T);S(D,Le)&&C(34067),t.unbindTexture()}else if(Ce){const T=I.texture;for(let ae=0,ke=T.length;ae<ke;ae++){const _e=T[ae],O=i.get(_e);t.bindTexture(3553,O.__webglTexture),Y(3553,_e,Le),le(j.__webglFramebuffer,I,_e,36064+ae,3553),S(_e,Le)&&C(3553)}t.unbindTexture()}else{let T=3553;(I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(a?T=I.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(T,re.__webglTexture),Y(T,D,Le),le(j.__webglFramebuffer,I,D,36064,T),S(D,Le)&&C(T),t.unbindTexture()}I.depthBuffer&&J(I)},this.updateRenderTargetMipmap=function ye(I){const D=b(I)||a,j=!0===I.isWebGLMultipleRenderTargets?I.texture:[I.texture];for(let re=0,me=j.length;re<me;re++){const Ce=j[re];if(S(Ce,D)){const Le=I.isWebGLCubeRenderTarget?34067:3553,T=i.get(Ce).__webglTexture;t.bindTexture(Le,T),C(Le),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Xe(I){if(a&&I.samples>0&&!1===Ve(I)){const D=I.width,j=I.height;let re=16384;const me=[36064],Ce=I.stencilBuffer?33306:36096;I.depthBuffer&&me.push(Ce);const Le=i.get(I),T=void 0!==Le.__ignoreDepthValues&&Le.__ignoreDepthValues;!1===T&&(I.depthBuffer&&(re|=256),I.stencilBuffer&&(re|=1024)),t.bindFramebuffer(36008,Le.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Le.__webglFramebuffer),!0===T&&(n.invalidateFramebuffer(36008,[Ce]),n.invalidateFramebuffer(36009,[Ce])),n.blitFramebuffer(0,0,D,j,0,0,D,j,re,9728),f&&n.invalidateFramebuffer(36008,me),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,Le.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=J,this.setupFrameBufferTexture=le,this.useMultisampledRTT=Ve}function E9(n,e,t){const i=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===Ha)return 5121;if(1017===s)return 32819;if(1018===s)return 32820;if(1010===s)return 5120;if(1011===s)return 5122;if(s===qd)return 5123;if(1013===s)return 5124;if(1014===s)return 5125;if(s===Go)return 5126;if(s===wc)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return 6406;if(s===Pr)return 6408;if(1024===s)return 6409;if(1025===s)return 6410;if(s===za)return 6402;if(s===Mc)return 34041;if(1028===s)return 6403;if(1022===s)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1029===s)return 36244;if(1030===s)return 33319;if(1031===s)return 33320;if(1033===s)return 36249;if(33776===s||33777===s||33778===s||33779===s)if(o===Yt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return o===Yt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return o===Yt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return o===Yt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===xc?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Bb.prototype.isMeshDistanceMaterial=!0;class VR extends Zn{constructor(e=[]){super(),this.cameras=e}}VR.prototype.isArrayCamera=!0;class po extends Mt{constructor(){super(),this.type="Group"}}po.prototype.isGroup=!0;const T9={type:"move"};class Vb{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new po,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new po,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new M,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new M),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new po,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new M,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new M),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==a&&(r=t.getPose(e.targetRaySpace,i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(T9))),c&&e.hand){o=!0;for(const p of e.hand.values()){const m=t.getJointPose(p,i);if(void 0===c.joints[p.jointName]){const _=new po;_.matrixAutoUpdate=!1,_.visible=!1,c.joints[p.jointName]=_,c.add(_)}const v=c.joints[p.jointName];null!==m&&(v.matrix.fromArray(m.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=m.radius),v.visible=null!==m}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,g=.005;c.inputState.pinching&&h>f+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}}class UR extends Ai{constructor(e,t,i,r,s,o,a,l,c,u){if((u=void 0!==u?u:za)!==za&&u!==Mc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===za&&(i=qd),void 0===i&&u===Mc&&(i=xc),super(null,r,s,o,a,l,u,i,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:ni,this.minFilter=void 0!==l?l:ni,this.flipY=!1,this.generateMipmaps=!1}}UR.prototype.isDepthTexture=!0;class A9 extends Wo{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=null,c=null,u=null,d=null,h=null;const f=t.getContextAttributes();let g=null,p=null;const m=[],v=new Map,_=new Zn;_.layers.enable(1),_.viewport=new Ot;const y=new Zn;y.layers.enable(2),y.viewport=new Ot;const b=[_,y],w=new VR;w.layers.enable(1),w.layers.enable(2);let S=null,C=null;function E(F){const G=v.get(F.inputSource);G&&G.dispatchEvent({type:F.type,data:F.inputSource})}function B(){v.forEach(function(F,G){F.disconnect(G)}),v.clear(),S=null,C=null,e.setRenderTarget(g),d=null,u=null,c=null,r=null,p=null,U.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function N(F){const G=r.inputSources;for(let q=0;q<m.length;q++)v.set(G[q],m[q]);for(let q=0;q<F.removed.length;q++){const ee=F.removed[q],X=v.get(ee);X&&(X.dispatchEvent({type:"disconnected",data:ee}),v.delete(ee))}for(let q=0;q<F.added.length;q++){const ee=F.added[q],X=v.get(ee);X&&X.dispatchEvent({type:"connected",data:ee})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(F){let G=m[F];return void 0===G&&(G=new Vb,m[F]=G),G.getTargetRaySpace()},this.getControllerGrip=function(F){let G=m[F];return void 0===G&&(G=new Vb,m[F]=G),G.getGripSpace()},this.getHand=function(F){let G=m[F];return void 0===G&&(G=new Vb,m[F]=G),G.getHandSpace()},this.setFramebufferScaleFactor=function(F){s=F,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(F){a=F,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getBaseLayer=function(){return null!==u?u:d},this.getBinding=function(){return c},this.getFrame=function(){return h},this.getSession=function(){return r},this.setSession=function(){var F=Zp(function*(G){if(r=G,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",E),r.addEventListener("selectstart",E),r.addEventListener("selectend",E),r.addEventListener("squeeze",E),r.addEventListener("squeezestart",E),r.addEventListener("squeezeend",E),r.addEventListener("end",B),r.addEventListener("inputsourceschange",N),!0!==f.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)d=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:d}),p=new gr(d.framebufferWidth,d.framebufferHeight,{format:Pr,type:Ha,encoding:e.outputEncoding});else{let q=null,ee=null,X=null;f.depth&&(X=f.stencil?35056:33190,q=f.stencil?Mc:za,ee=f.stencil?xc:qd);const xe={colorFormat:e.outputEncoding===Yt?35907:32856,depthFormat:X,scaleFactor:s};c=new XRWebGLBinding(r,t),u=c.createProjectionLayer(xe),r.updateRenderState({layers:[u]}),p=new gr(u.textureWidth,u.textureHeight,{format:Pr,type:Ha,depthTexture:new UR(u.textureWidth,u.textureHeight,ee,void 0,void 0,void 0,void 0,void 0,void 0,q),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0}),e.properties.get(p).__ignoreDepthValues=u.ignoreDepthValues}p.isXRRenderTarget=!0,this.setFoveation(1),o=yield r.requestReferenceSpace(a),U.setContext(r),U.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(G){return F.apply(this,arguments)}}();const x=new M,R=new M;function P(F,G){null===G?F.matrixWorld.copy(F.matrix):F.matrixWorld.multiplyMatrices(G.matrixWorld,F.matrix),F.matrixWorldInverse.copy(F.matrixWorld).invert()}this.updateCamera=function(F){if(null===r)return;w.near=y.near=_.near=F.near,w.far=y.far=_.far=F.far,(S!==w.near||C!==w.far)&&(r.updateRenderState({depthNear:w.near,depthFar:w.far}),S=w.near,C=w.far);const G=F.parent,q=w.cameras;P(w,G);for(let X=0;X<q.length;X++)P(q[X],G);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),F.position.copy(w.position),F.quaternion.copy(w.quaternion),F.scale.copy(w.scale),F.matrix.copy(w.matrix),F.matrixWorld.copy(w.matrixWorld);const ee=F.children;for(let X=0,xe=ee.length;X<xe;X++)ee[X].updateMatrixWorld(!0);2===q.length?function z(F,G,q){x.setFromMatrixPosition(G.matrixWorld),R.setFromMatrixPosition(q.matrixWorld);const ee=x.distanceTo(R),X=G.projectionMatrix.elements,xe=q.projectionMatrix.elements,Re=X[14]/(X[10]-1),Me=X[14]/(X[10]+1),Y=(X[9]+1)/X[5],ot=(X[9]-1)/X[5],Fe=(X[8]-1)/X[0],$e=(xe[8]+1)/xe[0],le=Re*Fe,Ze=Re*$e,Z=ee/(-Fe+$e),J=Z*-Fe;G.matrixWorld.decompose(F.position,F.quaternion,F.scale),F.translateX(J),F.translateZ(Z),F.matrixWorld.compose(F.position,F.quaternion,F.scale),F.matrixWorldInverse.copy(F.matrixWorld).invert();const se=Re+Z,Ie=Me+Z;F.projectionMatrix.makePerspective(le-J,Ze+(ee-J),Y*Me/Ie*se,ot*Me/Ie*se,se,Ie)}(w,_,y):w.projectionMatrix.copy(_.projectionMatrix)},this.getCamera=function(){return w},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(F){null!==u&&(u.fixedFoveation=F),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=F)};let V=null;const U=new lR;U.setAnimationLoop(function k(F,G){if(l=G.getViewerPose(o),h=G,null!==l){const ee=l.views;null!==d&&(e.setRenderTargetFramebuffer(p,d.framebuffer),e.setRenderTarget(p));let X=!1;ee.length!==w.cameras.length&&(w.cameras.length=0,X=!0);for(let xe=0;xe<ee.length;xe++){const Re=ee[xe];let Me=null;if(null!==d)Me=d.getViewport(Re);else{const ot=c.getViewSubImage(u,Re);Me=ot.viewport,0===xe&&(e.setRenderTargetTextures(p,ot.colorTexture,u.ignoreDepthValues?void 0:ot.depthStencilTexture),e.setRenderTarget(p))}const Y=b[xe];Y.matrix.fromArray(Re.transform.matrix),Y.projectionMatrix.fromArray(Re.projectionMatrix),Y.viewport.set(Me.x,Me.y,Me.width,Me.height),0===xe&&w.matrix.copy(Y.matrix),!0===X&&w.cameras.push(Y)}}const q=r.inputSources;for(let ee=0;ee<m.length;ee++)m[ee].update(q[ee],G,o);V&&V(F,G),h=null}),this.setAnimationLoop=function(F){V=F},this.dispose=function(){}}}function R9(n,e){function r(p,m){p.opacity.value=m.opacity,m.color&&p.diffuse.value.copy(m.color),m.emissive&&p.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(p.map.value=m.map),m.alphaMap&&(p.alphaMap.value=m.alphaMap),m.bumpMap&&(p.bumpMap.value=m.bumpMap,p.bumpScale.value=m.bumpScale,1===m.side&&(p.bumpScale.value*=-1)),m.displacementMap&&(p.displacementMap.value=m.displacementMap,p.displacementScale.value=m.displacementScale,p.displacementBias.value=m.displacementBias),m.emissiveMap&&(p.emissiveMap.value=m.emissiveMap),m.normalMap&&(p.normalMap.value=m.normalMap,p.normalScale.value.copy(m.normalScale),1===m.side&&p.normalScale.value.negate()),m.specularMap&&(p.specularMap.value=m.specularMap),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest);const v=e.get(m).envMap;if(v&&(p.envMap.value=v,p.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,p.reflectivity.value=m.reflectivity,p.ior.value=m.ior,p.refractionRatio.value=m.refractionRatio),m.lightMap){p.lightMap.value=m.lightMap;const b=!0!==n.physicallyCorrectLights?Math.PI:1;p.lightMapIntensity.value=m.lightMapIntensity*b}let _,y;m.aoMap&&(p.aoMap.value=m.aoMap,p.aoMapIntensity.value=m.aoMapIntensity),m.map?_=m.map:m.specularMap?_=m.specularMap:m.displacementMap?_=m.displacementMap:m.normalMap?_=m.normalMap:m.bumpMap?_=m.bumpMap:m.roughnessMap?_=m.roughnessMap:m.metalnessMap?_=m.metalnessMap:m.alphaMap?_=m.alphaMap:m.emissiveMap?_=m.emissiveMap:m.clearcoatMap?_=m.clearcoatMap:m.clearcoatNormalMap?_=m.clearcoatNormalMap:m.clearcoatRoughnessMap?_=m.clearcoatRoughnessMap:m.specularIntensityMap?_=m.specularIntensityMap:m.specularColorMap?_=m.specularColorMap:m.transmissionMap?_=m.transmissionMap:m.thicknessMap?_=m.thicknessMap:m.sheenColorMap?_=m.sheenColorMap:m.sheenRoughnessMap&&(_=m.sheenRoughnessMap),void 0!==_&&(_.isWebGLRenderTarget&&(_=_.texture),!0===_.matrixAutoUpdate&&_.updateMatrix(),p.uvTransform.value.copy(_.matrix)),m.aoMap?y=m.aoMap:m.lightMap&&(y=m.lightMap),void 0!==y&&(y.isWebGLRenderTarget&&(y=y.texture),!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uv2Transform.value.copy(y.matrix))}return{refreshFogUniforms:function t(p,m){p.fogColor.value.copy(m.color),m.isFog?(p.fogNear.value=m.near,p.fogFar.value=m.far):m.isFogExp2&&(p.fogDensity.value=m.density)},refreshMaterialUniforms:function i(p,m,v,_,y){m.isMeshBasicMaterial||m.isMeshLambertMaterial?r(p,m):m.isMeshToonMaterial?(r(p,m),function u(p,m){m.gradientMap&&(p.gradientMap.value=m.gradientMap)}(p,m)):m.isMeshPhongMaterial?(r(p,m),function c(p,m){p.specular.value.copy(m.specular),p.shininess.value=Math.max(m.shininess,1e-4)}(p,m)):m.isMeshStandardMaterial?(r(p,m),function d(p,m){p.roughness.value=m.roughness,p.metalness.value=m.metalness,m.roughnessMap&&(p.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(p.metalnessMap.value=m.metalnessMap),e.get(m).envMap&&(p.envMapIntensity.value=m.envMapIntensity)}(p,m),m.isMeshPhysicalMaterial&&function h(p,m,v){p.ior.value=m.ior,m.sheen>0&&(p.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),p.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(p.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(p.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(p.clearcoat.value=m.clearcoat,p.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(p.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(p.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),p.clearcoatNormalMap.value=m.clearcoatNormalMap,1===m.side&&p.clearcoatNormalScale.value.negate())),m.transmission>0&&(p.transmission.value=m.transmission,p.transmissionSamplerMap.value=v.texture,p.transmissionSamplerSize.value.set(v.width,v.height),m.transmissionMap&&(p.transmissionMap.value=m.transmissionMap),p.thickness.value=m.thickness,m.thicknessMap&&(p.thicknessMap.value=m.thicknessMap),p.attenuationDistance.value=m.attenuationDistance,p.attenuationColor.value.copy(m.attenuationColor)),p.specularIntensity.value=m.specularIntensity,p.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(p.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(p.specularColorMap.value=m.specularColorMap)}(p,m,y)):m.isMeshMatcapMaterial?(r(p,m),function f(p,m){m.matcap&&(p.matcap.value=m.matcap)}(p,m)):m.isMeshDepthMaterial?r(p,m):m.isMeshDistanceMaterial?(r(p,m),function g(p,m){p.referencePosition.value.copy(m.referencePosition),p.nearDistance.value=m.nearDistance,p.farDistance.value=m.farDistance}(p,m)):m.isMeshNormalMaterial?r(p,m):m.isLineBasicMaterial?(function s(p,m){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity}(p,m),m.isLineDashedMaterial&&function o(p,m){p.dashSize.value=m.dashSize,p.totalSize.value=m.dashSize+m.gapSize,p.scale.value=m.scale}(p,m)):m.isPointsMaterial?function a(p,m,v,_){let y;p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.size.value=m.size*v,p.scale.value=.5*_,m.map&&(p.map.value=m.map),m.alphaMap&&(p.alphaMap.value=m.alphaMap),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest),m.map?y=m.map:m.alphaMap&&(y=m.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uvTransform.value.copy(y.matrix))}(p,m,v,_):m.isSpriteMaterial?function l(p,m){let v;p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.rotation.value=m.rotation,m.map&&(p.map.value=m.map),m.alphaMap&&(p.alphaMap.value=m.alphaMap),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest),m.map?v=m.map:m.alphaMap&&(v=m.alphaMap),void 0!==v&&(!0===v.matrixAutoUpdate&&v.updateMatrix(),p.uvTransform.value.copy(v.matrix))}(p,m):m.isShadowMaterial?(p.color.value.copy(m.color),p.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function Zt(n={}){const e=void 0!==n.canvas?n.canvas:function I9(){const n=Jd("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,s=void 0!==n.antialias&&n.antialias,o=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,l=void 0!==n.powerPreference?n.powerPreference:"default",c=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=void 0!==n.context?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let d=null,h=null;const f=[],g=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=so,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const p=this;let m=!1,v=0,_=0,y=null,b=-1,w=null;const S=new Ot,C=new Ot;let E=null,B=e.width,N=e.height,x=1,R=null,z=null;const P=new Ot(0,0,B,N),V=new Ot(0,0,B,N);let k=!1;const U=new Cg;let F=!1,G=!1,q=null;const ee=new ue,X=new K,xe=new M,Re={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Me(){return null===y?x:1}let Fe,$e,le,Ze,Z,J,se,Ie,ye,Xe,Ge,Ve,At,Dt,I,D,j,re,me,Ce,Le,T,ae,Y=t;function ot(A,H){for(let $=0;$<A.length;$++){const te=e.getContext(A[$],H);if(null!==te)return te}return null}try{const A={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r139"),e.addEventListener("webglcontextlost",O,!1),e.addEventListener("webglcontextrestored",fe,!1),null===Y){const H=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&H.shift(),Y=ot(H,A),null===Y)throw ot(H)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Y.getShaderPrecisionFormat&&(Y.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(A){throw console.error("THREE.WebGLRenderer: "+A.message),A}function ke(){Fe=new Z$(Y),$e=new G$(Y,Fe,n),Fe.init($e),T=new E9(Y,Fe,$e),le=new D9(Y,Fe,$e),Ze=new J$(Y),Z=new p9,J=new C9(Y,Fe,le,Z,$e,T,Ze),se=new j$(p),Ie=new Y$(p),ye=new Wj(Y,$e),ae=new H$(Y,Fe,ye,$e),Xe=new X$(Y,ye,Ze,ae),Ge=new n7(Y,Xe,ye,Ze),me=new t7(Y,$e,J),D=new W$(Z),Ve=new f9(p,se,Ie,Fe,$e,ae,D),At=new R9(p,Z),Dt=new m9,I=new x9(Fe,$e),re=new U$(p,se,le,Ge,u,o),j=new BR(p,Ge,$e),Ce=new z$(Y,Fe,Ze,$e),Le=new K$(Y,Fe,Ze,$e),Ze.programs=Ve.programs,p.capabilities=$e,p.extensions=Fe,p.properties=Z,p.renderLists=Dt,p.shadowMap=j,p.state=le,p.info=Ze}ke();const _e=new A9(p,Y);function O(A){A.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function fe(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;const A=Ze.autoReset,H=j.enabled,$=j.autoUpdate,W=j.needsUpdate,te=j.type;ke(),Ze.autoReset=A,j.enabled=H,j.autoUpdate=$,j.needsUpdate=W,j.type=te}function he(A){const H=A.target;H.removeEventListener("dispose",he),function Ye(A){(function De(A){const H=Z.get(A).programs;void 0!==H&&(H.forEach(function($){Ve.releaseProgram($)}),A.isShaderMaterial&&Ve.releaseShaderCache(A))})(A),Z.remove(A)}(H)}this.xr=_e,this.getContext=function(){return Y},this.getContextAttributes=function(){return Y.getContextAttributes()},this.forceContextLoss=function(){const A=Fe.get("WEBGL_lose_context");A&&A.loseContext()},this.forceContextRestore=function(){const A=Fe.get("WEBGL_lose_context");A&&A.restoreContext()},this.getPixelRatio=function(){return x},this.setPixelRatio=function(A){void 0!==A&&(x=A,this.setSize(B,N,!1))},this.getSize=function(A){return A.set(B,N)},this.setSize=function(A,H,$){_e.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(B=A,N=H,e.width=Math.floor(A*x),e.height=Math.floor(H*x),!1!==$&&(e.style.width=A+"px",e.style.height=H+"px"),this.setViewport(0,0,A,H))},this.getDrawingBufferSize=function(A){return A.set(B*x,N*x).floor()},this.setDrawingBufferSize=function(A,H,$){B=A,N=H,x=$,e.width=Math.floor(A*$),e.height=Math.floor(H*$),this.setViewport(0,0,A,H)},this.getCurrentViewport=function(A){return A.copy(S)},this.getViewport=function(A){return A.copy(P)},this.setViewport=function(A,H,$,W){A.isVector4?P.set(A.x,A.y,A.z,A.w):P.set(A,H,$,W),le.viewport(S.copy(P).multiplyScalar(x).floor())},this.getScissor=function(A){return A.copy(V)},this.setScissor=function(A,H,$,W){A.isVector4?V.set(A.x,A.y,A.z,A.w):V.set(A,H,$,W),le.scissor(C.copy(V).multiplyScalar(x).floor())},this.getScissorTest=function(){return k},this.setScissorTest=function(A){le.setScissorTest(k=A)},this.setOpaqueSort=function(A){R=A},this.setTransparentSort=function(A){z=A},this.getClearColor=function(A){return A.copy(re.getClearColor())},this.setClearColor=function(){re.setClearColor.apply(re,arguments)},this.getClearAlpha=function(){return re.getClearAlpha()},this.setClearAlpha=function(){re.setClearAlpha.apply(re,arguments)},this.clear=function(A=!0,H=!0,$=!0){let W=0;A&&(W|=16384),H&&(W|=256),$&&(W|=1024),Y.clear(W)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",O,!1),e.removeEventListener("webglcontextrestored",fe,!1),Dt.dispose(),I.dispose(),Z.dispose(),se.dispose(),Ie.dispose(),Ge.dispose(),ae.dispose(),Ve.dispose(),_e.dispose(),_e.removeEventListener("sessionstart",at),_e.removeEventListener("sessionend",_n),q&&(q.dispose(),q=null),Rt.stop()},this.renderBufferDirect=function(A,H,$,W,te,nt){null===H&&(H=Re);const ht=te.isMesh&&te.matrixWorld.determinant()<0,_t=function Uee(A,H,$,W,te){!0!==H.isScene&&(H=Re),J.resetTextureUnits();const nt=H.fog,_t=null===y?p.outputEncoding:!0===y.isXRRenderTarget?y.texture.encoding:so,pt=(W.isMeshStandardMaterial?Ie:se).get(W.envMap||(W.isMeshStandardMaterial?H.environment:null)),Wt=!0===W.vertexColors&&!!$.attributes.color&&4===$.attributes.color.itemSize,Nt=!!W.normalMap&&!!$.attributes.tangent,kt=!!$.morphAttributes.position,Pn=!!$.morphAttributes.normal,_l=!!$.morphAttributes.color,Eu=W.toneMapped?p.toneMapping:0,Tu=$.morphAttributes.position||$.morphAttributes.normal||$.morphAttributes.color,Us=void 0!==Tu?Tu.length:0,Vt=Z.get(W),Au=h.state.lights;!0!==F||!0!==G&&A===w||D.setState(W,A,A===w&&W.id===b);let Kn=!1;W.version===Vt.__version?(Vt.needsLights&&Vt.lightsStateVersion!==Au.state.version||Vt.outputEncoding!==_t||te.isInstancedMesh&&!1===Vt.instancing||!te.isInstancedMesh&&!0===Vt.instancing||te.isSkinnedMesh&&!1===Vt.skinning||!te.isSkinnedMesh&&!0===Vt.skinning||Vt.envMap!==pt||W.fog&&Vt.fog!==nt||void 0!==Vt.numClippingPlanes&&(Vt.numClippingPlanes!==D.numPlanes||Vt.numIntersection!==D.numIntersection)||Vt.vertexAlphas!==Wt||Vt.vertexTangents!==Nt||Vt.morphTargets!==kt||Vt.morphNormals!==Pn||Vt.morphColors!==_l||Vt.toneMapping!==Eu||!0===$e.isWebGL2&&Vt.morphTargetsCount!==Us)&&(Kn=!0):(Kn=!0,Vt.__version=W.version);let Hs=Vt.currentProgram;!0===Kn&&(Hs=Tw(W,H,te));let ma=!1,tf=!1,Aw=!1;const Oi=Hs.getUniforms(),nf=Vt.uniforms;if(le.useProgram(Hs.program)&&(ma=!0,tf=!0,Aw=!0),W.id!==b&&(b=W.id,tf=!0),ma||w!==A){if(Oi.setValue(Y,"projectionMatrix",A.projectionMatrix),$e.logarithmicDepthBuffer&&Oi.setValue(Y,"logDepthBufFC",2/(Math.log(A.far+1)/Math.LN2)),w!==A&&(w=A,tf=!0,Aw=!0),W.isShaderMaterial||W.isMeshPhongMaterial||W.isMeshToonMaterial||W.isMeshStandardMaterial||W.envMap){const ds=Oi.map.cameraPosition;void 0!==ds&&ds.setValue(Y,xe.setFromMatrixPosition(A.matrixWorld))}(W.isMeshPhongMaterial||W.isMeshToonMaterial||W.isMeshLambertMaterial||W.isMeshBasicMaterial||W.isMeshStandardMaterial||W.isShaderMaterial)&&Oi.setValue(Y,"isOrthographic",!0===A.isOrthographicCamera),(W.isMeshPhongMaterial||W.isMeshToonMaterial||W.isMeshLambertMaterial||W.isMeshBasicMaterial||W.isMeshStandardMaterial||W.isShaderMaterial||W.isShadowMaterial||te.isSkinnedMesh)&&Oi.setValue(Y,"viewMatrix",A.matrixWorldInverse)}if(te.isSkinnedMesh){Oi.setOptional(Y,te,"bindMatrix"),Oi.setOptional(Y,te,"bindMatrixInverse");const ds=te.skeleton;ds&&($e.floatVertexTextures?(null===ds.boneTexture&&ds.computeBoneTexture(),Oi.setValue(Y,"boneTexture",ds.boneTexture,J),Oi.setValue(Y,"boneTextureSize",ds.boneTextureSize)):Oi.setOptional(Y,ds,"boneMatrices"))}const Rw=$.morphAttributes;return(void 0!==Rw.position||void 0!==Rw.normal||void 0!==Rw.color&&!0===$e.isWebGL2)&&me.update(te,$,W,Hs),(tf||Vt.receiveShadow!==te.receiveShadow)&&(Vt.receiveShadow=te.receiveShadow,Oi.setValue(Y,"receiveShadow",te.receiveShadow)),tf&&(Oi.setValue(Y,"toneMappingExposure",p.toneMappingExposure),Vt.needsLights&&function Hee(A,H){A.ambientLightColor.needsUpdate=H,A.lightProbe.needsUpdate=H,A.directionalLights.needsUpdate=H,A.directionalLightShadows.needsUpdate=H,A.pointLights.needsUpdate=H,A.pointLightShadows.needsUpdate=H,A.spotLights.needsUpdate=H,A.spotLightShadows.needsUpdate=H,A.rectAreaLights.needsUpdate=H,A.hemisphereLights.needsUpdate=H}(nf,Aw),nt&&W.fog&&At.refreshFogUniforms(nf,nt),At.refreshMaterialUniforms(nf,W,x,N,q),Jo.upload(Y,Vt.uniformsList,nf,J)),W.isShaderMaterial&&!0===W.uniformsNeedUpdate&&(Jo.upload(Y,Vt.uniformsList,nf,J),W.uniformsNeedUpdate=!1),W.isSpriteMaterial&&Oi.setValue(Y,"center",te.center),Oi.setValue(Y,"modelViewMatrix",te.modelViewMatrix),Oi.setValue(Y,"normalMatrix",te.normalMatrix),Oi.setValue(Y,"modelMatrix",te.matrixWorld),Hs}(A,H,$,W,te);le.setMaterial(W,ht);let pt=$.index;const Wt=$.attributes.position;if(null===pt){if(void 0===Wt||0===Wt.count)return}else if(0===pt.count)return;let Nt=1;!0===W.wireframe&&(pt=Xe.getWireframeAttribute($),Nt=2),ae.setup(te,W,_t,$,pt);let kt,Pn=Ce;null!==pt&&(kt=ye.get(pt),Pn=Le,Pn.setIndex(kt));const _l=null!==pt?pt.count:Wt.count,Eu=$.drawRange.start*Nt,Tu=$.drawRange.count*Nt,Us=null!==nt?nt.start*Nt:0,Vt=null!==nt?nt.count*Nt:1/0,Au=Math.max(Eu,Us),Kn=Math.min(_l,Eu+Tu,Us+Vt)-1,Hs=Math.max(0,Kn-Au+1);if(0!==Hs){if(te.isMesh)!0===W.wireframe?(le.setLineWidth(W.wireframeLinewidth*Me()),Pn.setMode(1)):Pn.setMode(4);else if(te.isLine){let ma=W.linewidth;void 0===ma&&(ma=1),le.setLineWidth(ma*Me()),Pn.setMode(te.isLineSegments?1:te.isLineLoop?2:3)}else te.isPoints?Pn.setMode(0):te.isSprite&&Pn.setMode(4);if(te.isInstancedMesh)Pn.renderInstances(Au,Hs,te.count);else if($.isInstancedBufferGeometry){const ma=Math.min($.instanceCount,$._maxInstanceCount);Pn.renderInstances(Au,Hs,ma)}else Pn.render(Au,Hs)}},this.compile=function(A,H){h=I.get(A),h.init(),g.push(h),A.traverseVisible(function($){$.isLight&&$.layers.test(H.layers)&&(h.pushLight($),$.castShadow&&h.pushShadow($))}),h.setupLights(p.physicallyCorrectLights),A.traverse(function($){const W=$.material;if(W)if(Array.isArray(W))for(let te=0;te<W.length;te++)Tw(W[te],A,$);else Tw(W,A,$)}),g.pop(),h=null};let Be=null;function at(){Rt.stop()}function _n(){Rt.start()}const Rt=new lR;function Bs(A,H,$,W){if(!1===A.visible)return;if(A.layers.test(H.layers))if(A.isGroup)$=A.renderOrder;else if(A.isLOD)!0===A.autoUpdate&&A.update(H);else if(A.isLight)h.pushLight(A),A.castShadow&&h.pushShadow(A);else if(A.isSprite){if(!A.frustumCulled||U.intersectsSprite(A)){W&&xe.setFromMatrixPosition(A.matrixWorld).applyMatrix4(ee);const ht=Ge.update(A),_t=A.material;_t.visible&&d.push(A,ht,_t,$,xe.z,null)}}else if((A.isMesh||A.isLine||A.isPoints)&&(A.isSkinnedMesh&&A.skeleton.frame!==Ze.render.frame&&(A.skeleton.update(),A.skeleton.frame=Ze.render.frame),!A.frustumCulled||U.intersectsObject(A))){W&&xe.setFromMatrixPosition(A.matrixWorld).applyMatrix4(ee);const ht=Ge.update(A),_t=A.material;if(Array.isArray(_t)){const pt=ht.groups;for(let Wt=0,Nt=pt.length;Wt<Nt;Wt++){const kt=pt[Wt],Pn=_t[kt.materialIndex];Pn&&Pn.visible&&d.push(A,ht,Pn,$,xe.z,kt)}}else _t.visible&&d.push(A,ht,_t,$,xe.z,null)}const nt=A.children;for(let ht=0,_t=nt.length;ht<_t;ht++)Bs(nt[ht],H,$,W)}function Vs(A,H,$,W){const te=A.opaque,nt=A.transmissive,ht=A.transparent;h.setupLightsView($),nt.length>0&&function Bee(A,H,$){const W=$e.isWebGL2;null===q&&(q=new gr(1,1,{generateMipmaps:!0,type:null!==T.convert(wc)?wc:Ha,minFilter:1008,samples:W&&!0===s?4:0})),p.getDrawingBufferSize(X),W?q.setSize(X.x,X.y):q.setSize(ig(X.x),ig(X.y));const te=p.getRenderTarget();p.setRenderTarget(q),p.clear();const nt=p.toneMapping;p.toneMapping=0,u_(A,H,$),p.toneMapping=nt,J.updateMultisampleRenderTarget(q),J.updateRenderTargetMipmap(q),p.setRenderTarget(te)}(te,H,$),W&&le.viewport(S.copy(W)),te.length>0&&u_(te,H,$),nt.length>0&&u_(nt,H,$),ht.length>0&&u_(ht,H,$),le.buffers.depth.setTest(!0),le.buffers.depth.setMask(!0),le.buffers.color.setMask(!0),le.setPolygonOffset(!1)}function u_(A,H,$){const W=!0===H.isScene?H.overrideMaterial:null;for(let te=0,nt=A.length;te<nt;te++){const ht=A[te],_t=ht.object,pt=ht.geometry,Wt=null===W?ht.material:W,Nt=ht.group;_t.layers.test($.layers)&&Vee(_t,H,$,pt,Wt,Nt)}}function Vee(A,H,$,W,te,nt){A.onBeforeRender(p,H,$,W,te,nt),A.modelViewMatrix.multiplyMatrices($.matrixWorldInverse,A.matrixWorld),A.normalMatrix.getNormalMatrix(A.modelViewMatrix),te.onBeforeRender(p,H,$,W,A,nt),!0===te.transparent&&2===te.side?(te.side=1,te.needsUpdate=!0,p.renderBufferDirect($,H,W,te,A,nt),te.side=0,te.needsUpdate=!0,p.renderBufferDirect($,H,W,te,A,nt),te.side=2):p.renderBufferDirect($,H,W,te,A,nt),A.onAfterRender(p,H,$,W,te,nt)}function Tw(A,H,$){!0!==H.isScene&&(H=Re);const W=Z.get(A),te=h.state.lights,ht=te.state.version,_t=Ve.getParameters(A,te.state,h.state.shadowsArray,H,$),pt=Ve.getProgramCacheKey(_t);let Wt=W.programs;W.environment=A.isMeshStandardMaterial?H.environment:null,W.fog=H.fog,W.envMap=(A.isMeshStandardMaterial?Ie:se).get(A.envMap||W.environment),void 0===Wt&&(A.addEventListener("dispose",he),Wt=new Map,W.programs=Wt);let Nt=Wt.get(pt);if(void 0!==Nt){if(W.currentProgram===Nt&&W.lightsStateVersion===ht)return G2(A,_t),Nt}else _t.uniforms=Ve.getUniforms(A),A.onBuild($,_t,p),A.onBeforeCompile(_t,p),Nt=Ve.acquireProgram(_t,pt),Wt.set(pt,Nt),W.uniforms=_t.uniforms;const kt=W.uniforms;(!A.isShaderMaterial&&!A.isRawShaderMaterial||!0===A.clipping)&&(kt.clippingPlanes=D.uniform),G2(A,_t),W.needsLights=function zee(A){return A.isMeshLambertMaterial||A.isMeshToonMaterial||A.isMeshPhongMaterial||A.isMeshStandardMaterial||A.isShadowMaterial||A.isShaderMaterial&&!0===A.lights}(A),W.lightsStateVersion=ht,W.needsLights&&(kt.ambientLightColor.value=te.state.ambient,kt.lightProbe.value=te.state.probe,kt.directionalLights.value=te.state.directional,kt.directionalLightShadows.value=te.state.directionalShadow,kt.spotLights.value=te.state.spot,kt.spotLightShadows.value=te.state.spotShadow,kt.rectAreaLights.value=te.state.rectArea,kt.ltc_1.value=te.state.rectAreaLTC1,kt.ltc_2.value=te.state.rectAreaLTC2,kt.pointLights.value=te.state.point,kt.pointLightShadows.value=te.state.pointShadow,kt.hemisphereLights.value=te.state.hemi,kt.directionalShadowMap.value=te.state.directionalShadowMap,kt.directionalShadowMatrix.value=te.state.directionalShadowMatrix,kt.spotShadowMap.value=te.state.spotShadowMap,kt.spotShadowMatrix.value=te.state.spotShadowMatrix,kt.pointShadowMap.value=te.state.pointShadowMap,kt.pointShadowMatrix.value=te.state.pointShadowMatrix);const Pn=Nt.getUniforms(),_l=Jo.seqWithValue(Pn.seq,kt);return W.currentProgram=Nt,W.uniformsList=_l,Nt}function G2(A,H){const $=Z.get(A);$.outputEncoding=H.outputEncoding,$.instancing=H.instancing,$.skinning=H.skinning,$.morphTargets=H.morphTargets,$.morphNormals=H.morphNormals,$.morphColors=H.morphColors,$.morphTargetsCount=H.morphTargetsCount,$.numClippingPlanes=H.numClippingPlanes,$.numIntersection=H.numClipIntersection,$.vertexAlphas=H.vertexAlphas,$.vertexTangents=H.vertexTangents,$.toneMapping=H.toneMapping}Rt.setAnimationLoop(function ve(A){Be&&Be(A)}),"undefined"!=typeof self&&Rt.setContext(self),this.setAnimationLoop=function(A){Be=A,_e.setAnimationLoop(A),null===A?Rt.stop():Rt.start()},_e.addEventListener("sessionstart",at),_e.addEventListener("sessionend",_n),this.render=function(A,H){if(void 0===H||!0===H.isCamera){if(!0!==m){if(!0===A.autoUpdate&&A.updateMatrixWorld(),null===H.parent&&H.updateMatrixWorld(),!0===_e.enabled&&!0===_e.isPresenting&&(!0===_e.cameraAutoUpdate&&_e.updateCamera(H),H=_e.getCamera()),!0===A.isScene&&A.onBeforeRender(p,A,H,y),h=I.get(A,g.length),h.init(),g.push(h),ee.multiplyMatrices(H.projectionMatrix,H.matrixWorldInverse),U.setFromProjectionMatrix(ee),G=this.localClippingEnabled,F=D.init(this.clippingPlanes,G,H),d=Dt.get(A,f.length),d.init(),f.push(d),Bs(A,H,0,p.sortObjects),d.finish(),!0===p.sortObjects&&d.sort(R,z),!0===F&&D.beginShadows(),j.render(h.state.shadowsArray,A,H),!0===F&&D.endShadows(),!0===this.info.autoReset&&this.info.reset(),re.render(d,A),h.setupLights(p.physicallyCorrectLights),H.isArrayCamera){const W=H.cameras;for(let te=0,nt=W.length;te<nt;te++){const ht=W[te];Vs(d,A,ht,ht.viewport)}}else Vs(d,A,H);null!==y&&(J.updateMultisampleRenderTarget(y),J.updateRenderTargetMipmap(y)),!0===A.isScene&&A.onAfterRender(p,A,H),ae.resetDefaultState(),b=-1,w=null,g.pop(),h=g.length>0?g[g.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return y},this.setRenderTargetTextures=function(A,H,$){Z.get(A.texture).__webglTexture=H,Z.get(A.depthTexture).__webglTexture=$;const W=Z.get(A);W.__hasExternalTextures=!0,W.__hasExternalTextures&&(W.__autoAllocateDepthBuffer=void 0===$,W.__autoAllocateDepthBuffer||!0===Fe.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),W.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(A,H){const $=Z.get(A);$.__webglFramebuffer=H,$.__useDefaultFramebuffer=void 0===H},this.setRenderTarget=function(A,H=0,$=0){y=A,v=H,_=$;let W=!0;if(A){const pt=Z.get(A);void 0!==pt.__useDefaultFramebuffer?(le.bindFramebuffer(36160,null),W=!1):void 0===pt.__webglFramebuffer?J.setupRenderTarget(A):pt.__hasExternalTextures&&J.rebindTextures(A,Z.get(A.texture).__webglTexture,Z.get(A.depthTexture).__webglTexture)}let te=null,nt=!1,ht=!1;if(A){const pt=A.texture;(pt.isData3DTexture||pt.isDataArrayTexture)&&(ht=!0);const Wt=Z.get(A).__webglFramebuffer;A.isWebGLCubeRenderTarget?(te=Wt[H],nt=!0):te=$e.isWebGL2&&A.samples>0&&!1===J.useMultisampledRTT(A)?Z.get(A).__webglMultisampledFramebuffer:Wt,S.copy(A.viewport),C.copy(A.scissor),E=A.scissorTest}else S.copy(P).multiplyScalar(x).floor(),C.copy(V).multiplyScalar(x).floor(),E=k;if(le.bindFramebuffer(36160,te)&&$e.drawBuffers&&W&&le.drawBuffers(A,te),le.viewport(S),le.scissor(C),le.setScissorTest(E),nt){const pt=Z.get(A.texture);Y.framebufferTexture2D(36160,36064,34069+H,pt.__webglTexture,$)}else if(ht){const pt=Z.get(A.texture);Y.framebufferTextureLayer(36160,36064,pt.__webglTexture,$||0,H||0)}b=-1},this.readRenderTargetPixels=function(A,H,$,W,te,nt,ht){if(!A||!A.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let _t=Z.get(A).__webglFramebuffer;if(A.isWebGLCubeRenderTarget&&void 0!==ht&&(_t=_t[ht]),_t){le.bindFramebuffer(36160,_t);try{const pt=A.texture,Wt=pt.format,Nt=pt.type;if(Wt!==Pr&&T.convert(Wt)!==Y.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const kt=Nt===wc&&(Fe.has("EXT_color_buffer_half_float")||$e.isWebGL2&&Fe.has("EXT_color_buffer_float"));if(!(Nt===Ha||T.convert(Nt)===Y.getParameter(35738)||Nt===Go&&($e.isWebGL2||Fe.has("OES_texture_float")||Fe.has("WEBGL_color_buffer_float"))||kt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");H>=0&&H<=A.width-W&&$>=0&&$<=A.height-te&&Y.readPixels(H,$,W,te,T.convert(Wt),T.convert(Nt),nt)}finally{const pt=null!==y?Z.get(y).__webglFramebuffer:null;le.bindFramebuffer(36160,pt)}}},this.copyFramebufferToTexture=function(A,H,$=0){if(!0!==H.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const W=Math.pow(2,-$),te=Math.floor(H.image.width*W),nt=Math.floor(H.image.height*W);J.setTexture2D(H,0),Y.copyTexSubImage2D(3553,$,0,0,A.x,A.y,te,nt),le.unbindTexture()},this.copyTextureToTexture=function(A,H,$,W=0){const te=H.image.width,nt=H.image.height,ht=T.convert($.format),_t=T.convert($.type);J.setTexture2D($,0),Y.pixelStorei(37440,$.flipY),Y.pixelStorei(37441,$.premultiplyAlpha),Y.pixelStorei(3317,$.unpackAlignment),H.isDataTexture?Y.texSubImage2D(3553,W,A.x,A.y,te,nt,ht,_t,H.image.data):H.isCompressedTexture?Y.compressedTexSubImage2D(3553,W,A.x,A.y,H.mipmaps[0].width,H.mipmaps[0].height,ht,H.mipmaps[0].data):Y.texSubImage2D(3553,W,A.x,A.y,ht,_t,H.image),0===W&&$.generateMipmaps&&Y.generateMipmap(3553),le.unbindTexture()},this.copyTextureToTexture3D=function(A,H,$,W,te=0){if(p.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const nt=A.max.x-A.min.x+1,ht=A.max.y-A.min.y+1,_t=A.max.z-A.min.z+1,pt=T.convert(W.format),Wt=T.convert(W.type);let Nt;if(W.isData3DTexture)J.setTexture3D(W,0),Nt=32879;else{if(!W.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");J.setTexture2DArray(W,0),Nt=35866}Y.pixelStorei(37440,W.flipY),Y.pixelStorei(37441,W.premultiplyAlpha),Y.pixelStorei(3317,W.unpackAlignment);const kt=Y.getParameter(3314),Pn=Y.getParameter(32878),_l=Y.getParameter(3316),Eu=Y.getParameter(3315),Tu=Y.getParameter(32877),Us=$.isCompressedTexture?$.mipmaps[0]:$.image;Y.pixelStorei(3314,Us.width),Y.pixelStorei(32878,Us.height),Y.pixelStorei(3316,A.min.x),Y.pixelStorei(3315,A.min.y),Y.pixelStorei(32877,A.min.z),$.isDataTexture||$.isData3DTexture?Y.texSubImage3D(Nt,te,H.x,H.y,H.z,nt,ht,_t,pt,Wt,Us.data):$.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Y.compressedTexSubImage3D(Nt,te,H.x,H.y,H.z,nt,ht,_t,pt,Us.data)):Y.texSubImage3D(Nt,te,H.x,H.y,H.z,nt,ht,_t,pt,Wt,Us),Y.pixelStorei(3314,kt),Y.pixelStorei(32878,Pn),Y.pixelStorei(3316,_l),Y.pixelStorei(3315,Eu),Y.pixelStorei(32877,Tu),0===te&&W.generateMipmaps&&Y.generateMipmap(Nt),le.unbindTexture()},this.initTexture=function(A){J.setTexture2D(A,0),le.unbindTexture()},this.resetState=function(){v=0,_=0,y=null,le.reset(),ae.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Zt.prototype.isWebGLRenderer=!0;class HR extends Zt{}HR.prototype.isWebGL1Renderer=!0;class Ag{constructor(e,t=25e-5){this.name="",this.color=new de(e),this.density=t}clone(){return new Ag(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Ag.prototype.isFogExp2=!0;class Rg{constructor(e,t=1,i=1e3){this.name="",this.color=new de(e),this.near=t,this.far=i}clone(){return new Rg(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Rg.prototype.isFog=!0;class el extends Mt{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}el.prototype.isScene=!0;class qc{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Yd,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=pr()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=pr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=pr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}qc.prototype.isInterleavedBuffer=!0;const Wi=new M;class tl{constructor(e,t,i,r=!1){this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Wi.fromBufferAttribute(this,t),Wi.applyMatrix4(e),this.setXYZ(t,Wi.x,Wi.y,Wi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Wi.fromBufferAttribute(this,t),Wi.applyNormalMatrix(e),this.setXYZ(t,Wi.x,Wi.y,Wi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Wi.fromBufferAttribute(this,t),Wi.transformDirection(e),this.setXYZ(t,Wi.x,Wi.y,Wi.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,i){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new fn(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new tl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}tl.prototype.isInterleavedBufferAttribute=!0;class Ub extends qn{constructor(e){super(),this.type="SpriteMaterial",this.color=new de(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let Yc;Ub.prototype.isSpriteMaterial=!0;const sh=new M,Zc=new M,Xc=new M,Kc=new K,oh=new K,zR=new ue,Ig=new M,ah=new M,Ng=new M,GR=new K,Hb=new K,WR=new K;function Pg(n,e,t,i,r,s){Kc.subVectors(n,t).addScalar(.5).multiply(i),void 0!==r?(oh.x=s*Kc.x-r*Kc.y,oh.y=r*Kc.x+s*Kc.y):oh.copy(Kc),n.copy(e),n.x+=oh.x,n.y+=oh.y,n.applyMatrix4(zR)}(class jR extends Mt{constructor(e){if(super(),this.type="Sprite",void 0===Yc){Yc=new Ue;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new qc(t,5);Yc.setIndex([0,1,2,0,2,3]),Yc.setAttribute("position",new tl(i,3,0,!1)),Yc.setAttribute("uv",new tl(i,2,3,!1))}this.geometry=Yc,this.material=void 0!==e?e:new Ub,this.center=new K(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Zc.setFromMatrixScale(this.matrixWorld),zR.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Xc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Zc.multiplyScalar(-Xc.z);const i=this.material.rotation;let r,s;0!==i&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;Pg(Ig.set(-.5,-.5,0),Xc,o,Zc,r,s),Pg(ah.set(.5,-.5,0),Xc,o,Zc,r,s),Pg(Ng.set(.5,.5,0),Xc,o,Zc,r,s),GR.set(0,0),Hb.set(1,0),WR.set(1,1);let a=e.ray.intersectTriangle(Ig,ah,Ng,!1,sh);if(null===a&&(Pg(ah.set(-.5,.5,0),Xc,o,Zc,r,s),Hb.set(0,1),a=e.ray.intersectTriangle(Ig,Ng,ah,!1,sh),null===a))return;const l=e.ray.origin.distanceTo(sh);l<e.near||l>e.far||t.push({distance:l,point:sh.clone(),uv:$n.getUV(sh,Ig,ah,Ng,GR,Hb,WR,new K),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const qR=new M,YR=new Ot,ZR=new Ot,P9=new M,XR=new ue;class Fg extends ge{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ue,this.bindMatrixInverse=new ue}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ot,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;YR.fromBufferAttribute(r.attributes.skinIndex,e),ZR.fromBufferAttribute(r.attributes.skinWeight,e),qR.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=ZR.getComponent(s);if(0!==o){const a=YR.getComponent(s);XR.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(P9.copy(qR).applyMatrix4(XR),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}Fg.prototype.isSkinnedMesh=!0;class Jc extends Mt{constructor(){super(),this.type="Bone"}}Jc.prototype.isBone=!0;class Qc extends Ai{constructor(e=null,t=1,i=1,r,s,o,a,l,c=ni,u=ni,d,h){super(null,o,a,l,c,u,r,s,d,h),this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Qc.prototype.isDataTexture=!0;const KR=new ue,O9=new ue;class kg{constructor(e=[],t=[]){this.uuid=pr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new ue)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new ue;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)KR.multiplyMatrices(e[s]?e[s].matrixWorld:O9,t[s]),KR.toArray(i,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new kg(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=$A(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Qc(t,e,e,Pr,Go);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Jc),this.bones.push(o),this.boneInverses.push((new ue).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class eu extends fn{constructor(e,t,i,r=1){"number"==typeof i&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,i),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}eu.prototype.isInstancedBufferAttribute=!0;const JR=new ue,QR=new ue,Lg=[],lh=new ge;(class eI extends ge{constructor(e,t,i){super(e,t),this.instanceMatrix=new eu(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(lh.geometry=this.geometry,lh.material=this.material,void 0!==lh.material)for(let s=0;s<r;s++){this.getMatrixAt(s,JR),QR.multiplyMatrices(i,JR),lh.matrixWorld=QR,lh.raycast(e,Lg);for(let o=0,a=Lg.length;o<a;o++){const l=Lg[o];l.instanceId=s,l.object=this,t.push(l)}Lg.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new eu(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class si extends qn{constructor(e){super(),this.type="LineBasicMaterial",this.color=new de(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}si.prototype.isLineBasicMaterial=!0;const tI=new M,nI=new M,iI=new ue,zb=new Ka,Bg=new Xa;class Ni extends Mt{constructor(e=new Ue,t=new si){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)tI.fromBufferAttribute(t,r-1),nI.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=tI.distanceTo(nI);e.setAttribute("lineDistance",new Te(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Bg.copy(i.boundingSphere),Bg.applyMatrix4(r),Bg.radius+=s,!1===e.ray.intersectsSphere(Bg))return;iI.copy(r).invert(),zb.copy(e.ray).applyMatrix4(iI);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new M,u=new M,d=new M,h=new M,f=this.isLineSegments?2:1;if(i.isBufferGeometry){const g=i.index,m=i.attributes.position;if(null!==g)for(let y=Math.max(0,o.start),b=Math.min(g.count,o.start+o.count)-1;y<b;y+=f){const w=g.getX(y),S=g.getX(y+1);if(c.fromBufferAttribute(m,w),u.fromBufferAttribute(m,S),zb.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const E=e.ray.origin.distanceTo(h);E<e.near||E>e.far||t.push({distance:E,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,o.start),b=Math.min(m.count,o.start+o.count)-1;y<b;y+=f){if(c.fromBufferAttribute(m,y),u.fromBufferAttribute(m,y+1),zb.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const S=e.ray.origin.distanceTo(h);S<e.near||S>e.far||t.push({distance:S,point:d.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else i.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Ni.prototype.isLine=!0;const rI=new M,sI=new M;class tu extends Ni{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)rI.fromBufferAttribute(t,r),sI.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+rI.distanceTo(sI);e.setAttribute("lineDistance",new Te(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}tu.prototype.isLineSegments=!0;(class oI extends Ni{constructor(e,t){super(e,t),this.type="LineLoop"}}).prototype.isLineLoop=!0;class Gb extends qn{constructor(e){super(),this.type="PointsMaterial",this.color=new de(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Gb.prototype.isPointsMaterial=!0;const aI=new ue,Wb=new Ka,Vg=new Xa,Ug=new M;function cI(n,e,t,i,r,s,o){const a=Wb.distanceSqToPoint(n);if(a<t){const l=new M;Wb.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}(class lI extends Mt{constructor(e=new Ue,t=new Gb){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Vg.copy(i.boundingSphere),Vg.applyMatrix4(r),Vg.radius+=s,!1===e.ray.intersectsSphere(Vg))return;aI.copy(r).invert(),Wb.copy(e.ray).applyMatrix4(aI);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(i.isBufferGeometry){const c=i.index,d=i.attributes.position;if(null!==c)for(let g=Math.max(0,o.start),p=Math.min(c.count,o.start+o.count);g<p;g++){const m=c.getX(g);Ug.fromBufferAttribute(d,m),cI(Ug,m,l,r,e,t,this)}else for(let g=Math.max(0,o.start),p=Math.min(d.count,o.start+o.count);g<p;g++)Ug.fromBufferAttribute(d,g),cI(Ug,g,l,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class F9 extends Ai{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.minFilter=void 0!==o?o:jn,this.magFilter=void 0!==s?s:jn,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function d(){u.needsUpdate=!0,e.requestVideoFrameCallback(d)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class k9 extends Ai{constructor(e,t,i){super({width:e,height:t}),this.format=i,this.magFilter=ni,this.minFilter=ni,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class uI extends Ai{constructor(e,t,i,r,s,o,a,l,c,u,d,h){super(null,o,a,l,c,u,r,s,d,h),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class L9 extends Ai{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0;class yr{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;o=t||e*i[s-1];let c,a=0,l=s-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,i[r]===o)return r/(s-1);const u=i[r];return(r+(o-u)/(i[r+1]-u))/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new K:new M);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new M,r=[],s=[],o=[],a=new M,l=new ue;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new M);s[0]=new M,o[0]=new M;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),d=Math.abs(r[0].y),h=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),h<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const g=Math.acos(kn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,g))}o[f].crossVectors(r[f],s[f])}if(!0===t){let f=Math.acos(kn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let g=1;g<=e;g++)s[g].applyMatrix4(l.makeRotationAxis(r[g],f*g)),o[g].crossVectors(r[g],s[g])}return{tangents:r,normals:s,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Hg extends yr{constructor(e=0,t=0,i=1,r=1,s=0,o=2*Math.PI,a=!1,l=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new K,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=o?0:r),!0===this.aClockwise&&!o&&(s===r?s=-r:s-=r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=l-this.aX,f=c-this.aY;l=h*u-f*d+this.aX,c=h*d+f*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Hg.prototype.isEllipseCurve=!0;class dI extends Hg{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.type="ArcCurve"}}function jb(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,d){let h=(o-s)/c-(a-s)/(c+u)+(a-o)/u,f=(a-o)/u-(l-o)/(u+d)+(l-a)/d;h*=u,f*=u,r(o,a,h,f)},calc:function(s){const o=s*s;return n+e*s+t*o+i*(o*s)}}}dI.prototype.isArcCurve=!0;const zg=new M,$b=new jb,qb=new jb,Yb=new jb;class hI extends yr{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new M){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let c,u,a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:0===l&&a===s-1&&(a=s-2,l=1),this.closed||a>0?c=r[(a-1)%s]:(zg.subVectors(r[0],r[1]).add(r[0]),c=zg);const d=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(zg.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=zg),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let g=Math.pow(c.distanceToSquared(d),f),p=Math.pow(d.distanceToSquared(h),f),m=Math.pow(h.distanceToSquared(u),f);p<1e-4&&(p=1),g<1e-4&&(g=p),m<1e-4&&(m=p),$b.initNonuniformCatmullRom(c.x,d.x,h.x,u.x,g,p,m),qb.initNonuniformCatmullRom(c.y,d.y,h.y,u.y,g,p,m),Yb.initNonuniformCatmullRom(c.z,d.z,h.z,u.z,g,p,m)}else"catmullrom"===this.curveType&&($b.initCatmullRom(c.x,d.x,h.x,u.x,this.tension),qb.initCatmullRom(c.y,d.y,h.y,u.y,this.tension),Yb.initCatmullRom(c.z,d.z,h.z,u.z,this.tension));return i.set($b.calc(l),qb.calc(l),Yb.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new M).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function fI(n,e,t,i,r){const s=.5*(i-e),o=.5*(r-t),a=n*n;return(2*t-2*i+s+o)*(n*a)+(-3*t+3*i-2*s-o)*a+s*n+t}function ch(n,e,t,i){return function B9(n,e){const t=1-n;return t*t*e}(n,e)+function V9(n,e){return 2*(1-n)*n*e}(n,t)+function U9(n,e){return n*n*e}(n,i)}function uh(n,e,t,i,r){return function H9(n,e){const t=1-n;return t*t*t*e}(n,e)+function z9(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function G9(n,e){return 3*(1-n)*n*n*e}(n,i)+function W9(n,e){return n*n*n*e}(n,r)}hI.prototype.isCatmullRomCurve3=!0;class Zb extends yr{constructor(e=new K,t=new K,i=new K,r=new K){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new K){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(uh(e,r.x,s.x,o.x,a.x),uh(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Zb.prototype.isCubicBezierCurve=!0;class pI extends yr{constructor(e=new M,t=new M,i=new M,r=new M){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new M){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(uh(e,r.x,s.x,o.x,a.x),uh(e,r.y,s.y,o.y,a.y),uh(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}pI.prototype.isCubicBezierCurve3=!0;class Gg extends yr{constructor(e=new K,t=new K){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new K){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const i=t||new K;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Gg.prototype.isLineCurve=!0;class Xb extends yr{constructor(e=new K,t=new K,i=new K){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new K){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(ch(e,r.x,s.x,o.x),ch(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Xb.prototype.isQuadraticBezierCurve=!0;class Kb extends yr{constructor(e=new M,t=new M,i=new M){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new M){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(ch(e,r.x,s.x,o.x),ch(e,r.y,s.y,o.y),ch(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Kb.prototype.isQuadraticBezierCurve3=!0;class Jb extends yr{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new K){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[0===o?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(fI(a,l.x,c.x,u.x,d.x),fI(a,l.y,c.y,u.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new K).fromArray(r))}return this}}Jb.prototype.isSplineCurve=!0;var Qb=Object.freeze({__proto__:null,ArcCurve:dI,CatmullRomCurve3:hI,CubicBezierCurve:Zb,CubicBezierCurve3:pI,EllipseCurve:Hg,LineCurve:Gg,LineCurve3:class j9 extends yr{constructor(e=new M,t=new M){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new M){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:Xb,QuadraticBezierCurve3:Kb,SplineCurve:Jb});class $9 extends yr{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Gg(t,e))}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength();return a.getPointAt(0===l?0:1-o/l,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],l=o.getPoints(o.isEllipseCurve?2*e:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new Qb[r.type]).fromJSON(r))}return this}}class dh extends $9{constructor(e){super(),this.type="Path",this.currentPoint=new K,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new Gg(this.currentPoint.clone(),new K(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new Xb(this.currentPoint.clone(),new K(e,t),new K(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new Zb(this.currentPoint.clone(),new K(e,t),new K(i,r),new K(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new Jb(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new Hg(e,t,i,r,s,o,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Xn extends Ue{constructor(e=1,t=1,i=1,r=8,s=1,o=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],d=[],h=[],f=[];let g=0;const p=[],m=i/2;let v=0;function y(b){const w=g,S=new K,C=new M;let E=0;const B=!0===b?e:t,N=!0===b?1:-1;for(let R=1;R<=r;R++)d.push(0,m*N,0),h.push(0,N,0),f.push(.5,.5),g++;const x=g;for(let R=0;R<=r;R++){const P=R/r*l+a,V=Math.cos(P),k=Math.sin(P);C.x=B*k,C.y=m*N,C.z=B*V,d.push(C.x,C.y,C.z),h.push(0,N,0),S.x=.5*V+.5,S.y=.5*k*N+.5,f.push(S.x,S.y),g++}for(let R=0;R<r;R++){const z=w+R,P=x+R;!0===b?u.push(P,P+1,z):u.push(P+1,P,z),E+=3}c.addGroup(v,E,!0===b?1:2),v+=E}(function _(){const b=new M,w=new M;let S=0;const C=(t-e)/i;for(let E=0;E<=s;E++){const B=[],N=E/s,x=N*(t-e)+e;for(let R=0;R<=r;R++){const z=R/r,P=z*l+a,V=Math.sin(P),k=Math.cos(P);w.x=x*V,w.y=-N*i+m,w.z=x*k,d.push(w.x,w.y,w.z),b.set(V,C,k).normalize(),h.push(b.x,b.y,b.z),f.push(z,1-N),B.push(g++)}p.push(B)}for(let E=0;E<r;E++)for(let B=0;B<s;B++){const x=p[B+1][E],R=p[B+1][E+1],z=p[B][E+1];u.push(p[B][E],x,z),u.push(x,R,z),S+=6}c.addGroup(v,S,0),v+=S})(),!1===o&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(u),this.setAttribute("position",new Te(d,3)),this.setAttribute("normal",new Te(h,3)),this.setAttribute("uv",new Te(f,2))}static fromJSON(e){return new Xn(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Qo extends Ue{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];function l(_,y,b,w){const S=w+1,C=[];for(let E=0;E<=S;E++){C[E]=[];const B=_.clone().lerp(b,E/S),N=y.clone().lerp(b,E/S),x=S-E;for(let R=0;R<=x;R++)C[E][R]=0===R&&E===S?B:B.clone().lerp(N,R/x)}for(let E=0;E<S;E++)for(let B=0;B<2*(S-E)-1;B++){const N=Math.floor(B/2);B%2==0?(h(C[E][N+1]),h(C[E+1][N]),h(C[E][N])):(h(C[E][N+1]),h(C[E+1][N+1]),h(C[E+1][N]))}}function h(_){s.push(_.x,_.y,_.z)}function f(_,y){const b=3*_;y.x=e[b+0],y.y=e[b+1],y.z=e[b+2]}function p(_,y,b,w){w<0&&1===_.x&&(o[y]=_.x-1),0===b.x&&0===b.z&&(o[y]=w/2/Math.PI+.5)}function m(_){return Math.atan2(_.z,-_.x)}function v(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}(function a(_){const y=new M,b=new M,w=new M;for(let S=0;S<t.length;S+=3)f(t[S+0],y),f(t[S+1],b),f(t[S+2],w),l(y,b,w,_)})(r),function c(_){const y=new M;for(let b=0;b<s.length;b+=3)y.x=s[b+0],y.y=s[b+1],y.z=s[b+2],y.normalize().multiplyScalar(_),s[b+0]=y.x,s[b+1]=y.y,s[b+2]=y.z}(i),function u(){const _=new M;for(let y=0;y<s.length;y+=3){_.x=s[y+0],_.y=s[y+1],_.z=s[y+2];const b=m(_)/2/Math.PI+.5,w=v(_)/Math.PI+.5;o.push(b,1-w)}(function g(){const _=new M,y=new M,b=new M,w=new M,S=new K,C=new K,E=new K;for(let B=0,N=0;B<s.length;B+=9,N+=6){_.set(s[B+0],s[B+1],s[B+2]),y.set(s[B+3],s[B+4],s[B+5]),b.set(s[B+6],s[B+7],s[B+8]),S.set(o[N+0],o[N+1]),C.set(o[N+2],o[N+3]),E.set(o[N+4],o[N+5]),w.copy(_).add(y).add(b).divideScalar(3);const x=m(w);p(S,N+0,_,x),p(C,N+2,y,x),p(E,N+4,b,x)}})(),function d(){for(let _=0;_<o.length;_+=6){const y=o[_+0],b=o[_+2],w=o[_+4],S=Math.max(y,b,w),C=Math.min(y,b,w);S>.9&&C<.1&&(y<.2&&(o[_+0]+=1),b<.2&&(o[_+2]+=1),w<.2&&(o[_+4]+=1))}}()}(),this.setAttribute("position",new Te(s,3)),this.setAttribute("normal",new Te(s.slice(),3)),this.setAttribute("uv",new Te(o,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new Qo(e.vertices,e.indices,e.radius,e.details)}}new M,new M,new M,new $n;class go extends dh{constructor(e){super(e),this.uuid=pr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new dh).fromJSON(r))}return this}}function mI(n,e,t,i,r){let s,o;if(r===function cq(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}(n,e,t,i)>0)for(s=e;s<t;s+=i)o=yI(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=yI(s,n[s],n[s+1],o);return o&&Kg(o,o.next)&&(gh(o),o=o.next),o}function ea(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!Kg(t,t.next)&&0!==Sn(t.prev,t,t.next))t=t.next;else{if(gh(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function fh(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function iq(n,e,t,i){let r=n;do{null===r.z&&(r.z=t1(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function rq(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1)}(r)}(n,i,r,s);let l,c,a=n;for(;n.prev!==n.next;)if(l=n.prev,c=n.next,s?Z9(n,i,r,s):Y9(n))e.push(l.i/t),e.push(n.i/t),e.push(c.i/t),gh(n),n=c.next,a=c.next;else if((n=c)===a){o?1===o?fh(n=X9(ea(n),e,t),e,t,i,r,s,2):2===o&&K9(n,e,t,i,r,s):fh(ea(n),e,t,i,r,s,1);break}}function Y9(n){const e=n.prev,t=n,i=n.next;if(Sn(e,t,i)>=0)return!1;let r=n.next.next;for(;r!==n.prev;){if(nu(e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y)&&Sn(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Z9(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Sn(r,s,o)>=0)return!1;const c=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,d=t1(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,t,i),h=t1(c,u,e,t,i);let f=n.prevZ,g=n.nextZ;for(;f&&f.z>=d&&g&&g.z<=h;){if(f!==n.prev&&f!==n.next&&nu(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&Sn(f.prev,f,f.next)>=0||(f=f.prevZ,g!==n.prev&&g!==n.next&&nu(r.x,r.y,s.x,s.y,o.x,o.y,g.x,g.y)&&Sn(g.prev,g,g.next)>=0))return!1;g=g.nextZ}for(;f&&f.z>=d;){if(f!==n.prev&&f!==n.next&&nu(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&Sn(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;g&&g.z<=h;){if(g!==n.prev&&g!==n.next&&nu(r.x,r.y,s.x,s.y,o.x,o.y,g.x,g.y)&&Sn(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function X9(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!Kg(r,s)&&_I(r,i,i.next,s)&&ph(r,s)&&ph(s,r)&&(e.push(r.i/t),e.push(i.i/t),e.push(s.i/t),gh(i),gh(i.next),i=n=s),i=i.next}while(i!==n);return ea(i)}function K9(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&oq(o,a)){let l=vI(o,a);return o=ea(o,o.next),l=ea(l,l.next),fh(o,e,t,i,r,s),void fh(l,e,t,i,r,s)}a=a.next}o=o.next}while(o!==n)}function Q9(n,e){return n.x-e.x}function eq(n,e){if(e=function tq(n,e){let t=e;const i=n.x,r=n.y;let o,s=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const h=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=i&&h>s){if(s=h,h===i){if(r===t.y)return t;if(r===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(i===s)return o;const a=o,l=o.x,c=o.y;let d,u=1/0;t=o;do{i>=t.x&&t.x>=l&&i!==t.x&&nu(r<c?i:s,r,l,c,r<c?s:i,r,t.x,t.y)&&(d=Math.abs(r-t.y)/(i-t.x),ph(t,n)&&(d<u||d===u&&(t.x>o.x||t.x===o.x&&nq(o,t)))&&(o=t,u=d)),t=t.next}while(t!==a);return o}(n,e),e){const t=vI(e,n);ea(e,e.next),ea(t,t.next)}}function nq(n,e){return Sn(n.prev,n,e.prev)<0&&Sn(e.next,n,n.next)<0}function t1(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-t)*r)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function sq(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function nu(n,e,t,i,r,s,o,a){return(r-o)*(e-a)-(n-o)*(s-a)>=0&&(n-o)*(i-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(r-o)*(i-a)>=0}function oq(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function aq(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&_I(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(ph(n,e)&&ph(e,n)&&function lq(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(Sn(n.prev,n,e.prev)||Sn(n,e.prev,e))||Kg(n,e)&&Sn(n.prev,n,n.next)>0&&Sn(e.prev,e,e.next)>0)}function Sn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Kg(n,e){return n.x===e.x&&n.y===e.y}function _I(n,e,t,i){const r=Qg(Sn(n,e,t)),s=Qg(Sn(n,e,i)),o=Qg(Sn(t,i,n)),a=Qg(Sn(t,i,e));return!!(r!==s&&o!==a||0===r&&Jg(n,t,e)||0===s&&Jg(n,i,e)||0===o&&Jg(t,n,i)||0===a&&Jg(t,e,i))}function Jg(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Qg(n){return n>0?1:n<0?-1:0}function ph(n,e){return Sn(n.prev,n,n.next)<0?Sn(n,e,n.next)>=0&&Sn(n,n.prev,e)>=0:Sn(n,e,n.prev)<0||Sn(n,n.next,e)<0}function vI(n,e){const t=new n1(n.i,n.x,n.y),i=new n1(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function yI(n,e,t,i){const r=new n1(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function gh(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function n1(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class mo{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return mo.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];bI(e),wI(i,e);let o=e.length;t.forEach(bI);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,wI(i,t[l]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=mI(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,d,h,f;if(i&&(s=function J9(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=mI(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(sq(c));for(r.sort(Q9),s=0;s<r.length;s++)eq(r[s],t),t=ea(t,t.next);return t}(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let g=t;g<r;g+=t)d=n[g],h=n[g+1],d<a&&(a=d),h<l&&(l=h),d>c&&(c=d),h>u&&(u=h);f=Math.max(c-a,u-l),f=0!==f?1/f:0}return fh(s,o,t,a,l,f),o}(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function bI(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function wI(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class ta extends Ue{constructor(e=new go([new K(.5,.5),new K(-.5,.5),new K(-.5,-.5),new K(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++)o(e[a]);function o(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1;let d=void 0!==t.depth?t.depth:1,h=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,g=void 0!==t.bevelSize?t.bevelSize:f-.1,p=void 0!==t.bevelOffset?t.bevelOffset:0,m=void 0!==t.bevelSegments?t.bevelSegments:3;const v=t.extrudePath,_=void 0!==t.UVGenerator?t.UVGenerator:uq;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=t.amount);let y,w,S,C,E,b=!1;v&&(y=v.getSpacedPoints(u),b=!0,h=!1,w=v.computeFrenetFrames(u,!1),S=new M,C=new M,E=new M),h||(m=0,f=0,g=0,p=0);const B=a.extractPoints(c);let N=B.shape;const x=B.holes;if(!mo.isClockWise(N)){N=N.reverse();for(let Z=0,J=x.length;Z<J;Z++){const se=x[Z];mo.isClockWise(se)&&(x[Z]=se.reverse())}}const z=mo.triangulateShape(N,x),P=N;for(let Z=0,J=x.length;Z<J;Z++)N=N.concat(x[Z]);function V(Z,J,se){return J||console.error("THREE.ExtrudeGeometry: vec does not exist"),J.clone().multiplyScalar(se).add(Z)}const k=N.length,U=z.length;function F(Z,J,se){let Ie,ye,Xe;const Ge=Z.x-J.x,Ve=Z.y-J.y,At=se.x-Z.x,Dt=se.y-Z.y,I=Ge*Ge+Ve*Ve;if(Math.abs(Ge*Dt-Ve*At)>Number.EPSILON){const j=Math.sqrt(I),re=Math.sqrt(At*At+Dt*Dt),me=J.x-Ve/j,Ce=J.y+Ge/j,ae=((se.x-Dt/re-me)*Dt-(se.y+At/re-Ce)*At)/(Ge*Dt-Ve*At);Ie=me+Ge*ae-Z.x,ye=Ce+Ve*ae-Z.y;const ke=Ie*Ie+ye*ye;if(ke<=2)return new K(Ie,ye);Xe=Math.sqrt(ke/2)}else{let j=!1;Ge>Number.EPSILON?At>Number.EPSILON&&(j=!0):Ge<-Number.EPSILON?At<-Number.EPSILON&&(j=!0):Math.sign(Ve)===Math.sign(Dt)&&(j=!0),j?(Ie=-Ve,ye=Ge,Xe=Math.sqrt(I)):(Ie=Ge,ye=Ve,Xe=Math.sqrt(I/2))}return new K(Ie/Xe,ye/Xe)}const G=[];for(let Z=0,J=P.length,se=J-1,Ie=Z+1;Z<J;Z++,se++,Ie++)se===J&&(se=0),Ie===J&&(Ie=0),G[Z]=F(P[Z],P[se],P[Ie]);const q=[];let ee,X=G.concat();for(let Z=0,J=x.length;Z<J;Z++){const se=x[Z];ee=[];for(let Ie=0,ye=se.length,Xe=ye-1,Ge=Ie+1;Ie<ye;Ie++,Xe++,Ge++)Xe===ye&&(Xe=0),Ge===ye&&(Ge=0),ee[Ie]=F(se[Ie],se[Xe],se[Ge]);q.push(ee),X=X.concat(ee)}for(let Z=0;Z<m;Z++){const J=Z/m,se=f*Math.cos(J*Math.PI/2),Ie=g*Math.sin(J*Math.PI/2)+p;for(let ye=0,Xe=P.length;ye<Xe;ye++){const Ge=V(P[ye],G[ye],Ie);ot(Ge.x,Ge.y,-se)}for(let ye=0,Xe=x.length;ye<Xe;ye++){const Ge=x[ye];ee=q[ye];for(let Ve=0,At=Ge.length;Ve<At;Ve++){const Dt=V(Ge[Ve],ee[Ve],Ie);ot(Dt.x,Dt.y,-se)}}}const xe=g+p;for(let Z=0;Z<k;Z++){const J=h?V(N[Z],X[Z],xe):N[Z];b?(C.copy(w.normals[0]).multiplyScalar(J.x),S.copy(w.binormals[0]).multiplyScalar(J.y),E.copy(y[0]).add(C).add(S),ot(E.x,E.y,E.z)):ot(J.x,J.y,0)}for(let Z=1;Z<=u;Z++)for(let J=0;J<k;J++){const se=h?V(N[J],X[J],xe):N[J];b?(C.copy(w.normals[Z]).multiplyScalar(se.x),S.copy(w.binormals[Z]).multiplyScalar(se.y),E.copy(y[Z]).add(C).add(S),ot(E.x,E.y,E.z)):ot(se.x,se.y,d/u*Z)}for(let Z=m-1;Z>=0;Z--){const J=Z/m,se=f*Math.cos(J*Math.PI/2),Ie=g*Math.sin(J*Math.PI/2)+p;for(let ye=0,Xe=P.length;ye<Xe;ye++){const Ge=V(P[ye],G[ye],Ie);ot(Ge.x,Ge.y,d+se)}for(let ye=0,Xe=x.length;ye<Xe;ye++){const Ge=x[ye];ee=q[ye];for(let Ve=0,At=Ge.length;Ve<At;Ve++){const Dt=V(Ge[Ve],ee[Ve],Ie);b?ot(Dt.x,Dt.y+y[u-1].y,y[u-1].x+se):ot(Dt.x,Dt.y,d+se)}}}function Y(Z,J){let se=Z.length;for(;--se>=0;){const Ie=se;let ye=se-1;ye<0&&(ye=Z.length-1);for(let Xe=0,Ge=u+2*m;Xe<Ge;Xe++){const Ve=k*Xe,At=k*(Xe+1);$e(J+Ie+Ve,J+ye+Ve,J+ye+At,J+Ie+At)}}}function ot(Z,J,se){l.push(Z),l.push(J),l.push(se)}function Fe(Z,J,se){le(Z),le(J),le(se);const Ie=r.length/3,ye=_.generateTopUV(i,r,Ie-3,Ie-2,Ie-1);Ze(ye[0]),Ze(ye[1]),Ze(ye[2])}function $e(Z,J,se,Ie){le(Z),le(J),le(Ie),le(J),le(se),le(Ie);const ye=r.length/3,Xe=_.generateSideWallUV(i,r,ye-6,ye-3,ye-2,ye-1);Ze(Xe[0]),Ze(Xe[1]),Ze(Xe[3]),Ze(Xe[1]),Ze(Xe[2]),Ze(Xe[3])}function le(Z){r.push(l[3*Z+0]),r.push(l[3*Z+1]),r.push(l[3*Z+2])}function Ze(Z){s.push(Z.x),s.push(Z.y)}(function Re(){const Z=r.length/3;if(h){let J=0,se=k*J;for(let Ie=0;Ie<U;Ie++){const ye=z[Ie];Fe(ye[2]+se,ye[1]+se,ye[0]+se)}J=u+2*m,se=k*J;for(let Ie=0;Ie<U;Ie++){const ye=z[Ie];Fe(ye[0]+se,ye[1]+se,ye[2]+se)}}else{for(let J=0;J<U;J++){const se=z[J];Fe(se[2],se[1],se[0])}for(let J=0;J<U;J++){const se=z[J];Fe(se[0]+k*u,se[1]+k*u,se[2]+k*u)}}i.addGroup(Z,r.length/3-Z,0)})(),function Me(){const Z=r.length/3;let J=0;Y(P,J),J+=P.length;for(let se=0,Ie=x.length;se<Ie;se++){const ye=x[se];Y(ye,J),J+=ye.length}i.addGroup(Z,r.length/3-Z,1)}()}this.setAttribute("position",new Te(r,3)),this.setAttribute("uv",new Te(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function dq(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++)i.push(t[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new Qb[r.type]).fromJSON(r)),new ta(i,e.options)}}const uq={generateTopUV:function(n,e,t,i,r){const a=e[3*i],l=e[3*i+1],c=e[3*r],u=e[3*r+1];return[new K(e[3*t],e[3*t+1]),new K(a,l),new K(c,u)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*i],u=e[3*i+1],d=e[3*i+2],h=e[3*r],f=e[3*r+1],g=e[3*r+2],p=e[3*s],m=e[3*s+1],v=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new K(o,1-l),new K(c,1-d),new K(h,1-g),new K(p,1-v)]:[new K(a,1-l),new K(u,1-d),new K(f,1-g),new K(m,1-v)]}};class _o extends Qo{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new _o(e.radius,e.detail)}}class mh extends Ue{constructor(e=new go([new K(0,.5),new K(-.5,-.5),new K(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,l=0;if(!1===Array.isArray(e))c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;function c(u){const d=r.length/3,h=u.extractPoints(t);let f=h.shape;const g=h.holes;!1===mo.isClockWise(f)&&(f=f.reverse());for(let m=0,v=g.length;m<v;m++){const _=g[m];!0===mo.isClockWise(_)&&(g[m]=_.reverse())}const p=mo.triangulateShape(f,g);for(let m=0,v=g.length;m<v;m++)f=f.concat(g[m]);for(let m=0,v=f.length;m<v;m++){const _=f[m];r.push(_.x,_.y,0),s.push(0,0,1),o.push(_.x,_.y)}for(let m=0,v=p.length;m<v;m++){const _=p[m];i.push(_[0]+d,_[1]+d,_[2]+d),l+=3}}this.setIndex(i),this.setAttribute("position",new Te(r,3)),this.setAttribute("normal",new Te(s,3)),this.setAttribute("uv",new Te(o,2))}toJSON(){const e=super.toJSON();return function hq(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++)i.push(t[e.shapes[r]]);return new mh(i,e.curveSegments)}}class iu extends Ue{constructor(e=1,t=32,i=16,r=0,s=2*Math.PI,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const u=[],d=new M,h=new M,f=[],g=[],p=[],m=[];for(let v=0;v<=i;v++){const _=[],y=v/i;let b=0;0==v&&0==o?b=.5/t:v==i&&l==Math.PI&&(b=-.5/t);for(let w=0;w<=t;w++){const S=w/t;d.x=-e*Math.cos(r+S*s)*Math.sin(o+y*a),d.y=e*Math.cos(o+y*a),d.z=e*Math.sin(r+S*s)*Math.sin(o+y*a),g.push(d.x,d.y,d.z),h.copy(d).normalize(),p.push(h.x,h.y,h.z),m.push(S+b,1-y),_.push(c++)}u.push(_)}for(let v=0;v<i;v++)for(let _=0;_<t;_++){const y=u[v][_+1],b=u[v][_],w=u[v+1][_],S=u[v+1][_+1];(0!==v||o>0)&&f.push(y,b,S),(v!==i-1||l<Math.PI)&&f.push(b,w,S)}this.setIndex(f),this.setAttribute("position",new Te(g,3)),this.setAttribute("normal",new Te(p,3)),this.setAttribute("uv",new Te(m,2))}static fromJSON(e){return new iu(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class vo extends Ue{constructor(e=1,t=.4,i=8,r=6,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new M,d=new M,h=new M;for(let f=0;f<=i;f++)for(let g=0;g<=r;g++){const p=g/r*s,m=f/i*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(p),d.y=(e+t*Math.cos(m))*Math.sin(p),d.z=t*Math.sin(m),a.push(d.x,d.y,d.z),u.x=e*Math.cos(p),u.y=e*Math.sin(p),h.subVectors(d,u).normalize(),l.push(h.x,h.y,h.z),c.push(g/r),c.push(f/i)}for(let f=1;f<=i;f++)for(let g=1;g<=r;g++){const m=(r+1)*(f-1)+g-1,v=(r+1)*(f-1)+g,_=(r+1)*f+g;o.push((r+1)*f+g-1,m,_),o.push(m,v,_)}this.setIndex(o),this.setAttribute("position",new Te(a,3)),this.setAttribute("normal",new Te(l,3)),this.setAttribute("uv",new Te(c,2))}static fromJSON(e){return new vo(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class DI extends qn{constructor(e){super(),this.type="ShadowMaterial",this.color=new de(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}DI.prototype.isShadowMaterial=!0;class CI extends is{constructor(e){super(e),this.type="RawShaderMaterial"}}CI.prototype.isRawShaderMaterial=!0;class i1 extends qn{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new de(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}i1.prototype.isMeshStandardMaterial=!0;class EI extends i1{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new K(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return kn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new de(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new de(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new de(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}EI.prototype.isMeshPhysicalMaterial=!0;class _h extends qn{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new de(16777215),this.specular=new de(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}_h.prototype.isMeshPhongMaterial=!0;class TI extends qn{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new de(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}TI.prototype.isMeshToonMaterial=!0;class AI extends qn{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}AI.prototype.isMeshNormalMaterial=!0;class r1 extends qn{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new de(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new de(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}r1.prototype.isMeshLambertMaterial=!0;class RI extends qn{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new de(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new K(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}RI.prototype.isMeshMatcapMaterial=!0;class II extends si{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}II.prototype.isLineDashedMaterial=!0;const fq={ShadowMaterial:DI,SpriteMaterial:Ub,RawShaderMaterial:CI,ShaderMaterial:is,PointsMaterial:Gb,MeshPhysicalMaterial:EI,MeshStandardMaterial:i1,MeshPhongMaterial:_h,MeshToonMaterial:TI,MeshNormalMaterial:AI,MeshLambertMaterial:r1,MeshDepthMaterial:Lb,MeshDistanceMaterial:Bb,MeshBasicMaterial:Ts,MeshMatcapMaterial:RI,LineDashedMaterial:II,LineBasicMaterial:si,Material:qn};qn.fromType=function(n){return new fq[n]};const yn={arraySlice:function(n,e,t){return yn.isTypedArray(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)},convertArray:function(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)},isTypedArray:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)},getKeyframeOrder:function(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,s){return n[r]-n[s]}),i},sortedArray:function(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r},flattenJSON:function(n,e,t,i){let r=1,s=n[0];for(;void 0!==s&&void 0===s[i];)s=n[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=n[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),t.push(o)),s=n[r++]}while(void 0!==s)},subclip:function(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),d=[],h=[];for(let f=0;f<c.times.length;++f){const g=c.times[f]*r;if(!(g<t||g>=i)){d.push(c.times[f]);for(let p=0;p<u;++p)h.push(c.values[f*u+p])}}0!==d.length&&(c.times=yn.convertArray(d,c.times.constructor),c.values=yn.convertArray(h,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=n.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===l});if(void 0===c)continue;let u=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let h=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const g=a.times.length-1;let p;if(s<=a.times[0])p=yn.arraySlice(a.values,u,d-u);else if(s>=a.times[g]){const v=g*d+u;p=yn.arraySlice(a.values,v,v+d-u)}else{const v=a.createInterpolant(),_=u,y=d-u;v.evaluate(s),p=yn.arraySlice(v.resultBuffer,_,y)}"quaternion"===l&&(new Ft).fromArray(p).normalize().conjugate().toArray(p);const m=c.times.length;for(let v=0;v<m;++v){const _=v*f+h;if("quaternion"===l)Ft.multiplyQuaternionsFlat(c.values,_,p,0,c.values,_);else{const y=f-2*h;for(let b=0;b<y;++b)c.values[_+b]-=p[b]}}}return n.blendMode=2501,n}};class na{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,s)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,s,e)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}na.prototype.beforeStart_=na.prototype.copySampleValue_,na.prototype.afterEnd_=na.prototype.copySampleValue_;class pq extends na{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Sc,endingEnd:Sc}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case Dc:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case Dc:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,g=(i-t)/(r-t),p=g*g,m=p*g,v=-h*m+2*h*p-h*g,_=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*g+1,y=(-1-f)*m+(1.5+f)*p+.5*g,b=f*m-f*p;for(let w=0;w!==a;++w)s[w]=v*o[u+w]+_*o[c+w]+y*o[l+w]+b*o[d+w];return s}}class NI extends na{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class gq extends na{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Rs{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=yn.convertArray(t,this.TimeBufferType),this.values=yn.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:yn.convertArray(e.times,Array),values:yn.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new gq(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new NI(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new pq(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=yn.arraySlice(i,s,o),this.values=yn.arraySlice(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&yn.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=yn.arraySlice(this.times),t=yn.arraySlice(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let g=0;g!==i;++g){const p=t[d+g];if(p!==t[h+g]||p!==t[f+g]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=yn.arraySlice(e,0,o),this.values=yn.arraySlice(t,0,o*i)):(this.times=e,this.values=t),this}clone(){const e=yn.arraySlice(this.times,0),t=yn.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Rs.prototype.TimeBufferType=Float32Array,Rs.prototype.ValueBufferType=Float32Array,Rs.prototype.DefaultInterpolation=2301;class ru extends Rs{}ru.prototype.ValueTypeName="bool",ru.prototype.ValueBufferType=Array,ru.prototype.DefaultInterpolation=2300,ru.prototype.InterpolantFactoryMethodLinear=void 0,ru.prototype.InterpolantFactoryMethodSmooth=void 0;class PI extends Rs{}PI.prototype.ValueTypeName="color";class vh extends Rs{}vh.prototype.ValueTypeName="number";class mq extends na{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)Ft.slerpFlat(s,0,o,c-a,o,c,l);return s}}class su extends Rs{InterpolantFactoryMethodLinear(e){return new mq(this.times,this.values,this.getValueSize(),e)}}su.prototype.ValueTypeName="quaternion",su.prototype.DefaultInterpolation=2301,su.prototype.InterpolantFactoryMethodSmooth=void 0;class ou extends Rs{}ou.prototype.ValueTypeName="string",ou.prototype.ValueBufferType=Array,ou.prototype.DefaultInterpolation=2300,ou.prototype.InterpolantFactoryMethodLinear=void 0,ou.prototype.InterpolantFactoryMethodSmooth=void 0;class yh extends Rs{}yh.prototype.ValueTypeName="vector";class bh{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=pr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(vq(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Rs.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=yn.getKeyframeOrder(l);l=yn.sortedArray(l,1,u),c=yn.sortedArray(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new vh(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let h=r[d];h||(r[d]=h=[]),h.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,h,f,g,p){if(0!==f.length){const m=[],v=[];yn.flattenJSON(f,m,v,g),0!==m.length&&p.push(new d(h,m,v))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let g;for(g=0;g<h.length;g++)if(h[g].morphTargets)for(let p=0;p<h[g].morphTargets.length;p++)f[h[g].morphTargets[p]]=-1;for(const p in f){const m=[],v=[];for(let _=0;_!==h[g].morphTargets.length;++_){const y=h[g];m.push(y.time),v.push(y.morphTarget===p?1:0)}r.push(new vh(".morphTargetInfluence["+p+"]",m,v))}l=f.length*o}else{const f=".bones["+t[d].name+"]";i(yh,f+".position",h,"pos",r),i(su,f+".quaternion",h,"rot",r),i(yh,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function vq(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function _q(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vh;case"vector":case"vector2":case"vector3":case"vector4":return yh;case"color":return PI;case"quaternion":return su;case"bool":case"boolean":return ru;case"string":return ou}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];yn.flattenJSON(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const au={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};const yq=new class OI{constructor(e,t,i){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return-1!==d&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],g=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return g}return null}}};class yo{constructor(e){this.manager=void 0!==e?e:yq,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const bo={};class wo extends yo{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=au.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==bo[e])return void bo[e].push({onLoad:t,onProgress:i,onError:r});bo[e]=[],bo[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===c.body||void 0===c.body.getReader)return c;const u=bo[e],d=c.body.getReader(),h=c.headers.get("Content-Length"),f=h?parseInt(h):0,g=0!==f;let p=0;const m=new ReadableStream({start(v){!function _(){d.read().then(({done:y,value:b})=>{if(y)v.close();else{p+=b.byteLength;const w=new ProgressEvent("progress",{lengthComputable:g,loaded:p,total:f});for(let S=0,C=u.length;S<C;S++){const E=u[S];E.onProgress&&E.onProgress(w)}v.enqueue(b),_()}})}()}});return new Response(m)}throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(g=>f.decode(g))}}}).then(c=>{au.add(e,c);const u=bo[e];delete bo[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=bo[e];if(void 0===u)throw this.manager.itemError(e),c;delete bo[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class sm extends yo{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=au.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Jd("img");function l(){u(),au.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(d){u(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class bq extends yo{constructor(e){super(e)}load(e,t,i,r){const s=new nh,o=new sm(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,6===a&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class FI extends yo{constructor(e){super(e)}load(e,t,i,r){const s=new Ai,o=new sm(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},i,r),s}}class Is extends Mt{constructor(e,t=1){super(),this.type="Light",this.color=new de(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}Is.prototype.isLight=!0;(class kI extends Is{constructor(e,t,i){super(e,i),this.type="HemisphereLight",this.position.copy(Mt.DefaultUp),this.updateMatrix(),this.groundColor=new de(t)}copy(e){return Is.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const LI=new ue,BI=new M,VI=new M;class s1{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new K(512,512),this.map=null,this.mapPass=null,this.matrix=new ue,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Cg,this._frameExtents=new K(1,1),this._viewportCount=1,this._viewports=[new Ot(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;BI.setFromMatrixPosition(e.matrixWorld),t.position.copy(BI),VI.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(VI),t.updateMatrixWorld(),LI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(LI),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class UI extends s1{constructor(){super(new Zn(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,i=2*Xd*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}UI.prototype.isSpotLightShadow=!0;class o1 extends Is{constructor(e,t,i=0,r=Math.PI/3,s=0,o=1){super(e,t),this.type="SpotLight",this.position.copy(Mt.DefaultUp),this.updateMatrix(),this.target=new Mt,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.shadow=new UI}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}o1.prototype.isSpotLight=!0;const HI=new ue,wh=new M,a1=new M;class zI extends s1{constructor(){super(new Zn(90,1,.5,500)),this._frameExtents=new K(4,2),this._viewportCount=6,this._viewports=[new Ot(2,1,1,1),new Ot(0,1,1,1),new Ot(3,1,1,1),new Ot(1,1,1,1),new Ot(3,0,1,1),new Ot(1,0,1,1)],this._cubeDirections=[new M(1,0,0),new M(-1,0,0),new M(0,0,1),new M(0,0,-1),new M(0,1,0),new M(0,-1,0)],this._cubeUps=[new M(0,1,0),new M(0,1,0),new M(0,1,0),new M(0,1,0),new M(0,0,1),new M(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),wh.setFromMatrixPosition(e.matrixWorld),i.position.copy(wh),a1.copy(i.position),a1.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(a1),i.updateMatrixWorld(),r.makeTranslation(-wh.x,-wh.y,-wh.z),HI.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(HI)}}zI.prototype.isPointLightShadow=!0;class om extends Is{constructor(e,t,i=0,r=1){super(e,t),this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new zI}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}om.prototype.isPointLight=!0;class GI extends s1{constructor(){super(new ih(-5,5,5,-5,.5,500))}}GI.prototype.isDirectionalLightShadow=!0;class xh extends Is{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Mt.DefaultUp),this.updateMatrix(),this.target=new Mt,this.shadow=new GI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}xh.prototype.isDirectionalLight=!0;class l1 extends Is{constructor(e,t){super(e,t),this.type="AmbientLight"}}l1.prototype.isAmbientLight=!0;(class WI extends Is{constructor(e,t,i=10,r=10){super(e,t),this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}).prototype.isRectAreaLight=!0;class jI{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new M)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],i*r*1.092548),t.addScaledVector(o[5],r*s*1.092548),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],i*s*1.092548),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*s),t.addScaledVector(o[3],1.023328*i),t.addScaledVector(o[4],.858086*i*r),t.addScaledVector(o[5],.858086*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],.858086*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}jI.prototype.isSphericalHarmonics3=!0;class am extends Is{constructor(e=new jI,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}am.prototype.isLightProbe=!0;class lu{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch(i){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}let lm;(class $I extends Ue{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0,class Sq extends yo{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=au.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){au.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}.prototype.isImageBitmapLoader=!0;class Dq extends yo{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new wo(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);(void 0===lm&&(lm=new(window.AudioContext||window.webkitAudioContext)),lm).decodeAudioData(l,function(u){t(u)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}}(class Cq extends am{constructor(e,t,i=1){super(void 0,i);const r=(new de).set(e),s=(new de).set(t),o=new M(r.r,r.g,r.b),a=new M(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}).prototype.isHemisphereLightProbe=!0,class Eq extends am{constructor(e,t=1){super(void 0,t);const i=(new de).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class Pq{constructor(e,t,i){let r,s,o;switch(this.binding=e,this.valueSize=i,t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(0===o){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else o+=t,this._mixBufferRegion(i,s,0,t/o,r);this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(i,r,t*this._origIndex,1-s,t),o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const t=this.buffer,i=this.valueSize,r=i*this._origIndex;this.binding.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){Ft.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;Ft.multiplyQuaternionsFlat(e,o,e,t,e,i),Ft.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const c1="\\[\\]\\.:\\/",Oq=new RegExp("["+c1+"]","g"),u1="[^"+c1+"]",Fq="[^"+c1.replace("\\.","")+"]",kq=/((?:WC+[\/:])*)/.source.replace("WC",u1),Lq=/(WCOD+)?/.source.replace("WCOD",Fq),Bq=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",u1),Vq=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",u1),Uq=new RegExp("^"+kq+Lq+Bq+Vq+"$"),Hq=["material","materials","bones"];class zq{constructor(e,t,i){const r=i||Gt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let Gt=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Oq,"")}static parseTrackName(t){const i=Uq.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Hq.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=zq,n})();Gt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Gt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Gt.prototype.GetterByBindingType=[Gt.prototype._getValue_direct,Gt.prototype._getValue_array,Gt.prototype._getValue_arrayElement,Gt.prototype._getValue_toArray],Gt.prototype.SetterByBindingTypeAndVersioning=[[Gt.prototype._setValue_direct,Gt.prototype._setValue_direct_setNeedsUpdate,Gt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_array,Gt.prototype._setValue_array_setNeedsUpdate,Gt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_arrayElement,Gt.prototype._setValue_arrayElement_setNeedsUpdate,Gt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Gt.prototype._setValue_fromArray,Gt.prototype._setValue_fromArray_setNeedsUpdate,Gt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Wq{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:Sc,endingEnd:Sc};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,a=r/s;e.warp(1,s/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const l=(e-s)*i;if(l<0||0===i)return;this._startTime=null,t=i*l}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(2501===this.blendMode)for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);else for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(null!==i){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;null!==i&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=2202===i;if(0===e)return-1===s?r:o&&1==(1&s)?t-r:r;if(2200===i){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&1==(1&s))return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=Dc,r.endingEnd=Dc):(r.endingStart=e?this.zeroSlopeAtStart?Dc:Sc:2402,r.endingEnd=t?this.zeroSlopeAtEnd?Dc:Sc:2402)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}(class jq extends Wo{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];void 0===u&&(u={},c[l]=u);for(let d=0;d!==s;++d){const h=r[d],f=h.name;let g=u[f];if(void 0!==g)++g.referenceCount,o[d]=g;else{if(g=o[d],void 0!==g){null===g._cacheIndex&&(++g.referenceCount,this._addInactiveBinding(g,l,f));continue}g=new Pq(Gt.create(i,f,t&&t._propertyBindings[d].binding.parsedPath),h.ValueTypeName,h.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,l,f),o[d]=g}a[d].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];void 0===o&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],0===Object.keys(a).length&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return void 0===i&&(i=new NI(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o="string"==typeof e?bh.findByName(r,e):e;const a=null!==o?o.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===i&&(i=null!==o?o.blendMode:2500),void 0!==l){const d=l.actionByRoot[s];if(void 0!==d&&d.blendMode===i)return d;c=l.knownActions[0],null===o&&(o=c._clip)}if(null===o)return null;const u=new Wq(this,o,t,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const i=t||this._root,r=i.uuid,s="string"==typeof e?bh.findByName(i,e):e,a=this._actionsByClip[s?s.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)e[i].stop();return this}update(e){const t=this._actions,i=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(void 0!==s){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const l=i[o].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const s=this._bindingsByRootAndName[t];if(void 0!==s)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class d1{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new d1(void 0===this.value.clone?this.value:this.value.clone())}}function tN(n,e){return n.distance-e.distance}function h1(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let s=0,o=r.length;s<o;s++)h1(r[s],e,t,!0)}}(class $q extends qc{constructor(e,t,i=1){super(e,t),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}).prototype.isInstancedInterleavedBuffer=!0;class nN{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(kn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const iN=new K;class Mh{constructor(e=new K(1/0,1/0),t=new K(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=iN.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return iN.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Mh.prototype.isBox2=!0;const ia=new M,um=new ue,f1=new ue;function oN(n){const e=[];!0===n.isBone&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,oN(n.children[t]));return e}const hN=new ArrayBuffer(4),rs=(new Float32Array(hN),new Uint32Array(hN),new Uint32Array(512)),ss=new Uint32Array(512);for(let n=0;n<256;++n){const e=n-127;e<-27?(rs[n]=0,rs[256|n]=32768,ss[n]=24,ss[256|n]=24):e<-14?(rs[n]=1024>>-e-14,rs[256|n]=1024>>-e-14|32768,ss[n]=-e-1,ss[256|n]=-e-1):e<=15?(rs[n]=e+15<<10,rs[256|n]=e+15<<10|32768,ss[n]=13,ss[256|n]=13):e<128?(rs[n]=31744,rs[256|n]=64512,ss[n]=24,ss[256|n]=24):(rs[n]=31744,rs[256|n]=64512,ss[n]=13,ss[256|n]=13)}const g1=new Uint32Array(2048),cu=new Uint32Array(64),gN=new Uint32Array(64);for(let n=1;n<1024;++n){let e=n<<13,t=0;for(;0==(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,g1[n]=e|t}for(let n=1024;n<2048;++n)g1[n]=939524096+(n-1024<<13);for(let n=1;n<31;++n)cu[n]=n<<23;cu[31]=1199570944,cu[32]=2147483648;for(let n=33;n<63;++n)cu[n]=2147483648+(n-32<<23);cu[63]=3347054592;for(let n=1;n<64;++n)32!==n&&(gN[n]=1024);yr.create=function(n,e){return console.log("THREE.Curve.create() has been deprecated"),n.prototype=Object.create(yr.prototype),n.prototype.constructor=n,n.prototype.getPoint=e,n},dh.prototype.fromPoints=function(n){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(n)},class Jq extends tu{constructor(e=10,t=10,i=4473924,r=8947848){i=new de(i),r=new de(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let h=0,f=0,g=-a;h<=t;h++,g+=o){l.push(-a,0,g,a,0,g),l.push(g,0,-a,g,0,a);const p=h===s?i:r;p.toArray(c,f),f+=3,p.toArray(c,f),f+=3,p.toArray(c,f),f+=3,p.toArray(c,f),f+=3}const u=new Ue;u.setAttribute("position",new Te(l,3)),u.setAttribute("color",new Te(c,3)),super(u,new si({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class Xq extends tu{constructor(e){const t=oN(e),i=new Ue,r=[],s=[],o=new de(0,0,1),a=new de(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new Te(r,3)),i.setAttribute("color",new Te(s,3)),super(i,new si({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");f1.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(um.multiplyMatrices(f1,a.matrixWorld),ia.setFromMatrixPosition(um),r.setXYZ(o,ia.x,ia.y,ia.z),um.multiplyMatrices(f1,a.parent.matrixWorld),ia.setFromMatrixPosition(um),r.setXYZ(o+1,ia.x,ia.y,ia.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},yo.prototype.extractUrlBase=function(n){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),lu.extractUrlBase(n)},yo.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Mh.prototype.center=function(n){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(n)},Mh.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Mh.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Mh.prototype.size=function(n){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(n)},Or.prototype.center=function(n){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(n)},Or.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Or.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Or.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},Or.prototype.size=function(n){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(n)},_r.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},Xa.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Cg.prototype.setFromMatrix=function(n){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(n)},ii.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},ii.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},ii.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},ii.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},ii.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},ii.prototype.getInverse=function(n){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},ue.prototype.extractPosition=function(n){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(n)},ue.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},ue.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new M).setFromMatrixColumn(this,3)},ue.prototype.setRotationFromQuaternion=function(n){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(n)},ue.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},ue.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},ue.prototype.multiplyVector4=function(n){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},ue.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},ue.prototype.rotateAxis=function(n){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),n.transformDirection(this)},ue.prototype.crossVector=function(n){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},ue.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},ue.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},ue.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},ue.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},ue.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},ue.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},ue.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},ue.prototype.makeFrustum=function(n,e,t,i,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(n,e,i,t,r,s)},ue.prototype.getInverse=function(n){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},fo.prototype.isIntersectionLine=function(n){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(n)},Ft.prototype.multiplyVector3=function(n){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),n.applyQuaternion(this)},Ft.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ka.prototype.isIntersectionBox=function(n){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Ka.prototype.isIntersectionPlane=function(n){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(n)},Ka.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},$n.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},$n.prototype.barycoordFromPoint=function(n,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(n,e)},$n.prototype.midpoint=function(n){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(n)},$n.prototypenormal=function(n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(n)},$n.prototype.plane=function(n){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(n)},$n.barycoordFromPoint=function(n,e,t,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),$n.getBarycoord(n,e,t,i,r)},$n.normal=function(n,e,t,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),$n.getNormal(n,e,t,i)},go.prototype.extractAllPoints=function(n){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(n)},go.prototype.extrude=function(n){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ta(this,n)},go.prototype.makeGeometry=function(n){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new mh(this,n)},K.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},K.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},K.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},M.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},M.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},M.prototype.getPositionFromMatrix=function(n){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(n)},M.prototype.getScaleFromMatrix=function(n){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(n)},M.prototype.getColumnFromMatrix=function(n,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,n)},M.prototype.applyProjection=function(n){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(n)},M.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},M.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},M.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ot.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},Ot.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Mt.prototype.getChildByName=function(n){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(n)},Mt.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Mt.prototype.translate=function(n,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,n)},Mt.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Mt.prototype.applyMatrix=function(n){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(Mt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(n){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=n}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ge.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(ge.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Fg.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Zn.prototype.setLens=function(n,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(n)},Object.defineProperties(Is.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(n){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=n}},shadowCameraLeft:{set:function(n){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=n}},shadowCameraRight:{set:function(n){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=n}},shadowCameraTop:{set:function(n){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=n}},shadowCameraBottom:{set:function(n){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=n}},shadowCameraNear:{set:function(n){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=n}},shadowCameraFar:{set:function(n){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=n}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(n){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=n}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(n){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=n}},shadowMapHeight:{set:function(n){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=n}}}),Object.defineProperties(fn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Zd},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Zd)}}}),fn.prototype.setDynamic=function(n){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===n?Zd:Yd),this},fn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},fn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ue.prototype.addIndex=function(n){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(n)},Ue.prototype.addAttribute=function(n,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===n?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(n,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(n,new fn(arguments[1],arguments[2])))},Ue.prototype.addDrawCall=function(n,e,t){void 0!==t&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(n,e)},Ue.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Ue.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Ue.prototype.removeAttribute=function(n){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(n)},Ue.prototype.applyMatrix=function(n){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(Ue.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),qc.prototype.setDynamic=function(n){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===n?Zd:Yd),this},qc.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ta.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},ta.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},ta.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},el.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},d1.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(qn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new de}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(n){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=n}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(is.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(n){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=n}}}),Zt.prototype.clearTarget=function(n,e,t,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(n),this.clear(e,t,i)},Zt.prototype.animate=function(n){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(n)},Zt.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Zt.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Zt.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Zt.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Zt.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Zt.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Zt.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Zt.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Zt.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Zt.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Zt.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Zt.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Zt.prototype.enableScissorTest=function(n){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(n)},Zt.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Zt.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Zt.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Zt.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Zt.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Zt.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Zt.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Zt.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Zt.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Zt.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Zt.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=n}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=n}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(n){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===n?Yt:so}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(BR.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(gr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=n}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=n}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=n}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=n}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(n){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=n}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(n){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=n}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(n){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=n}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(n){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=n}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(n){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=n}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(n){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=n}}}),class Rq extends Mt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(n){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Dq).load(n,function(i){e.setBuffer(i)}),this},Ab.prototype.updateCubeMap=function(n,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(n,e)},Ab.prototype.clear=function(n,e,t,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(n,e,t,i)},$a.crossOrigin=void 0,$a.loadTexture=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new FI;r.setCrossOrigin(this.crossOrigin);const s=r.load(n,t,void 0,i);return e&&(s.mapping=e),s},$a.loadTextureCube=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new bq;r.setCrossOrigin(this.crossOrigin);const s=r.load(n,t,void 0,i);return e&&(s.mapping=e),s},$a.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},$a.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"139"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="139");var Xt=Uint8Array,di=Uint16Array,ra=Uint32Array,uu=new Xt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),du=new Xt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Sh=new Xt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_N=function(n,e){for(var t=new di(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];var r=new ra(t[30]);for(i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return[t,r]},vN=_N(uu,2),m1=vN[0],gm=vN[1];m1[28]=258,gm[258]=28;for(var bN=_N(du,0)[0],Dh=new di(32768),mn=0;mn<32768;++mn){var sa=(43690&mn)>>>1|(21845&mn)<<1;Dh[mn]=((65280&(sa=(61680&(sa=(52428&sa)>>>2|(13107&sa)<<2))>>>4|(3855&sa)<<4))>>>8|(255&sa)<<8)>>>1}var Ns=function(n,e,t){for(var i=n.length,r=0,s=new di(e);r<i;++r)++s[n[r]-1];var a,o=new di(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;if(t){a=new di(1<<e);var l=15-e;for(r=0;r<i;++r)if(n[r])for(var c=r<<4|n[r],u=e-n[r],d=o[n[r]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)a[Dh[d]>>>l]=c}else for(a=new di(i),r=0;r<i;++r)n[r]&&(a[r]=Dh[o[n[r]-1]++]>>>15-n[r]);return a},oa=new Xt(288);for(mn=0;mn<144;++mn)oa[mn]=8;for(mn=144;mn<256;++mn)oa[mn]=9;for(mn=256;mn<280;++mn)oa[mn]=7;for(mn=280;mn<288;++mn)oa[mn]=8;var Ch=new Xt(32);for(mn=0;mn<32;++mn)Ch[mn]=5;var xN=Ns(oa,9,1),SN=Ns(Ch,5,1),mm=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},kr=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(7&e)&t},_m=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(7&e)},Eh=function(n){return(n/8|0)+(7&n&&1)},vm=function(n,e,t){var i=n.length;if(!i||t&&!t.l&&i<5)return e||new Xt(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new Xt(3*i));var o=function(Y){var ot=e.length;if(Y>ot){var Fe=new Xt(Math.max(2*ot,Y));Fe.set(e),e=Fe}},a=t.f||0,l=t.p||0,c=t.b||0,u=t.l,d=t.d,h=t.m,f=t.n,g=8*i;do{if(!u){t.f=a=kr(n,l,1);var p=kr(n,l+1,3);if(l+=3,!p){var v=n[(m=Eh(l)+4)-4]|n[m-3]<<8,_=m+v;if(_>i){if(s)throw"unexpected EOF";break}r&&o(c+v),e.set(n.subarray(m,_),c),t.b=c+=v,t.p=l=8*_;continue}if(1==p)u=xN,d=SN,h=9,f=5;else{if(2!=p)throw"invalid block type";var y=kr(n,l,31)+257,b=kr(n,l+10,15)+4,w=y+kr(n,l+5,31)+1;l+=14;for(var S=new Xt(w),C=new Xt(19),E=0;E<b;++E)C[Sh[E]]=kr(n,l+3*E,7);l+=3*b;var B=mm(C),N=(1<<B)-1,x=Ns(C,B,1);for(E=0;E<w;){var m,R=x[kr(n,l,N)];if(l+=15&R,(m=R>>>4)<16)S[E++]=m;else{var z=0,P=0;for(16==m?(P=3+kr(n,l,3),l+=2,z=S[E-1]):17==m?(P=3+kr(n,l,7),l+=3):18==m&&(P=11+kr(n,l,127),l+=7);P--;)S[E++]=z}}var V=S.subarray(0,y),k=S.subarray(y);h=mm(V),f=mm(k),u=Ns(V,h,1),d=Ns(k,f,1)}if(l>g){if(s)throw"unexpected EOF";break}}r&&o(c+131072);for(var U=(1<<h)-1,F=(1<<f)-1,G=l;;G=l){var q=(z=u[_m(n,l)&U])>>>4;if((l+=15&z)>g){if(s)throw"unexpected EOF";break}if(!z)throw"invalid length/literal";if(q<256)e[c++]=q;else{if(256==q){G=l,u=null;break}var ee=q-254;q>264&&(ee=kr(n,l,(1<<(X=uu[E=q-257]))-1)+m1[E],l+=X);var xe=d[_m(n,l)&F],Re=xe>>>4;if(!xe)throw"invalid distance";if(l+=15&xe,k=bN[Re],Re>3){var X=du[Re];k+=_m(n,l)&(1<<X)-1,l+=X}if(l>g){if(s)throw"unexpected EOF";break}r&&o(c+131072);for(var Me=c+ee;c<Me;c+=4)e[c]=e[c-k],e[c+1]=e[c+1-k],e[c+2]=e[c+2-k],e[c+3]=e[c+3-k];c=Me}}t.l=u,t.p=G,t.b=c,u&&(a=1,t.m=h,t.d=d,t.n=f)}while(!a);return c==e.length?e:function(n,e,t){(null==e||e<0)&&(e=0),(null==t||t>n.length)&&(t=n.length);var i=new(n instanceof di?di:n instanceof ra?ra:Xt)(t-e);return i.set(n.subarray(e,t)),i}(e,0,c)},wm=new Xt(0);var C1="undefined"!=typeof TextDecoder&&new TextDecoder;try{C1.decode(wm,{stream:!0})}catch(n){}class WN extends yr{constructor(e,t,i,r,s){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=s||this.knots.length-1;for(let o=0;o<i.length;++o){const a=i[o];this.controlPoints[o]=new Ot(a.x,a.y,a.z,a.w)}}getPoint(e,t){const i=t||new M,s=function hY(n,e,t,i){const r=this.findSpan(n,i,e),s=this.calcBasisFunctions(r,i,n,e),o=new Ot(0,0,0,0);for(let a=0;a<=n;++a){const l=t[r-n+a],c=s[a],u=l.w*c;o.x+=l.x*u,o.y+=l.y*u,o.z+=l.z*u,o.w+=l.w*c}return o}(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!=s.w&&s.divideScalar(s.w),i.set(s.x,s.y,s.z)}getTangent(e,t){const i=t||new M,s=function fY(n,e,t,i,r){const s=this.calcBSplineDerivatives(n,e,t,i,r);return this.calcRationalCurveDerivatives(s)}(this.degree,this.knots,this.controlPoints,this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),1);return i.copy(s[1]).normalize(),i}}let wt,Bn,er;class pY extends yo{constructor(e){super(e)}load(e,t,i,r){const s=this,o=""===s.path?lu.extractUrlBase(e):s.path,a=new wo(this.manager);a.setPath(s.path),a.setResponseType("arraybuffer"),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{t(s.parse(l,o))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e,t){if(function bY(n){const e="Kaydara FBX Binary  \0";return n.byteLength>=e.length&&e===XN(n,0,e.length)}(e))wt=(new yY).parse(e);else{const r=XN(e);if(!function wY(n){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function i(r){const s=n[r-1];return n=n.slice(t+r),t++,s}for(let r=0;r<e.length;++r)if(i(1)===e[r])return!1;return!0}(r))throw new Error("THREE.FBXLoader: Unknown format.");if(qN(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+qN(r));wt=(new vY).parse(r)}const i=new FI(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new gY(i,this.manager).parse(wt)}}class gY{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){Bn=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),i=this.parseMaterials(t),r=this.parseDeformers(),s=(new mY).parse(r);return this.parseScene(r,s,i),er}parseConnections(){const e=new Map;return"Connections"in wt&&wt.Connections.connections.forEach(function(i){const r=i[0],s=i[1],o=i[2];e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:s,relationship:o};e.get(r).parents.push(a),e.has(s)||e.set(s,{parents:[],children:[]});const l={ID:r,relationship:o};e.get(s).children.push(l)}),e}parseImages(){const e={},t={};if("Video"in wt.Objects){const i=wt.Objects.Video;for(const r in i){const s=i[r];if(e[parseInt(r)]=s.RelativeFilename||s.Filename,"Content"in s){const a=s.Content instanceof ArrayBuffer&&s.Content.byteLength>0,l="string"==typeof s.Content&&""!==s.Content;if(a||l){const c=this.parseImage(i[r]);t[s.RelativeFilename||s.Filename]=c}}}}for(const i in e){const r=e[i];e[i]=void 0!==t[r]?t[r]:e[i].split("\\").pop()}return e}parseImage(e){const t=e.Content,i=e.RelativeFilename||e.Filename,r=i.slice(i.lastIndexOf(".")+1).toLowerCase();let s;switch(r){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",i),s="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof t)return"data:"+s+";base64,"+t;{const o=new Uint8Array(t);return window.URL.createObjectURL(new Blob([o],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in wt.Objects){const i=wt.Objects.Texture;for(const r in i){const s=this.parseTexture(i[r],e);t.set(parseInt(r),s)}}return t}parseTexture(e,t){const i=this.loadTexture(e,t);i.ID=e.id,i.name=e.attrName;const r=e.WrapModeU,s=e.WrapModeV,a=void 0!==s?s.value:0;if(i.wrapS=0===(void 0!==r?r.value:0)?yc:Ti,i.wrapT=0===a?yc:Ti,"Scaling"in e){const l=e.Scaling.value;i.repeat.x=l[0],i.repeat.y=l[1]}return i}loadTexture(e,t){let i;const r=this.textureLoader.path,s=Bn.get(e.id).children;let o;void 0!==s&&s.length>0&&void 0!==t[s[0].ID]&&(i=t[s[0].ID],(0===i.indexOf("blob:")||0===i.indexOf("data:"))&&this.textureLoader.setPath(void 0));const a=e.FileName.slice(-3).toLowerCase();if("tga"===a){const l=this.manager.getHandler(".tga");null===l?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),o=new Ai):(l.setPath(this.textureLoader.path),o=l.load(i))}else"psd"===a?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),o=new Ai):o=this.textureLoader.load(i);return this.textureLoader.setPath(r),o}parseMaterials(e){const t=new Map;if("Material"in wt.Objects){const i=wt.Objects.Material;for(const r in i){const s=this.parseMaterial(i[r],e);null!==s&&t.set(parseInt(r),s)}}return t}parseMaterial(e,t){const i=e.id,r=e.attrName;let s=e.ShadingModel;if("object"==typeof s&&(s=s.value),!Bn.has(i))return null;const o=this.parseParameters(e,t,i);let a;switch(s.toLowerCase()){case"phong":a=new _h;break;case"lambert":a=new r1;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),a=new _h}return a.setValues(o),a.name=r,a}parseParameters(e,t,i){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=(new de).fromArray(e.Diffuse.value):e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(r.color=(new de).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=(new de).fromArray(e.Emissive.value):e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(r.emissive=(new de).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=(new de).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=(new de).fromArray(e.SpecularColor.value));const s=this;return Bn.get(i).children.forEach(function(o){const a=o.relationship;switch(a){case"Bump":r.bumpMap=s.getTexture(t,o.ID);break;case"Maya|TEX_ao_map":r.aoMap=s.getTexture(t,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=s.getTexture(t,o.ID),void 0!==r.map&&(r.map.encoding=Yt);break;case"DisplacementColor":r.displacementMap=s.getTexture(t,o.ID);break;case"EmissiveColor":r.emissiveMap=s.getTexture(t,o.ID),void 0!==r.emissiveMap&&(r.emissiveMap.encoding=Yt);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=s.getTexture(t,o.ID);break;case"ReflectionColor":r.envMap=s.getTexture(t,o.ID),void 0!==r.envMap&&(r.envMap.mapping=303,r.envMap.encoding=Yt);break;case"SpecularColor":r.specularMap=s.getTexture(t,o.ID),void 0!==r.specularMap&&(r.specularMap.encoding=Yt);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=s.getTexture(t,o.ID),r.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a)}}),r}getTexture(e,t){return"LayeredTexture"in wt.Objects&&t in wt.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=Bn.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in wt.Objects){const i=wt.Objects.Deformer;for(const r in i){const s=i[r],o=Bn.get(parseInt(r));if("Skin"===s.attrType){const a=this.parseSkeleton(o,i);a.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=o.parents[0].ID,e[r]=a}else if("BlendShape"===s.attrType){const a={id:r};a.rawTargets=this.parseMorphTargets(o,i),a.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=a}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const i=[];return e.children.forEach(function(r){const s=t[r.ID];if("Cluster"!==s.attrType)return;const o={ID:r.ID,indices:[],weights:[],transformLink:(new ue).fromArray(s.TransformLink.a)};"Indexes"in s&&(o.indices=s.Indexes.a,o.weights=s.Weights.a),i.push(o)}),{rawBones:i,bones:[]}}parseMorphTargets(e,t){const i=[];for(let r=0;r<e.children.length;r++){const s=e.children[r],o=t[s.ID],a={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;a.geoID=Bn.get(parseInt(s.ID)).children.filter(function(l){return void 0===l.relationship})[0].ID,i.push(a)}return i}parseScene(e,t,i){er=new po;const r=this.parseModels(e.skeletons,t,i),s=wt.Objects.Model,o=this;r.forEach(function(l){o.setLookAtProperties(l,s[l.ID]),Bn.get(l.ID).parents.forEach(function(d){const h=r.get(d.ID);void 0!==h&&h.add(l)}),null===l.parent&&er.add(l)}),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),er.traverse(function(l){if(l.userData.transformData){l.parent&&(l.userData.transformData.parentMatrix=l.parent.matrix,l.userData.transformData.parentMatrixWorld=l.parent.matrixWorld);const c=YN(l.userData.transformData);l.applyMatrix4(c),l.updateWorldMatrix()}});const a=(new _Y).parse();1===er.children.length&&er.children[0].isGroup&&(er.children[0].animations=a,er=er.children[0]),er.animations=a}parseModels(e,t,i){const r=new Map,s=wt.Objects.Model;for(const o in s){const a=parseInt(o),l=s[o],c=Bn.get(a);let u=this.buildSkeleton(c,e,a,l.attrName);if(!u){switch(l.attrType){case"Camera":u=this.createCamera(c);break;case"Light":u=this.createLight(c);break;case"Mesh":u=this.createMesh(c,t,i);break;case"NurbsCurve":u=this.createCurve(c,t);break;case"LimbNode":case"Root":u=new Jc;break;default:u=new po}u.name=l.attrName?Gt.sanitizeNodeName(l.attrName):"",u.ID=a}this.getTransformData(u,l),r.set(a,u)}return r}buildSkeleton(e,t,i,r){let s=null;return e.parents.forEach(function(o){for(const a in t){const l=t[a];l.rawBones.forEach(function(c,u){if(c.ID===o.ID){const d=s;s=new Jc,s.matrixWorld.copy(c.transformLink),s.name=r?Gt.sanitizeNodeName(r):"",s.ID=i,l.bones[u]=s,null!==d&&s.add(d)}})}}),s}createCamera(e){let t,i;if(e.children.forEach(function(r){const s=wt.Objects.NodeAttribute[r.ID];void 0!==s&&(i=s)}),void 0===i)t=new Mt;else{let r=0;void 0!==i.CameraProjectionType&&1===i.CameraProjectionType.value&&(r=1);let s=1;void 0!==i.NearPlane&&(s=i.NearPlane.value/1e3);let o=1e3;void 0!==i.FarPlane&&(o=i.FarPlane.value/1e3);let a=window.innerWidth,l=window.innerHeight;void 0!==i.AspectWidth&&void 0!==i.AspectHeight&&(a=i.AspectWidth.value,l=i.AspectHeight.value);const c=a/l;let u=45;void 0!==i.FieldOfView&&(u=i.FieldOfView.value);const d=i.FocalLength?i.FocalLength.value:null;switch(r){case 0:t=new Zn(u,c,s,o),null!==d&&t.setFocalLength(d);break;case 1:t=new ih(-a/2,a/2,l/2,-l/2,s,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new Mt}}return t}createLight(e){let t,i;if(e.children.forEach(function(r){const s=wt.Objects.NodeAttribute[r.ID];void 0!==s&&(i=s)}),void 0===i)t=new Mt;else{let r;r=void 0===i.LightType?0:i.LightType.value;let s=16777215;void 0!==i.Color&&(s=(new de).fromArray(i.Color.value));let o=void 0===i.Intensity?1:i.Intensity.value/100;void 0!==i.CastLightOnObject&&0===i.CastLightOnObject.value&&(o=0);let a=0;void 0!==i.FarAttenuationEnd&&(a=void 0!==i.EnableFarAttenuation&&0===i.EnableFarAttenuation.value?0:i.FarAttenuationEnd.value);const l=1;switch(r){case 0:t=new om(s,o,a,l);break;case 1:t=new xh(s,o);break;case 2:let c=Math.PI/3;void 0!==i.InnerAngle&&(c=Es.degToRad(i.InnerAngle.value));let u=0;void 0!==i.OuterAngle&&(u=Es.degToRad(i.OuterAngle.value),u=Math.max(u,1)),t=new o1(s,o,a,c,u,l);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),t=new om(s,o)}void 0!==i.CastShadows&&1===i.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,i){let r,s=null,o=null;const a=[];return e.children.forEach(function(l){t.has(l.ID)&&(s=t.get(l.ID)),i.has(l.ID)&&a.push(i.get(l.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new _h({color:13421772}),a.push(o)),"color"in s.attributes&&a.forEach(function(l){l.vertexColors=!0}),s.FBX_Deformer?(r=new Fg(s,o),r.normalizeSkinWeights()):r=new ge(s,o),r}createCurve(e,t){const i=e.children.reduce(function(s,o){return t.has(o.ID)&&(s=t.get(o.ID)),s},null),r=new si({color:3342591,linewidth:1});return new Ni(i,r)}getTransformData(e,t){const i={};"InheritType"in t&&(i.inheritType=parseInt(t.InheritType.value)),i.eulerOrder="RotationOrder"in t?ZN(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(i.translation=t.Lcl_Translation.value),"PreRotation"in t&&(i.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(i.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(i.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(i.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(i.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(i.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(i.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(i.rotationPivot=t.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,t){"LookAtProperty"in t&&Bn.get(e.ID).children.forEach(function(r){if("LookAtProperty"===r.relationship){const s=wt.Objects.Model[r.ID];if("Lcl_Translation"in s){const o=s.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(o),er.add(e.target)):e.lookAt((new M).fromArray(o))}}})}bindSkeleton(e,t,i){const r=this.parsePoseNodes();for(const s in e){const o=e[s];Bn.get(parseInt(o.ID)).parents.forEach(function(l){t.has(l.ID)&&Bn.get(l.ID).parents.forEach(function(d){i.has(d.ID)&&i.get(d.ID).bind(new kg(o.bones),r[d.ID])})})}}parsePoseNodes(){const e={};if("Pose"in wt.Objects){const t=wt.Objects.Pose;for(const i in t)if("BindPose"===t[i].attrType&&t[i].NbPoseNodes>0){const r=t[i].PoseNode;Array.isArray(r)?r.forEach(function(s){e[s.Node]=(new ue).fromArray(s.Matrix.a)}):e[r.Node]=(new ue).fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in wt&&"AmbientColor"in wt.GlobalSettings){const e=wt.GlobalSettings.AmbientColor.value,t=e[0],i=e[1],r=e[2];if(0!==t||0!==i||0!==r){const s=new de(t,i,r);er.add(new l1(s,1))}}}}class mY{parse(e){const t=new Map;if("Geometry"in wt.Objects){const i=wt.Objects.Geometry;for(const r in i){const s=Bn.get(parseInt(r)),o=this.parseGeometry(s,i[r],e);t.set(parseInt(r),o)}}return t}parseGeometry(e,t,i){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,i);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,i){const r=i.skeletons,s=[],o=e.parents.map(function(d){return wt.Objects.Model[d.ID]});if(0===o.length)return;const a=e.children.reduce(function(d,h){return void 0!==r[h.ID]&&(d=r[h.ID]),d},null);e.children.forEach(function(d){void 0!==i.morphTargets[d.ID]&&s.push(i.morphTargets[d.ID])});const l=o[0],c={};"RotationOrder"in l&&(c.eulerOrder=ZN(l.RotationOrder.value)),"InheritType"in l&&(c.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(c.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(c.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(c.scale=l.GeometricScaling.value);const u=YN(c);return this.genGeometry(t,a,s,u)}genGeometry(e,t,i,r){const s=new Ue;e.attrName&&(s.name=e.attrName);const o=this.parseGeoNode(e,t),a=this.genBuffers(o),l=new Te(a.vertex,3);if(l.applyMatrix4(r),s.setAttribute("position",l),a.colors.length>0&&s.setAttribute("color",new Te(a.colors,3)),t&&(s.setAttribute("skinIndex",new xb(a.weightsIndices,4)),s.setAttribute("skinWeight",new Te(a.vertexWeights,4)),s.FBX_Deformer=t),a.normal.length>0){const c=(new ii).getNormalMatrix(r),u=new Te(a.normal,3);u.applyNormalMatrix(c),s.setAttribute("normal",u)}if(a.uvs.forEach(function(c,u){let d="uv"+(u+1).toString();0===u&&(d="uv"),s.setAttribute(d,new Te(a.uvs[u],2))}),o.material&&"AllSame"!==o.material.mappingType){let c=a.materialIndex[0],u=0;if(a.materialIndex.forEach(function(d,h){d!==c&&(s.addGroup(u,h-u,c),c=d,u=h)}),s.groups.length>0){const d=s.groups[s.groups.length-1],h=d.start+d.count;h!==a.materialIndex.length&&s.addGroup(h,a.materialIndex.length-h,c)}0===s.groups.length&&s.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(s,e,i,r),s}parseGeoNode(e,t){const i={};if(i.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],i.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return i.weightTable={},null!==t&&(i.skeleton=t,t.rawBones.forEach(function(r,s){r.indices.forEach(function(o,a){void 0===i.weightTable[o]&&(i.weightTable[o]=[]),i.weightTable[o].push({id:s,weight:r.weights[a]})})})),i}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,r=0,s=!1,o=[],a=[],l=[],c=[],u=[],d=[];const h=this;return e.vertexIndices.forEach(function(f,g){let p,m=!1;f<0&&(f^=-1,m=!0);let v=[],_=[];if(o.push(3*f,3*f+1,3*f+2),e.color){const y=Rm(g,i,f,e.color);l.push(y[0],y[1],y[2])}if(e.skeleton){if(void 0!==e.weightTable[f]&&e.weightTable[f].forEach(function(y){_.push(y.weight),v.push(y.id)}),_.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const y=[0,0,0,0],b=[0,0,0,0];_.forEach(function(w,S){let C=w,E=v[S];b.forEach(function(B,N,x){if(C>B){x[N]=C,C=B;const R=y[N];y[N]=E,E=R}})}),v=y,_=b}for(;_.length<4;)_.push(0),v.push(0);for(let y=0;y<4;++y)u.push(_[y]),d.push(v[y])}if(e.normal){const y=Rm(g,i,f,e.normal);a.push(y[0],y[1],y[2])}e.material&&"AllSame"!==e.material.mappingType&&(p=Rm(g,i,f,e.material)[0]),e.uv&&e.uv.forEach(function(y,b){const w=Rm(g,i,f,y);void 0===c[b]&&(c[b]=[]),c[b].push(w[0]),c[b].push(w[1])}),r++,m&&(h.genFace(t,e,o,p,a,l,c,u,d,r),i++,r=0,o=[],a=[],l=[],c=[],u=[],d=[])}),t}genFace(e,t,i,r,s,o,a,l,c,u){for(let d=2;d<u;d++)e.vertex.push(t.vertexPositions[i[0]]),e.vertex.push(t.vertexPositions[i[1]]),e.vertex.push(t.vertexPositions[i[2]]),e.vertex.push(t.vertexPositions[i[3*(d-1)]]),e.vertex.push(t.vertexPositions[i[3*(d-1)+1]]),e.vertex.push(t.vertexPositions[i[3*(d-1)+2]]),e.vertex.push(t.vertexPositions[i[3*d]]),e.vertex.push(t.vertexPositions[i[3*d+1]]),e.vertex.push(t.vertexPositions[i[3*d+2]]),t.skeleton&&(e.vertexWeights.push(l[0]),e.vertexWeights.push(l[1]),e.vertexWeights.push(l[2]),e.vertexWeights.push(l[3]),e.vertexWeights.push(l[4*(d-1)]),e.vertexWeights.push(l[4*(d-1)+1]),e.vertexWeights.push(l[4*(d-1)+2]),e.vertexWeights.push(l[4*(d-1)+3]),e.vertexWeights.push(l[4*d]),e.vertexWeights.push(l[4*d+1]),e.vertexWeights.push(l[4*d+2]),e.vertexWeights.push(l[4*d+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(d-1)]),e.weightsIndices.push(c[4*(d-1)+1]),e.weightsIndices.push(c[4*(d-1)+2]),e.weightsIndices.push(c[4*(d-1)+3]),e.weightsIndices.push(c[4*d]),e.weightsIndices.push(c[4*d+1]),e.weightsIndices.push(c[4*d+2]),e.weightsIndices.push(c[4*d+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[3*(d-1)]),e.colors.push(o[3*(d-1)+1]),e.colors.push(o[3*(d-1)+2]),e.colors.push(o[3*d]),e.colors.push(o[3*d+1]),e.colors.push(o[3*d+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(s[0]),e.normal.push(s[1]),e.normal.push(s[2]),e.normal.push(s[3*(d-1)]),e.normal.push(s[3*(d-1)+1]),e.normal.push(s[3*(d-1)+2]),e.normal.push(s[3*d]),e.normal.push(s[3*d+1]),e.normal.push(s[3*d+2])),t.uv&&t.uv.forEach(function(h,f){void 0===e.uvs[f]&&(e.uvs[f]=[]),e.uvs[f].push(a[f][0]),e.uvs[f].push(a[f][1]),e.uvs[f].push(a[f][2*(d-1)]),e.uvs[f].push(a[f][2*(d-1)+1]),e.uvs[f].push(a[f][2*d]),e.uvs[f].push(a[f][2*d+1])})}addMorphTargets(e,t,i,r){if(0===i.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;i.forEach(function(o){o.rawTargets.forEach(function(a){const l=wt.Objects.Geometry[a.geoID];void 0!==l&&s.genMorphGeometry(e,t,l,r,a.name)})})}genMorphGeometry(e,t,i,r,s){const o=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],a=void 0!==i.Vertices?i.Vertices.a:[],l=void 0!==i.Indexes?i.Indexes.a:[],u=new Float32Array(3*e.attributes.position.count);for(let g=0;g<l.length;g++){const p=3*l[g];u[p]=a[3*g],u[p+1]=a[3*g+1],u[p+2]=a[3*g+2]}const h=this.genBuffers({vertexIndices:o,vertexPositions:u}),f=new Te(h.vertex,3);f.name=s||i.attrName,f.applyMatrix4(r),e.morphAttributes.position.push(f)}parseNormals(e){const i=e.ReferenceInformationType;let s=[];return"IndexToDirect"===i&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:e.Normals.a,indices:s,mappingType:e.MappingInformationType,referenceType:i}}parseUVs(e){const i=e.ReferenceInformationType;let s=[];return"IndexToDirect"===i&&(s=e.UVIndex.a),{dataSize:2,buffer:e.UV.a,indices:s,mappingType:e.MappingInformationType,referenceType:i}}parseVertexColors(e){const i=e.ReferenceInformationType;let s=[];return"IndexToDirect"===i&&(s=e.ColorIndex.a),{dataSize:4,buffer:e.Colors.a,indices:s,mappingType:e.MappingInformationType,referenceType:i}}parseMaterialIndices(e){const t=e.MappingInformationType,i=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const r=e.Materials.a,s=[];for(let o=0;o<r.length;++o)s.push(o);return{dataSize:1,buffer:r,indices:s,mappingType:t,referenceType:i}}parseNurbsGeometry(e){if(void 0===WN)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new Ue;const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Ue;const i=t-1,r=e.KnotVector.a,s=[],o=e.Points.a;for(let d=0,h=o.length;d<h;d+=4)s.push((new Ot).fromArray(o,d));let a,l;if("Closed"===e.Form)s.push(s[0]);else if("Periodic"===e.Form){a=i,l=r.length-1-a;for(let d=0;d<i;++d)s.push(s[d])}const u=new WN(i,r,s,a,l).getPoints(12*s.length);return(new Ue).setFromPoints(u)}}class _Y{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const i in t){const s=this.addClip(t[i]);e.push(s)}return e}parseClips(){if(void 0===wt.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=wt.Objects.AnimationCurveNode,t=new Map;for(const i in e){const r=e[i];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const s={id:r.id,attr:r.attrName,curves:{}};t.set(s.id,s)}}return t}parseAnimationCurves(e){const t=wt.Objects.AnimationCurve;for(const i in t){const r={id:t[i].id,times:t[i].KeyTime.a.map(xY),values:t[i].KeyValueFloat.a},s=Bn.get(r.id);if(void 0!==s){const o=s.parents[0].ID,a=s.parents[0].relationship;a.match(/X/)?e.get(o).curves.x=r:a.match(/Y/)?e.get(o).curves.y=r:a.match(/Z/)?e.get(o).curves.z=r:a.match(/d|DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=r)}}}parseAnimationLayers(e){const t=wt.Objects.AnimationLayer,i=new Map;for(const r in t){const s=[],o=Bn.get(parseInt(r));void 0!==o&&(o.children.forEach(function(l,c){if(e.has(l.ID)){const u=e.get(l.ID);if(void 0!==u.curves.x||void 0!==u.curves.y||void 0!==u.curves.z){if(void 0===s[c]){const d=Bn.get(l.ID).parents.filter(function(h){return void 0!==h.relationship})[0].ID;if(void 0!==d){const h=wt.Objects.Model[d.toString()];if(void 0===h)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",l);const f={modelName:h.attrName?Gt.sanitizeNodeName(h.attrName):"",ID:h.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};er.traverse(function(g){g.ID===h.id&&(f.transform=g.matrix,g.userData.transformData&&(f.eulerOrder=g.userData.transformData.eulerOrder))}),f.transform||(f.transform=new ue),"PreRotation"in h&&(f.preRotation=h.PreRotation.value),"PostRotation"in h&&(f.postRotation=h.PostRotation.value),s[c]=f}}s[c]&&(s[c][u.attr]=u)}else if(void 0!==u.curves.morph){if(void 0===s[c]){const d=Bn.get(l.ID).parents.filter(function(v){return void 0!==v.relationship})[0].ID,h=Bn.get(d).parents[0].ID,f=Bn.get(h).parents[0].ID,g=Bn.get(f).parents[0].ID,p=wt.Objects.Model[g],m={modelName:p.attrName?Gt.sanitizeNodeName(p.attrName):"",morphName:wt.Objects.Deformer[d].attrName};s[c]=m}s[c][u.attr]=u}}}),i.set(parseInt(r),s))}return i}parseAnimStacks(e){const t=wt.Objects.AnimationStack,i={};for(const r in t){const s=Bn.get(parseInt(r)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(s[0].ID);i[r]={name:t[r].attrName,layer:o}}return i}addClip(e){let t=[];const i=this;return e.layer.forEach(function(r){t=t.concat(i.generateTracks(r))}),new bh(e.name,-1,t)}generateTracks(e){const t=[];let i=new M,r=new Ft,s=new M;if(e.transform&&e.transform.decompose(i,r,s),i=i.toArray(),r=(new _r).setFromQuaternion(r,e.eulerOrder).toArray(),s=s.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);void 0!==o&&t.push(o)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");void 0!==o&&t.push(o)}if(void 0!==e.DeformPercent){const o=this.generateMorphTrack(e);void 0!==o&&t.push(o)}return t}generateVectorTrack(e,t,i,r){const s=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(s,t,i);return new yh(e+"."+r,s,o)}generateRotationTrack(e,t,i,r,s,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(Es.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(Es.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(Es.degToRad));const a=this.getTimesForAllAxes(t),l=this.getKeyframeTrackValues(a,t,i);void 0!==r&&((r=r.map(Es.degToRad)).push(o),r=(new _r).fromArray(r),r=(new Ft).setFromEuler(r)),void 0!==s&&((s=s.map(Es.degToRad)).push(o),s=(new _r).fromArray(s),s=(new Ft).setFromEuler(s).invert());const c=new Ft,u=new _r,d=[];for(let h=0;h<l.length;h+=3)u.set(l[h],l[h+1],l[h+2],o),c.setFromEuler(u),void 0!==r&&c.premultiply(r),void 0!==s&&c.multiply(s),c.toArray(d,h/3*4);return new su(e+".quaternion",a,d)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,i=t.values.map(function(s){return s/100}),r=er.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new vh(e.modelName+".morphTargetInfluences["+r+"]",t.times,i)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(i,r){return i-r}),t.length>1){let i=1,r=t[0];for(let s=1;s<t.length;s++){const o=t[s];o!==r&&(t[i]=o,r=o,i++)}t=t.slice(0,i)}return t}getKeyframeTrackValues(e,t,i){const r=i,s=[];let o=-1,a=-1,l=-1;return e.forEach(function(c){if(t.x&&(o=t.x.times.indexOf(c)),t.y&&(a=t.y.times.indexOf(c)),t.z&&(l=t.z.times.indexOf(c)),-1!==o){const u=t.x.values[o];s.push(u),r[0]=u}else s.push(r[0]);if(-1!==a){const u=t.y.values[a];s.push(u),r[1]=u}else s.push(r[1]);if(-1!==l){const u=t.z.values[l];s.push(u),r[2]=u}else s.push(r[2])}),s}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const i=e.values[t-1],r=e.values[t]-i,s=Math.abs(r);if(s>=180){const o=s/180,a=r/o;let l=i+a;const c=e.times[t-1],d=(e.times[t]-c)/o;let h=c+d;const f=[],g=[];for(;h<e.times[t];)f.push(h),h+=d,g.push(l),l+=a;e.times=KN(e.times,t,f),e.values=KN(e.values,t,g)}}}}class vY{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new $N,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,i=e.split(/[\r\n]+/);return i.forEach(function(r,s){const o=r.match(/^[\s\t]*;/),a=r.match(/^[\s\t]*$/);if(o||a)return;const l=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),c=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),u=r.match("^\\t{"+(t.currentIndent-1)+"}}");l?t.parseNodeBegin(r,l):c?t.parseNodeProperty(r,c,i[++s]):u?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const i=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(l){return l.trim().replace(/^"/,"").replace(/"$/,"")}),s={name:i},o=this.parseNodeAttr(r),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(i,s):i in a?("PoseNode"===i?a.PoseNode.push(s):void 0!==a[i].id&&(a[i]={},a[i][a[i].id]=a[i]),""!==o.id&&(a[i][o.id]=s)):"number"==typeof o.id?(a[i]={},a[i][o.id]=s):"Properties70"!==i&&(a[i]="PoseNode"===i?[s]:s),"number"==typeof o.id&&(s.id=o.id),""!==o.name&&(s.attrName=o.name),""!==o.type&&(s.attrType=o.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let i="",r="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:i,type:r}}parseNodeProperty(e,t,i){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===s&&(s=i.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===r){const l=s.split(",").slice(1),c=parseInt(l[0]),u=parseInt(l[1]);let d=s.split(",").slice(3);d=d.map(function(h){return h.trim().replace(/^"/,"")}),r="connections",s=[c,u],function SY(n,e){for(let t=0,i=n.length,r=e.length;t<r;t++,i++)n[i]=e[t]}(s,d),void 0===o[r]&&(o[r]=[])}"Node"===r&&(o.id=s),r in o&&Array.isArray(o[r])?o[r].push(s):"a"!==r?o[r]=s:o.a=s,this.setCurrentProp(o,r),"a"===r&&","!==s.slice(-1)&&(o.a=T1(s))}else this.parseNodeSpecialProperty(e,r,s)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=T1(t.a))}parseNodeSpecialProperty(e,t,i){const r=i.split('",').map(function(u){return u.trim().replace(/^\"/,"").replace(/\s/,"_")}),s=r[0],o=r[1],a=r[2],l=r[3];let c=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=T1(c)}this.getPrevNode()[s]={type:o,type2:a,flag:l,value:c},this.setCurrentProp(this.getPrevNode(),s)}}class yY{parse(e){const t=new jN(e);t.skip(23);const i=t.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const r=new $N;for(;!this.endOfContent(t);){const s=this.parseNode(t,i);null!==s&&r.add(s.name,s)}return r}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const i={},r=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),a=e.getString(o);if(0===r)return null;const l=[];for(let h=0;h<s;h++)l.push(this.parseProperty(e));const c=l.length>0?l[0]:"",u=l.length>1?l[1]:"",d=l.length>2?l[2]:"";for(i.singleProperty=1===s&&e.getOffset()===r;r>e.getOffset();){const h=this.parseNode(e,t);null!==h&&this.parseSubNode(a,i,h)}return i.propertyList=l,"number"==typeof c&&(i.id=c),""!==u&&(i.attrName=u),""!==d&&(i.attrType=d),""!==a&&(i.name=a),i}parseSubNode(e,t,i){if(!0===i.singleProperty){const r=i.propertyList[0];Array.isArray(r)?(t[i.name]=i,i.a=r):t[i.name]=r}else if("Connections"===e&&"C"===i.name){const r=[];i.propertyList.forEach(function(s,o){0!==o&&r.push(s)}),void 0===t.connections&&(t.connections=[]),t.connections.push(r)}else if("Properties70"===i.name)Object.keys(i).forEach(function(s){t[s]=i[s]});else if("Properties70"===e&&"P"===i.name){let r=i.propertyList[0],s=i.propertyList[1];const o=i.propertyList[2],a=i.propertyList[3];let l;0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),l="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:i.propertyList[4],t[r]={type:s,type2:o,flag:a,value:l}}else void 0===t[i.name]?"number"==typeof i.id?(t[i.name]={},t[i.name][i.id]=i):t[i.name]=i:"PoseNode"===i.name?(Array.isArray(t[i.name])||(t[i.name]=[t[i.name]]),t[i.name].push(i)):void 0===t[i.name][i.id]&&(t[i.name][i.id]=i)}parseProperty(e){const t=e.getString(1);let i;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),s=e.getUint32(),o=e.getUint32();if(0===s)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const a=function Em(n,e){return vm((function(n){if(8!=(15&n[0])||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(32&n[1])throw"invalid zlib data: preset dictionaries not supported"}(n),n.subarray(2,-4)),e)}(new Uint8Array(e.getArrayBuffer(o))),l=new jN(a.buffer);switch(t){case"b":case"c":return l.getBooleanArray(r);case"d":return l.getFloat64Array(r);case"f":return l.getFloat32Array(r);case"i":return l.getInt32Array(r);case"l":return l.getInt64Array(r)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class jN{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return 1==(1&this.getUint8())}getBooleanArray(e){const t=[];for(let i=0;i<e;i++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();const i=t.indexOf(0);return i>=0&&(t=t.slice(0,i)),lu.decodeText(new Uint8Array(t))}}class $N{add(e,t){this[e]=t}}function qN(n){const t=n.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function xY(n){return n/46186158e3}const MY=[];function Rm(n,e,t,i){let r;switch(i.mappingType){case"ByPolygonVertex":r=n;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}"IndexToDirect"===i.referenceType&&(r=i.indices[r]);const s=r*i.dataSize;return function DY(n,e,t,i){for(let r=t,s=0;r<i;r++,s++)n[s]=e[r];return n}(MY,i.buffer,s,s+i.dataSize)}const E1=new _r,gu=new M;function YN(n){const e=new ue,t=new ue,i=new ue,r=new ue,s=new ue,o=new ue,a=new ue,l=new ue,c=new ue,u=new ue,d=new ue,h=new ue,f=n.inheritType?n.inheritType:0;if(n.translation&&e.setPosition(gu.fromArray(n.translation)),n.preRotation){const N=n.preRotation.map(Es.degToRad);N.push(n.eulerOrder),t.makeRotationFromEuler(E1.fromArray(N))}if(n.rotation){const N=n.rotation.map(Es.degToRad);N.push(n.eulerOrder),i.makeRotationFromEuler(E1.fromArray(N))}if(n.postRotation){const N=n.postRotation.map(Es.degToRad);N.push(n.eulerOrder),r.makeRotationFromEuler(E1.fromArray(N)),r.invert()}n.scale&&s.scale(gu.fromArray(n.scale)),n.scalingOffset&&a.setPosition(gu.fromArray(n.scalingOffset)),n.scalingPivot&&o.setPosition(gu.fromArray(n.scalingPivot)),n.rotationOffset&&l.setPosition(gu.fromArray(n.rotationOffset)),n.rotationPivot&&c.setPosition(gu.fromArray(n.rotationPivot)),n.parentMatrixWorld&&(d.copy(n.parentMatrix),u.copy(n.parentMatrixWorld));const g=t.clone().multiply(i).multiply(r),p=new ue;p.extractRotation(u);const m=new ue;m.copyPosition(u);const v=m.clone().invert().multiply(u),_=p.clone().invert().multiply(v),y=s,b=new ue;if(0===f)b.copy(p).multiply(g).multiply(_).multiply(y);else if(1===f)b.copy(p).multiply(_).multiply(g).multiply(y);else{const x=(new ue).scale((new M).setFromMatrixScale(d)).clone().invert(),R=_.clone().multiply(x);b.copy(p).multiply(g).multiply(R).multiply(y)}const w=c.clone().invert(),S=o.clone().invert();let C=e.clone().multiply(l).multiply(c).multiply(t).multiply(i).multiply(r).multiply(w).multiply(a).multiply(o).multiply(s).multiply(S);const E=(new ue).copyPosition(C),B=u.clone().multiply(E);return h.copyPosition(B),C=h.clone().multiply(b),C.premultiply(u.invert()),C}function ZN(n){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(n=n||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[n]}function T1(n){return n.split(",").map(function(t){return parseFloat(t)})}function XN(n,e,t){return void 0===e&&(e=0),void 0===t&&(t=n.byteLength),lu.decodeText(new Uint8Array(n,e,t))}function KN(n,e,t){return n.slice(0,e).concat(t).concat(n.slice(e))}const JN={is:(n,e)=>n.type===e.name||Object.getPrototypeOf(n)instanceof e||Object.getPrototypeOf(n).constructor.name===e.name,arrayEqual(n,e){const t=new Set(n),i=new Set(e);return n.every(r=>i.has(r))&&e.every(r=>t.has(r))}};var CY=Iu(928);let mu=(()=>{class n{constructor(){this.scenesSource$=new Wn([]),this.importSource$=new on,this.selectionSource$=new Wn([]),this.layoutUpdatedSource$=new on,this.focusSource$=new on,this.scenes$=this.scenesSource$.asObservable(),this.import$=this.importSource$.asObservable(),this.selection$=this.selectionSource$.asObservable(),this.layoutUpdated$=this.layoutUpdatedSource$.asObservable(),this.focus$=this.focusSource$.asObservable()}setScenes(t){this.scenesSource$.next(t)}import(t){this.importSource$.next(t)}setSelection(t){return!JN.arrayEqual(t,this.selectionSource$.getValue())&&(this.selectionSource$.next(t),!0)}updateLayout(){this.layoutUpdatedSource$.next(null)}focus(t){this.focusSource$.next(t)}importFileAsync(t){var i=this;return Zp(function*(){console.log("loading file",t);const r=yield i.useImportLoaderAsync(t);r.name=(0,CY.basename)(t),i.import(r)})()}useImportLoaderAsync(t){var i=this;return Zp(function*(){if(t.toLowerCase().endsWith(".fbx"))return yield i.loadAsync(new pY,t);throw new Error(`could not find loader for url: '${t}'`)})()}loadAsync(t,i){return Zp(function*(){return yield t.loadAsync(i,r=>console.log(r))})()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ke({token:n,factory:n.\u0275fac}),n})();class EY extends Q{constructor(e,t){super()}schedule(e,t=0){return this}}const Im={setInterval(n,e,...t){const{delegate:i}=Im;return(null==i?void 0:i.setInterval)?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=Im;return((null==e?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0},QN={now:()=>(QN.delegate||Date).now(),delegate:void 0};class Ih{constructor(e,t=Ih.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}Ih.now=QN.now;const A1=new class AY extends Ih{constructor(e,t=Ih.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}(class TY extends EY{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return Im.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;Im.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ie(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),RY=A1,NY=["gutterEls"];function PY(n,e){if(1&n){const t=dr();Ee(0,"div",2,3),Qe("keydown",function(r){gi(t);const s=He().index;return He().startKeyboardDrag(r,2*s+1,s+1)})("mousedown",function(r){gi(t);const s=He().index;return He().startMouseDrag(r,2*s+1,s+1)})("touchstart",function(r){gi(t);const s=He().index;return He().startMouseDrag(r,2*s+1,s+1)})("mouseup",function(r){gi(t);const s=He().index;return He().clickGutter(r,s+1)})("touchend",function(r){gi(t);const s=He().index;return He().clickGutter(r,s+1)}),un(2,"div",4),Ae()}if(2&n){const t=He(),i=t.index,r=t.$implicit,s=He();pd("flex-basis",s.gutterSize,"px")("order",2*i+1),$t("aria-label",s.gutterAriaLabel)("aria-orientation",s.direction)("aria-valuemin",r.minSize)("aria-valuemax",r.maxSize)("aria-valuenow",r.size)("aria-valuetext",s.getAriaAreaSizeText(r.size))}}function OY(n,e){1&n&&Oe(0,PY,3,10,"div",1),2&n&&ce("ngIf",!1===e.last)}const FY=["*"];function Nh(n){if(void 0!==n.changedTouches&&n.changedTouches.length>0)return{x:n.changedTouches[0].clientX,y:n.changedTouches[0].clientY};if(void 0!==n.clientX&&void 0!==n.clientY)return{x:n.clientX,y:n.clientY};if(void 0!==n.currentTarget){const e=n.currentTarget;return{x:e.offsetLeft,y:e.offsetTop}}return null}function eP(n,e,t){return Math.abs(n.x-e.x)<=t&&Math.abs(n.y-e.y)<=t}function tP(n,e){const t=n.nativeElement.getBoundingClientRect();return"horizontal"===e?t.width:t.height}function Ph(n){return"boolean"==typeof n?n:"false"!==n}function ca(n,e){return null==n?e:(n=Number(n),!isNaN(n)&&n>=0?n:e)}function nP(n,e){if("percent"===n){const t=e.reduce((i,r)=>null!==r?i+r:i,0);return e.every(i=>null!==i)&&t>99.9&&t<100.1}if("pixel"===n)return 1===e.filter(t=>null===t).length}function Nm(n){return null===n.size?null:!0===n.component.lockSize?n.size:null===n.component.minSize?null:n.component.minSize>n.size?n.size:n.component.minSize}function Pm(n){return null===n.size?null:!0===n.component.lockSize?n.size:null===n.component.maxSize?null:n.component.maxSize<n.size?n.size:n.component.maxSize}function _u(n,e,t,i){return e.reduce((r,s)=>{const o=function LY(n,e,t,i){return 0===t?{areaSnapshot:e,pixelAbsorb:0,percentAfterAbsorption:e.sizePercentAtStart,pixelRemain:0}:0===e.sizePixelAtStart&&t<0?{areaSnapshot:e,pixelAbsorb:0,percentAfterAbsorption:0,pixelRemain:t}:"percent"===n?function BY(n,e,t){const r=(n.sizePixelAtStart+e)/t*100;if(e>0){if(null!==n.area.maxSize&&r>n.area.maxSize){const s=n.area.maxSize/100*t;return{areaSnapshot:n,pixelAbsorb:s,percentAfterAbsorption:n.area.maxSize,pixelRemain:n.sizePixelAtStart+e-s}}return{areaSnapshot:n,pixelAbsorb:e,percentAfterAbsorption:r>100?100:r,pixelRemain:0}}if(e<0){if(null!==n.area.minSize&&r<n.area.minSize){const s=n.area.minSize/100*t;return{areaSnapshot:n,pixelAbsorb:s,percentAfterAbsorption:n.area.minSize,pixelRemain:n.sizePixelAtStart+e-s}}return r<0?{areaSnapshot:n,pixelAbsorb:-n.sizePixelAtStart,percentAfterAbsorption:0,pixelRemain:e+n.sizePixelAtStart}:{areaSnapshot:n,pixelAbsorb:e,percentAfterAbsorption:r,pixelRemain:0}}}(e,t,i):"pixel"===n?function VY(n,e,t){const i=n.sizePixelAtStart+e;return e>0?null!==n.area.maxSize&&i>n.area.maxSize?{areaSnapshot:n,pixelAbsorb:n.area.maxSize-n.sizePixelAtStart,percentAfterAbsorption:-1,pixelRemain:i-n.area.maxSize}:{areaSnapshot:n,pixelAbsorb:e,percentAfterAbsorption:-1,pixelRemain:0}:e<0?null!==n.area.minSize&&i<n.area.minSize?{areaSnapshot:n,pixelAbsorb:n.area.minSize+e-i,percentAfterAbsorption:-1,pixelRemain:i-n.area.minSize}:i<0?{areaSnapshot:n,pixelAbsorb:-n.sizePixelAtStart,percentAfterAbsorption:-1,pixelRemain:e+n.sizePixelAtStart}:{areaSnapshot:n,pixelAbsorb:e,percentAfterAbsorption:-1,pixelRemain:0}:void 0}(e,t):void 0}(n,s,r.remain,i);return r.list.push(o),r.remain=o.pixelRemain,r},{remain:t,list:[]})}function iP(n,e){"percent"===n?e.areaSnapshot.area.size=e.percentAfterAbsorption:"pixel"===n&&null!==e.areaSnapshot.area.size&&(e.areaSnapshot.area.size=e.areaSnapshot.sizePixelAtStart+e.pixelAbsorb)}const UY=new ft("angular-split-global-config");let rP=(()=>{class n{constructor(t,i,r,s,o){this.ngZone=t,this.elRef=i,this.cdRef=r,this.renderer=s,this.gutterClickDeltaPx=2,this._config={direction:"horizontal",unit:"percent",gutterSize:11,gutterStep:1,restrictMove:!1,useTransition:!1,disabled:!1,dir:"ltr",gutterDblClickDuration:0},this.dragStart=new et(!1),this.dragEnd=new et(!1),this.gutterClick=new et(!1),this.gutterDblClick=new et(!1),this.dragProgressSubject=new on,this.dragProgress$=this.dragProgressSubject.asObservable(),this.isDragging=!1,this.isWaitingClear=!1,this.isWaitingInitialMove=!1,this.dragListeners=[],this.snapshot=null,this.startPoint=null,this.endPoint=null,this.displayedAreas=[],this.hiddenAreas=[],this._clickTimeout=null,this.direction=this._direction,this._config=o?Object.assign(this._config,o):this._config,Object.keys(this._config).forEach(a=>{this[a]=this._config[a]})}set direction(t){this._direction="vertical"===t?"vertical":"horizontal",this.renderer.addClass(this.elRef.nativeElement,`as-${this._direction}`),this.renderer.removeClass(this.elRef.nativeElement,"as-"+("vertical"===this._direction?"horizontal":"vertical")),this.build(!1,!1)}get direction(){return this._direction}set unit(t){this._unit="pixel"===t?"pixel":"percent",this.renderer.addClass(this.elRef.nativeElement,`as-${this._unit}`),this.renderer.removeClass(this.elRef.nativeElement,"as-"+("pixel"===this._unit?"percent":"pixel")),this.build(!1,!0)}get unit(){return this._unit}set gutterSize(t){this._gutterSize=ca(t,11),this.build(!1,!1)}get gutterSize(){return this._gutterSize}set gutterStep(t){this._gutterStep=ca(t,1)}get gutterStep(){return this._gutterStep}set restrictMove(t){this._restrictMove=Ph(t)}get restrictMove(){return this._restrictMove}set useTransition(t){this._useTransition=Ph(t),this._useTransition?this.renderer.addClass(this.elRef.nativeElement,"as-transition"):this.renderer.removeClass(this.elRef.nativeElement,"as-transition")}get useTransition(){return this._useTransition}set disabled(t){this._disabled=Ph(t),this._disabled?this.renderer.addClass(this.elRef.nativeElement,"as-disabled"):this.renderer.removeClass(this.elRef.nativeElement,"as-disabled")}get disabled(){return this._disabled}set dir(t){this._dir="rtl"===t?"rtl":"ltr",this.renderer.setAttribute(this.elRef.nativeElement,"dir",this._dir)}get dir(){return this._dir}set gutterDblClickDuration(t){this._gutterDblClickDuration=ca(t,0)}get gutterDblClickDuration(){return this._gutterDblClickDuration}get transitionEnd(){return new Kt(t=>this.transitionEndSubscriber=t).pipe(function IY(n,e=A1){return Cn((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,i.next(c)}};function l(){const c=o+n,u=e.now();if(u<c)return r=this.schedule(void 0,c-u),void i.add(r);a()}t.subscribe(an(i,c=>{s=c,o=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}(20))}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{setTimeout(()=>this.renderer.addClass(this.elRef.nativeElement,"as-init"))})}getNbGutters(){return 0===this.displayedAreas.length?0:this.displayedAreas.length-1}addArea(t){const i={component:t,order:0,size:0,minSize:null,maxSize:null,sizeBeforeCollapse:null,gutterBeforeCollapse:0};!0===t.visible?(this.displayedAreas.push(i),this.build(!0,!0)):this.hiddenAreas.push(i)}removeArea(t){if(this.displayedAreas.some(i=>i.component===t)){const i=this.displayedAreas.find(r=>r.component===t);this.displayedAreas.splice(this.displayedAreas.indexOf(i),1),this.build(!0,!0)}else if(this.hiddenAreas.some(i=>i.component===t)){const i=this.hiddenAreas.find(r=>r.component===t);this.hiddenAreas.splice(this.hiddenAreas.indexOf(i),1)}}updateArea(t,i,r){!0===t.visible&&this.build(i,r)}showArea(t){const i=this.hiddenAreas.find(s=>s.component===t);if(void 0===i)return;const r=this.hiddenAreas.splice(this.hiddenAreas.indexOf(i),1);this.displayedAreas.push(...r),this.build(!0,!0)}hideArea(t){const i=this.displayedAreas.find(s=>s.component===t);if(void 0===i)return;const r=this.displayedAreas.splice(this.displayedAreas.indexOf(i),1);r.forEach(s=>{s.order=0,s.size=0}),this.hiddenAreas.push(...r),this.build(!0,!0)}getVisibleAreaSizes(){return this.displayedAreas.map(t=>null===t.size?"*":t.size)}setVisibleAreaSizes(t){if(t.length!==this.displayedAreas.length)return!1;const i=t.map(s=>ca(s,null));return!1!==nP(this.unit,i)&&(this.displayedAreas.forEach((s,o)=>s.component._size=i[o]),this.build(!1,!0),!0)}build(t,i){if(this.stopDragging(),!0===t&&(this.displayedAreas.every(r=>null!==r.component.order)&&this.displayedAreas.sort((r,s)=>r.component.order-s.component.order),this.displayedAreas.forEach((r,s)=>{r.order=2*s,r.component.setStyleOrder(r.order)})),!0===i){const r=nP(this.unit,this.displayedAreas.map(s=>s.component.size));switch(this.unit){case"percent":{const s=100/this.displayedAreas.length;this.displayedAreas.forEach(o=>{o.size=r?o.component.size:s,o.minSize=Nm(o),o.maxSize=Pm(o)});break}case"pixel":if(r)this.displayedAreas.forEach(s=>{s.size=s.component.size,s.minSize=Nm(s),s.maxSize=Pm(s)});else{const s=this.displayedAreas.filter(o=>null===o.component.size);if(0===s.length&&this.displayedAreas.length>0)this.displayedAreas.forEach((o,a)=>{o.size=0===a?null:o.component.size,o.minSize=0===a?null:Nm(o),o.maxSize=0===a?null:Pm(o)});else if(s.length>1){let o=!1;this.displayedAreas.forEach(a=>{null===a.component.size?!1===o?(a.size=null,a.minSize=null,a.maxSize=null,o=!0):(a.size=100,a.minSize=null,a.maxSize=null):(a.size=a.component.size,a.minSize=Nm(a),a.maxSize=Pm(a))})}}}}this.refreshStyleSizes(),this.cdRef.markForCheck()}refreshStyleSizes(){if("percent"===this.unit)if(1===this.displayedAreas.length)this.displayedAreas[0].component.setStyleFlex(0,0,"100%",!1,!1);else{const t=this.getNbGutters()*this.gutterSize;this.displayedAreas.forEach(i=>{i.component.setStyleFlex(0,0,`calc( ${i.size}% - ${i.size/100*t}px )`,null!==i.minSize&&i.minSize===i.size,null!==i.maxSize&&i.maxSize===i.size)})}else"pixel"===this.unit&&this.displayedAreas.forEach(t=>{null===t.size?t.component.setStyleFlex(1,1,1===this.displayedAreas.length?"100%":"auto",!1,!1):1===this.displayedAreas.length?t.component.setStyleFlex(0,0,"100%",!1,!1):t.component.setStyleFlex(0,0,`${t.size}px`,null!==t.minSize&&t.minSize===t.size,null!==t.maxSize&&t.maxSize===t.size)})}clickGutter(t,i){const r=Nh(t);this.startPoint&&eP(this.startPoint,r,this.gutterClickDeltaPx)&&(!this.isDragging||this.isWaitingInitialMove)&&(null!==this._clickTimeout?(window.clearTimeout(this._clickTimeout),this._clickTimeout=null,this.notify("dblclick",i),this.stopDragging()):this._clickTimeout=window.setTimeout(()=>{this._clickTimeout=null,this.notify("click",i),this.stopDragging()},this.gutterDblClickDuration))}startKeyboardDrag(t,i,r){if(!0===this.disabled||!0===this.isWaitingClear)return;const s=function kY(n,e){if("horizontal"===e)switch(n.key){case"ArrowLeft":case"ArrowRight":case"PageUp":case"PageDown":break;default:return null}if("vertical"===e)switch(n.key){case"ArrowUp":case"ArrowDown":case"PageUp":case"PageDown":break;default:return null}const t=n.currentTarget,i="PageUp"===n.key||"PageDown"===n.key?500:50;let r=t.offsetLeft,s=t.offsetTop;switch(n.key){case"ArrowLeft":r-=i;break;case"ArrowRight":r+=i;break;case"ArrowUp":s-=i;break;case"ArrowDown":s+=i;break;case"PageUp":"vertical"===e?s-=i:r+=i;break;case"PageDown":"vertical"===e?s+=i:r-=i;break;default:return null}return{x:r,y:s}}(t,this.direction);null!==s&&(this.endPoint=s,this.startPoint=Nh(t),t.preventDefault(),t.stopPropagation(),this.setupForDragEvent(i,r),this.startDragging(),this.drag(),this.stopDragging())}startMouseDrag(t,i,r){t.preventDefault(),t.stopPropagation(),this.startPoint=Nh(t),null!==this.startPoint&&!0!==this.disabled&&!0!==this.isWaitingClear&&(this.setupForDragEvent(i,r),this.dragListeners.push(this.renderer.listen("document","mouseup",this.stopDragging.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchend",this.stopDragging.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchcancel",this.stopDragging.bind(this))),this.ngZone.runOutsideAngular(()=>{this.dragListeners.push(this.renderer.listen("document","mousemove",this.mouseDragEvent.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchmove",this.mouseDragEvent.bind(this)))}),this.startDragging())}setupForDragEvent(t,i){this.snapshot={gutterNum:i,lastSteppedOffset:0,allAreasSizePixel:tP(this.elRef,this.direction)-this.getNbGutters()*this.gutterSize,allInvolvedAreasSizePercent:100,areasBeforeGutter:[],areasAfterGutter:[]},this.displayedAreas.forEach(r=>{const s={area:r,sizePixelAtStart:tP(r.component.elRef,this.direction),sizePercentAtStart:"percent"===this.unit?r.size:-1};r.order<t?!0===this.restrictMove?this.snapshot.areasBeforeGutter=[s]:this.snapshot.areasBeforeGutter.unshift(s):r.order>t&&(!0===this.restrictMove?0===this.snapshot.areasAfterGutter.length&&(this.snapshot.areasAfterGutter=[s]):this.snapshot.areasAfterGutter.push(s))}),this.snapshot.allInvolvedAreasSizePercent=[...this.snapshot.areasBeforeGutter,...this.snapshot.areasAfterGutter].reduce((r,s)=>r+s.sizePercentAtStart,0)}startDragging(){this.displayedAreas.forEach(t=>t.component.lockEvents()),this.isDragging=!0,this.isWaitingInitialMove=!0}mouseDragEvent(t){t.preventDefault(),t.stopPropagation();const i=Nh(t);null!==this._clickTimeout&&!eP(this.startPoint,i,this.gutterClickDeltaPx)&&(window.clearTimeout(this._clickTimeout),this._clickTimeout=null),!1!==this.isDragging&&(this.endPoint=Nh(t),null!==this.endPoint&&this.drag())}drag(){if(this.isWaitingInitialMove){if(this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y)return;this.ngZone.run(()=>{this.isWaitingInitialMove=!1,this.renderer.addClass(this.elRef.nativeElement,"as-dragging"),this.renderer.addClass(this.gutterEls.toArray()[this.snapshot.gutterNum-1].nativeElement,"as-dragged"),this.notify("start",this.snapshot.gutterNum)})}let t="horizontal"===this.direction?this.startPoint.x-this.endPoint.x:this.startPoint.y-this.endPoint.y;"rtl"===this.dir&&(t=-t);const i=Math.round(t/this.gutterStep)*this.gutterStep;if(i===this.snapshot.lastSteppedOffset)return;this.snapshot.lastSteppedOffset=i;let r=_u(this.unit,this.snapshot.areasBeforeGutter,-i,this.snapshot.allAreasSizePixel),s=_u(this.unit,this.snapshot.areasAfterGutter,i,this.snapshot.allAreasSizePixel);if(0!==r.remain&&0!==s.remain?Math.abs(r.remain)===Math.abs(s.remain)||(Math.abs(r.remain)>Math.abs(s.remain)?s=_u(this.unit,this.snapshot.areasAfterGutter,i+r.remain,this.snapshot.allAreasSizePixel):r=_u(this.unit,this.snapshot.areasBeforeGutter,-(i-s.remain),this.snapshot.allAreasSizePixel)):0!==r.remain?s=_u(this.unit,this.snapshot.areasAfterGutter,i+r.remain,this.snapshot.allAreasSizePixel):0!==s.remain&&(r=_u(this.unit,this.snapshot.areasBeforeGutter,-(i-s.remain),this.snapshot.allAreasSizePixel)),"percent"===this.unit){const o=[...r.list,...s.list],a=o.find(l=>0!==l.percentAfterAbsorption&&l.percentAfterAbsorption!==l.areaSnapshot.area.minSize&&l.percentAfterAbsorption!==l.areaSnapshot.area.maxSize);a&&(a.percentAfterAbsorption=this.snapshot.allInvolvedAreasSizePercent-o.filter(l=>l!==a).reduce((l,c)=>l+c.percentAfterAbsorption,0))}r.list.forEach(o=>iP(this.unit,o)),s.list.forEach(o=>iP(this.unit,o)),this.refreshStyleSizes(),this.notify("progress",this.snapshot.gutterNum)}stopDragging(t){if(t&&(t.preventDefault(),t.stopPropagation()),!1!==this.isDragging){for(this.displayedAreas.forEach(i=>i.component.unlockEvents());this.dragListeners.length>0;){const i=this.dragListeners.pop();i&&i()}this.isDragging=!1,!1===this.isWaitingInitialMove&&this.notify("end",this.snapshot.gutterNum),this.renderer.removeClass(this.elRef.nativeElement,"as-dragging"),this.renderer.removeClass(this.gutterEls.toArray()[this.snapshot.gutterNum-1].nativeElement,"as-dragged"),this.snapshot=null,this.isWaitingClear=!0,this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.startPoint=null,this.endPoint=null,this.isWaitingClear=!1})})}}notify(t,i){const r=this.getVisibleAreaSizes();"start"===t?this.dragStart.emit({gutterNum:i,sizes:r}):"end"===t?this.dragEnd.emit({gutterNum:i,sizes:r}):"click"===t?this.gutterClick.emit({gutterNum:i,sizes:r}):"dblclick"===t?this.gutterDblClick.emit({gutterNum:i,sizes:r}):"transitionEnd"===t?this.transitionEndSubscriber&&this.ngZone.run(()=>this.transitionEndSubscriber.next(r)):"progress"===t&&this.dragProgressSubject.next({gutterNum:i,sizes:r})}ngOnDestroy(){this.stopDragging()}collapseArea(t,i,r){const s=this.displayedAreas.find(l=>l.component===t);if(void 0===s)return;const o="right"===r?1:-1;s.sizeBeforeCollapse||(s.sizeBeforeCollapse=s.size,s.gutterBeforeCollapse=o),s.size=i;const a=this.gutterEls.find(l=>l.nativeElement.style.order===`${s.order+o}`);a&&this.renderer.addClass(a.nativeElement,"as-split-gutter-collapsed"),this.updateArea(t,!1,!1)}expandArea(t){const i=this.displayedAreas.find(s=>s.component===t);if(void 0===i||!i.sizeBeforeCollapse)return;i.size=i.sizeBeforeCollapse,i.sizeBeforeCollapse=null;const r=this.gutterEls.find(s=>s.nativeElement.style.order===`${i.order+i.gutterBeforeCollapse}`);r&&this.renderer.removeClass(r.nativeElement,"as-split-gutter-collapsed"),this.updateArea(t,!1,!1)}getAriaAreaSizeText(t){return null===t?null:t.toFixed(0)+" "+this.unit}}return n.\u0275fac=function(t){return new(t||n)(L(dn),L(qt),L(Tr),L(Ki),L(UY,8))},n.\u0275cmp=ln({type:n,selectors:[["as-split"]],viewQuery:function(t,i){if(1&t&&oc(NY,5),2&t){let r;tn(r=nn())&&(i.gutterEls=r)}},inputs:{direction:"direction",unit:"unit",gutterSize:"gutterSize",gutterStep:"gutterStep",restrictMove:"restrictMove",useTransition:"useTransition",disabled:"disabled",dir:"dir",gutterDblClickDuration:"gutterDblClickDuration",gutterClickDeltaPx:"gutterClickDeltaPx",gutterAriaLabel:"gutterAriaLabel"},outputs:{transitionEnd:"transitionEnd",dragStart:"dragStart",dragEnd:"dragEnd",gutterClick:"gutterClick",gutterDblClick:"gutterDblClick"},exportAs:["asSplit"],ngContentSelectors:FY,decls:2,vars:1,consts:[["ngFor","",3,"ngForOf"],["role","slider","tabindex","0","class","as-split-gutter",3,"flex-basis","order","keydown","mousedown","touchstart","mouseup","touchend",4,"ngIf"],["role","slider","tabindex","0",1,"as-split-gutter",3,"keydown","mousedown","touchstart","mouseup","touchend"],["gutterEls",""],[1,"as-split-gutter-icon"]],template:function(t,i){1&t&&(hd(),fd(0),Oe(1,OY,1,1,"ng-template",0)),2&t&&(oe(1),ce("ngForOf",i.displayedAreas))},directives:[Ss,Bo],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:nowrap;justify-content:flex-start;align-items:stretch;overflow:hidden;width:100%;height:100%}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{border:none;flex-grow:0;flex-shrink:0;background-color:#eee;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%] > .as-split-gutter.as-split-gutter-collapsed[_ngcontent-%COMP%]{flex-basis:1px!important;pointer-events:none}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{width:100%;height:100%;background-position:center center;background-repeat:no-repeat}[_nghost-%COMP%]    >.as-split-area{flex-grow:0;flex-shrink:0;overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]    >.as-split-area.as-hidden{flex:0 1 0px!important;overflow-x:hidden;overflow-y:hidden}.as-horizontal[_nghost-%COMP%]{flex-direction:row}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:row;cursor:col-resize;height:100%}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==)}.as-horizontal[_nghost-%COMP%]    >.as-split-area{height:100%}.as-vertical[_nghost-%COMP%]{flex-direction:column}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:column;cursor:row-resize;width:100%}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC)}.as-vertical[_nghost-%COMP%]    >.as-split-area{width:100%}.as-vertical[_nghost-%COMP%]    >.as-split-area.as-hidden{max-width:0}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{cursor:default}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url()}.as-transition.as-init[_nghost-%COMP%]:not(.as-dragging) > .as-split-gutter[_ngcontent-%COMP%], .as-transition.as-init[_nghost-%COMP%]:not(.as-dragging)    >.as-split-area{transition:flex-basis .3s}"],changeDetection:0}),n})(),HY=(()=>{class n{constructor(t,i,r,s){this.ngZone=t,this.elRef=i,this.renderer=r,this.split=s,this._order=null,this._size=null,this._minSize=null,this._maxSize=null,this._lockSize=!1,this._visible=!0,this.lockListeners=[],this.renderer.addClass(this.elRef.nativeElement,"as-split-area")}set order(t){this._order=ca(t,null),this.split.updateArea(this,!0,!1)}get order(){return this._order}set size(t){this._size=ca(t,null),this.split.updateArea(this,!1,!0)}get size(){return this._size}set minSize(t){this._minSize=ca(t,null),this.split.updateArea(this,!1,!0)}get minSize(){return this._minSize}set maxSize(t){this._maxSize=ca(t,null),this.split.updateArea(this,!1,!0)}get maxSize(){return this._maxSize}set lockSize(t){this._lockSize=Ph(t),this.split.updateArea(this,!1,!0)}get lockSize(){return this._lockSize}set visible(t){this._visible=Ph(t),this._visible?(this.split.showArea(this),this.renderer.removeClass(this.elRef.nativeElement,"as-hidden")):(this.split.hideArea(this),this.renderer.addClass(this.elRef.nativeElement,"as-hidden"))}get visible(){return this._visible}ngOnInit(){this.split.addArea(this),this.ngZone.runOutsideAngular(()=>{this.transitionListener=this.renderer.listen(this.elRef.nativeElement,"transitionend",t=>{"flex-basis"===t.propertyName&&this.split.notify("transitionEnd",-1)})})}setStyleOrder(t){this.renderer.setStyle(this.elRef.nativeElement,"order",t)}setStyleFlex(t,i,r,s,o){this.renderer.setStyle(this.elRef.nativeElement,"flex-grow",t),this.renderer.setStyle(this.elRef.nativeElement,"flex-shrink",i),this.renderer.setStyle(this.elRef.nativeElement,"flex-basis",r),!0===s?this.renderer.addClass(this.elRef.nativeElement,"as-min"):this.renderer.removeClass(this.elRef.nativeElement,"as-min"),!0===o?this.renderer.addClass(this.elRef.nativeElement,"as-max"):this.renderer.removeClass(this.elRef.nativeElement,"as-max")}lockEvents(){this.ngZone.runOutsideAngular(()=>{this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement,"selectstart",()=>!1)),this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement,"dragstart",()=>!1))})}unlockEvents(){for(;this.lockListeners.length>0;){const t=this.lockListeners.pop();t&&t()}}ngOnDestroy(){this.unlockEvents(),this.transitionListener&&this.transitionListener(),this.split.removeArea(this)}collapse(t=0,i="right"){this.split.collapseArea(this,t,i)}expand(){this.split.expandArea(this)}}return n.\u0275fac=function(t){return new(t||n)(L(dn),L(qt),L(Ki),L(rP))},n.\u0275dir=pe({type:n,selectors:[["as-split-area"],["","as-split-area",""]],inputs:{order:"order",size:"size",minSize:"minSize",maxSize:"maxSize",lockSize:"lockSize",visible:"visible"},exportAs:["asSplitArea"]}),n})(),zY=(()=>{class n{static forRoot(){return console.warn("AngularSplitModule.forRoot() is deprecated and will be removed in v6"),{ngModule:n,providers:[]}}static forChild(){return console.warn("AngularSplitModule.forChild() is deprecated and will be removed in v6"),{ngModule:n,providers:[]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})();const GY=["addListener","removeListener"],WY=["addEventListener","removeEventListener"],jY=["on","off"];function ji(n,e,t,i){if(Ct(t)&&(i=t,t=void 0),i)return ji(n,e,t).pipe(wy(i));const[r,s]=function YY(n){return Ct(n.addEventListener)&&Ct(n.removeEventListener)}(n)?WY.map(o=>a=>n[o](e,a,t)):function $Y(n){return Ct(n.addListener)&&Ct(n.removeListener)}(n)?GY.map(sP(n,e)):function qY(n){return Ct(n.on)&&Ct(n.off)}(n)?jY.map(sP(n,e)):[];if(!r&&m_(n))return Vn(o=>ji(o,e,t))(xi(n));if(!r)throw new TypeError("Invalid event target");return new Kt(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function sP(n,e){return t=>i=>n[t](e,i)}const{isArray:XY}=Array;function oP(n){return 1===n.length&&XY(n[0])?n[0]:n}function Om(...n){const e=cf(n),t=oP(n);return t.length?new Kt(i=>{let r=t.map(()=>[]),s=t.map(()=>!1);i.add(()=>{r=s=null});for(let o=0;!i.closed&&o<t.length;o++)xi(t[o]).subscribe(an(i,a=>{if(r[o].push(a),r.every(l=>l.length)){const l=r.map(c=>c.shift());i.next(e?e(...l):l),r.some((c,u)=>!c.length&&s[u])&&i.complete()}},()=>{s[o]=!0,!r[o].length&&i.complete()}));return()=>{r=s=null}}):Vr}function oi(n){return Cn((e,t)=>{xi(n).subscribe(an(t,()=>t.complete(),hi)),!t.closed&&e.subscribe(t)})}function QY(n,e){return n===e}function N1(...n){const e=cf(n);return Cn((t,i)=>{const r=n.length,s=new Array(r);let o=n.map(()=>!1),a=!1;for(let l=0;l<r;l++)xi(n[l]).subscribe(an(i,c=>{s[l]=c,!a&&!o[l]&&(o[l]=!0,(a=o.every(zs))&&(o=null))},hi));t.subscribe(an(i,l=>{if(a){const c=[l,...s];i.next(e?e(...c):c)}}))})}new Kt(hi);let uP=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(L(Ki),L(qt))},n.\u0275dir=pe({type:n}),n})(),al=(()=>{class n extends uP{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Di(n)))(i||n)}}(),n.\u0275dir=pe({type:n,features:[Bt]}),n})();const Lr=new ft("NgValueAccessor"),sZ={provide:Lr,useExisting:It(()=>P1),multi:!0};let P1=(()=>{class n extends al{writeValue(t){this.setProperty("checked",t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Di(n)))(i||n)}}(),n.\u0275dir=pe({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,i){1&t&&Qe("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[en([sZ]),Bt]}),n})();const oZ={provide:Lr,useExisting:It(()=>vu),multi:!0},lZ=new ft("CompositionEventMode");let vu=(()=>{class n extends uP{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function aZ(){const n=Ms()?Ms().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(L(Ki),L(qt),L(lZ,8))},n.\u0275dir=pe({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&Qe("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[en([oZ]),Bt]}),n})();const Pi=new ft("NgValidators"),da=new ft("NgAsyncValidators");function bP(n){return null!=n}function wP(n){const e=dd(n)?li(n):n;return cv(e),e}function xP(n){let e={};return n.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function MP(n,e){return e.map(t=>t(n))}function SP(n){return n.map(e=>function uZ(n){return!n.validate}(e)?e:t=>e.validate(t))}function O1(n){return null!=n?function DP(n){if(!n)return null;const e=n.filter(bP);return 0==e.length?null:function(t){return xP(MP(t,e))}}(SP(n)):null}function F1(n){return null!=n?function CP(n){if(!n)return null;const e=n.filter(bP);return 0==e.length?null:function(t){return function rZ(...n){const e=cf(n),{args:t,keys:i}=tT(n),r=new Kt(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let d=!1;xi(t[u]).subscribe(an(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(i?nT(i,a):a),s.complete())}))}});return e?r.pipe(wy(e)):r}(MP(t,e).map(wP)).pipe(St(xP))}}(SP(n)):null}function EP(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function k1(n){return n?Array.isArray(n)?n:[n]:[]}function km(n,e){return Array.isArray(n)?n.includes(e):n===e}function RP(n,e){const t=k1(e);return k1(n).forEach(r=>{km(t,r)||t.push(r)}),t}function IP(n,e){return k1(e).filter(t=>!km(n,t))}class NP{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=O1(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=F1(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class ha extends NP{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class $i extends NP{get formDirective(){return null}get path(){return null}}let Lm=(()=>{class n extends class PP{constructor(e){this._cd=e}is(e){var t,i,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[e])}}{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(L(ha,2))},n.\u0275dir=pe({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&zt("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[Bt]}),n})();function Oh(n,e){(function V1(n,e){const t=function TP(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(EP(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function AP(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(EP(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();Hm(e._rawValidators,r),Hm(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),function yZ(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&FP(n,e)})}(n,e),function wZ(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function bZ(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&FP(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function vZ(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function Hm(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function FP(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function z1(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const Fh="VALID",Gm="INVALID",yu="PENDING",kh="DISABLED";function W1(n){return(Wm(n)?n.validators:n)||null}function VP(n){return Array.isArray(n)?O1(n):n||null}function j1(n,e){return(Wm(e)?e.asyncValidators:n)||null}function UP(n){return Array.isArray(n)?F1(n):n||null}function Wm(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const $1=n=>n instanceof Y1;function zP(n){return(n=>n instanceof jP)(n)?n.value:n.getRawValue()}function GP(n,e){const t=$1(n),i=n.controls;if(!(t?Object.keys(i):i).length)throw new Et(1e3,"");if(!i[e])throw new Et(1001,"")}function WP(n,e){$1(n),n._forEachChild((i,r)=>{if(void 0===e[r])throw new Et(1002,"")})}class q1{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=VP(this._rawValidators),this._composedAsyncValidatorFn=UP(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Fh}get invalid(){return this.status===Gm}get pending(){return this.status==yu}get disabled(){return this.status===kh}get enabled(){return this.status!==kh}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=VP(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=UP(e)}addValidators(e){this.setValidators(RP(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(RP(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(IP(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(IP(e,this._rawAsyncValidators))}hasValidator(e){return km(this._rawValidators,e)}hasAsyncValidator(e){return km(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=yu,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=kh,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Fh,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Fh||this.status===yu)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?kh:Fh}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=yu,this._hasOwnPendingAsyncValidator=!0;const t=wP(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function DZ(n,e,t){if(null==e||(Array.isArray(e)||(e=e.split(t)),Array.isArray(e)&&0===e.length))return null;let i=n;return e.forEach(r=>{i=$1(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(n=>n instanceof EZ)(i)&&i.at(r)||null}),i}(this,e,".")}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new et,this.statusChanges=new et}_calculateStatus(){return this._allControlsDisabled()?kh:this.errors?Gm:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yu)?yu:this._anyControlsHaveStatus(Gm)?Gm:Fh}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Wm(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class jP extends q1{constructor(e=null,t,i){super(W1(t),j1(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Wm(t)&&t.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){z1(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){z1(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class Y1 extends q1{constructor(e,t,i){super(W1(t),j1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){WP(this,e),Object.keys(e).forEach(i=>{GP(this,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=zP(t),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const i=this.controls[t];if(this.contains(t)&&e(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,i)=>((t.enabled||this.disabled)&&(e[i]=t.value),e))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class EZ extends q1{constructor(e,t,i){super(W1(t),j1(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){WP(this,e),e.forEach((i,r)=>{GP(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>zP(e))}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((t,i)=>!!i._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const RZ={provide:ha,useExisting:It(()=>Bh)},YP=(()=>Promise.resolve(null))();let Bh=(()=>{class n extends ha{constructor(t,i,r,s,o){super(),this._changeDetectorRef=o,this.control=new jP,this._registered=!1,this.update=new et,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function H1(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===vu?t=s:function SZ(n){return Object.getPrototypeOf(n.constructor)===al}(s)?i=s:r=s}),r||i||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function U1(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Oh(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){YP.then(()=>{var i;this.control.setValue(t,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=""===i||i&&"false"!==i;YP.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(t){return this._parent?function Vm(n,e){return[...e.path,n]}(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)(L($i,9),L(Pi,10),L(da,10),L(Lr,10),L(Tr,8))},n.\u0275dir=pe({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[en([RZ]),Bt,ki]}),n})();const NZ={provide:Lr,useExisting:It(()=>X1),multi:!0};let X1=(()=>{class n extends al{writeValue(t){this.setProperty("value",null==t?"":t)}registerOnChange(t){this.onChange=i=>{t(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=Di(n)))(i||n)}}(),n.\u0275dir=pe({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,i){1&t&&Qe("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[en([NZ]),Bt]}),n})(),ZP=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({}),n})(),nX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[ZP]]}),n})(),fO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[nX]}),n})();Math,Math,Math;const fK=["*"],IK=["dialog"],NK=["ngbNavOutlet",""];function PK(n,e){}const OK=function(n){return{$implicit:n}};function FK(n,e){if(1&n&&(Ee(0,"div",2),Oe(1,PK,0,0,"ng-template",3),Ae()),2&n){const t=He().$implicit,i=He();ce("item",t)("nav",i.nav)("role",i.paneRole),oe(1),ce("ngTemplateOutlet",(null==t.contentTpl?null:t.contentTpl.templateRef)||null)("ngTemplateOutletContext",ap(5,OK,t.active||i.isPanelTransitioning(t)))}}function kK(n,e){if(1&n&&Oe(0,FK,2,7,"div",1),2&n){const t=e.$implicit,i=He();ce("ngIf",t.isPanelInDom()||i.isPanelTransitioning(t))}}function fw(n){return"string"==typeof n}function ul(n){return null!=n}function Du(n){return(n||document.body).getBoundingClientRect()}const RO={animation:!0,transitionTimerDelayMs:5},DJ=()=>{},{transitionTimerDelayMs:CJ}=RO,jh=new Map,qi=(n,e,t,i)=>{let r=i.context||{};const s=jh.get(e);if(s)switch(i.runningTransition){case"continue":return Vr;case"stop":n.run(()=>s.transition$.complete()),r=Object.assign(s.context,r),jh.delete(e)}const o=t(e,i.animation,r)||DJ;if(!i.animation||"none"===window.getComputedStyle(e).transitionProperty)return n.run(()=>o()),st(void 0).pipe(function MJ(n){return e=>new Kt(t=>e.subscribe({next:o=>n.run(()=>t.next(o)),error:o=>n.run(()=>t.error(o)),complete:()=>n.run(()=>t.complete())}))}(n));const a=new on,l=new on,c=a.pipe(function JY(...n){return e=>Id(e,st(...n))}(!0));jh.set(e,{transition$:a,complete:()=>{l.next(),l.complete()},context:r});const u=function SJ(n){const{transitionDelay:e,transitionDuration:t}=window.getComputedStyle(n);return 1e3*(parseFloat(e)+parseFloat(t))}(e);return n.runOutsideAngular(()=>{const d=ji(e,"transitionend").pipe(oi(c),hr(({target:f})=>f===e));(function aP(...n){return 1===(n=oP(n)).length?xi(n[0]):new Kt(function KY(n){return e=>{let t=[];for(let i=0;t&&!e.closed&&i<n.length;i++)t.push(xi(n[i]).subscribe(an(e,r=>{if(t){for(let s=0;s<t.length;s++)s!==i&&t[s].unsubscribe();t=null}e.next(r)})))}}(n))})(function R1(n=0,e,t=RY){let i=-1;return null!=e&&(qw(e)?t=e:i=e),new Kt(r=>{let s=function ZY(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(u+CJ).pipe(oi(c)),d,l).pipe(oi(c)).subscribe(()=>{jh.delete(e),n.run(()=>{o(),a.next(),a.complete()})})}),a.asObservable()};let Xm=(()=>{class n{constructor(){this.animation=RO.animation}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),kO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),LO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),VO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({}),n})(),zO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),GO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({}),n})();var ai=(()=>{return(n=ai||(ai={}))[n.Tab=9]="Tab",n[n.Enter=13]="Enter",n[n.Escape=27]="Escape",n[n.Space=32]="Space",n[n.PageUp=33]="PageUp",n[n.PageDown=34]="PageDown",n[n.End=35]="End",n[n.Home=36]="Home",n[n.ArrowLeft=37]="ArrowLeft",n[n.ArrowUp=38]="ArrowUp",n[n.ArrowRight=39]="ArrowRight",n[n.ArrowDown=40]="ArrowDown",ai;var n})();"undefined"!=typeof navigator&&navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const jO=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function $O(n){const e=Array.from(n.querySelectorAll(jO)).filter(t=>-1!==t.tabIndex);return[e[0],e[e.length-1]]}new Date(1882,10,12),new Date(2174,10,25);let e2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi,fO]]}),n})(),s2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({}),n})();class pl{constructor(e,t,i){this.nodes=e,this.viewRef=t,this.componentRef=i}}let yQ=(()=>{class n{constructor(t,i){this._el=t,this._zone=i}ngOnInit(){this._zone.onStable.asObservable().pipe(fi(1)).subscribe(()=>{qi(this._zone,this._el.nativeElement,(t,i)=>{i&&Du(t),t.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return qi(this._zone,this._el.nativeElement,({classList:t})=>t.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return n.\u0275fac=function(t){return new(t||n)(L(qt),L(dn))},n.\u0275cmp=ln({type:n,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(t,i){2&t&&(Oo("modal-backdrop"+(i.backdropClass?" "+i.backdropClass:"")),zt("show",!i.animation)("fade",i.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})();class o2{close(e){}dismiss(e){}}class bQ{constructor(e,t,i,r){this._windowCmptRef=e,this._contentRef=t,this._backdropCmptRef=i,this._beforeDismiss=r,this._closed=new on,this._dismissed=new on,this._hidden=new on,e.instance.dismissEvent.subscribe(s=>{this.dismiss(s)}),this.result=new Promise((s,o)=>{this._resolve=s,this._reject=o}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(oi(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(oi(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(e){this._windowCmptRef&&(this._closed.next(e),this._resolve(e),this._removeModalElements())}_dismiss(e){this._dismissed.next(e),this._reject(e),this._removeModalElements()}dismiss(e){if(this._windowCmptRef)if(this._beforeDismiss){const t=this._beforeDismiss();!function AO(n){return n&&n.then}(t)?!1!==t&&this._dismiss(e):t.then(i=>{!1!==i&&this._dismiss(e)},()=>{})}else this._dismiss(e)}_removeModalElements(){const e=this._windowCmptRef.instance.hide(),t=this._backdropCmptRef?this._backdropCmptRef.instance.hide():st(void 0);e.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),t.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),Om(e,t).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var Zh=(()=>{return(n=Zh||(Zh={}))[n.BACKDROP_CLICK=0]="BACKDROP_CLICK",n[n.ESC=1]="ESC",Zh;var n})();let wQ=(()=>{class n{constructor(t,i,r){this._document=t,this._elRef=i,this._zone=r,this._closed$=new on,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new et,this.shown=new on,this.hidden=new on}get fullscreenClass(){return!0===this.fullscreen?" modal-fullscreen":fw(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(t){this.dismissEvent.emit(t)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(fi(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:t}=this._elRef,i={animation:this.animation,runningTransition:"stop"},o=Om(qi(this._zone,t,()=>t.classList.remove("show"),i),qi(this._zone,this._dialogEl.nativeElement,()=>{},i));return o.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),o}_show(){const t={animation:this.animation,runningTransition:"continue"};Om(qi(this._zone,this._elRef.nativeElement,(s,o)=>{o&&Du(s),s.classList.add("show")},t),qi(this._zone,this._dialogEl.nativeElement,()=>{},t)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:t}=this._elRef;this._zone.runOutsideAngular(()=>{ji(t,"keydown").pipe(oi(this._closed$),hr(r=>r.which===ai.Escape)).subscribe(r=>{this.keyboard?requestAnimationFrame(()=>{r.defaultPrevented||this._zone.run(()=>this.dismiss(Zh.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;ji(this._dialogEl.nativeElement,"mousedown").pipe(oi(this._closed$),zi(()=>i=!1),to(()=>ji(t,"mouseup").pipe(oi(this._closed$),fi(1))),hr(({target:r})=>t===r)).subscribe(()=>{i=!0}),ji(t,"click").pipe(oi(this._closed$)).subscribe(({target:r})=>{t===r&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(Zh.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:t}=this._elRef;if(!t.contains(document.activeElement)){const i=t.querySelector("[ngbAutofocus]"),r=$O(t)[0];(i||r||t).focus()}}_restoreFocus(){const t=this._document.body,i=this._elWithFocus;let r;r=i&&i.focus&&t.contains(i)?i:t,this._zone.runOutsideAngular(()=>{setTimeout(()=>r.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&qi(this._zone,this._elRef.nativeElement,({classList:t})=>(t.add("modal-static"),()=>t.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return n.\u0275fac=function(t){return new(t||n)(L(vi),L(qt),L(dn))},n.\u0275cmp=ln({type:n,selectors:[["ngb-modal-window"]],viewQuery:function(t,i){if(1&t&&oc(IK,7),2&t){let r;tn(r=nn())&&(i._dialogEl=r.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(t,i){2&t&&($t("aria-modal",!0)("aria-labelledby",i.ariaLabelledBy)("aria-describedby",i.ariaDescribedBy),Oo("modal d-block"+(i.windowClass?" "+i.windowClass:"")),zt("fade",i.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:fK,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(t,i){1&t&&(hd(),Ee(0,"div",0,1)(2,"div",2),fd(3),Ae()()),2&t&&Oo("modal-dialog"+(i.size?" modal-"+i.size:"")+(i.centered?" modal-dialog-centered":"")+i.fullscreenClass+(i.scrollable?" modal-dialog-scrollable":"")+(i.modalDialogClass?" "+i.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2}),n})(),xQ=(()=>{class n{constructor(t){this._document=t}hide(){const t=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),i=this._document.body,r=i.style,{overflow:s,paddingRight:o}=r;if(t>0){const a=parseFloat(window.getComputedStyle(i).paddingRight);r.paddingRight=`${a+t}px`}return r.overflow="hidden",()=>{t>0&&(r.paddingRight=o),r.overflow=s}}}return n.\u0275fac=function(t){return new(t||n)(Ne(vi))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),MQ=(()=>{class n{constructor(t,i,r,s,o,a){this._applicationRef=t,this._injector=i,this._document=r,this._scrollBar=s,this._rendererFactory=o,this._ngZone=a,this._activeWindowCmptHasChanged=new on,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","scrollable","size","windowClass","modalDialogClass"],this._windowCmpts=[],this._activeInstances=new et,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const l=this._windowCmpts[this._windowCmpts.length-1];((n,e,t,i=!1)=>{this._ngZone.runOutsideAngular(()=>{const r=ji(e,"focusin").pipe(oi(t),St(s=>s.target));ji(e,"keydown").pipe(oi(t),hr(s=>s.which===ai.Tab),N1(r)).subscribe(([s,o])=>{const[a,l]=$O(e);(o===a||o===e)&&s.shiftKey&&(l.focus(),s.preventDefault()),o===l&&!s.shiftKey&&(a.focus(),s.preventDefault())}),i&&ji(e,"click").pipe(oi(t),N1(r),St(s=>s[1])).subscribe(s=>s.focus())})})(0,l.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(l.location.nativeElement)}})}_restoreScrollBar(){const t=this._scrollBarRestoreFn;t&&(this._scrollBarRestoreFn=null,t())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(t,i,r,s){const o=s.container instanceof HTMLElement?s.container:ul(s.container)?this._document.querySelector(s.container):this._document.body,a=this._rendererFactory.createRenderer(null,null);if(!o)throw new Error(`The specified modal container "${s.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const l=new o2,c=this._getContentRef(t,s.injector||i,r,l,s);let u=!1!==s.backdrop?this._attachBackdrop(t,o):void 0,d=this._attachWindowComponent(t,o,c),h=new bQ(d,c,u,s.beforeDismiss);return this._registerModalRef(h),this._registerWindowCmpt(d),h.hidden.pipe(fi(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(a.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),l.close=f=>{h.close(f)},l.dismiss=f=>{h.dismiss(f)},this._applyWindowOptions(d.instance,s),1===this._modalRefs.length&&a.addClass(this._document.body,"modal-open"),u&&u.instance&&(this._applyBackdropOptions(u.instance,s),u.changeDetectorRef.detectChanges()),d.changeDetectorRef.detectChanges(),h}get activeInstances(){return this._activeInstances}dismissAll(t){this._modalRefs.forEach(i=>i.dismiss(t))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(t,i){let s=t.resolveComponentFactory(yQ).create(this._injector);return this._applicationRef.attachView(s.hostView),i.appendChild(s.location.nativeElement),s}_attachWindowComponent(t,i,r){let o=t.resolveComponentFactory(wQ).create(this._injector,r.nodes);return this._applicationRef.attachView(o.hostView),i.appendChild(o.location.nativeElement),o}_applyWindowOptions(t,i){this._windowAttributes.forEach(r=>{ul(i[r])&&(t[r]=i[r])})}_applyBackdropOptions(t,i){this._backdropAttributes.forEach(r=>{ul(i[r])&&(t[r]=i[r])})}_getContentRef(t,i,r,s,o){return r?r instanceof xn?this._createFromTemplateRef(r,s):fw(r)?this._createFromString(r):this._createFromComponent(t,i,r,s,o):new pl([])}_createFromTemplateRef(t,i){const s=t.createEmbeddedView({$implicit:i,close(o){i.close(o)},dismiss(o){i.dismiss(o)}});return this._applicationRef.attachView(s),new pl([s.rootNodes],s)}_createFromString(t){const i=this._document.createTextNode(`${t}`);return new pl([[i]])}_createFromComponent(t,i,r,s,o){const a=t.resolveComponentFactory(r),l=mi.create({providers:[{provide:o2,useValue:s}],parent:i}),c=a.create(l),u=c.location.nativeElement;return o.scrollable&&u.classList.add("component-host-scrollable"),this._applicationRef.attachView(c.hostView),new pl([[u]],c.hostView,c)}_setAriaHidden(t){const i=t.parentElement;i&&t!==this._document.body&&(Array.from(i.children).forEach(r=>{r!==t&&"SCRIPT"!==r.nodeName&&(this._ariaHiddenValues.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((t,i)=>{t?i.setAttribute("aria-hidden",t):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(t){const i=()=>{const r=this._modalRefs.indexOf(t);r>-1&&(this._modalRefs.splice(r,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(t),this._activeInstances.emit(this._modalRefs),t.result.then(i,i)}_registerWindowCmpt(t){this._windowCmpts.push(t),this._activeWindowCmptHasChanged.next(),t.onDestroy(()=>{const i=this._windowCmpts.indexOf(t);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}}return n.\u0275fac=function(t){return new(t||n)(Ne(fp),Ne(mi),Ne(vi),Ne(xQ),Ne(bv),Ne(dn))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),SQ=(()=>{class n{constructor(t){this._ngbConfig=t,this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(t){this._animation=t}}return n.\u0275fac=function(t){return new(t||n)(Ne(Xm))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),DQ=(()=>{class n{constructor(t,i,r,s){this._moduleCFR=t,this._injector=i,this._modalStack=r,this._config=s}open(t,i={}){const r=Object.assign(Object.assign(Object.assign({},this._config),{animation:this._config.animation}),i);return this._modalStack.open(this._moduleCFR,this._injector,t,r)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(t){this._modalStack.dismissAll(t)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return n.\u0275fac=function(t){return new(t||n)(Ne(ic),Ne(mi),Ne(MQ),Ne(SQ))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),a2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({providers:[DQ]}),n})(),CQ=(()=>{class n{constructor(t){this._ngbConfig=t,this.destroyOnHide=!0,this.orientation="horizontal",this.roles="tablist",this.keyboard=!1}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(t){this._animation=t}}return n.\u0275fac=function(t){return new(t||n)(Ne(Xm))},n.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const l2=n=>ul(n)&&""!==n;let EQ=0,ww=(()=>{class n{constructor(t){this.templateRef=t}}return n.\u0275fac=function(t){return new(t||n)(L(xn))},n.\u0275dir=pe({type:n,selectors:[["ng-template","ngbNavContent",""]]}),n})(),r_=(()=>{class n{constructor(t,i){this.elementRef=i,this.disabled=!1,this.shown=new et,this.hidden=new et,this._nav=t}ngAfterContentChecked(){this.contentTpl=this.contentTpls.first}ngOnInit(){ul(this.domId)||(this.domId="ngb-nav-"+EQ++)}get active(){return this._nav.activeId===this.id}get id(){return l2(this._id)?this._id:this.domId}get panelDomId(){return`${this.domId}-panel`}isPanelInDom(){return(ul(this.destroyOnHide)?!this.destroyOnHide:!this._nav.destroyOnHide)||this.active}}return n.\u0275fac=function(t){return new(t||n)(L(It(()=>s_)),L(qt))},n.\u0275dir=pe({type:n,selectors:[["","ngbNavItem",""]],contentQueries:function(t,i,r){if(1&t&&Rn(r,ww,4),2&t){let s;tn(s=nn())&&(i.contentTpls=s)}},hostVars:2,hostBindings:function(t,i){2&t&&zt("nav-item",!0)},inputs:{destroyOnHide:"destroyOnHide",disabled:"disabled",domId:"domId",_id:["ngbNavItem","_id"]},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbNavItem"]}),n})(),s_=(()=>{class n{constructor(t,i,r,s){this.role=t,this._cd=r,this._document=s,this.activeIdChange=new et,this.shown=new et,this.hidden=new et,this.destroy$=new on,this.navItemChange$=new on,this.navChange=new et,this.animation=i.animation,this.destroyOnHide=i.destroyOnHide,this.orientation=i.orientation,this.roles=i.roles,this.keyboard=i.keyboard}click(t){t.disabled||this._updateActiveId(t.id)}onKeyDown(t){if("tablist"!==this.roles||!this.keyboard)return;const i=t.which,r=this.links.filter(a=>!a.navItem.disabled),{length:s}=r;let o=-1;if(r.forEach((a,l)=>{a.elRef.nativeElement===this._document.activeElement&&(o=l)}),s){switch(i){case ai.ArrowLeft:if("vertical"===this.orientation)return;o=(o-1+s)%s;break;case ai.ArrowRight:if("vertical"===this.orientation)return;o=(o+1)%s;break;case ai.ArrowDown:if("horizontal"===this.orientation)return;o=(o+1)%s;break;case ai.ArrowUp:if("horizontal"===this.orientation)return;o=(o-1+s)%s;break;case ai.Home:o=0;break;case ai.End:o=s-1}"changeWithArrows"===this.keyboard&&this.select(r[o].navItem.id),r[o].elRef.nativeElement.focus(),t.preventDefault()}}select(t){this._updateActiveId(t,!1)}ngAfterContentInit(){if(!ul(this.activeId)){const t=this.items.first?this.items.first.id:null;l2(t)&&(this._updateActiveId(t,!1),this._cd.detectChanges())}this.items.changes.pipe(oi(this.destroy$)).subscribe(()=>this._notifyItemChanged(this.activeId))}ngOnChanges({activeId:t}){t&&!t.firstChange&&this._notifyItemChanged(t.currentValue)}ngOnDestroy(){this.destroy$.next()}_updateActiveId(t,i=!0){if(this.activeId!==t){let r=!1;i&&this.navChange.emit({activeId:this.activeId,nextId:t,preventDefault:()=>{r=!0}}),r||(this.activeId=t,this.activeIdChange.emit(t),this._notifyItemChanged(t))}}_notifyItemChanged(t){this.navItemChange$.next(this._getItemById(t))}_getItemById(t){return this.items&&this.items.find(i=>i.id===t)||null}}return n.\u0275fac=function(t){return new(t||n)(Ma("role"),L(CQ),L(Tr),L(vi))},n.\u0275dir=pe({type:n,selectors:[["","ngbNav",""]],contentQueries:function(t,i,r){if(1&t&&(Rn(r,r_,4),Rn(r,xw,5)),2&t){let s;tn(s=nn())&&(i.items=s),tn(s=nn())&&(i.links=s)}},hostVars:6,hostBindings:function(t,i){1&t&&Qe("keydown.arrowLeft",function(s){return i.onKeyDown(s)})("keydown.arrowRight",function(s){return i.onKeyDown(s)})("keydown.arrowDown",function(s){return i.onKeyDown(s)})("keydown.arrowUp",function(s){return i.onKeyDown(s)})("keydown.Home",function(s){return i.onKeyDown(s)})("keydown.End",function(s){return i.onKeyDown(s)}),2&t&&($t("aria-orientation","vertical"===i.orientation&&"tablist"===i.roles?"vertical":void 0)("role",i.role?i.role:i.roles?"tablist":void 0),zt("nav",!0)("flex-column","vertical"===i.orientation))},inputs:{activeId:"activeId",animation:"animation",destroyOnHide:"destroyOnHide",orientation:"orientation",roles:"roles",keyboard:"keyboard"},outputs:{activeIdChange:"activeIdChange",shown:"shown",hidden:"hidden",navChange:"navChange"},exportAs:["ngbNav"],features:[ki]}),n})(),xw=(()=>{class n{constructor(t,i,r,s){this.role=t,this.navItem=i,this.nav=r,this.elRef=s}hasNavItemClass(){return this.navItem.elementRef.nativeElement.nodeType===Node.COMMENT_NODE}}return n.\u0275fac=function(t){return new(t||n)(Ma("role"),L(r_),L(s_),L(qt))},n.\u0275dir=pe({type:n,selectors:[["a","ngbNavLink",""]],hostAttrs:["href",""],hostVars:14,hostBindings:function(t,i){1&t&&Qe("click",function(s){return i.nav.click(i.navItem),s.preventDefault()}),2&t&&(Fo("id",i.navItem.domId),$t("role",i.role?i.role:i.nav.roles?"tab":void 0)("tabindex",i.navItem.disabled?-1:void 0)("aria-controls",i.navItem.isPanelInDom()?i.navItem.panelDomId:null)("aria-selected",i.navItem.active)("aria-disabled",i.navItem.disabled),zt("nav-link",!0)("nav-item",i.hasNavItemClass())("active",i.navItem.active)("disabled",i.navItem.disabled))}}),n})();const TQ=({classList:n})=>(n.remove("show"),()=>n.remove("active")),AQ=(n,e)=>{e&&Du(n),n.classList.add("show")};let Mw=(()=>{class n{constructor(t){this.elRef=t}}return n.\u0275fac=function(t){return new(t||n)(L(qt))},n.\u0275dir=pe({type:n,selectors:[["","ngbNavPane",""]],hostAttrs:[1,"tab-pane"],hostVars:5,hostBindings:function(t,i){2&t&&(Fo("id",i.item.panelDomId),$t("role",i.role?i.role:i.nav.roles?"tabpanel":void 0)("aria-labelledby",i.item.domId),zt("fade",i.nav.animation))},inputs:{item:"item",nav:"nav",role:"role"}}),n})(),c2=(()=>{class n{constructor(t,i){this._cd=t,this._ngZone=i,this._activePane=null}isPanelTransitioning(t){var i;return(null===(i=this._activePane)||void 0===i?void 0:i.item)===t}ngAfterViewInit(){var t;this._updateActivePane(),this.nav.navItemChange$.pipe(oi(this.nav.destroy$),Op((null===(t=this._activePane)||void 0===t?void 0:t.item)||null),function I1(n,e=zs){return n=null!=n?n:QY,Cn((t,i)=>{let r,s=!0;t.subscribe(an(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),function iZ(n){return hr((e,t)=>n<=t)}(1)).subscribe(i=>{const r={animation:this.nav.animation,runningTransition:"stop"};this._cd.detectChanges(),this._activePane?qi(this._ngZone,this._activePane.elRef.nativeElement,TQ,r).subscribe(()=>{var s;const o=null===(s=this._activePane)||void 0===s?void 0:s.item;this._activePane=this._getPaneForItem(i),this._cd.markForCheck(),this._activePane&&(this._activePane.elRef.nativeElement.classList.add("active"),qi(this._ngZone,this._activePane.elRef.nativeElement,AQ,r).subscribe(()=>{i&&(i.shown.emit(),this.nav.shown.emit(i.id))})),o&&(o.hidden.emit(),this.nav.hidden.emit(o.id))}):this._updateActivePane()})}_updateActivePane(){var t,i;this._activePane=this._getActivePane(),null===(t=this._activePane)||void 0===t||t.elRef.nativeElement.classList.add("show"),null===(i=this._activePane)||void 0===i||i.elRef.nativeElement.classList.add("active")}_getPaneForItem(t){return this._panes&&this._panes.find(i=>i.item===t)||null}_getActivePane(){return this._panes&&this._panes.find(t=>t.item.active)||null}}return n.\u0275fac=function(t){return new(t||n)(L(Tr),L(dn))},n.\u0275cmp=ln({type:n,selectors:[["","ngbNavOutlet",""]],viewQuery:function(t,i){if(1&t&&oc(Mw,5),2&t){let r;tn(r=nn())&&(i._panes=r)}},hostVars:2,hostBindings:function(t,i){2&t&&zt("tab-content",!0)},inputs:{paneRole:"paneRole",nav:["ngbNavOutlet","nav"]},attrs:NK,decls:1,vars:1,consts:[["ngFor","",3,"ngForOf"],["ngbNavPane","",3,"item","nav","role",4,"ngIf"],["ngbNavPane","",3,"item","nav","role"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){1&t&&Oe(0,kK,1,1,"ng-template",0),2&t&&ce("ngForOf",i.nav.items)},directives:[Ss,Bo,Mw,Pa],encapsulation:2,changeDetection:0}),n})(),u2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),v2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),b2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),w2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),x2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),M2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),S2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),D2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({}),n})();new ft("live announcer delay",{providedIn:"root",factory:function BQ(){return 100}});let C2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[Qi]]}),n})(),E2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({}),n})();const VQ=[kO,LO,VO,zO,GO,e2,s2,a2,u2,E2,v2,b2,w2,x2,M2,S2,D2,C2];let UQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[VQ,kO,LO,VO,zO,GO,e2,s2,a2,u2,E2,v2,b2,w2,x2,M2,S2,D2,C2]}),n})(),Sw=(()=>{class n{ngOnInit(){this.icon=n.findIcon(this.type,this.name)}static findIcon(t,i){switch(t){case"tab":return n.findTabIcon(i);case"object":return n.findObjectIcon(i);case"component":return n.findComponentIcon(i);default:return n.defaultIcon}}static findTabIcon(t){switch(t){case"Hierarchy":return"fa-list";case"Scene":return n.findObjectIcon(el.name);case"Inspector":return"fa-circle-info";case"Project":return"fa-folder";default:return n.defaultIcon}}static findObjectIcon(t){switch(t){case xh.name:return"fa-lightbulb";case Zn.name:return"fa-camera";case po.name:return"fa-layer-group";case el.name:return"fa-image";case Jc.name:return"fa-bone";default:return n.defaultIcon}}static findComponentIcon(t){return n.defaultIcon}}return n.defaultIcon="fa-question",n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["icon"]],inputs:{type:"type",name:"name"},decls:1,vars:2,consts:[[1,"fa-solid","fa-fw","me-1",3,"ngClass","title"]],template:function(t,i){1&t&&un(0,"i",0),2&t&&(Ca("title",i.name),ce("ngClass",i.icon))},directives:[uy],encapsulation:2}),n})();function HQ(n,e){1&n&&ud(0)}function zQ(n,e){1&n&&Oe(0,HQ,1,0,"ng-container",10),2&n&&ce("ngTemplateOutlet",He().$implicit.templateRef)}function GQ(n,e){if(1&n&&(Ee(0,"li",6)(1,"a",7),un(2,"icon",8),_i(3),Ae(),Oe(4,zQ,1,1,"ng-template",9),Ae()),2&n){const t=e.$implicit;Ca("ngbNavItem",t.name),ce("destroyOnHide",t.destroyOnHide),oe(2),ce("type","tab")("name",t.name),oe(1),Ea("",t.name," ")}}let T2=(()=>{class n{constructor(t){this.templateRef=t,this.destroyOnHide=!0}}return n.\u0275fac=function(t){return new(t||n)(L(xn))},n.\u0275dir=pe({type:n,selectors:[["","tab-link",""]],inputs:{name:"name",destroyOnHide:"destroyOnHide"}}),n})(),WQ=(()=>{class n{ngAfterContentInit(){this.activeTab=this.links.first.name}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["tab-set"]],contentQueries:function(t,i,r){if(1&t&&Rn(r,T2,4),2&t){let s;tn(s=nn())&&(i.links=s)}},decls:6,vars:2,consts:[[1,"d-flex","flex-column","h-100","w-100"],[1,"flex-shrink-1","bg-light"],["ngbNav","",1,"nav-tabs","xs","fs-xs"],["nav","ngbNav"],[3,"ngbNavItem","destroyOnHide",4,"ngFor","ngForOf"],[1,"h-100","w-100","overflow-hidden",3,"ngbNavOutlet"],[3,"ngbNavItem","destroyOnHide"],["ngbNavLink","",1,"px-2","py-1"],[3,"type","name"],["ngbNavContent",""],[4,"ngTemplateOutlet"]],template:function(t,i){if(1&t&&(Ee(0,"div",0)(1,"div",1)(2,"ul",2,3),Oe(4,GQ,5,5,"li",4),Ae()(),un(5,"div",5),Ae()),2&t){const r=Xi(3);oe(4),ce("ngForOf",i.links),oe(1),ce("ngbNavOutlet",r)}},directives:[s_,Ss,r_,xw,Sw,ww,Pa,c2],encapsulation:2}),n})();const jQ=function(n,e){return{"bg-primary":n,"text-white":e}};let $Q=(()=>{class n{constructor(t){this.rin=t,this.expanded=!0}toggleExpanded(t){t.stopPropagation(),this.expanded=!this.expanded}select(){this.rin.setSelection([this.node])||this.rin.focus(this.node)}}return n.\u0275fac=function(t){return new(t||n)(L(mu))},n.\u0275cmp=ln({type:n,selectors:[["object-node"]],inputs:{node:"node",depth:"depth",selected:"selected"},decls:7,vars:16,consts:[[1,"text-nowrap",2,"cursor","pointer",3,"click"],[3,"click"],[1,"fa-solid","fa-caret-down","fa-fw"],[1,"fa-solid","fa-caret-right","fa-fw"],[3,"type","name"]],template:function(t,i){1&t&&(Ee(0,"div",0),Qe("click",function(){return i.select()}),Ee(1,"span",1),Qe("click",function(s){return i.toggleExpanded(s)}),un(2,"i",2)(3,"i",3),Ae(),un(4,"icon",4),Ee(5,"span"),_i(6),Ae()()),2&t&&(Oo(Aa(13,jQ,i.selected,i.selected)),oe(1),pd("margin-left",16*i.depth,"px"),zt("invisible",0===i.node.children.length),oe(1),zt("d-none",!i.expanded),oe(1),zt("d-none",i.expanded),oe(1),ce("type","object")("name",i.node.type),oe(2),ec(i.node.name?i.node.name:"("+i.node.type+")"))},directives:[Sw],encapsulation:2}),n})();function qQ(n,e){1&n&&ud(0)}const YQ=function(n,e,t){return{$implicit:n,depth:e,selected:t}};function ZQ(n,e){if(1&n&&(Xs(0),Oe(1,qQ,1,0,"ng-container",6),Ks()),2&n){const t=e.$implicit,i=He().depth,r=He(),s=Xi(1);oe(1),ce("ngTemplateOutlet",s)("ngTemplateOutletContext",lp(2,YQ,t,i+1,r.selection.includes(t)))}}function XQ(n,e){if(1&n&&(un(0,"object-node",3,4),Ee(2,"span",5),Oe(3,ZQ,2,6,"ng-container",2),Ae()),2&n){const t=e.$implicit,i=e.depth,r=e.selected,s=Xi(1);ce("node",t)("depth",i)("selected",r),oe(2),ce("hidden",!s.expanded),oe(1),ce("ngForOf",t.children)}}function KQ(n,e){1&n&&ud(0)}const JQ=function(n,e){return{$implicit:n,depth:0,selected:e}};function QQ(n,e){if(1&n&&(Xs(0),Oe(1,KQ,1,0,"ng-container",6),Ks()),2&n){const t=e.$implicit,i=He(),r=Xi(1);oe(1),ce("ngTemplateOutlet",r)("ngTemplateOutletContext",Aa(2,JQ,t,i.selection.includes(t)))}}let eee=(()=>{class n{constructor(t){this.rin=t}ngOnInit(){this.scenesSub=this.rin.scenes$.subscribe(t=>this.onScenesUpdated(t)),this.selectionSub=this.rin.selection$.subscribe(t=>this.onSelectionUpdated(t))}ngOnDestroy(){this.scenesSub.unsubscribe(),this.selectionSub.unsubscribe()}onScenesUpdated(t){this.scenes=t}onSelectionUpdated(t){this.selection=t}}return n.\u0275fac=function(t){return new(t||n)(L(mu))},n.\u0275cmp=ln({type:n,selectors:[["scene-tree-view"]],decls:4,vars:1,consts:[["tree",""],[1,"h-100","w-100","fs-xs","overflow-y-only"],[4,"ngFor","ngForOf"],[3,"node","depth","selected"],["item",""],[3,"hidden"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){1&t&&(Oe(0,XQ,4,5,"ng-template",null,0,Xr),Ee(2,"div",1),Oe(3,QQ,2,5,"ng-container",2),Ae()),2&t&&(oe(3),ce("ngForOf",i.scenes))},directives:[$Q,Ss,Pa],encapsulation:2}),n})();const A2={type:"change"},Dw={type:"start"},R2={type:"end"};class tee extends Wo{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new M,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(T){T.addEventListener("keydown",Dt),this._domElementKeyEvents=T},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(A2),i.update(),s=r.NONE},this.update=function(){const T=new M,ae=(new Ft).setFromUnitVectors(e.up,new M(0,1,0)),ke=ae.clone().invert(),_e=new M,O=new Ft,fe=2*Math.PI;return function(){const Ye=i.object.position;T.copy(Ye).sub(i.target),T.applyQuaternion(ae),a.setFromVector3(T),i.autoRotate&&s===r.NONE&&B(function C(){return 2*Math.PI/60/60*i.autoRotateSpeed}()),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let De=i.minAzimuthAngle,Be=i.maxAzimuthAngle;return isFinite(De)&&isFinite(Be)&&(De<-Math.PI?De+=fe:De>Math.PI&&(De-=fe),Be<-Math.PI?Be+=fe:Be>Math.PI&&(Be-=fe),a.theta=De<=Be?Math.max(De,Math.min(Be,a.theta)):a.theta>(De+Be)/2?Math.max(De,a.theta):Math.min(Be,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),T.setFromSpherical(a),T.applyQuaternion(ke),Ye.copy(i.target).add(T),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(d||_e.distanceToSquared(i.object.position)>o||8*(1-O.dot(i.object.quaternion))>o)&&(i.dispatchEvent(A2),_e.copy(i.object.position),O.copy(i.object.quaternion),d=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",j),i.domElement.removeEventListener("pointerdown",se),i.domElement.removeEventListener("pointercancel",Xe),i.domElement.removeEventListener("wheel",At),i.domElement.removeEventListener("pointermove",Ie),i.domElement.removeEventListener("pointerup",ye),null!==i._domElementKeyEvents&&i._domElementKeyEvents.removeEventListener("keydown",Dt)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new nN,l=new nN;let c=1;const u=new M;let d=!1;const h=new K,f=new K,g=new K,p=new K,m=new K,v=new K,_=new K,y=new K,b=new K,w=[],S={};function E(){return Math.pow(.95,i.zoomSpeed)}function B(T){l.theta-=T}function N(T){l.phi-=T}const x=function(){const T=new M;return function(ke,_e){T.setFromMatrixColumn(_e,0),T.multiplyScalar(-ke),u.add(T)}}(),R=function(){const T=new M;return function(ke,_e){!0===i.screenSpacePanning?T.setFromMatrixColumn(_e,1):(T.setFromMatrixColumn(_e,0),T.crossVectors(i.object.up,T)),T.multiplyScalar(ke),u.add(T)}}(),z=function(){const T=new M;return function(ke,_e){const O=i.domElement;if(i.object.isPerspectiveCamera){T.copy(i.object.position).sub(i.target);let he=T.length();he*=Math.tan(i.object.fov/2*Math.PI/180),x(2*ke*he/O.clientHeight,i.object.matrix),R(2*_e*he/O.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(x(ke*(i.object.right-i.object.left)/i.object.zoom/O.clientWidth,i.object.matrix),R(_e*(i.object.top-i.object.bottom)/i.object.zoom/O.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function P(T){i.object.isPerspectiveCamera?c/=T:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*T)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function V(T){i.object.isPerspectiveCamera?c*=T:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/T)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function k(T){h.set(T.clientX,T.clientY)}function F(T){p.set(T.clientX,T.clientY)}function Re(){1===w.length?h.set(w[0].pageX,w[0].pageY):h.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function Me(){1===w.length?p.set(w[0].pageX,w[0].pageY):p.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function Y(){const T=w[0].pageX-w[1].pageX,ae=w[0].pageY-w[1].pageY,ke=Math.sqrt(T*T+ae*ae);_.set(0,ke)}function $e(T){if(1==w.length)f.set(T.pageX,T.pageY);else{const ke=Le(T);f.set(.5*(T.pageX+ke.x),.5*(T.pageY+ke.y))}g.subVectors(f,h).multiplyScalar(i.rotateSpeed);const ae=i.domElement;B(2*Math.PI*g.x/ae.clientHeight),N(2*Math.PI*g.y/ae.clientHeight),h.copy(f)}function le(T){if(1===w.length)m.set(T.pageX,T.pageY);else{const ae=Le(T);m.set(.5*(T.pageX+ae.x),.5*(T.pageY+ae.y))}v.subVectors(m,p).multiplyScalar(i.panSpeed),z(v.x,v.y),p.copy(m)}function Ze(T){const ae=Le(T),ke=T.pageX-ae.x,_e=T.pageY-ae.y,O=Math.sqrt(ke*ke+_e*_e);y.set(0,O),b.set(0,Math.pow(y.y/_.y,i.zoomSpeed)),P(b.y),_.copy(y)}function se(T){!1!==i.enabled&&(0===w.length&&(i.domElement.setPointerCapture(T.pointerId),i.domElement.addEventListener("pointermove",Ie),i.domElement.addEventListener("pointerup",ye)),function re(T){w.push(T)}(T),"touch"===T.pointerType?function I(T){switch(Ce(T),w.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;Re(),s=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;Me(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function ot(){i.enableZoom&&Y(),i.enablePan&&Me()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function Fe(){i.enableZoom&&Y(),i.enableRotate&&Re()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Dw)}(T):function Ge(T){let ae;switch(T.button){case 0:ae=i.mouseButtons.LEFT;break;case 1:ae=i.mouseButtons.MIDDLE;break;case 2:ae=i.mouseButtons.RIGHT;break;default:ae=-1}switch(ae){case 1:if(!1===i.enableZoom)return;(function U(T){_.set(T.clientX,T.clientY)})(T),s=r.DOLLY;break;case 0:if(T.ctrlKey||T.metaKey||T.shiftKey){if(!1===i.enablePan)return;F(T),s=r.PAN}else{if(!1===i.enableRotate)return;k(T),s=r.ROTATE}break;case 2:if(T.ctrlKey||T.metaKey||T.shiftKey){if(!1===i.enableRotate)return;k(T),s=r.ROTATE}else{if(!1===i.enablePan)return;F(T),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&i.dispatchEvent(Dw)}(T))}function Ie(T){!1!==i.enabled&&("touch"===T.pointerType?function D(T){switch(Ce(T),s){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;$e(T),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;le(T),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function Z(T){i.enableZoom&&Ze(T),i.enablePan&&le(T)})(T),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function J(T){i.enableZoom&&Ze(T),i.enableRotate&&$e(T)})(T),i.update();break;default:s=r.NONE}}(T):function Ve(T){if(!1!==i.enabled)switch(s){case r.ROTATE:if(!1===i.enableRotate)return;!function G(T){f.set(T.clientX,T.clientY),g.subVectors(f,h).multiplyScalar(i.rotateSpeed);const ae=i.domElement;B(2*Math.PI*g.x/ae.clientHeight),N(2*Math.PI*g.y/ae.clientHeight),h.copy(f),i.update()}(T);break;case r.DOLLY:if(!1===i.enableZoom)return;!function q(T){y.set(T.clientX,T.clientY),b.subVectors(y,_),b.y>0?P(E()):b.y<0&&V(E()),_.copy(y),i.update()}(T);break;case r.PAN:if(!1===i.enablePan)return;!function ee(T){m.set(T.clientX,T.clientY),v.subVectors(m,p).multiplyScalar(i.panSpeed),z(v.x,v.y),p.copy(m),i.update()}(T)}}(T))}function ye(T){me(T),0===w.length&&(i.domElement.releasePointerCapture(T.pointerId),i.domElement.removeEventListener("pointermove",Ie),i.domElement.removeEventListener("pointerup",ye)),i.dispatchEvent(R2),s=r.NONE}function Xe(T){me(T)}function At(T){!1===i.enabled||!1===i.enableZoom||s!==r.NONE||(T.preventDefault(),i.dispatchEvent(Dw),function X(T){T.deltaY<0?V(E()):T.deltaY>0&&P(E()),i.update()}(T),i.dispatchEvent(R2))}function Dt(T){!1===i.enabled||!1===i.enablePan||function xe(T){let ae=!1;switch(T.code){case i.keys.UP:z(0,i.keyPanSpeed),ae=!0;break;case i.keys.BOTTOM:z(0,-i.keyPanSpeed),ae=!0;break;case i.keys.LEFT:z(i.keyPanSpeed,0),ae=!0;break;case i.keys.RIGHT:z(-i.keyPanSpeed,0),ae=!0}ae&&(T.preventDefault(),i.update())}(T)}function j(T){!1!==i.enabled&&T.preventDefault()}function me(T){delete S[T.pointerId];for(let ae=0;ae<w.length;ae++)if(w[ae].pointerId==T.pointerId)return void w.splice(ae,1)}function Ce(T){let ae=S[T.pointerId];void 0===ae&&(ae=new K,S[T.pointerId]=ae),ae.set(T.pageX,T.pageY)}function Le(T){return S[(T.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}i.domElement.addEventListener("contextmenu",j),i.domElement.addEventListener("pointerdown",se),i.domElement.addEventListener("pointercancel",Xe),i.domElement.addEventListener("wheel",At,{passive:!1}),this.update()}}const gl=new class Yq{constructor(e,t,i=0,r=1/0){this.ray=new Ka(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new _b,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return h1(e,this,i,t),i.sort(tN),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)h1(e[r],this,i,t);return i.sort(tN),i}},tr=new M,ga=new M,wn=new Ft,I2={X:new M(1,0,0),Y:new M(0,1,0),Z:new M(0,0,1)},Cw={type:"change"},N2={type:"mouseDown"},P2={type:"mouseUp",mode:null},O2={type:"objectChange"};class F2 extends Mt{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new V2;this._gizmo=i,this.add(i);const r=new U2;this._plane=r,this.add(r);const s=this;function o(_,y){let b=y;Object.defineProperty(s,_,{get:function(){return void 0!==b?b:y},set:function(w){b!==w&&(b=w,r[_]=w,i[_]=w,s.dispatchEvent({type:_+"-changed",value:w}),s.dispatchEvent(Cw))}}),s[_]=y,r[_]=y,i[_]=y}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new M,l=new M,c=new Ft,u=new Ft,d=new M,h=new Ft,f=new M,g=new M,p=new M,v=new M;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",u),o("cameraPosition",d),o("cameraQuaternion",h),o("pointStart",f),o("pointEnd",g),o("rotationAxis",p),o("rotationAngle",0),o("eye",v),this._offset=new M,this._startNorm=new M,this._endNorm=new M,this._cameraScale=new M,this._parentPosition=new M,this._parentQuaternion=new Ft,this._parentQuaternionInv=new Ft,this._parentScale=new M,this._worldScaleStart=new M,this._worldQuaternionInv=new Ft,this._worldScale=new M,this._positionStart=new M,this._quaternionStart=new Ft,this._scaleStart=new M,this._getPointer=nee.bind(this),this._onPointerDown=ree.bind(this),this._onPointerHover=iee.bind(this),this._onPointerMove=see.bind(this),this._onPointerUp=oee.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;gl.setFromCamera(e,this.camera);const t=Ew(this._gizmo.picker[this.mode],gl);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){gl.setFromCamera(e,this.camera);const t=Ew(this._plane,gl,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,N2.mode=this.mode,this.dispatchEvent(N2)}}pointerMove(e){const t=this.axis,i=this.mode,r=this.object;let s=this.space;if("scale"===i?s="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(s="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;gl.setFromCamera(e,this.camera);const o=Ew(this._plane,gl,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===s&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===s&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===s&&(r.position.applyQuaternion(wn.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===s&&(r.parent&&r.position.add(tr.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(tr.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),ga.set(a,a,a)}else tr.copy(this.pointStart),ga.copy(this.pointEnd),tr.applyQuaternion(this._worldQuaternionInv),ga.applyQuaternion(this._worldQuaternionInv),ga.divide(tr),-1===t.search("X")&&(ga.x=1),-1===t.search("Y")&&(ga.y=1),-1===t.search("Z")&&(ga.z=1);r.scale.copy(this._scaleStart).multiply(ga),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(tr.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(tr.copy(this.rotationAxis).cross(this.eye))*a):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(I2[t]),tr.copy(I2[t]),"local"===s&&tr.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(tr.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===s&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(wn.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(wn.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(Cw),this.dispatchEvent(O2)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(P2.mode=this.mode,this.dispatchEvent(P2)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){!this.enabled||this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(Cw),this.dispatchEvent(O2),this.pointStart.copy(this.pointEnd))}getRaycaster(){return gl}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}update(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}function nee(n){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:n.button};{const e=this.domElement.getBoundingClientRect();return{x:(n.clientX-e.left)/e.width*2-1,y:-(n.clientY-e.top)/e.height*2+1,button:n.button}}}function iee(n){if(this.enabled)switch(n.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(n))}}function ree(n){!this.enabled||(document.pointerLockElement||this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(n)),this.pointerDown(this._getPointer(n)))}function see(n){!this.enabled||this.pointerMove(this._getPointer(n))}function oee(n){!this.enabled||(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(n)))}function Ew(n,e,t){const i=e.intersectObject(n,!0);for(let r=0;r<i.length;r++)if(i[r].object.visible||t)return i[r];return!1}F2.prototype.isTransformControls=!0;const o_=new _r,rn=new M(0,1,0),k2=new M(0,0,0),L2=new ue,a_=new Ft,l_=new Ft,Ls=new M,B2=new ue,Xh=new M(1,0,0),ml=new M(0,1,0),Kh=new M(0,0,1),c_=new M,Jh=new M,Qh=new M;class V2 extends Mt{constructor(){super(),this.type="TransformControlsGizmo";const e=new Ts({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new si({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const r=t.clone();r.opacity=.5;const s=e.clone();s.color.setHex(16711680);const o=e.clone();o.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const u=e.clone();u.color.setHex(255),u.opacity=.5;const d=e.clone();d.opacity=.25;const h=e.clone();h.color.setHex(16776960),h.opacity=.25,e.clone().color.setHex(16776960);const g=e.clone();g.color.setHex(7895160);const p=new Xn(0,.04,.1,12);p.translate(0,.05,0);const m=new In(.08,.08,.08);m.translate(0,.04,0);const v=new Ue;v.setAttribute("position",new Te([0,0,0,1,0,0],3));const _=new Xn(.0075,.0075,.5,3);function y(V,k){const U=new vo(V,.0075,3,64,k*Math.PI*2);return U.rotateY(Math.PI/2),U.rotateX(Math.PI/2),U}_.translate(0,.25,0);const w={X:[[new ge(p,s),[.5,0,0],[0,0,-Math.PI/2]],[new ge(p,s),[-.5,0,0],[0,0,Math.PI/2]],[new ge(_,s),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new ge(p,o),[0,.5,0]],[new ge(p,o),[0,-.5,0],[Math.PI,0,0]],[new ge(_,o)]],Z:[[new ge(p,a),[0,0,.5],[Math.PI/2,0,0]],[new ge(p,a),[0,0,-.5],[-Math.PI/2,0,0]],[new ge(_,a),null,[Math.PI/2,0,0]]],XYZ:[[new ge(new _o(.1,0),d.clone()),[0,0,0]]],XY:[[new ge(new In(.15,.15,.01),u.clone()),[.15,.15,0]]],YZ:[[new ge(new In(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new ge(new In(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},S={X:[[new ge(new Xn(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new ge(new Xn(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new ge(new Xn(.2,0,.6,4),i),[0,.3,0]],[new ge(new Xn(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new ge(new Xn(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new ge(new Xn(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new ge(new _o(.2,0),i)]],XY:[[new ge(new In(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new ge(new In(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new ge(new In(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},C={START:[[new ge(new _o(.01,2),r),null,null,null,"helper"]],END:[[new ge(new _o(.01,2),r),null,null,null,"helper"]],DELTA:[[new Ni(function b(){const V=new Ue;return V.setAttribute("position",new Te([0,0,0,1,1,1],3)),V}(),r),null,null,null,"helper"]],X:[[new Ni(v,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Ni(v,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Ni(v,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},E={XYZE:[[new ge(y(.5,1),g),null,[0,Math.PI/2,0]]],X:[[new ge(y(.5,.5),s)]],Y:[[new ge(y(.5,.5),o),null,[0,0,-Math.PI/2]]],Z:[[new ge(y(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new ge(y(.75,1),h),null,[0,Math.PI/2,0]]]},B={AXIS:[[new Ni(v,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},N={XYZE:[[new ge(new iu(.25,10,8),i)]],X:[[new ge(new vo(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new ge(new vo(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new ge(new vo(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new ge(new vo(.75,.1,2,24),i)]]},x={X:[[new ge(m,s),[.5,0,0],[0,0,-Math.PI/2]],[new ge(_,s),[0,0,0],[0,0,-Math.PI/2]],[new ge(m,s),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new ge(m,o),[0,.5,0]],[new ge(_,o)],[new ge(m,o),[0,-.5,0],[0,0,Math.PI]]],Z:[[new ge(m,a),[0,0,.5],[Math.PI/2,0,0]],[new ge(_,a),[0,0,0],[Math.PI/2,0,0]],[new ge(m,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new ge(new In(.15,.15,.01),u),[.15,.15,0]]],YZ:[[new ge(new In(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new ge(new In(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new ge(new In(.1,.1,.1),d.clone())]]},R={X:[[new ge(new Xn(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new ge(new Xn(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new ge(new Xn(.2,0,.6,4),i),[0,.3,0]],[new ge(new Xn(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new ge(new Xn(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new ge(new Xn(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new ge(new In(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new ge(new In(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new ge(new In(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new ge(new In(.2,.2,.2),i),[0,0,0]]]},z={X:[[new Ni(v,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Ni(v,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Ni(v,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function P(V){const k=new Mt;for(const U in V)for(let F=V[U].length;F--;){const G=V[U][F][0].clone(),q=V[U][F][1],ee=V[U][F][2],X=V[U][F][3],xe=V[U][F][4];G.name=U,G.tag=xe,q&&G.position.set(q[0],q[1],q[2]),ee&&G.rotation.set(ee[0],ee[1],ee[2]),X&&G.scale.set(X[0],X[1],X[2]),G.updateMatrix();const Re=G.geometry.clone();Re.applyMatrix4(G.matrix),G.geometry=Re,G.renderOrder=1/0,G.position.set(0,0,0),G.rotation.set(0,0,0),G.scale.set(1,1,1),k.add(G)}return k}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=P(w)),this.add(this.gizmo.rotate=P(E)),this.add(this.gizmo.scale=P(x)),this.add(this.picker.translate=P(S)),this.add(this.picker.rotate=P(N)),this.add(this.picker.scale=P(R)),this.add(this.helper.translate=P(C)),this.add(this.helper.rotate=P(B)),this.add(this.helper.scale=P(z)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const i="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:l_;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let s=0;s<r.length;s++){const o=r[s];let a;o.visible=!0,o.rotation.set(0,0,0),o.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),o.scale.set(1,1,1).multiplyScalar(a*this.size/4),"helper"!==o.tag?(o.quaternion.copy(i),"translate"===this.mode||"scale"===this.mode?("X"===o.name&&Math.abs(rn.copy(Xh).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Y"===o.name&&Math.abs(rn.copy(ml).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"Z"===o.name&&Math.abs(rn.copy(Kh).applyQuaternion(i).dot(this.eye))>.99&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XY"===o.name&&Math.abs(rn.copy(Kh).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"YZ"===o.name&&Math.abs(rn.copy(Xh).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1),"XZ"===o.name&&Math.abs(rn.copy(ml).applyQuaternion(i).dot(this.eye))<.2&&(o.scale.set(1e-10,1e-10,1e-10),o.visible=!1)):"rotate"===this.mode&&(a_.copy(i),rn.copy(this.eye).applyQuaternion(wn.copy(i).invert()),-1!==o.name.search("E")&&o.quaternion.setFromRotationMatrix(L2.lookAt(this.eye,k2,ml)),"X"===o.name&&(wn.setFromAxisAngle(Xh,Math.atan2(-rn.y,rn.z)),wn.multiplyQuaternions(a_,wn),o.quaternion.copy(wn)),"Y"===o.name&&(wn.setFromAxisAngle(ml,Math.atan2(rn.x,rn.z)),wn.multiplyQuaternions(a_,wn),o.quaternion.copy(wn)),"Z"===o.name&&(wn.setFromAxisAngle(Kh,Math.atan2(rn.y,rn.x)),wn.multiplyQuaternions(a_,wn),o.quaternion.copy(wn))),o.visible=o.visible&&(-1===o.name.indexOf("X")||this.showX),o.visible=o.visible&&(-1===o.name.indexOf("Y")||this.showY),o.visible=o.visible&&(-1===o.name.indexOf("Z")||this.showZ),o.visible=o.visible&&(-1===o.name.indexOf("E")||this.showX&&this.showY&&this.showZ),o.material._color=o.material._color||o.material.color.clone(),o.material._opacity=o.material._opacity||o.material.opacity,o.material.color.copy(o.material._color),o.material.opacity=o.material._opacity,this.enabled&&this.axis&&(o.name===this.axis||this.axis.split("").some(function(l){return o.name===l}))&&(o.material.color.setHex(16776960),o.material.opacity=1)):(o.visible=!1,"AXIS"===o.name?(o.position.copy(this.worldPositionStart),o.visible=!!this.axis,"X"===this.axis&&(wn.setFromEuler(o_.set(0,0,0)),o.quaternion.copy(i).multiply(wn),Math.abs(rn.copy(Xh).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Y"===this.axis&&(wn.setFromEuler(o_.set(0,0,Math.PI/2)),o.quaternion.copy(i).multiply(wn),Math.abs(rn.copy(ml).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"Z"===this.axis&&(wn.setFromEuler(o_.set(0,Math.PI/2,0)),o.quaternion.copy(i).multiply(wn),Math.abs(rn.copy(Kh).applyQuaternion(i).dot(this.eye))>.9&&(o.visible=!1)),"XYZE"===this.axis&&(wn.setFromEuler(o_.set(0,Math.PI/2,0)),rn.copy(this.rotationAxis),o.quaternion.setFromRotationMatrix(L2.lookAt(k2,rn,ml)),o.quaternion.multiply(wn),o.visible=this.dragging),"E"===this.axis&&(o.visible=!1)):"START"===o.name?(o.position.copy(this.worldPositionStart),o.visible=this.dragging):"END"===o.name?(o.position.copy(this.worldPosition),o.visible=this.dragging):"DELTA"===o.name?(o.position.copy(this.worldPositionStart),o.quaternion.copy(this.worldQuaternionStart),tr.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),tr.applyQuaternion(this.worldQuaternionStart.clone().invert()),o.scale.copy(tr),o.visible=this.dragging):(o.quaternion.copy(i),o.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(o.visible=-1!==this.axis.search(o.name))))}super.updateMatrixWorld(e)}}V2.prototype.isTransformControlsGizmo=!0;class U2 extends ge{constructor(){super(new Gc(1e5,1e5,2,2),new Ts({visible:!1,wireframe:!0,side:2,transparent:!0,opacity:.1,toneMapped:!1})),this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),c_.copy(Xh).applyQuaternion("local"===t?this.worldQuaternion:l_),Jh.copy(ml).applyQuaternion("local"===t?this.worldQuaternion:l_),Qh.copy(Kh).applyQuaternion("local"===t?this.worldQuaternion:l_),rn.copy(Jh),this.mode){case"translate":case"scale":switch(this.axis){case"X":rn.copy(this.eye).cross(c_),Ls.copy(c_).cross(rn);break;case"Y":rn.copy(this.eye).cross(Jh),Ls.copy(Jh).cross(rn);break;case"Z":rn.copy(this.eye).cross(Qh),Ls.copy(Qh).cross(rn);break;case"XY":Ls.copy(Qh);break;case"YZ":Ls.copy(c_);break;case"XZ":rn.copy(Qh),Ls.copy(Jh);break;case"XYZ":case"E":Ls.set(0,0,0)}break;default:Ls.set(0,0,0)}0===Ls.length()?this.quaternion.copy(this.cameraQuaternion):(B2.lookAt(tr.set(0,0,0),Ls,rn),this.quaternion.setFromRotationMatrix(B2)),super.updateMatrixWorld(e)}}U2.prototype.isTransformControlsPlane=!0;var ef=function(){var n=0,e=document.createElement("div");function t(u){return e.appendChild(u.dom),u}function i(u){for(var d=0;d<e.children.length;d++)e.children[d].style.display=d===u?"block":"none";n=u}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(u){u.preventDefault(),i(++n%e.children.length)},!1);var r=(performance||Date).now(),s=r,o=0,a=t(new ef.Panel("FPS","#0ff","#002")),l=t(new ef.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new ef.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:e,addPanel:t,showPanel:i,begin:function(){r=(performance||Date).now()},end:function(){o++;var u=(performance||Date).now();if(l.update(u-r,200),u>=s+1e3&&(a.update(1e3*o/(u-s),100),s=u,o=0,c)){var d=performance.memory;c.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return u},update:function(){r=this.end()},domElement:e,setMode:i}};ef.Panel=function(n,e,t){var i=1/0,r=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,c=3*o,u=2*o,d=3*o,h=15*o,f=74*o,g=30*o,p=document.createElement("canvas");p.width=a,p.height=l,p.style.cssText="width:80px;height:48px";var m=p.getContext("2d");return m.font="bold "+9*o+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=t,m.fillRect(0,0,a,l),m.fillStyle=e,m.fillText(n,c,u),m.fillRect(d,h,f,g),m.fillStyle=t,m.globalAlpha=.9,m.fillRect(d,h,f,g),{dom:p,update:function(v,_){i=Math.min(i,v),r=Math.max(r,v),m.fillStyle=t,m.globalAlpha=1,m.fillRect(0,0,a,h),m.fillStyle=e,m.fillText(s(v)+" "+n+" ("+s(i)+"-"+s(r)+")",c,u),m.drawImage(p,d+o,h,f-o,g,d,h,f-o,g),m.fillRect(d+f-o,h,o,g),m.fillStyle=t,m.globalAlpha=.9,m.fillRect(d+f-o,h,o,s((1-v/_)*g))}}};const aee=ef,lee=["container"],cee=["canvas"];function uee(n,e){if(1&n){const t=dr();Xs(0),Ee(1,"button",9),Qe("click",function(){const s=gi(t).$implicit;return He().setTransformMode(s.mode)}),un(2,"i",10),Ae(),Ks()}if(2&n){const t=e.$implicit,i=He();oe(1),zt("active",i.transformMode===t.mode),Ca("title",t.title),oe(1),ce("ngClass",t.icon)}}let dee=(()=>{class n{constructor(t){this.rin=t,this.scenes=[],this.worldPosition=new M,this.transformMode="translate",this.transformTools=[{mode:"translate",icon:"fa-up-down-left-right",title:"Translate"},{mode:"rotate",icon:"fa-rotate",title:"Rotate"},{mode:"scale",icon:"fa-vector-square",title:"Scale"}]}get container(){return this.containerRef.nativeElement}get canvas(){return this.canvasRef.nativeElement}ngOnInit(){this.importSub=this.rin.import$.subscribe(t=>this.onImport(t)),this.layoutUpdatedSub=this.rin.layoutUpdated$.subscribe(()=>this.onLayoutUpdated()),this.focusSub=this.rin.focus$.subscribe(t=>this.onFocus(t)),this.selectionSub=this.rin.selection$.subscribe(t=>this.onSelectionUpdated(t))}ngOnDestroy(){var t,i,r;this.importSub.unsubscribe(),this.layoutUpdatedSub.unsubscribe(),this.focusSub.unsubscribe(),this.selectionSub.unsubscribe(),null===(t=this.orbit)||void 0===t||t.dispose(),null===(i=this.transform)||void 0===i||i.dispose(),null===(r=this.renderer)||void 0===r||r.dispose()}ngAfterViewInit(){setTimeout(()=>this.createThreeObjects(),0)}setTransformMode(t){var i;t!==this.transformMode&&(this.transformMode=t,null===(i=this.transform)||void 0===i||i.setMode(t))}onCanvasClick(){console.warn("enable canvas clicks to deselect current selection, unless orbit controls or transform controls are being used")}onImport(t){this.scenes[0].add(t)}onLayoutUpdated(){const t=this.container.clientWidth,i=this.container.clientHeight;this.camera.aspect=t/i,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,i)}onFocus(t){t.getWorldPosition(this.worldPosition);const i=new M(0,0,-1).applyQuaternion(this.camera.quaternion).negate(),r=this.orbit.target.distanceTo(this.camera.position),s=this.worldPosition.clone().add(i.multiplyScalar(r));this.camera.position.copy(s),this.orbit.target.copy(this.worldPosition),this.orbit.update()}onSelectionUpdated(t){var i;1===t.length&&null!=t[0].parent?this.transform.attach(t[0]):null===(i=this.transform)||void 0===i||i.detach()}createThreeObjects(){const t=new el;t.name="Default Scene",t.background=new de(10066329),this.camera=new Zn(50,this.canvas.clientWidth/this.canvas.clientHeight),this.camera.name="Scene Camera",this.camera.userData.isSceneCamera=!0,this.camera.position.set(-2,2,4),this.light=new xh,this.light.name="Scene Light",this.light.intensity=1.5,this.light.position.set(10,10,5),t.add(this.light),this.renderer=new HR({canvas:this.canvas,alpha:!0}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.orbit=new tee(this.camera,this.canvas),this.stats=aee(),this.stats.dom.style.position="absolute",this.container.appendChild(this.stats.dom),this.scenes.push(t),this.gizmos=new el,this.gizmos.name="Gizmos Scene",this.transform=new F2(this.camera,this.canvas),this.transform.addEventListener("dragging-changed",s=>this.orbit.enabled=!s.value),this.gizmos.add(this.transform);const r=this;(function s(){requestAnimationFrame(s),r.renderer.autoClear=!0;for(let o=0;o<r.scenes.length;o++)r.renderer.render(r.scenes[o],r.camera),r.renderer.clearDepth(),r.renderer.autoClear=!1;r.renderer.render(r.gizmos,r.camera),r.stats.update()})(),this.rin.setScenes(this.scenes),this.rin.importFileAsync("./assets/Samba Dancing.fbx")}}return n.\u0275fac=function(t){return new(t||n)(L(mu))},n.\u0275cmp=ln({type:n,selectors:[["scene-view"]],viewQuery:function(t,i){if(1&t&&(oc(lee,5),oc(cee,5)),2&t){let r;tn(r=nn())&&(i.containerRef=r.first),tn(r=nn())&&(i.canvasRef=r.first)}},decls:9,vars:1,consts:[[1,"d-flex","flex-column","h-100","w-100"],[1,"flex-shrink-1","border-secondary","border-bottom"],["role","toolbar",1,"btn-toolbar"],["role","group",1,"btn-group","btn-group-sm","xs","m-1"],[4,"ngFor","ngForOf"],[1,"h-100","w-100","position-relative","overflow-hidden"],["container",""],[2,"width","100%","height","100%",3,"click"],["canvas",""],["type","button",1,"btn","btn-secondary","p-1",3,"title","click"],[1,"fa-solid","fa-fw",3,"ngClass"]],template:function(t,i){1&t&&(Ee(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Oe(4,uee,3,4,"ng-container",4),Ae()()(),Ee(5,"div",5,6)(7,"canvas",7,8),Qe("click",function(){return i.onCanvasClick()}),Ae()()()),2&t&&(oe(4),ce("ngForOf",i.transformTools))},directives:[Ss,uy],encapsulation:2}),n})();const hee=["*"];let H2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["inspector-table"]],ngContentSelectors:hee,decls:2,vars:0,consts:[[1,"table","table-borderless","table-sm","border-secondary","border-bottom"]],template:function(t,i){1&t&&(hd(),Ee(0,"table",0),fd(1),Ae())},encapsulation:2}),n})();const fee=["*"];let z2=(()=>{class n{constructor(){this.cols=2,this.expanded=!0}toggleExpanded(){this.expanded=!this.expanded}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["component-editor"]],inputs:{name:"name",cols:"cols"},ngContentSelectors:fee,decls:12,vars:9,consts:[[1,"table-secondary"],[3,"click"],[1,"fa-solid","fa-caret-down","fa-fw"],[1,"fa-solid","fa-caret-right","fa-fw"],[1,"w-100",3,"colSpan"],[3,"type","name"],[1,"bg-light",3,"hidden"]],template:function(t,i){1&t&&(hd(),Ee(0,"inspector-table")(1,"thead")(2,"tr",0)(3,"th")(4,"span",1),Qe("click",function(){return i.toggleExpanded()}),un(5,"i",2)(6,"i",3),Ae()(),Ee(7,"th",4),un(8,"icon",5),_i(9),Ae()()(),Ee(10,"tbody",6),fd(11),Ae()()),2&t&&(oe(5),zt("d-none",!i.expanded),oe(1),zt("d-none",i.expanded),oe(1),Ca("colSpan",i.cols),oe(1),ce("type","component")("name",i.name),oe(1),ec(i.name),oe(1),ce("hidden",!i.expanded))},directives:[H2,Sw],encapsulation:2}),n})();const pee=["vector3-editor",""];let gee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["","vector3-editor",""]],inputs:{name:"name",model:"model"},attrs:pee,decls:18,vars:4,consts:[["colSpan","2",1,"align-middle"],[1,"input-group","input-group-sm","xs"],[1,"input-group-text","p-1"],["type","number","step","any",1,"form-control","p-1",3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&(un(0,"th"),Ee(1,"th",0),_i(2),Ae(),Ee(3,"td")(4,"div",1)(5,"span",2),_i(6,"X"),Ae(),Ee(7,"input",3),Qe("ngModelChange",function(s){return i.model.x=s}),Ae()()(),Ee(8,"td")(9,"div",1)(10,"span",2),_i(11,"Y"),Ae(),Ee(12,"input",3),Qe("ngModelChange",function(s){return i.model.y=s}),Ae()()(),Ee(13,"td")(14,"div",1)(15,"span",2),_i(16,"Z"),Ae(),Ee(17,"input",3),Qe("ngModelChange",function(s){return i.model.z=s}),Ae()()()),2&t&&(oe(2),ec(i.name),oe(5),ce("ngModel",i.model.x),oe(5),ce("ngModel",i.model.y),oe(5),ce("ngModel",i.model.z))},directives:[X1,vu,Lm,Bh],encapsulation:2}),n})(),mee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["transform-editor"]],inputs:{model:"model"},decls:4,vars:8,consts:[[3,"name","cols"],["vector3-editor","",3,"name","model"]],template:function(t,i){1&t&&(Ee(0,"component-editor",0),un(1,"tr",1)(2,"tr",1)(3,"tr",1),Ae()),2&t&&(ce("name","Transform")("cols",5),oe(1),ce("name","Position")("model",i.model.position),oe(1),ce("name","Rotation")("model",i.model.rotation),oe(1),ce("name","Scale")("model",i.model.scale))},directives:[z2,gee],encapsulation:2}),n})();const _ee=["color-editor",""];let vee=(()=>{class n{constructor(){this.modelChange=new et}ngOnInit(){this.value=`#${this.model.getHexString()}`}onValueChange(){this.modelChange.emit(new de(this.value))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["","color-editor",""]],inputs:{name:"name",model:"model"},outputs:{modelChange:"modelChange"},attrs:_ee,decls:6,vars:2,consts:[["colSpan","2",1,"align-middle"],["colSpan","3"],[1,"input-group","input-group-sm","xs"],["type","color",1,"form-control","p-1",3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&(un(0,"th"),Ee(1,"th",0),_i(2),Ae(),Ee(3,"td",1)(4,"div",2)(5,"input",3),Qe("ngModelChange",function(s){return i.value=s})("ngModelChange",function(){return i.onValueChange()}),Ae()()()),2&t&&(oe(2),ec(i.name),oe(3),ce("ngModel",i.value))},directives:[vu,Lm,Bh],encapsulation:2}),n})();function yee(n,e){if(1&n){const t=dr();Xs(0),Ee(1,"tr",2),Qe("modelChange",function(r){return gi(t),He().backgroundColor=r}),Ae(),Ks()}if(2&n){const t=He();oe(1),ce("name","Background")("model",t.backgroundColor)}}let bee=(()=>{class n{get backgroundIsColor(){return JN.is(this.model.background,de)}get backgroundColor(){return this.model.background}set backgroundColor(t){this.model.background=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["scene-editor"]],inputs:{model:"model"},decls:2,vars:3,consts:[[3,"name","cols"],[4,"ngIf"],["color-editor","",3,"name","model","modelChange"]],template:function(t,i){1&t&&(Ee(0,"component-editor",0),Oe(1,yee,2,2,"ng-container",1),Ae()),2&t&&(ce("name","Scene")("cols",5),oe(1),ce("ngIf",i.backgroundIsColor))},directives:[z2,Bo,vee],encapsulation:2}),n})();function wee(n,e){if(1&n&&(Ee(0,"li"),_i(1),Ae()),2&n){const t=e.$implicit,i=He();oe(1),hv("",t,": ",i.getPropertyType(t),"")}}let xee=(()=>{class n{constructor(){this.properties=[]}get ownPropertyNames(){return Object.getOwnPropertyNames(this.model).sort((t,i)=>t.localeCompare(i))}getPropertyType(t){var i,r;return null!==(r=null===(i=this.model[t])||void 0===i?void 0:i.constructor.name)&&void 0!==r?r:typeof this.model[t]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["property-list"]],inputs:{model:"model"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(Ee(0,"ul"),Oe(1,wee,2,2,"li",0),Ae()),2&t&&(oe(1),ce("ngForOf",i.ownPropertyNames))},directives:[Ss],encapsulation:2}),n})();function Mee(n,e){1&n&&un(0,"scene-editor",4),2&n&&ce("model",He().scene)}let See=(()=>{class n{get scene(){return this.model}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["object-editor"]],inputs:{model:"model"},decls:12,vars:6,consts:[[1,"align-middle"],["type","checkbox","title","Visible",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"w-100","xs"],["type","text",1,"form-control","p-1",3,"ngModel","ngModelChange"],[3,"model"],[3,"ngSwitch"],[3,"model",4,"ngSwitchCase"]],template:function(t,i){1&t&&(Ee(0,"inspector-table")(1,"tbody")(2,"tr")(3,"td",0)(4,"div")(5,"input",1),Qe("ngModelChange",function(s){return i.model.visible=s}),Ae()()(),Ee(6,"td",2)(7,"input",3),Qe("ngModelChange",function(s){return i.model.name=s}),Ae()()()()(),un(8,"transform-editor",4),Xs(9,5),Oe(10,Mee,1,1,"scene-editor",6),Ks(),un(11,"property-list",4)),2&t&&(oe(5),ce("ngModel",i.model.visible),oe(2),ce("ngModel",i.model.name),oe(1),ce("model",i.model),oe(1),ce("ngSwitch",i.model.type),oe(1),ce("ngSwitchCase","Scene"),oe(1),ce("model",i.model))},directives:[H2,P1,Lm,Bh,vu,mee,Ep,LE,bee,xee],encapsulation:2}),n})();function Dee(n,e){if(1&n&&(Ee(0,"div",3)(1,"div",4),_i(2),Ae()()),2&n){const t=He();oe(2),Ea("",t.selection.length," items selected")}}function Cee(n,e){if(1&n&&(Xs(0),un(1,"object-editor",5),Ks()),2&n){const t=He();oe(1),ce("model",t.selection[0])}}let Eee=(()=>{class n{constructor(t){this.rin=t}ngOnInit(){this.selectionSub=this.rin.selection$.subscribe(t=>this.onSelectionUpdated(t))}ngOnDestroy(){this.selectionSub.unsubscribe()}onSelectionUpdated(t){this.selection=t}}return n.\u0275fac=function(t){return new(t||n)(L(mu))},n.\u0275cmp=ln({type:n,selectors:[["inspector-view"]],decls:4,vars:2,consts:[["multiple",""],[1,"w-100","h-100","fs-xs","overflow-y-only"],[4,"ngIf","ngIfElse"],[1,"d-flex","h-100"],[1,"w-100","text-center","align-self-center"],[3,"model"]],template:function(t,i){if(1&t&&(Oe(0,Dee,3,1,"ng-template",null,0,Xr),Ee(2,"div",1),Oe(3,Cee,2,1,"ng-container",2),Ae()),2&t){const r=Xi(1);oe(3),ce("ngIf",1===i.selection.length)("ngIfElse",r)}},directives:[Bo,See],encapsulation:2}),n})();function Tee(n,e){1&n&&un(0,"scene-tree-view")}function Aee(n,e){1&n&&un(0,"scene-view")}function Ree(n,e){1&n&&_i(0,"Second Content")}function Iee(n,e){1&n&&_i(0," Empty ")}function Nee(n,e){1&n&&un(0,"inspector-view")}const Pee=[{path:"",redirectTo:"engine",pathMatch:"full"},{path:"engine",component:(()=>{class n{constructor(t){this.rin=t}onSplitDragEnd(){this.rin.updateLayout()}onWindowResized(){this.rin.updateLayout()}}return n.\u0275fac=function(t){return new(t||n)(L(mu))},n.\u0275cmp=ln({type:n,selectors:[["layout"]],decls:18,vars:12,consts:[["direction","horizontal",1,"vh-100",3,"dragEnd","resize"],[3,"size"],["direction","vertical",3,"dragEnd"],["direction","horizontal",3,"dragEnd"],[1,"overflow-hidden",3,"size"],["tab-link","",3,"name"],["tab-link","",3,"name","destroyOnHide"]],template:function(t,i){1&t&&(Ee(0,"as-split",0),Qe("dragEnd",function(){return i.onSplitDragEnd()})("resize",function(){return i.onWindowResized()},!1,fM),Ee(1,"as-split-area",1)(2,"as-split",2),Qe("dragEnd",function(){return i.onSplitDragEnd()}),Ee(3,"as-split-area",1)(4,"as-split",3),Qe("dragEnd",function(){return i.onSplitDragEnd()}),Ee(5,"as-split-area",4)(6,"tab-set"),Oe(7,Tee,1,0,"ng-template",5),Ae()(),Ee(8,"as-split-area",4)(9,"tab-set"),Oe(10,Aee,1,0,"ng-template",6),Oe(11,Ree,1,0,"ng-template",5),Ae()()()(),Ee(12,"as-split-area",1)(13,"tab-set"),Oe(14,Iee,1,0,"ng-template",5),Ae()()()(),Ee(15,"as-split-area",1)(16,"tab-set"),Oe(17,Nee,1,0,"ng-template",5),Ae()()()),2&t&&(oe(1),ce("size",75),oe(2),ce("size",80),oe(2),ce("size",35),oe(2),ce("name","Hierarchy"),oe(1),ce("size",65),oe(2),ce("name","Scene")("destroyOnHide",!1),oe(1),ce("name","Second"),oe(1),ce("size",20),oe(2),ce("name","Project"),oe(1),ce("size",25),oe(2),ce("name","Inspector"))},directives:[rP,HY,WQ,T2,eee,dee,Eee],encapsulation:2}),n})()}];let Oee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({imports:[[aA.forRoot(Pee,{useHash:!0})],aA]}),n})(),Fee=(()=>{class n{constructor(){this.title="rin-ng"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ln({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&un(0,"router-outlet")},directives:[ky],styles:[""]}),n})(),kee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n}),n.\u0275inj=Pt({providers:[mu],imports:[[JE,fO,zY,UQ]]}),n})(),Lee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Lt({type:n,bootstrap:[Fee]}),n.\u0275inj=Pt({providers:[],imports:[[JE,Oee,kee]]}),n})();(function wz(){dE=!1})(),O4().bootstrapModule(Lee).catch(n=>console.error(n))},928:Ru=>{function nr(pn){if("string"!=typeof pn)throw new TypeError("Path must be a string. Received "+JSON.stringify(pn))}function Iu(pn,ie){for(var Pe,Q="",We=0,qe=-1,vt=0,lt=0;lt<=pn.length;++lt){if(lt<pn.length)Pe=pn.charCodeAt(lt);else{if(47===Pe)break;Pe=47}if(47===Pe){if(qe!==lt-1&&1!==vt)if(qe!==lt-1&&2===vt){if(Q.length<2||2!==We||46!==Q.charCodeAt(Q.length-1)||46!==Q.charCodeAt(Q.length-2))if(Q.length>2){var Ut=Q.lastIndexOf("/");if(Ut!==Q.length-1){-1===Ut?(Q="",We=0):We=(Q=Q.slice(0,Ut)).length-1-Q.lastIndexOf("/"),qe=lt,vt=0;continue}}else if(2===Q.length||1===Q.length){Q="",We=0,qe=lt,vt=0;continue}ie&&(Q.length>0?Q+="/..":Q="..",We=2)}else Q.length>0?Q+="/"+pn.slice(qe+1,lt):Q=pn.slice(qe+1,lt),We=lt-qe-1;qe=lt,vt=0}else 46===Pe&&-1!==vt?++vt:vt=-1}return Q}var hs={resolve:function(){for(var We,ie="",Q=!1,qe=arguments.length-1;qe>=-1&&!Q;qe--){var vt;qe>=0?vt=arguments[qe]:(void 0===We&&(We=process.cwd()),vt=We),nr(vt),0!==vt.length&&(ie=vt+"/"+ie,Q=47===vt.charCodeAt(0))}return ie=Iu(ie,!Q),Q?ie.length>0?"/"+ie:"/":ie.length>0?ie:"."},normalize:function(ie){if(nr(ie),0===ie.length)return".";var Q=47===ie.charCodeAt(0),We=47===ie.charCodeAt(ie.length-1);return 0===(ie=Iu(ie,!Q)).length&&!Q&&(ie="."),ie.length>0&&We&&(ie+="/"),Q?"/"+ie:ie},isAbsolute:function(ie){return nr(ie),ie.length>0&&47===ie.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var ie,Q=0;Q<arguments.length;++Q){var We=arguments[Q];nr(We),We.length>0&&(void 0===ie?ie=We:ie+="/"+We)}return void 0===ie?".":hs.normalize(ie)},relative:function(ie,Q){if(nr(ie),nr(Q),ie===Q||(ie=hs.resolve(ie))===(Q=hs.resolve(Q)))return"";for(var We=1;We<ie.length&&47===ie.charCodeAt(We);++We);for(var qe=ie.length,vt=qe-We,Pe=1;Pe<Q.length&&47===Q.charCodeAt(Pe);++Pe);for(var Ut=Q.length-Pe,hi=vt<Ut?vt:Ut,Fi=-1,sn=0;sn<=hi;++sn){if(sn===hi){if(Ut>hi){if(47===Q.charCodeAt(Pe+sn))return Q.slice(Pe+sn+1);if(0===sn)return Q.slice(Pe+sn)}else vt>hi&&(47===ie.charCodeAt(We+sn)?Fi=sn:0===sn&&(Fi=0));break}var rf=ie.charCodeAt(We+sn);if(rf!==Q.charCodeAt(Pe+sn))break;47===rf&&(Fi=sn)}var ir="";for(sn=We+Fi+1;sn<=qe;++sn)(sn===qe||47===ie.charCodeAt(sn))&&(ir+=0===ir.length?"..":"/..");return ir.length>0?ir+Q.slice(Pe+Fi):(47===Q.charCodeAt(Pe+=Fi)&&++Pe,Q.slice(Pe))},_makeLong:function(ie){return ie},dirname:function(ie){if(nr(ie),0===ie.length)return".";for(var Q=ie.charCodeAt(0),We=47===Q,qe=-1,vt=!0,Pe=ie.length-1;Pe>=1;--Pe)if(47===(Q=ie.charCodeAt(Pe))){if(!vt){qe=Pe;break}}else vt=!1;return-1===qe?We?"/":".":We&&1===qe?"//":ie.slice(0,qe)},basename:function(ie,Q){if(void 0!==Q&&"string"!=typeof Q)throw new TypeError('"ext" argument must be a string');nr(ie);var Pe,We=0,qe=-1,vt=!0;if(void 0!==Q&&Q.length>0&&Q.length<=ie.length){if(Q.length===ie.length&&Q===ie)return"";var lt=Q.length-1,Ut=-1;for(Pe=ie.length-1;Pe>=0;--Pe){var hi=ie.charCodeAt(Pe);if(47===hi){if(!vt){We=Pe+1;break}}else-1===Ut&&(vt=!1,Ut=Pe+1),lt>=0&&(hi===Q.charCodeAt(lt)?-1==--lt&&(qe=Pe):(lt=-1,qe=Ut))}return We===qe?qe=Ut:-1===qe&&(qe=ie.length),ie.slice(We,qe)}for(Pe=ie.length-1;Pe>=0;--Pe)if(47===ie.charCodeAt(Pe)){if(!vt){We=Pe+1;break}}else-1===qe&&(vt=!1,qe=Pe+1);return-1===qe?"":ie.slice(We,qe)},extname:function(ie){nr(ie);for(var Q=-1,We=0,qe=-1,vt=!0,Pe=0,lt=ie.length-1;lt>=0;--lt){var Ut=ie.charCodeAt(lt);if(47!==Ut)-1===qe&&(vt=!1,qe=lt+1),46===Ut?-1===Q?Q=lt:1!==Pe&&(Pe=1):-1!==Q&&(Pe=-1);else if(!vt){We=lt+1;break}}return-1===Q||-1===qe||0===Pe||1===Pe&&Q===qe-1&&Q===We+1?"":ie.slice(Q,qe)},format:function(ie){if(null===ie||"object"!=typeof ie)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof ie);return function Ct(pn,ie){var Q=ie.dir||ie.root,We=ie.base||(ie.name||"")+(ie.ext||"");return Q?Q===ie.root?Q+We:Q+pn+We:We}("/",ie)},parse:function(ie){nr(ie);var Q={root:"",dir:"",base:"",ext:"",name:""};if(0===ie.length)return Q;var vt,We=ie.charCodeAt(0),qe=47===We;qe?(Q.root="/",vt=1):vt=0;for(var Pe=-1,lt=0,Ut=-1,hi=!0,Fi=ie.length-1,sn=0;Fi>=vt;--Fi)if(47!==(We=ie.charCodeAt(Fi)))-1===Ut&&(hi=!1,Ut=Fi+1),46===We?-1===Pe?Pe=Fi:1!==sn&&(sn=1):-1!==Pe&&(sn=-1);else if(!hi){lt=Fi+1;break}return-1===Pe||-1===Ut||0===sn||1===sn&&Pe===Ut-1&&Pe===lt+1?-1!==Ut&&(Q.base=Q.name=ie.slice(0===lt&&qe?1:lt,Ut)):(0===lt&&qe?(Q.name=ie.slice(1,Pe),Q.base=ie.slice(1,Ut)):(Q.name=ie.slice(lt,Pe),Q.base=ie.slice(lt,Ut)),Q.ext=ie.slice(Pe,Ut)),lt>0?Q.dir=ie.slice(0,lt-1):qe&&(Q.dir="/"),Q},sep:"/",delimiter:":",win32:null,posix:null};hs.posix=hs,Ru.exports=hs}},Ru=>{Ru(Ru.s=369)}]);