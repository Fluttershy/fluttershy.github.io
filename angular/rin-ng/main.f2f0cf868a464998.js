"use strict";(self.webpackChunkrin_ng=self.webpackChunkrin_ng||[]).push([[179],{871:(yd,br,Za)=>{var Xa={};function At(n){return"function"==typeof n}function Mn(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Za.r(Xa),Za.d(Xa,{AsyncCompress:()=>lO,AsyncDecompress:()=>ZZ,AsyncDeflate:()=>sO,AsyncGunzip:()=>uO,AsyncGzip:()=>lO,AsyncInflate:()=>Ow,AsyncUnzipInflate:()=>sX,AsyncUnzlib:()=>hO,AsyncZipDeflate:()=>tX,AsyncZlib:()=>qZ,Compress:()=>p_,DecodeUTF8:()=>JZ,Decompress:()=>pO,Deflate:()=>os,EncodeUTF8:()=>QZ,Gunzip:()=>m_,Gzip:()=>p_,Inflate:()=>mr,Unzip:()=>aX,UnzipInflate:()=>oX,UnzipPassThrough:()=>xO,Unzlib:()=>y_,Zip:()=>nX,ZipDeflate:()=>eX,ZipPassThrough:()=>yf,Zlib:()=>kw,compress:()=>cO,compressSync:()=>g_,decompress:()=>XZ,decompressSync:()=>KZ,deflate:()=>aO,deflateSync:()=>mf,gunzip:()=>dO,gunzipSync:()=>__,gzip:()=>cO,gzipSync:()=>g_,inflate:()=>Fw,inflateSync:()=>nd,strFromU8:()=>Hw,strToU8:()=>Fa,unzip:()=>lX,unzipSync:()=>cX,unzlib:()=>fO,unzlibSync:()=>_f,zip:()=>iX,zipSync:()=>rX,zlib:()=>YZ,zlibSync:()=>Lw});const ce=Mn(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function ue(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Ve{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const o of t)o.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(At(i))try{i()}catch(o){e=o instanceof ce?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{Ue(o)}catch(s){e=null!=e?e:[],s instanceof ce?e=[...e,...s.errors]:e.push(s)}}if(e)throw new ce(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Ue(e);else{if(e instanceof Ve){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ue(t,e)}remove(e){const{_finalizers:t}=this;t&&ue(t,e),e instanceof Ve&&e._removeParent(this)}}Ve.EMPTY=(()=>{const n=new Ve;return n.closed=!0,n})();const et=Ve.EMPTY;function It(n){return n instanceof Ve||n&&"closed"in n&&At(n.remove)&&At(n.add)&&At(n.unsubscribe)}function Ue(n){At(n)?n():n.unsubscribe()}const ut={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},en={setTimeout(n,e,...t){const{delegate:i}=en;return(null==i?void 0:i.setTimeout)?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=en;return((null==e?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function wr(n){en.setTimeout(()=>{const{onUnhandledError:e}=ut;if(!e)throw n;e(n)})}function Qn(){}const yn=gs("C",void 0,void 0);function gs(n,e,t){return{kind:n,value:e,error:t}}let Ka=null;function Qf(n){if(ut.useDeprecatedSynchronousErrorHandling){const e=!Ka;if(e&&(Ka={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Ka;if(Ka=null,t)throw i}}else n()}class g0 extends Ve{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,It(e)&&e.add(this)):this.destination=Wk}static create(e,t,i){return new ep(e,t,i)}next(e){this.isStopped?_0(function p0(n){return gs("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?_0(function Jf(n){return gs("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?_0(yn,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const zk=Function.prototype.bind;function m0(n,e){return zk.call(n,e)}class Gk{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){tp(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){tp(i)}else tp(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){tp(t)}}}class ep extends g0{constructor(e,t,i){let r;if(super(),At(e)||!e)r={next:null!=e?e:void 0,error:null!=t?t:void 0,complete:null!=i?i:void 0};else{let o;this&&ut.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&m0(e.next,o),error:e.error&&m0(e.error,o),complete:e.complete&&m0(e.complete,o)}):r=e}this.destination=new Gk(r)}}function tp(n){ut.useDeprecatedSynchronousErrorHandling?function Uk(n){ut.useDeprecatedSynchronousErrorHandling&&Ka&&(Ka.errorThrown=!0,Ka.error=n)}(n):wr(n)}function _0(n,e){const{onStoppedNotification:t}=ut;t&&en.setTimeout(()=>t(n,e))}const Wk={closed:!0,next:Qn,error:function jk(n){throw n},complete:Qn},y0="function"==typeof Symbol&&Symbol.observable||"@@observable";function ms(n){return n}let pn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const o=function qk(n){return n&&n instanceof g0||function $k(n){return n&&At(n.next)&&At(n.error)&&At(n.complete)}(n)&&It(n)}(t)?t:new ep(t,i,r);return Qf(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Jx(i))((r,o)=>{const s=new ep({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[y0](){return this}pipe(...t){return function Kx(n){return 0===n.length?ms:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=Jx(t))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=e=>new n(e),n})();function Jx(n){var e;return null!==(e=null!=n?n:ut.Promise)&&void 0!==e?e:Promise}const Yk=Mn(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ft=(()=>{class n extends pn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Qx(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new Yk}next(t){Qf(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Qf(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Qf(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:o}=this;return i||r?et:(this.currentObservers=null,o.push(t),new Ve(()=>{this.currentObservers=null,ue(o,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){const t=new pn;return t.source=this,t}}return n.create=(e,t)=>new Qx(e,t),n})();class Qx extends Ft{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:et}}function eM(n){return At(null==n?void 0:n.lift)}function Vn(n){return e=>{if(eM(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function vn(n,e,t,i,r){return new Zk(n,e,t,i,r)}class Zk extends g0{constructor(e,t,i,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Bt(n,e){return Vn((t,i)=>{let r=0;t.subscribe(vn(i,o=>{i.next(n.call(e,o,r++))}))})}function Ja(n){return this instanceof Ja?(this.v=n,this):new Ja(n)}function Qk(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(h){i[h]&&(r[h]=function(f){return new Promise(function(g,p){o.push([h,f,g,p])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof Ja?Promise.resolve(h.value.v).then(c,u):d(o[0][2],h)}(i[h](f))}catch(g){d(o[0][3],g)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),o.shift(),o.length&&a(o[0][0],o[0][1])}}function e3(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function iM(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){!function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}(a,l,(s=n[o](s)).done,s.value)})}}}const b0=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function rM(n){return At(null==n?void 0:n.then)}function oM(n){return At(n[y0])}function sM(n){return Symbol.asyncIterator&&At(null==n?void 0:n[Symbol.asyncIterator])}function aM(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const lM=function n3(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function cM(n){return At(null==n?void 0:n[lM])}function uM(n){return Qk(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Ja(t.read());if(r)return yield Ja(void 0);yield yield Ja(i)}}finally{t.releaseLock()}})}function dM(n){return At(null==n?void 0:n.getReader)}function Fi(n){if(n instanceof pn)return n;if(null!=n){if(oM(n))return function r3(n){return new pn(e=>{const t=n[y0]();if(At(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(b0(n))return function o3(n){return new pn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(rM(n))return function s3(n){return new pn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,wr)})}(n);if(sM(n))return hM(n);if(cM(n))return function a3(n){return new pn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(dM(n))return function l3(n){return hM(uM(n))}(n)}throw aM(n)}function hM(n){return new pn(e=>{(function c3(n,e){var t,i,r,o;return function Kk(n,e,t,i){return new(t||(t=Promise))(function(o,s){function a(u){try{c(i.next(u))}catch(d){s(d)}}function l(u){try{c(i.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):function r(o){return o instanceof t?o:new t(function(s){s(o)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=e3(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function _s(n,e,t,i=0,r=!1){const o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function ei(n,e,t=1/0){return At(e)?ei((i,r)=>Bt((o,s)=>e(i,o,r,s))(Fi(n(i,r))),t):("number"==typeof e&&(t=e),Vn((i,r)=>function u3(n,e,t,i,r,o,s,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=p=>c<i?g(p):l.push(p),g=p=>{o&&e.next(p),c++;let m=!1;Fi(t(p,u++)).subscribe(vn(e,y=>{null==r||r(y),o?f(y):e.next(y)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;l.length&&c<i;){const y=l.shift();s?_s(e,s,()=>g(y)):g(y)}h()}catch(y){e.error(y)}}))};return n.subscribe(vn(e,f,()=>{d=!0,h()})),()=>{null==a||a()}}(i,r,n,t)))}function vd(n=1/0){return ei(ms,n)}const fo=new pn(n=>n.complete());function fM(n){return n&&At(n.schedule)}function w0(n){return n[n.length-1]}function np(n){return At(w0(n))?n.pop():void 0}function bd(n){return fM(w0(n))?n.pop():void 0}function pM(n,e=0){return Vn((t,i)=>{t.subscribe(vn(i,r=>_s(i,n,()=>i.next(r),e),()=>_s(i,n,()=>i.complete(),e),r=>_s(i,n,()=>i.error(r),e)))})}function gM(n,e=0){return Vn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function mM(n,e){if(!n)throw new Error("Iterable cannot be null");return new pn(t=>{_s(t,e,()=>{const i=n[Symbol.asyncIterator]();_s(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function xi(n,e){return e?function y3(n,e){if(null!=n){if(oM(n))return function f3(n,e){return Fi(n).pipe(gM(e),pM(e))}(n,e);if(b0(n))return function g3(n,e){return new pn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(rM(n))return function p3(n,e){return Fi(n).pipe(gM(e),pM(e))}(n,e);if(sM(n))return mM(n,e);if(cM(n))return function m3(n,e){return new pn(t=>{let i;return _s(t,e,()=>{i=n[lM](),_s(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void t.error(s)}o?t.complete():t.next(r)},0,!0)}),()=>At(null==i?void 0:i.return)&&i.return()})}(n,e);if(dM(n))return function _3(n,e){return mM(uM(n),e)}(n,e)}throw aM(n)}(n,e):Fi(n)}function ui(n){return n<=0?()=>fo:Vn((e,t)=>{let i=0;e.subscribe(vn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function x0(n,e,...t){return!0===e?(n(),null):!1===e?null:e(...t).pipe(ui(1)).subscribe(()=>n())}function gn(n){for(let e in n)if(n[e]===gn)return e;throw Error("Could not find renamed property on target object.")}function M0(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function on(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(on).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function D0(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const w3=gn({__forward_ref__:gn});function Vt(n){return n.__forward_ref__=Vt,n.toString=function(){return on(this())},n}function _t(n){return _M(n)?n():n}function _M(n){return"function"==typeof n&&n.hasOwnProperty(w3)&&n.__forward_ref__===Vt}class Ut extends Error{constructor(e,t){super(function S0(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function dt(n){return"string"==typeof n?n:null==n?"":String(n)}function Ci(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():dt(n)}function ip(n,e){const t=e?` in ${e}`:"";throw new Ut(-201,`No provider for ${Ci(n)} found${t}`)}function Mr(n,e){null==n&&function Dn(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Ye(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function zt(n){return{providers:n.providers||[],imports:n.imports||[]}}function E0(n){return yM(n,rp)||yM(n,bM)}function yM(n,e){return n.hasOwnProperty(e)?n[e]:null}function vM(n){return n&&(n.hasOwnProperty(C0)||n.hasOwnProperty(T3))?n[C0]:null}const rp=gn({\u0275prov:gn}),C0=gn({\u0275inj:gn}),bM=gn({ngInjectableDef:gn}),T3=gn({ngInjectorDef:gn});var at=(()=>((at=at||{})[at.Default=0]="Default",at[at.Host=1]="Host",at[at.Self=2]="Self",at[at.SkipSelf=4]="SkipSelf",at[at.Optional=8]="Optional",at))();let T0;function Js(n){const e=T0;return T0=n,e}function wM(n,e,t){const i=E0(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&at.Optional?null:void 0!==e?e:void ip(on(n),"Injector")}function Qs(n){return{toString:n}.toString()}var po=(()=>((po=po||{})[po.OnPush=0]="OnPush",po[po.Default=1]="Default",po))(),zo=(()=>{return(n=zo||(zo={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",zo;var n})();const I3="undefined"!=typeof globalThis&&globalThis,R3="undefined"!=typeof window&&window,N3="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,un=I3||"undefined"!=typeof global&&global||R3||N3,tc={},mn=[],op=gn({\u0275cmp:gn}),A0=gn({\u0275dir:gn}),I0=gn({\u0275pipe:gn}),xM=gn({\u0275mod:gn}),vs=gn({\u0275fac:gn}),wd=gn({__NG_ELEMENT_ID__:gn});let P3=0;function He(n){return Qs(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===po.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||mn,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||zo.Emulated,id:"c",styles:n.styles||mn,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,o=n.features,s=n.pipes;return i.id+=P3++,i.inputs=EM(n.inputs,t),i.outputs=EM(n.outputs),o&&o.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(MM):null,i.pipeDefs=s?()=>("function"==typeof s?s():s).map(DM):null,i})}function MM(n){return ki(n)||function ea(n){return n[A0]||null}(n)}function DM(n){return function Qa(n){return n[I0]||null}(n)}const SM={};function $t(n){return Qs(()=>{const e={type:n.type,bootstrap:n.bootstrap||mn,declarations:n.declarations||mn,imports:n.imports||mn,exports:n.exports||mn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(SM[n.id]=n.type),e})}function EM(n,e){if(null==n)return tc;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),t[r]=i,e&&(e[r]=o)}return t}const me=He;function ki(n){return n[op]||null}function Gr(n,e){const t=n[xM]||null;if(!t&&!0===e)throw new Error(`Type ${on(n)} does not have '\u0275mod' property.`);return t}function Go(n){return Array.isArray(n)&&"object"==typeof n[1]}function mo(n){return Array.isArray(n)&&!0===n[1]}function P0(n){return 0!=(8&n.flags)}function cp(n){return 2==(2&n.flags)}function up(n){return 1==(1&n.flags)}function _o(n){return null!==n.template}function V3(n){return 0!=(512&n[2])}function il(n,e){return n.hasOwnProperty(vs)?n[vs]:null}class z3{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Bi(){return TM}function TM(n){return n.type.prototype.ngOnChanges&&(n.setInput=j3),G3}function G3(){const n=IM(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===tc)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function j3(n,e,t,i){const r=IM(n)||function W3(n,e){return n[AM]=e}(n,{previous:tc,current:null}),o=r.current||(r.current={}),s=r.previous,a=this.declaredInputs[t],l=s[a];o[a]=new z3(l&&l.currentValue,e,s===tc),n[i]=e}Bi.ngInherit=!0;const AM="__ngSimpleChanges__";function IM(n){return n[AM]||null}let B0;function Hn(n){return!!n.listen}const RM={createRenderer:(n,e)=>function V0(){return void 0!==B0?B0:"undefined"!=typeof document?document:void 0}()};function ti(n){for(;Array.isArray(n);)n=n[0];return n}function dp(n,e){return ti(e[n])}function $r(n,e){return ti(e[n.index])}function H0(n,e){return n.data[e]}function Sr(n,e){const t=e[n];return Go(t)?t:t[0]}function NM(n){return 4==(4&n[2])}function U0(n){return 128==(128&n[2])}function ta(n,e){return null==e?null:n[e]}function PM(n){n[18]=0}function z0(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const ot={lFrame:UM(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function OM(){return ot.bindingsEnabled}function le(){return ot.lFrame.lView}function Gt(){return ot.lFrame.tView}function ge(n){return ot.lFrame.contextLView=n,n[8]}function di(){let n=FM();for(;null!==n&&64===n.type;)n=n.parent;return n}function FM(){return ot.lFrame.currentTNode}function jo(n,e){const t=ot.lFrame;t.currentTNode=n,t.isParent=e}function G0(){return ot.lFrame.isParent}function j0(){ot.lFrame.isParent=!1}function hp(){return ot.isInCheckNoChangesMode}function fp(n){ot.isInCheckNoChangesMode=n}function Xi(){const n=ot.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function ac(){return ot.lFrame.bindingIndex++}function ws(n){const e=ot.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function lL(n,e){const t=ot.lFrame;t.bindingIndex=t.bindingRootIndex=n,W0(e)}function W0(n){ot.lFrame.currentDirectiveIndex=n}function BM(){return ot.lFrame.currentQueryIndex}function q0(n){ot.lFrame.currentQueryIndex=n}function uL(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function VM(n,e,t){if(t&at.SkipSelf){let r=e,o=n;for(;!(r=r.parent,null!==r||t&at.Host||(r=uL(o),null===r||(o=o[15],10&r.type))););if(null===r)return!1;e=r,n=o}const i=ot.lFrame=HM();return i.currentTNode=e,i.lView=n,!0}function pp(n){const e=HM(),t=n[1];ot.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function HM(){const n=ot.lFrame,e=null===n?null:n.child;return null===e?UM(n):e}function UM(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function zM(){const n=ot.lFrame;return ot.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const GM=zM;function gp(){const n=zM();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ki(){return ot.lFrame.selectedIndex}function na(n){ot.lFrame.selectedIndex=n}function Un(){const n=ot.lFrame;return H0(n.tView,n.selectedIndex)}function mp(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=o;s&&(n.contentHooks||(n.contentHooks=[])).push(-t,s),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function _p(n,e,t){jM(n,e,3,t)}function yp(n,e,t,i){(3&n[2])===t&&jM(n,e,t,i)}function Y0(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function jM(n,e,t,i){const o=null!=i?i:-1,s=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<s;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<o||-1==o)&&(vL(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function vL(n,e,t,i){const r=t[i]<0,o=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{o.call(a)}finally{}}}else try{o.call(a)}finally{}}class Ed{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function vp(n,e,t){const i=Hn(n);let r=0;for(;r<t.length;){const o=t[r];if("number"==typeof o){if(0!==o)break;r++;const s=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,s):e.setAttributeNS(s,a,l)}else{const s=o,a=t[++r];X0(s)?i&&n.setProperty(e,s,a):i?n.setAttribute(e,s,a):e.setAttribute(s,a),r++}}return r}function WM(n){return 3===n||4===n||6===n}function X0(n){return 64===n.charCodeAt(0)}function bp(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||$M(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function $M(n,e,t,i,r){let o=0,s=n.length;if(-1===e)s=-1;else for(;o<n.length;){const a=n[o++];if("number"==typeof a){if(a===e){s=-1;break}if(a>e){s=o-1;break}}}for(;o<n.length;){const a=n[o];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[o+1]=r));if(i===n[o+1])return void(n[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),null!==i&&n.splice(o++,0,i),null!==r&&n.splice(o++,0,r)}function qM(n){return-1!==n}function lc(n){return 32767&n}function cc(n,e){let t=function DL(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let K0=!0;function wp(n){const e=K0;return K0=n,e}let SL=0;function Td(n,e){const t=Q0(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,J0(i.data,n),J0(e,null),J0(i.blueprint,null));const r=xp(n,e),o=n.injectorIndex;if(qM(r)){const s=lc(r),a=cc(r,e),l=a[1].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=r,o}function J0(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Q0(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function xp(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const o=r[1],s=o.type;if(i=2===s?o.declTNode:1===s?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function Mp(n,e,t){!function EL(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(wd)&&(i=t[wd]),null==i&&(i=t[wd]=SL++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function XM(n,e,t){if(t&at.Optional)return n;ip(e,"NodeInjector")}function KM(n,e,t,i){if(t&at.Optional&&void 0===i&&(i=null),0==(t&(at.Self|at.Host))){const r=n[9],o=Js(void 0);try{return r?r.get(e,i,t&at.Optional):wM(e,i,t&at.Optional)}finally{Js(o)}}return XM(i,e,t)}function JM(n,e,t,i=at.Default,r){if(null!==n){const o=function IL(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(wd)?n[wd]:void 0;return"number"==typeof e?e>=0?255&e:TL:e}(t);if("function"==typeof o){if(!VM(e,n,i))return i&at.Host?XM(r,t,i):KM(e,t,i,r);try{const s=o(i);if(null!=s||i&at.Optional)return s;ip(t)}finally{GM()}}else if("number"==typeof o){let s=null,a=Q0(n,e),l=-1,c=i&at.Host?e[16][6]:null;for((-1===a||i&at.SkipSelf)&&(l=-1===a?xp(n,e):e[a+8],-1!==l&&tD(i,!1)?(s=e[1],a=lc(l),e=cc(l,e)):a=-1);-1!==a;){const u=e[1];if(eD(o,a,u.data)){const d=AL(a,e,t,s,i,c);if(d!==QM)return d}l=e[a+8],-1!==l&&tD(i,e[1].data[a+8]===c)&&eD(o,a,e)?(s=u,a=lc(l),e=cc(l,e)):a=-1}}}return KM(e,t,i,r)}const QM={};function TL(){return new uc(di(),le())}function AL(n,e,t,i,r,o){const s=e[1],a=s.data[n+8],u=Dp(a,s,t,null==i?cp(a)&&K0:i!=s&&0!=(3&a.type),r&at.Host&&o===a);return null!==u?Ad(e,s,u,a):QM}function Dp(n,e,t,i,r){const o=n.providerIndexes,s=e.data,a=1048575&o,l=n.directiveStart,u=o>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const g=s[f];if(f<l&&t===g||f>=l&&g.type===t)return f}if(r){const f=s[l];if(f&&_o(f)&&f.type===t)return l}return null}function Ad(n,e,t,i){let r=n[t];const o=e.data;if(function bL(n){return n instanceof Ed}(r)){const s=r;s.resolving&&function x3(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Ut(-200,`Circular dependency in DI detected for ${n}${t}`)}(Ci(o[t]));const a=wp(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Js(s.injectImpl):null;VM(n,i,at.Default);try{r=n[t]=s.factory(void 0,o,n,i),e.firstCreatePass&&t>=i.directiveStart&&function yL(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){const s=TM(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),o&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o))}(t,o[t],e)}finally{null!==l&&Js(l),wp(a),s.resolving=!1,GM()}}return r}function eD(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function tD(n,e){return!(n&at.Self||n&at.Host&&e)}class uc{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return JM(this._tNode,this._lView,e,i,t)}}function On(n){return Qs(()=>{const e=n.prototype.constructor,t=e[vs]||ey(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const o=r[vs]||ey(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function ey(n){return _M(n)?()=>{const e=ey(_t(n));return e&&e()}:il(n)}function rl(n){return function CL(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const o=t[r];if(WM(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(o===e)return t[r+1];r+=2}}}return null}(di(),n)}const hc="__parameters__";function pc(n,e,t){return Qs(()=>{const i=function ty(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(l,c,u){const d=l.hasOwnProperty(hc)?l[hc]:Object.defineProperty(l,hc,{value:[]})[hc];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(s),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class wt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Ye({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const NL=new wt("AnalyzeForEntryComponents");function qr(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),qr(i,e)):e!==n&&e.push(i)}return e}function Wo(n,e){n.forEach(t=>Array.isArray(t)?Wo(t,e):e(t))}function iD(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Sp(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Nd(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Er(n,e,t){let i=gc(n,e);return i>=0?n[1|i]=t:(i=~i,function FL(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function iy(n,e){const t=gc(n,e);if(t>=0)return n[1|t]}function gc(n,e){return function sD(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const o=i+(r-i>>1),s=n[o<<t];if(e===s)return o<<t;s>e?r=o:i=o+1}return~(r<<t)}(n,e,1)}const Pd={},oy="__NG_DI_FLAG__",Cp="ngTempTokenPath",zL=/\n/gm,lD="__source",jL=gn({provide:String,useValue:gn});let Od;function cD(n){const e=Od;return Od=n,e}function WL(n,e=at.Default){if(void 0===Od)throw new Ut(203,"");return null===Od?wM(n,void 0,e):Od.get(n,e&at.Optional?null:void 0,e)}function ke(n,e=at.Default){return(function A3(){return T0}()||WL)(_t(n),e)}const $L=ke;function sy(n){const e=[];for(let t=0;t<n.length;t++){const i=_t(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Ut(900,"");let r,o=at.Default;for(let s=0;s<i.length;s++){const a=i[s],l=qL(a);"number"==typeof l?-1===l?r=a.token:o|=l:r=a}e.push(ke(r,o))}else e.push(ke(i))}return e}function Fd(n,e){return n[oy]=e,n.prototype[oy]=e,n}function qL(n){return n[oy]}const Tp=Fd(pc("Inject",n=>({token:n})),-1),ra=Fd(pc("Optional"),8),kd=Fd(pc("SkipSelf"),4);function oa(n){return n instanceof class yD{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}?n.changingThisBreaksApplicationSecurity:n}const TD="__ngContext__";function Vi(n,e){n[TD]=e}function my(n){const e=function Ud(n){return n[TD]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function yy(n){return n.ngOriginalError}function VB(n,...e){n.error(...e)}class zd{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=function BB(n){return n&&n.ngErrorLogger||VB}(e);i(this._console,"ERROR",e),t&&i(this._console,"ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&yy(e);for(;t&&yy(t);)t=yy(t);return t||null}}const ZB=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(un))();function PD(n){return n.ownerDocument.defaultView}function qo(n){return n instanceof Function?n():n}var Cr=(()=>((Cr=Cr||{})[Cr.Important=1]="Important",Cr[Cr.DashCase=2]="DashCase",Cr))();function by(n,e){return undefined(n,e)}function Gd(n){const e=n[3];return mo(e)?e[3]:e}function wy(n){return BD(n[13])}function xy(n){return BD(n[4])}function BD(n){for(;null!==n&&!mo(n);)n=n[4];return n}function vc(n,e,t,i,r){if(null!=i){let o,s=!1;mo(i)?o=i:Go(i)&&(s=!0,i=i[0]);const a=ti(i);0===n&&null!==t?null==r?jD(e,t,a):ol(e,t,a,r||null,!0):1===n&&null!==t?ol(e,t,a,r||null,!0):2===n?function KD(n,e,t){const i=Op(n,e);i&&function lV(n,e,t,i){Hn(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,s):3===n&&e.destroyNode(a),null!=o&&function dV(n,e,t,i,r){const o=t[7];o!==ti(t)&&vc(e,n,i,o,r);for(let a=10;a<t.length;a++){const l=t[a];jd(l[1],l,n,e,i,o)}}(e,n,o,t,r)}}function Dy(n,e,t){if(Hn(n))return n.createElement(e,t);{const i=null!==t?function Z3(n){const e=n.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(t):null;return null===i?n.createElement(e):n.createElementNS(i,e)}}function HD(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,z0(r,-1)),t.splice(i,1)}function Sy(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&HD(r,i),e>0&&(n[t-1][4]=i[4]);const o=Sp(n,10+e);!function eV(n,e){jd(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const s=o[19];null!==s&&s.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function UD(n,e){if(!(256&e[2])){const t=e[11];Hn(t)&&t.destroyNode&&jd(n,e,t,3,null,null),function iV(n){let e=n[13];if(!e)return Ey(n[1],n);for(;e;){let t=null;if(Go(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)Go(e)&&Ey(e[1],e),e=e[3];null===e&&(e=n),Go(e)&&Ey(e[1],e),t=e&&e[4]}e=t}}(e)}}function Ey(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function aV(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Ed)){const o=t[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],l=o[s+1];try{l.call(a)}finally{}}else try{o.call(r)}finally{}}}}(n,e),function sV(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let o=0;o<t.length-1;o+=2)if("string"==typeof t[o]){const s=t[o+1],a="function"==typeof s?s(e):ti(e[s]),l=i[r=t[o+2]],c=t[o+3];"boolean"==typeof c?a.removeEventListener(t[o],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),o+=2}else{const s=i[r=t[o+1]];t[o].call(s)}if(null!==i){for(let o=r+1;o<i.length;o++)i[o]();e[7]=null}}(n,e),1===e[1].type&&Hn(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&mo(e[3])){t!==e[3]&&HD(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function zD(n,e,t){return function GD(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===zo.None||r===zo.Emulated)return null}return $r(i,t)}(n,e.parent,t)}function ol(n,e,t,i,r){Hn(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function jD(n,e,t){Hn(n)?n.appendChild(e,t):e.appendChild(t)}function WD(n,e,t,i,r){null!==i?ol(n,e,t,i,r):jD(n,e,t)}function Op(n,e){return Hn(n)?n.parentNode(e):e.parentNode}function $D(n,e,t){return YD(n,e,t)}let YD=function qD(n,e,t){return 40&n.type?$r(n,t):null};function Fp(n,e,t,i){const r=zD(n,i,e),o=e[11],a=$D(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)WD(o,r,t[l],a,!1);else WD(o,r,t,a,!1)}function kp(n,e){if(null!==e){const t=e.type;if(3&t)return $r(e,n);if(4&t)return Ty(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return kp(n,i);{const r=n[e.index];return mo(r)?Ty(-1,r):ti(r)}}if(32&t)return by(e,n)()||ti(n[e.index]);{const i=XD(n,e);return null!==i?Array.isArray(i)?i[0]:kp(Gd(n[16]),i):kp(n,e.next)}}return null}function XD(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Ty(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return kp(i,r)}return e[7]}function Ay(n,e,t,i,r,o,s){for(;null!=t;){const a=i[t.index],l=t.type;if(s&&0===e&&(a&&Vi(ti(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)Ay(n,e,t.child,i,r,o,!1),vc(e,n,r,a,o);else if(32&l){const c=by(t,i);let u;for(;u=c();)vc(e,n,r,u,o);vc(e,n,r,a,o)}else 16&l?JD(n,e,i,t,r,o):vc(e,n,r,a,o);t=s?t.projectionNext:t.next}}function jd(n,e,t,i,r,o){Ay(t,i,n.firstChild,e,r,o,!1)}function JD(n,e,t,i,r,o){const s=t[16],l=s[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)vc(e,n,r,l[c],o);else Ay(n,e,l,s[3],r,o,!0)}function QD(n,e,t){Hn(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function Iy(n,e,t){Hn(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function eS(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}const tS="ng-template";function fV(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==eS(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function nS(n){return 4===n.type&&n.value!==tS}function pV(n,e,t){return e===(4!==n.type||t?n.value:tS)}function gV(n,e,t){let i=4;const r=n.attrs||[],o=function yV(n){for(let e=0;e<n.length;e++)if(WM(n[e]))return e;return n.length}(r);let s=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!s)if(4&i){if(i=2|1&i,""!==l&&!pV(n,l,t)||""===l&&1===e.length){if(yo(i))return!1;s=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!fV(n.attrs,c,t)){if(yo(i))return!1;s=!0}continue}const d=mV(8&i?"class":l,r,nS(n),t);if(-1===d){if(yo(i))return!1;s=!0;continue}if(""!==c){let h;h=d>o?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==eS(f,c,0)||2&i&&c!==h){if(yo(i))return!1;s=!0}}}}else{if(!s&&!yo(i)&&!yo(l))return!1;if(s&&yo(l))continue;s=!1,i=l|1&i}}return yo(i)||s}function yo(n){return 0==(1&n)}function mV(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){const s=e[r];if(s===n)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function vV(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function iS(n,e,t=!1){for(let i=0;i<e.length;i++)if(gV(n,e[i],t))return!0;return!1}function bV(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function rS(n,e){return n?":not("+e.trim()+")":e}function wV(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let s=n[t];if("string"==typeof s)if(2&i){const a=n[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!yo(s)&&(e+=rS(o,r),r=""),i=s,o=o||!yo(i);t++}return""!==r&&(e+=rS(o,r)),e}const ht={};function A(n){oS(Gt(),le(),Ki()+n,hp())}function oS(n,e,t,i){if(!i)if(3==(3&e[2])){const o=n.preOrderCheckHooks;null!==o&&_p(e,o,t)}else{const o=n.preOrderHooks;null!==o&&yp(e,o,0,t)}na(t)}function Lp(n,e){return n<<17|e<<2}function vo(n){return n>>17&32767}function Ry(n){return 2|n}function xs(n){return(131068&n)>>2}function Ny(n,e){return-131069&n|e<<2}function Py(n){return 1|n}function mS(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],o=t[i+1];if(-1!==o){const s=n.data[o];q0(r),s.contentQueries(2,e[o],o)}}}function Wd(n,e,t,i,r,o,s,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,PM(u),u[3]=u[15]=n,u[8]=t,u[10]=s||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=o,u[16]=2==e.type?n[16]:u,u}function bc(n,e,t,i,r){let o=n.data[e];if(null===o)o=function zy(n,e,t,i,r){const o=FM(),s=G0(),l=n.data[e]=function VV(n,e,t,i,r,o){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==o&&(s?null==o.child&&null!==l.parent&&(o.child=l):null===o.next&&(o.next=l)),l}(n,e,t,i,r),function aL(){return ot.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=t,o.value=i,o.attrs=r;const s=function Sd(){const n=ot.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return jo(o,!0),o}function wc(n,e,t,i){if(0===t)return-1;const r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function $d(n,e,t){pp(e);try{const i=n.viewQuery;null!==i&&Ky(1,i,t);const r=n.template;null!==r&&_S(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&mS(n,e),n.staticViewQueries&&Ky(2,n.viewQuery,t);const o=n.components;null!==o&&function kV(n,e){for(let t=0;t<e.length;t++)iH(n,e[t])}(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,gp()}}function xc(n,e,t,i){const r=e[2];if(256==(256&r))return;pp(e);const o=hp();try{PM(e),function kM(n){return ot.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&_S(n,e,t,2,i);const s=3==(3&r);if(!o)if(s){const c=n.preOrderCheckHooks;null!==c&&_p(e,c,null)}else{const c=n.preOrderHooks;null!==c&&yp(e,c,0,null),Y0(e,0)}if(function tH(n){for(let e=wy(n);null!==e;e=xy(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],o=r[3];0==(1024&r[2])&&z0(o,1),r[2]|=1024}}}(e),function eH(n){for(let e=wy(n);null!==e;e=xy(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];U0(i)&&xc(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&mS(n,e),!o)if(s){const c=n.contentCheckHooks;null!==c&&_p(e,c)}else{const c=n.contentHooks;null!==c&&yp(e,c,1),Y0(e,1)}!function OV(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)na(~r);else{const o=r,s=t[++i],a=t[++i];lL(s,o),a(2,e[o])}}}finally{na(-1)}}(n,e);const a=n.components;null!==a&&function FV(n,e){for(let t=0;t<e.length;t++)nH(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&Ky(2,l,i),!o)if(s){const c=n.viewCheckHooks;null!==c&&_p(e,c)}else{const c=n.viewHooks;null!==c&&yp(e,c,2),Y0(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),o||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,z0(e[3],-1))}finally{gp()}}function LV(n,e,t,i){const r=e[10],o=!hp(),s=NM(e);try{o&&!s&&r.begin&&r.begin(),s&&$d(n,e,i),xc(n,e,t,i)}finally{o&&!s&&r.end&&r.end()}}function _S(n,e,t,i,r){const o=Ki(),s=2&i;try{na(-1),s&&e.length>20&&oS(n,e,20,hp()),t(i,r)}finally{na(o)}}function yS(n,e,t){if(P0(e)){const r=e.directiveEnd;for(let o=e.directiveStart;o<r;o++){const s=n.data[o];s.contentQueries&&s.contentQueries(1,t[o],o)}}}function Gy(n,e,t){!OM()||(function $V(n,e,t,i){const r=t.directiveStart,o=t.directiveEnd;n.firstCreatePass||Td(t,e),Vi(i,e);const s=t.initialInputs;for(let a=r;a<o;a++){const l=n.data[a],c=_o(l);c&&KV(e,t,l);const u=Ad(e,n,a,t);Vi(u,e),null!==s&&JV(0,a-r,u,l,0,s),c&&(Sr(t.index,e)[8]=u)}}(n,e,t,$r(t,e)),128==(128&t.flags)&&function qV(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,a=function cL(){return ot.lFrame.currentDirectiveIndex}();try{na(s);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];W0(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&ES(c,u)}}finally{na(-1),W0(a)}}(n,e,t))}function jy(n,e,t=$r){const i=e.localNames;if(null!==i){let r=e.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?t(e,n):n[s];n[r++]=a}}}function vS(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Hp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Hp(n,e,t,i,r,o,s,a,l,c){const u=20+i,d=u+r,h=function BV(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:ht);return t}(u,d),f="function"==typeof c?c():c;return h[1]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function xS(n,e,t,i){const r=NS(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&PS(n).push(i,r.length-1))}function MS(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function Tr(n,e,t,i,r,o,s,a){const l=$r(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(kS(n,t,u,i,r),cp(e)&&function zV(n,e){const t=Sr(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function UV(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=s?s(r,e.value||"",i):r,Hn(o)?o.setProperty(l,i,r):X0(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function Wy(n,e,t,i){let r=!1;if(OM()){const o=function YV(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let o=0;o<i.length;o++){const s=i[o];iS(t,s.selectors,!1)&&(r||(r=[]),Mp(Td(t,e),n,s.type),_o(s)?(CS(n,t),r.unshift(s)):r.push(s))}return r}(n,e,t),s=null===i?null:{"":-1};if(null!==o){r=!0,TS(t,n.data.length,o.length);for(let u=0;u<o.length;u++){const d=o[u];d.providersResolver&&d.providersResolver(d)}let a=!1,l=!1,c=wc(n,e,o.length,null);for(let u=0;u<o.length;u++){const d=o[u];t.mergedAttrs=bp(t.mergedAttrs,d.hostAttrs),AS(n,t,e,c,d),XV(c,d,s),null!==d.contentQueries&&(t.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=128);const h=d.type.prototype;!a&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function HV(n,e){const i=e.directiveEnd,r=n.data,o=e.attrs,s=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],d=u.inputs,h=null===o||nS(e)?null:QV(d,o);s.push(h),a=MS(d,c,a),l=MS(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=s,e.inputs=a,e.outputs=l}(n,t)}s&&function ZV(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const o=t[e[r+1]];if(null==o)throw new Ut(-301,!1);i.push(e[r],o)}}}(t,i,s)}return t.mergedAttrs=bp(t.mergedAttrs,t.attrs),r}function SS(n,e,t,i,r,o){const s=o.hostBindings;if(s){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function WV(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,s)}}function ES(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function CS(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function XV(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;_o(e)&&(t[""]=n)}}function TS(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function AS(n,e,t,i,r){n.data[i]=r;const o=r.factory||(r.factory=il(r.type)),s=new Ed(o,_o(r),null);n.blueprint[i]=s,t[i]=s,SS(n,e,0,i,wc(n,t,r.hostVars,ht),r)}function KV(n,e,t){const i=$r(e,n),r=vS(t),o=n[10],s=Up(n,Wd(n,r,null,t.onPush?64:16,i,e,o,o.createRenderer(i,t),null,null));n[e.index]=s}function Yo(n,e,t,i,r,o){const s=$r(n,e);!function $y(n,e,t,i,r,o,s){if(null==o)Hn(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==s?dt(o):s(o,i||"",r);Hn(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],s,o,n.value,t,i,r)}function JV(n,e,t,i,r,o){const s=o[e];if(null!==s){const a=i.setInput;for(let l=0;l<s.length;){const c=s[l++],u=s[l++],d=s[l++];null!==a?i.setInput(t,d,c,u):t[u]=d}}}function QV(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function IS(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function nH(n,e){const t=Sr(e,n);if(U0(t)){const i=t[1];80&t[2]?xc(i,t,i.template,t[8]):t[5]>0&&qy(t)}}function qy(n){for(let i=wy(n);null!==i;i=xy(i))for(let r=10;r<i.length;r++){const o=i[r];if(1024&o[2]){const s=o[1];xc(s,o,s.template,o[8])}else o[5]>0&&qy(o)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Sr(t[i],n);U0(r)&&r[5]>0&&qy(r)}}function iH(n,e){const t=Sr(e,n),i=t[1];(function rH(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),$d(i,t,t[8])}function Up(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function Yy(n){for(;n;){n[2]|=64;const e=Gd(n);if(V3(n)&&!e)return n;n=e}return null}function Xy(n,e,t){const i=e[10];i.begin&&i.begin();try{xc(n,e,n.template,t)}catch(r){throw FS(e,r),r}finally{i.end&&i.end()}}function RS(n){!function Zy(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=my(t),r=i[1];LV(r,i,r.template,t)}}(n[8])}function Ky(n,e,t){q0(0),e(n,t)}const lH=(()=>Promise.resolve(null))();function NS(n){return n[7]||(n[7]=[])}function PS(n){return n.cleanup||(n.cleanup=[])}function FS(n,e){const t=n[9],i=t?t.get(zd,null):null;i&&i.handleError(e)}function kS(n,e,t,i,r){for(let o=0;o<t.length;){const s=t[o++],a=t[o++],l=e[s],c=n.data[s];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Ms(n,e,t){const i=dp(e,n);!function VD(n,e,t){Hn(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function zp(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?o=a:1==o?r=D0(r,a):2==o&&(i=D0(i,a+": "+e[++s]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const Jy=new wt("INJECTOR",-1);class LS{get(e,t=Pd){if(t===Pd){const i=new Error(`NullInjectorError: No provider for ${on(e)}!`);throw i.name="NullInjectorError",i}return t}}const Qy=new wt("Set Injector scope."),qd={},dH={};let ev;function BS(){return void 0===ev&&(ev=new LS),ev}function VS(n,e=null,t=null,i){const r=HS(n,e,t,i);return r._resolveInjectorDefTypes(),r}function HS(n,e=null,t=null,i){return new hH(n,t,e||BS(),i)}class hH{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const o=[];t&&Wo(t,a=>this.processProvider(a,e,t)),Wo([e],a=>this.processInjectorType(a,[],o)),this.records.set(Jy,Mc(void 0,this));const s=this.records.get(Qy);this.scope=null!=s?s.value:null,this.source=r||("object"==typeof e?null:on(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=Pd,i=at.Default){this.assertNotDestroyed();const r=cD(this),o=Js(void 0);try{if(!(i&at.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function bH(n){return"function"==typeof n||"object"==typeof n&&n instanceof wt}(e)&&E0(e);a=l&&this.injectableDefInScope(l)?Mc(tv(e),qd):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&at.Self?BS():this.parent).get(e,t=i&at.Optional&&t===Pd?null:t)}catch(s){if("NullInjectorError"===s.name){if((s[Cp]=s[Cp]||[]).unshift(on(e)),r)throw s;return function YL(n,e,t,i){const r=n[Cp];throw e[lD]&&r.unshift(e[lD]),n.message=function ZL(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=on(e);if(Array.isArray(e))r=e.map(on).join(" -> ");else if("object"==typeof e){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):on(a)))}r=`{${o.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(zL,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Cp]=null,n}(s,e,"R3InjectorError",this.source)}throw s}finally{Js(o),cD(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(on(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ut(205,!1)}processInjectorType(e,t,i){if(!(e=_t(e)))return!1;let r=vM(e);const o=null==r&&e.ngModule||void 0,s=void 0===o?e:o,a=-1!==i.indexOf(s);if(void 0!==o&&(r=vM(o)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(s);try{Wo(r.imports,d=>{this.processInjectorType(d,t,i)&&(void 0===u&&(u=[]),u.push(d))})}finally{}if(void 0!==u)for(let d=0;d<u.length;d++){const{ngModule:h,providers:f}=u[d];Wo(f,g=>this.processProvider(g,h,f||mn))}}this.injectorDefTypes.add(s);const l=il(s)||(()=>new s);this.records.set(s,Mc(l,qd));const c=r.providers;if(null!=c&&!a){const u=e;Wo(c,d=>this.processProvider(d,u,c))}return void 0!==o&&void 0!==e.providers}processProvider(e,t,i){let r=Dc(e=_t(e))?e:_t(e&&e.provide);const o=function pH(n,e,t){return zS(n)?Mc(void 0,n.useValue):Mc(US(n),qd)}(e);if(Dc(e)||!0!==e.multi)this.records.get(r);else{let s=this.records.get(r);s||(s=Mc(void 0,qd,!0),s.factory=()=>sy(s.multi),this.records.set(r,s)),r=e,s.multi.push(e)}this.records.set(r,o)}hydrate(e,t){return t.value===qd&&(t.value=dH,t.value=t.factory()),"object"==typeof t.value&&t.value&&function vH(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=_t(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function tv(n){const e=E0(n),t=null!==e?e.factory:il(n);if(null!==t)return t;if(n instanceof wt)throw new Ut(204,!1);if(n instanceof Function)return function fH(n){const e=n.length;if(e>0)throw Nd(e,"?"),new Ut(204,!1);const t=function E3(n){const e=n&&(n[rp]||n[bM]);if(e){const t=function C3(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Ut(204,!1)}function US(n,e,t){let i;if(Dc(n)){const r=_t(n);return il(r)||tv(r)}if(zS(n))i=()=>_t(n.useValue);else if(function mH(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...sy(n.deps||[]));else if(function gH(n){return!(!n||!n.useExisting)}(n))i=()=>ke(_t(n.useExisting));else{const r=_t(n&&(n.useClass||n.provide));if(!function yH(n){return!!n.deps}(n))return il(r)||tv(r);i=()=>new r(...sy(n.deps))}return i}function Mc(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function zS(n){return null!==n&&"object"==typeof n&&jL in n}function Dc(n){return"function"==typeof n}let Ti=(()=>{class n{static create(t,i){var r;if(Array.isArray(t))return VS({name:""},i,t,"");{const o=null!==(r=t.name)&&void 0!==r?r:"";return VS({name:o},t.parent,t.providers,o)}}}return n.THROW_IF_NOT_FOUND=Pd,n.NULL=new LS,n.\u0275prov=Ye({token:n,providedIn:"any",factory:()=>ke(Jy)}),n.__NG_ELEMENT_ID__=-1,n})();function TH(n,e){mp(my(n)[1],di())}function lt(n){let e=function eE(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(_o(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Ut(903,"");r=e.\u0275dir}if(r){if(t){i.push(r);const s=n;s.inputs=rv(n.inputs),s.declaredInputs=rv(n.declaredInputs),s.outputs=rv(n.outputs);const a=r.hostBindings;a&&NH(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&IH(n,l),c&&RH(n,c),M0(n.inputs,r.inputs),M0(n.declaredInputs,r.declaredInputs),M0(n.outputs,r.outputs),_o(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(n),a===lt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function AH(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=bp(r.hostAttrs,t=bp(t,r.hostAttrs))}}(i)}function rv(n){return n===tc?{}:n===mn?[]:n}function IH(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function RH(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,o)=>{e(i,r,o),t(i,r,o)}:e}function NH(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}let Gp=null;function Sc(){if(!Gp){const n=un.Symbol;if(n&&n.iterator)Gp=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Gp=i)}}}return Gp}function Yd(n){return!!ov(n)&&(Array.isArray(n)||!(n instanceof Map)&&Sc()in n)}function ov(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Zo(n,e,t){return n[e]=t}function Hi(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function sl(n,e,t,i){const r=Hi(n,e,t);return Hi(n,e+1,i)||r}function sn(n,e,t,i){const r=le();return Hi(r,ac(),e)&&(Gt(),Yo(Un(),r,n,e,t,i)),sn}function Cc(n,e,t,i){return Hi(n,ac(),t)?e+dt(t)+i:ht}function Tc(n,e,t,i,r,o){const a=sl(n,function bs(){return ot.lFrame.bindingIndex}(),t,r);return ws(2),a?e+dt(t)+i+dt(r)+o:ht}function W(n,e,t,i,r,o,s,a){const l=le(),c=Gt(),u=n+20,d=c.firstCreatePass?function VH(n,e,t,i,r,o,s,a,l){const c=e.consts,u=bc(e,n,4,s||null,ta(c,a));Wy(e,t,u,ta(c,l)),mp(e,u);const d=u.tViews=Hp(2,u,i,r,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,o,s):c.data[u];jo(d,!1);const h=l[11].createComment("");Fp(c,l,h,d),Vi(h,l),Up(l,l[u]=IS(h,l,h,d)),up(d)&&Gy(c,l,d),null!=s&&jy(l,d,a)}function gt(n){return function sc(n,e){return n[e]}(function sL(){return ot.lFrame.contextLView}(),20+n)}function k(n,e=at.Default){const t=le();return null===t?ke(n,e):JM(di(),t,_t(n),e)}function uv(){throw new Error("invalid")}function S(n,e,t){const i=le();return Hi(i,ac(),e)&&Tr(Gt(),Un(),i,n,e,i[11],t,!1),S}function dv(n,e,t,i,r){const s=r?"class":"style";kS(n,t,e.inputs[s],s,i)}function F(n,e,t,i){const r=le(),o=Gt(),s=20+n,a=r[11],l=r[s]=Dy(a,e,function _L(){return ot.lFrame.currentNamespace}()),c=o.firstCreatePass?function sU(n,e,t,i,r,o,s){const a=e.consts,c=bc(e,n,2,r,ta(a,o));return Wy(e,t,c,ta(a,s)),null!==c.attrs&&zp(c,c.attrs,!1),null!==c.mergedAttrs&&zp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(s,o,r,0,e,t,i):o.data[s];jo(c,!0);const u=c.mergedAttrs;null!==u&&vp(a,l,u);const d=c.classes;null!==d&&Iy(a,l,d);const h=c.styles;return null!==h&&QD(a,l,h),64!=(64&c.flags)&&Fp(o,r,l,c),0===function tL(){return ot.lFrame.elementDepthCount}()&&Vi(l,r),function nL(){ot.lFrame.elementDepthCount++}(),up(c)&&(Gy(o,r,c),yS(o,c,r)),null!==i&&jy(r,c),F}function B(){let n=di();G0()?j0():(n=n.parent,jo(n,!1));const e=n;!function iL(){ot.lFrame.elementDepthCount--}();const t=Gt();return t.firstCreatePass&&(mp(t,n),P0(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function xL(n){return 0!=(16&n.flags)}(e)&&dv(t,e,le(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function ML(n){return 0!=(32&n.flags)}(e)&&dv(t,e,le(),e.stylesWithoutHost,!1),B}function he(n,e,t,i){return F(n,e,t,i),B(),he}function qt(n,e,t){const i=le(),r=Gt(),o=n+20,s=r.firstCreatePass?function aU(n,e,t,i,r){const o=e.consts,s=ta(o,i),a=bc(e,n,8,"ng-container",s);return null!==s&&zp(a,s,!0),Wy(e,t,a,ta(o,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(o,r,i,e,t):r.data[o];jo(s,!0);const a=i[o]=i[11].createComment("");return Fp(r,i,a,s),Vi(a,i),up(s)&&(Gy(r,i,s),yS(r,s,i)),null!=t&&jy(i,s),qt}function Yt(){let n=di();const e=Gt();return G0()?j0():(n=n.parent,jo(n,!1)),e.firstCreatePass&&(mp(e,n),P0(n)&&e.queries.elementEnd(n)),Yt}function tn(n,e,t){return qt(n,e,t),Yt(),tn}function nt(){return le()}function Xd(n){return!!n&&"function"==typeof n.then}const hv=function bE(n){return!!n&&"function"==typeof n.subscribe};function Y(n,e,t,i){const r=le(),o=Gt(),s=di();return function xE(n,e,t,i,r,o,s,a){const l=up(i),u=n.firstCreatePass&&PS(n),d=e[8],h=NS(e);let f=!0;if(3&i.type||a){const m=$r(i,e),y=a?a(m):m,_=h.length,v=a?b=>a(ti(b[i.index])):i.index;if(Hn(t)){let b=null;if(!a&&l&&(b=function lU(n,e,t,i){const r=n.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===t&&r[o+1]===i){const a=e[7],l=r[o+2];return a.length>l?a[l]:null}"string"==typeof s&&(o+=2)}return null}(n,e,r,i.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=o,b.__ngLastListenerFn__=o,f=!1;else{o=fv(i,e,d,o,!1);const w=t.listen(y,r,o);h.push(o,w),u&&u.push(r,v,_,_+1)}}else o=fv(i,e,d,o,!0),y.addEventListener(r,o,s),h.push(o),u&&u.push(r,v,_,s)}else o=fv(i,e,d,o,!1);const g=i.outputs;let p;if(f&&null!==g&&(p=g[r])){const m=p.length;if(m)for(let y=0;y<m;y+=2){const D=e[p[y]][p[y+1]].subscribe(o),C=h.length;h.push(o,D),u&&u.push(r,i.index,C,-(C+1))}}}(o,r,r[11],s,n,e,!!t,i),Y}function ME(n,e,t,i){try{return!1!==t(i)}catch(r){return FS(n,r),!1}}function fv(n,e,t,i,r){return function o(s){if(s===Function)return i;const a=2&n.flags?Sr(n.index,e):e;0==(32&e[2])&&Yy(a);let l=ME(e,0,i,s),c=o.__ngNextListenerFn__;for(;c;)l=ME(e,0,c,s)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(s.preventDefault(),s.returnValue=!1),l}}function H(n=1){return function dL(n){return(ot.lFrame.contextLView=function hL(n,e){for(;n>0;)e=e[15],n--;return e}(n,ot.lFrame.contextLView))[8]}(n)}function cU(n,e){let t=null;const i=function _V(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const o=e[r];if("*"!==o){if(null===i?iS(n,o,!0):bV(i,o))return r}else t=r}return t}function kc(n){const e=le()[16][6];if(!e.projection){const i=e.projection=Nd(n?n.length:1,null),r=i.slice();let o=e.child;for(;null!==o;){const s=n?cU(o,n):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function Lc(n,e=0,t){const i=le(),r=Gt(),o=bc(r,20+n,16,null,t||null);null===o.projection&&(o.projection=e),j0(),64!=(64&o.flags)&&function uV(n,e,t){JD(e[11],0,e,t,zD(n,t,e),$D(t.parent||e[6],t,e))}(r,i,o)}function Zr(n,e,t){return $p(n,"",e,"",t),Zr}function $p(n,e,t,i,r){const o=le(),s=Cc(o,e,t,i);return s!==ht&&Tr(Gt(),Un(),o,n,s,o[11],r,!1),$p}function NE(n,e,t,i,r){const o=n[t+1],s=null===e;let a=i?vo(o):xs(o),l=!1;for(;0!==a&&(!1===l||s);){const u=n[a+1];hU(n[a],e)&&(l=!0,n[a+1]=i?Py(u):Ry(u)),a=i?vo(u):xs(u)}l&&(n[t+1]=i?Ry(o):Py(o))}function hU(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&gc(n,e)>=0}const fi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function PE(n){return n.substring(fi.key,fi.keyEnd)}function OE(n,e){const t=fi.textEnd;return t===e?-1:(e=fi.keyEnd=function mU(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}(n,fi.key=e,t),Bc(n,e,t))}function Bc(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function al(n,e,t){return wo(n,e,t,!1),al}function Ze(n,e){return wo(n,e,null,!0),Ze}function Ds(n){!function xo(n,e,t,i){const r=Gt(),o=ws(2);r.firstUpdatePass&&HE(r,null,o,i);const s=le();if(t!==ht&&Hi(s,o,t)){const a=r.data[Ki()];if(jE(a,i)&&!VE(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(t=D0(l,t||"")),dv(r,a,s,t,i)}else!function SU(n,e,t,i,r,o,s,a){r===ht&&(r=mn);let l=0,c=0,u=0<r.length?r[0]:null,d=0<o.length?o[0]:null;for(;null!==u||null!==d;){const h=l<r.length?r[l+1]:void 0,f=c<o.length?o[c+1]:void 0;let p,g=null;u===d?(l+=2,c+=2,h!==f&&(g=d,p=f)):null===d||null!==u&&u<d?(l+=2,g=u):(c+=2,g=d,p=f),null!==g&&zE(n,e,t,i,g,p,s,a),u=l<r.length?r[l]:null,d=c<o.length?o[c]:null}}(r,a,s,s[11],s[o+1],s[o+1]=function DU(n,e,t){if(null==t||""===t)return mn;const i=[],r=oa(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else"string"==typeof r&&e(i,r);return i}(n,e,t),i,o)}}(Er,Ko,n,!0)}function Ko(n,e){for(let t=function pU(n){return function kE(n){fi.key=0,fi.keyEnd=0,fi.value=0,fi.valueEnd=0,fi.textEnd=n.length}(n),OE(n,Bc(n,0,fi.textEnd))}(e);t>=0;t=OE(e,t))Er(n,PE(e),!0)}function wo(n,e,t,i){const r=le(),o=Gt(),s=ws(2);o.firstUpdatePass&&HE(o,n,s,i),e!==ht&&Hi(r,s,e)&&zE(o,o.data[Ki()],r,r[11],n,r[s+1]=function EU(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=on(oa(n)))),n}(e,t),i,s)}function VE(n,e){return e>=n.expandoStartIndex}function HE(n,e,t,i){const r=n.data;if(null===r[t+1]){const o=r[Ki()],s=VE(n,t);jE(o,i)&&null===e&&!s&&(e=!1),e=function bU(n,e,t,i){const r=function $0(n){const e=ot.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let o=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=Kd(t=pv(null,n,e,t,i),e.attrs,i),o=null);else{const s=e.directiveStylingLast;if(-1===s||n[s]!==r)if(t=pv(r,n,e,t,i),null===o){let l=function wU(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==xs(i))return n[vo(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=pv(null,n,e,l[1],i),l=Kd(l,e.attrs,i),function xU(n,e,t,i){n[vo(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else o=function MU(n,e,t){let i;const r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++)i=Kd(i,n[o].hostAttrs,t);return Kd(i,e.attrs,t)}(n,e,i)}return void 0!==o&&(i?e.residualClasses=o:e.residualStyles=o),t}(r,o,e,i),function uU(n,e,t,i,r,o){let s=o?e.classBindings:e.styleBindings,a=vo(s),l=xs(s);n[i]=t;let u,c=!1;if(Array.isArray(t)){const d=t;u=d[1],(null===u||gc(d,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const h=vo(n[a+1]);n[i+1]=Lp(h,a),0!==h&&(n[h+1]=Ny(n[h+1],i)),n[a+1]=function DV(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Lp(a,0),0!==a&&(n[a+1]=Ny(n[a+1],i)),a=i;else n[i+1]=Lp(l,0),0===a?a=i:n[l+1]=Ny(n[l+1],i),l=i;c&&(n[i+1]=Ry(n[i+1])),NE(n,u,i,!0),NE(n,u,i,!1),function dU(n,e,t,i,r){const o=r?n.residualClasses:n.residualStyles;null!=o&&"string"==typeof e&&gc(o,e)>=0&&(t[i+1]=Py(t[i+1]))}(e,u,n,i,o),s=Lp(a,l),o?e.classBindings=s:e.styleBindings=s}(r,o,e,t,s,i)}}function pv(n,e,t,i,r){let o=null;const s=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<s&&(o=e[a],i=Kd(i,o.hostAttrs,r),o!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function Kd(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let o=0;o<e.length;o++){const s=e[o];"number"==typeof s?r=s:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Er(n,s,!!t||e[++o]))}return void 0===n?null:n}function zE(n,e,t,i,r,o,s,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];qp(function lS(n){return 1==(1&n)}(c)?GE(l,e,t,r,xs(c),s):void 0)||(qp(o)||function aS(n){return 2==(2&n)}(c)&&(o=GE(l,null,t,r,a,s)),function hV(n,e,t,i,r){const o=Hn(n);if(e)r?o?n.addClass(t,i):t.classList.add(i):o?n.removeClass(t,i):t.classList.remove(i);else{let s=-1===i.indexOf("-")?void 0:Cr.DashCase;if(null==r)o?n.removeStyle(t,i,s):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),s|=Cr.Important),o?n.setStyle(t,i,r,s):t.style.setProperty(i,r,a?"important":"")}}}(i,s,dp(Ki(),t),r,o))}function GE(n,e,t,i,r,o){const s=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=t[r+1];h===ht&&(h=d?mn:void 0);let f=d?iy(h,i):u===i?h:void 0;if(c&&!qp(f)&&(f=iy(l,i)),qp(f)&&(a=f,s))return a;const g=n[r+1];r=s?vo(g):xs(g)}if(null!==e){let l=o?e.residualClasses:e.residualStyles;null!=l&&(a=iy(l,i))}return a}function qp(n){return void 0!==n}function jE(n,e){return 0!=(n.flags&(e?16:32))}function Rt(n,e=""){const t=le(),i=Gt(),r=n+20,o=i.firstCreatePass?bc(i,r,1,e,null):i.data[r],s=t[r]=function My(n,e){return Hn(n)?n.createText(e):n.createTextNode(e)}(t[11],e);Fp(i,t,s,o),jo(o,!1)}function Ui(n){return Jo("",n,""),Ui}function Jo(n,e,t){const i=le(),r=Cc(i,n,e,t);return r!==ht&&Ms(i,Ki(),r),Jo}function Yp(n,e,t,i,r){const o=le(),s=Tc(o,n,e,t,i,r);return s!==ht&&Ms(o,Ki(),s),Yp}function la(n,e,t){const i=le();return Hi(i,ac(),e)&&Tr(Gt(),Un(),i,n,e,i[11],t,!0),la}const Zp="en-US";let uC=Zp;function yv(n,e,t,i,r){if(n=_t(n),Array.isArray(n))for(let o=0;o<n.length;o++)yv(n[o],e,t,i,r);else{const o=Gt(),s=le();let a=Dc(n)?n:_t(n.provide),l=US(n);const c=di(),u=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(Dc(n)||!n.multi){const f=new Ed(l,r,k),g=bv(a,e,r?u:u+h,d);-1===g?(Mp(Td(c,s),o,a),vv(o,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),s.push(f)):(t[g]=f,s[g]=f)}else{const f=bv(a,e,u+h,d),g=bv(a,e,u,u+h),p=f>=0&&t[f],m=g>=0&&t[g];if(r&&!m||!r&&!p){Mp(Td(c,s),o,a);const y=function Gz(n,e,t,i,r){const o=new Ed(n,t,k);return o.multi=[],o.index=e,o.componentProviders=0,OC(o,r,i&&!t),o}(r?zz:Uz,t.length,r,i,l);!r&&m&&(t[g].providerFactory=y),vv(o,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(y),s.push(y)}else vv(o,n,f>-1?f:g,OC(t[r?g:f],l,!r&&i));!r&&i&&m&&t[g].componentProviders++}}}function vv(n,e,t,i){const r=Dc(e),o=function _H(n){return!!n.useClass}(e);if(r||o){const l=(o?_t(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[i,l]):c[u+1].push(i,l)}else c.push(t,l)}}}function OC(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function bv(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function Uz(n,e,t,i){return wv(this.multi,[])}function zz(n,e,t,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=Ad(t,t[1],this.providerFactory.index,i);o=a.slice(0,s),wv(r,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],wv(r,o);return o}function wv(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function dn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function Hz(n,e,t){const i=Gt();if(i.firstCreatePass){const r=_o(n);yv(t,i.data,i.blueprint,r,!0),yv(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class FC{}class $z{resolveComponentFactory(e){throw function Wz(n){const e=Error(`No component factory found for ${on(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let Uc=(()=>{class n{}return n.NULL=new $z,n})();function qz(){return zc(di(),le())}function zc(n,e){return new Kt($r(n,e))}let Kt=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=qz,n})();function Yz(n){return n instanceof Kt?n.nativeElement:n}class xv{}let zi=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Xz(){const n=le(),t=Sr(di().index,n);return function Zz(n){return n[11]}(Go(t)?t:n)}(),n})(),Kz=(()=>{class n{}return n.\u0275prov=Ye({token:n,providedIn:"root",factory:()=>null}),n})();class nh{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Jz=new nh("13.3.4"),Mv={};function eg(n,e,t,i,r=!1){for(;null!==t;){const o=e[t.index];if(null!==o&&i.push(ti(o)),mo(o))for(let a=10;a<o.length;a++){const l=o[a],c=l[1].firstChild;null!==c&&eg(l[1],l,c,i)}const s=t.type;if(8&s)eg(n,e,t.child,i);else if(32&s){const a=by(t,e);let l;for(;l=a();)i.push(l)}else if(16&s){const a=XD(e,t);if(Array.isArray(a))i.push(...a);else{const l=Gd(e[16]);eg(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class ih{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return eg(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(mo(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Sy(e,i),Sp(t,i))}this._attachedToViewContainer=!1}UD(this._lView[1],this._lView)}onDestroy(e){xS(this._lView[1],this._lView,null,e)}markForCheck(){Yy(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Xy(this._lView[1],this._lView,this.context)}checkNoChanges(){!function sH(n,e,t){fp(!0);try{Xy(n,e,t)}finally{fp(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Ut(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function nV(n,e){jd(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Ut(902,"");this._appRef=e}}class Qz extends ih{constructor(e){super(e),this._view=e}detectChanges(){RS(this._view)}checkNoChanges(){!function aH(n){fp(!0);try{RS(n)}finally{fp(!1)}}(this._view)}get context(){return null}}class LC extends Uc{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=ki(e);return new Dv(t,this.ngModule)}}function BC(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class Dv extends FC{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function xV(n){return n.map(wV).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return BC(this.componentDef.inputs)}get outputs(){return BC(this.componentDef.outputs)}create(e,t,i,r){const o=(r=r||this.ngModule)?function t4(n,e){return{get:(t,i,r)=>{const o=n.get(t,Mv,r);return o!==Mv||i===Mv?o:e.get(t,i,r)}}}(e,r.injector):e,s=o.get(xv,RM),a=o.get(Kz,null),l=s.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function wS(n,e,t){if(Hn(n))return n.selectRootElement(e,t===zo.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):Dy(s.createRenderer(null,this.componentDef),c,function e4(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(c)),d=this.componentDef.onPush?576:528,h=function QS(n,e){return{components:[],scheduler:n||ZB,clean:lH,playerHandler:e||null,flags:0}}(),f=Hp(0,null,null,1,0,null,null,null,null,null),g=Wd(null,f,h,d,null,null,s,l,a,o);let p,m;pp(g);try{const y=function KS(n,e,t,i,r,o){const s=t[1];t[20]=n;const l=bc(s,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(zp(l,c,!0),null!==n&&(vp(r,n,c),null!==l.classes&&Iy(r,n,l.classes),null!==l.styles&&QD(r,n,l.styles)));const u=i.createRenderer(n,e),d=Wd(t,vS(e),null,e.onPush?64:16,t[20],l,i,u,o||null,null);return s.firstCreatePass&&(Mp(Td(l,t),s,e.type),CS(s,l),TS(l,t.length,1)),Up(t,d),t[20]=d}(u,this.componentDef,g,s,l);if(u)if(i)vp(l,u,["ng-version",Jz.full]);else{const{attrs:_,classes:v}=function MV(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let o=n[i];if("string"==typeof o)2===r?""!==o&&e.push(o,n[++i]):8===r&&t.push(o);else{if(!yo(r))break;r=o}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);_&&vp(l,u,_),v&&v.length>0&&Iy(l,u,v.join(" "))}if(m=H0(f,20),void 0!==t){const _=m.projection=[];for(let v=0;v<this.ngContentSelectors.length;v++){const b=t[v];_.push(null!=b?Array.from(b):null)}}p=function JS(n,e,t,i,r){const o=t[1],s=function jV(n,e,t){const i=di();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),AS(n,i,e,wc(n,e,1,null),t));const r=Ad(e,n,i.directiveStart,i);Vi(r,e);const o=$r(i,e);return o&&Vi(o,e),r}(o,t,e);if(i.components.push(s),n[8]=s,r&&r.forEach(l=>l(s,e)),e.contentQueries){const l=di();e.contentQueries(1,s,l.directiveStart)}const a=di();return!o.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(na(a.index),SS(t[1],a,0,a.directiveStart,a.directiveEnd,e),ES(e,s)),s}(y,this.componentDef,g,h,[TH]),$d(f,g,null)}finally{gp()}return new i4(this.componentType,p,zc(m,g),g,m)}}class i4 extends class jz{}{constructor(e,t,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.instance=t,this.hostView=this.changeDetectorRef=new Qz(r),this.componentType=e}get injector(){return new uc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class Ss{}class VC{}const Gc=new Map;class zC extends Ss{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new LC(this);const i=Gr(e);this._bootstrapComponents=qo(i.bootstrap),this._r3Injector=HS(e,t,[{provide:Ss,useValue:this},{provide:Uc,useValue:this.componentFactoryResolver}],on(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Ti.THROW_IF_NOT_FOUND,i=at.Default){return e===Ti||e===Ss||e===Jy?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Sv extends VC{constructor(e){super(),this.moduleType=e,null!==Gr(e)&&function o4(n){const e=new Set;!function t(i){const r=Gr(i,!0),o=r.id;null!==o&&(function HC(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${on(e)} vs ${on(e.name)}`)}(o,Gc.get(o),i),Gc.set(o,i));const s=qo(r.imports);for(const a of s)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new zC(this.moduleType,e)}}function Xr(n,e,t){const i=Xi()+n,r=le();return r[i]===ht?Zo(r,i,t?e.call(t):e()):function Zd(n,e){return n[e]}(r,i)}function Ai(n,e,t,i){return function GC(n,e,t,i,r,o){const s=e+t;return Hi(n,s,r)?Zo(n,s+1,o?i.call(o,r):i(r)):rh(n,s+1)}(le(),Xi(),n,e,t,i)}function Mo(n,e,t,i,r){return function jC(n,e,t,i,r,o,s){const a=e+t;return sl(n,a,r,o)?Zo(n,a+2,s?i.call(s,r,o):i(r,o)):rh(n,a+2)}(le(),Xi(),n,e,t,i,r)}function Ar(n,e,t,i,r,o){return function WC(n,e,t,i,r,o,s,a){const l=e+t;return function jp(n,e,t,i,r){const o=sl(n,e,t,i);return Hi(n,e+2,r)||o}(n,l,r,o,s)?Zo(n,l+3,a?i.call(a,r,o,s):i(r,o,s)):rh(n,l+3)}(le(),Xi(),n,e,t,i,r,o)}function rh(n,e){const t=n[e];return t===ht?void 0:t}function Ev(n){return e=>{setTimeout(n,void 0,e)}}const Ne=class v4 extends Ft{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,o,s;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const d=e;a=null===(r=d.next)||void 0===r?void 0:r.bind(d),l=null===(o=d.error)||void 0===o?void 0:o.bind(d),c=null===(s=d.complete)||void 0===s?void 0:s.bind(d)}this.__isAsync&&(l=Ev(l),a&&(a=Ev(a)),c&&(c=Ev(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof Ve&&e.add(u),u}};function b4(){return this._results[Sc()]()}class Cv{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Sc(),i=Cv.prototype;i[t]||(i[t]=b4)}get changes(){return this._changes||(this._changes=new Ne)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=qr(e);(this._changesDetected=!function PL(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Tn=(()=>{class n{}return n.__NG_ELEMENT_ID__=M4,n})();const w4=Tn,x4=class extends w4{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=Wd(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(i[19]=o.createEmbeddedView(t)),$d(t,i,e),new ih(i)}};function M4(){return tg(di(),le())}function tg(n,e){return 4&n.type?new x4(e,n,zc(n,e)):null}let $n=(()=>{class n{}return n.__NG_ELEMENT_ID__=D4,n})();function D4(){return XC(di(),le())}const S4=$n,YC=class extends S4{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return zc(this._hostTNode,this._hostLView)}get injector(){return new uc(this._hostTNode,this._hostLView)}get parentInjector(){const e=xp(this._hostTNode,this._hostLView);if(qM(e)){const t=cc(e,this._hostLView),i=lc(e);return new uc(t[1].data[i+8],t)}return new uc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=ZC(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,o){const s=e&&!function Rd(n){return"function"==typeof n}(e);let a;if(s)a=t;else{const d=t||{};a=d.index,i=d.injector,r=d.projectableNodes,o=d.ngModuleRef}const l=s?e:new Dv(ki(e)),c=i||this.parentInjector;if(!o&&null==l.ngModule){const h=(s?c:this.parentInjector).get(Ss,null);h&&(o=h)}const u=l.create(c,r,void 0,o);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[1];if(function eL(n){return mo(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=i[3],h=new YC(d,d[6],d[3]);h.detach(h.indexOf(e))}}const o=this._adjustIndex(t),s=this._lContainer;!function rV(n,e,t,i){const r=10+i,o=t.length;i>0&&(t[r-1][4]=e),i<o-10?(e[4]=t[r],iD(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const s=e[17];null!==s&&t!==s&&function oV(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(s,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,s,o);const a=Ty(o,s),l=i[11],c=Op(l,s[7]);return null!==c&&function tV(n,e,t,i,r,o){i[0]=r,i[6]=e,jd(n,i,t,1,r,o)}(r,s[6],l,i,c,a),e.attachToViewContainerRef(),iD(Tv(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=ZC(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Sy(this._lContainer,t);i&&(Sp(Tv(this._lContainer),t),UD(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=Sy(this._lContainer,t);return i&&null!=Sp(Tv(this._lContainer),t)?new ih(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function ZC(n){return n[8]}function Tv(n){return n[8]||(n[8]=[])}function XC(n,e){let t;const i=e[n.index];if(mo(i))t=i;else{let r;if(8&n.type)r=ti(i);else{const o=e[11];r=o.createComment("");const s=$r(n,e);ol(o,Op(o,s),r,function cV(n,e){return Hn(n)?n.nextSibling(e):e.nextSibling}(o,s),!1)}e[n.index]=t=IS(i,e,r,n),Up(e,t)}return new YC(t,n,e)}class Av{constructor(e){this.queryList=e,this.matches=null}clone(){return new Av(this.queryList)}setDirty(){this.queryList.setDirty()}}class Iv{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){const s=t.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new Iv(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==tT(e,t).matches&&this.queries[t].setDirty()}}class KC{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Rv{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,null!==t?t.push(o):t=[o])}return null!==t?new Rv(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Nv{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Nv(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(e,t,T4(t,o)),this.matchTNodeWithReadOption(e,t,Dp(t,e,o,!1,!1))}else i===Tn?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Dp(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Kt||r===$n||r===Tn&&4&t.type)this.addMatch(t.index,-2);else{const o=Dp(t,e,r,!1,!1);null!==o&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function T4(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function I4(n,e,t,i){return-1===t?function A4(n,e){return 11&n.type?zc(n,e):4&n.type?tg(n,e):null}(e,n):-2===t?function R4(n,e,t){return t===Kt?zc(e,n):t===Tn?tg(e,n):t===$n?XC(e,n):void 0}(n,e,i):Ad(n,n[1],t,e)}function JC(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const o=n.data,s=t.matches,a=[];for(let l=0;l<s.length;l+=2){const c=s[l];a.push(c<0?null:I4(e,o[c],s[l+1],t.metadata.read))}r.matches=a}return r.matches}function Pv(n,e,t,i){const r=n.queries.getByIndex(t),o=r.matches;if(null!==o){const s=JC(n,e,r,t);for(let a=0;a<o.length;a+=2){const l=o[a];if(l>0)i.push(s[a/2]);else{const c=o[a+1],u=e[-l];for(let d=10;d<u.length;d++){const h=u[d];h[17]===h[3]&&Pv(h[1],h,c,i)}if(null!==u[9]){const d=u[9];for(let h=0;h<d.length;h++){const f=d[h];Pv(f[1],f,c,i)}}}}}return i}function xt(n){const e=le(),t=Gt(),i=BM();q0(i+1);const r=tT(t,i);if(n.dirty&&NM(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const o=r.crossesNgTemplate?Pv(t,e,i,[]):JC(t,e,r,i);n.reset(o,Yz),n.notifyOnChanges()}return!0}return!1}function Gi(n,e,t){const i=Gt();i.firstCreatePass&&(eT(i,new KC(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),QC(i,le(),e)}function An(n,e,t,i){const r=Gt();if(r.firstCreatePass){const o=di();eT(r,new KC(e,t,i),o.index),function P4(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}QC(r,le(),t)}function Mt(){return function N4(n,e){return n[19].queries[e].queryList}(le(),BM())}function QC(n,e,t){const i=new Cv(4==(4&t));xS(n,e,i,i.destroy),null===e[19]&&(e[19]=new Iv),e[19].queries.push(new Av(i))}function eT(n,e,t){null===n.queries&&(n.queries=new Rv),n.queries.track(new Nv(e,t))}function tT(n,e){return n.queries.getByIndex(e)}function st(n,e){return tg(n,e)}function rg(...n){}const Vv=new wt("Application Initializer");let Hv=(()=>{class n{constructor(t){this.appInits=t,this.resolve=rg,this.reject=rg,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if(Xd(o))t.push(o);else if(hv(o)){const s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(ke(Vv,8))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ah=new wt("AppId",{providedIn:"root",factory:function yT(){return`${Uv()}${Uv()}${Uv()}`}});function Uv(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const vT=new wt("Platform Initializer"),zv=new wt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),bT=new wt("appBootstrapListener");let X4=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const ua=new wt("LocaleId",{providedIn:"root",factory:()=>$L(ua,at.Optional|at.SkipSelf)||function K4(){return"undefined"!=typeof $localize&&$localize.locale||Zp}()});class Q4{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let wT=(()=>{class n{compileModuleSync(t){return new Sv(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),o=qo(Gr(t).declarations).reduce((s,a)=>{const l=ki(a);return l&&s.push(new Dv(l)),s},[]);return new Q4(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const tG=(()=>Promise.resolve(0))();function Gv(n){"undefined"==typeof Zone?tG.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class an{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ne(!1),this.onMicrotaskEmpty=new Ne(!1),this.onStable=new Ne(!1),this.onError=new Ne(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function nG(){let n=un.requestAnimationFrame,e=un.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function oG(n){const e=()=>{!function rG(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(un,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Wv(n),n.isCheckStableRunning=!0,jv(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Wv(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,o,s,a)=>{try{return xT(n),t.invokeTask(r,o,s,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&e(),MT(n)}},onInvoke:(t,i,r,o,s,a,l)=>{try{return xT(n),t.invoke(r,o,s,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),MT(n)}},onHasTask:(t,i,r,o)=>{t.hasTask(r,o),i===r&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,Wv(n),jv(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(t,i,r,o)=>(t.handleError(r,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!an.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(an.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,iG,rg,rg);try{return o.runTask(s,t,i)}finally{o.cancelTask(s)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const iG={};function jv(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Wv(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function xT(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function MT(n){n._nesting--,jv(n)}class sG{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ne,this.onMicrotaskEmpty=new Ne,this.onStable=new Ne,this.onError=new Ne}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let $v=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{an.assertNotInAngularZone(),Gv(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Gv(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:o,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(ke(an))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})(),aG=(()=>{class n{constructor(){this._applications=new Map,qv.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return qv.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();class lG{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let qv=new lG,cl=null;const DT=new wt("AllowMultipleToken"),ST=new wt("PlatformOnDestroy");class ET{constructor(e,t){this.name=e,this.token=t}}function CT(n,e,t=[]){const i=`Platform: ${e}`,r=new wt(i);return(o=[])=>{let s=Yv();if(!s||s.injector.get(DT,!1)){const a=[...t,...o,{provide:r,useValue:!0}];n?n(a):function hG(n){if(cl&&!cl.get(DT,!1))throw new Ut(400,"");cl=n;const e=n.get(TT),t=n.get(vT,null);t&&t.forEach(i=>i())}(function pG(n=[],e){return Ti.create({name:e,providers:[{provide:Qy,useValue:"platform"},{provide:ST,useValue:()=>cl=null},...n]})}(a,i))}return function fG(n){const e=Yv();if(!e)throw new Ut(401,"");return e}()}}function Yv(){var n;return null!==(n=null==cl?void 0:cl.get(TT))&&void 0!==n?n:null}let TT=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function gG(n,e){let t;return t="noop"===n?new sG:("zone.js"===n?void 0:n)||new an({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:an,useValue:a}];return a.run(()=>{const c=Ti.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),d=u.injector.get(zd,null);if(!d)throw new Ut(402,"");return a.runOutsideAngular(()=>{const h=a.onError.subscribe({next:f=>{d.handleError(f)}});u.onDestroy(()=>{Zv(this._modules,u),h.unsubscribe()})}),function mG(n,e,t){try{const i=t();return Xd(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(d,a,()=>{const h=u.injector.get(Hv);return h.runInitializers(),h.donePromise.then(()=>(function KU(n){Mr(n,"Expected localeId to be defined"),"string"==typeof n&&(uC=n.toLowerCase().replace(/_/g,"-"))}(u.injector.get(ua,Zp)||Zp),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=AT({},i);return function uG(n,e,t){const i=new Sv(t);return Promise.resolve(i)}(0,0,t).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(t){const i=t.injector.get(og);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Ut(403,"");t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ut(404,"");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(ST,null);null==t||t(),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(ke(Ti))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function AT(n,e){return Array.isArray(e)?e.reduce(AT,n):Object.assign(Object.assign({},n),e)}let og=(()=>{class n{constructor(t,i,r,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new pn(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),a=new pn(l=>{let c;this._zone.runOutsideAngular(()=>{c=this._zone.onStable.subscribe(()=>{an.assertNotInAngularZone(),Gv(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const u=this._zone.onUnstable.subscribe(()=>{an.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{c.unsubscribe(),u.unsubscribe()}});this.isStable=function v3(...n){const e=bd(n),t=function h3(n,e){return"number"==typeof w0(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Fi(i[0]):vd(t)(xi(i,e)):fo}(s,a.pipe(function b3(n={}){const{connector:e=(()=>new Ft),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return o=>{let s=null,a=null,l=null,c=0,u=!1,d=!1;const h=()=>{null==a||a.unsubscribe(),a=null},f=()=>{h(),s=l=null,u=d=!1},g=()=>{const p=s;f(),null==p||p.unsubscribe()};return Vn((p,m)=>{c++,!d&&!u&&h();const y=l=null!=l?l:e();m.add(()=>{c--,0===c&&!d&&!u&&(a=x0(g,r))}),y.subscribe(m),s||(s=new ep({next:_=>y.next(_),error:_=>{d=!0,h(),a=x0(f,t,_),y.error(_)},complete:()=>{u=!0,h(),a=x0(f,i),y.complete()}}),xi(p).subscribe(s))})(o)}}()))}bootstrap(t,i){if(!this._initStatus.done)throw new Ut(405,"");let r;r=t instanceof FC?t:this._injector.get(Uc).resolveComponentFactory(t),this.componentTypes.push(r.componentType);const o=function dG(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Ss),a=r.create(Ti.NULL,[],i||r.selector,o),l=a.location.nativeElement,c=a.injector.get($v,null),u=c&&a.injector.get(aG);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),Zv(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Ut(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;Zv(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(bT,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(ke(an),ke(Ti),ke(zd),ke(Hv))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Zv(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let RT=!0,Kr=(()=>{class n{}return n.__NG_ELEMENT_ID__=vG,n})();function vG(n){return function bG(n,e,t){if(cp(n)&&!t){const i=Sr(n.index,e);return new ih(i,i)}return 47&n.type?new ih(e[16],e):null}(di(),le(),16==(16&n))}class kT{constructor(){}supports(e){return Yd(e)}create(e){return new EG(e)}}const SG=(n,e)=>e;class EG{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||SG}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,o=null;for(;t||i;){const s=!i||t&&t.currentIndex<BT(i,r,o)?t:i,a=BT(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(t=t._next,null==s.previousIndex)r++;else{o||(o=[]);const c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){const f=h<o.length?o[h]:o[h]=0,g=f+h;u<=g&&g<c&&(o[h]=f+1)}o[s.previousIndex]=u-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Yd(e))throw new Ut(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,o,s,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),null!==t&&Object.is(t.trackById,s)?(i&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)):(t=this._mismatch(t,o,s,a),i=!0),t=t._next}else r=0,function BH(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Sc()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{s=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,s)?(i&&(t=this._verifyReinsertion(t,a,s,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,s,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let o;return null===e?o=this._itTail:(o=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,r)):e=this._addAfter(new CG(t,i),o,r),e}_verifyReinsertion(e,t,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?e=this._reinsertAfter(o,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,o=e._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new LT),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new LT),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class CG{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class TG{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class LT{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new TG,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function BT(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class VT{constructor(){}supports(e){return e instanceof Map||ov(e)}create(){return new AG}}class AG{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||ov(e)))throw new Ut(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const o=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,o)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new IG(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class IG{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function HT(){return new lg([new kT])}let lg=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||HT()),deps:[[n,new kd,new ra]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Ut(901,"")}}return n.\u0275prov=Ye({token:n,providedIn:"root",factory:HT}),n})();function UT(){return new lh([new VT])}let lh=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||UT()),deps:[[n,new kd,new ra]]}}find(t){const i=this.factories.find(o=>o.supports(t));if(i)return i;throw new Ut(901,"")}}return n.\u0275prov=Ye({token:n,providedIn:"root",factory:UT}),n})();const PG=CT(null,"core",[]);let OG=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(ke(og))},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({}),n})(),cg=null;function Qo(){return cg}const Ii=new wt("DocumentToken");let dl=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:function(){return function BG(){return ke(zT)}()},providedIn:"platform"}),n})();const VG=new wt("Location Initialized");let zT=(()=>{class n extends dl{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Qo().getBaseHref(this._doc)}onPopState(t){const i=Qo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Qo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){GT()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){GT()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(ke(Ii))},n.\u0275prov=Ye({token:n,factory:function(){return function HG(){return new zT(ke(Ii))}()},providedIn:"platform"}),n})();function GT(){return!!window.history.pushState}function eb(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function jT(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Es(n){return n&&"?"!==n[0]?"?"+n:n}let Wc=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:function(){return function UG(n){const e=ke(Ii).location;return new WT(ke(dl),e&&e.origin||"")}()},providedIn:"root"}),n})();const tb=new wt("appBaseHref");let WT=(()=>{class n extends Wc{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return eb(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Es(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){const s=this.prepareExternalUrl(r+Es(o));this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){const s=this.prepareExternalUrl(r+Es(o));this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(ke(dl),ke(tb,8))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})(),zG=(()=>{class n extends Wc{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=eb(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,o){let s=this.prepareExternalUrl(r+Es(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,i,s)}replaceState(t,i,r,o){let s=this.prepareExternalUrl(r+Es(o));0==s.length&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(ke(dl),ke(tb,8))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})(),nb=(()=>{class n{constructor(t,i){this._subject=new Ne,this._urlChangeListeners=[],this._platformStrategy=t;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=jT($T(r)),this._platformStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Es(i))}normalize(t){return n.stripTrailingSlash(function jG(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,$T(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._platformStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Es(i)),r)}replaceState(t,i="",r=null){this._platformStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Es(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=Es,n.joinWithSlash=eb,n.stripTrailingSlash=jT,n.\u0275fac=function(t){return new(t||n)(ke(Wc),ke(dl))},n.\u0275prov=Ye({token:n,factory:function(){return function GG(){return new nb(ke(Wc),ke(dl))}()},providedIn:"root"}),n})();function $T(n){return n.replace(/\/index.html$/,"")}let vg=(()=>{class n{constructor(t,i,r,o){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(Yd(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${on(i.item)}`);this._toggleClass(i.item,!0)}),t.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!0)):Object.keys(t).forEach(i=>this._toggleClass(i,!!t[i])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!1)):Object.keys(t).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(t,i){(t=t.trim())&&t.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)(k(lg),k(lh),k(Kt),k(zi))},n.\u0275dir=me({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class A5{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ri=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new A5(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),tA(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{tA(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(k($n),k(Tn),k(lg))},n.\u0275dir=me({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function tA(n,e){n.context.$implicit=e.item}let Yn=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new I5,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){nA("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){nA("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(k($n),k(Tn))},n.\u0275dir=me({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class I5{constructor(){this.$implicit=null,this.ngIf=null}}function nA(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${on(e)}'.`)}class hb{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let hl=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const i=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(t)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=me({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),n})(),dh=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new hb(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(t){return new(t||n)(k($n),k(Tn),k(hl,9))},n.\u0275dir=me({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),n})(),bg=(()=>{class n{constructor(t,i,r){r._addDefault(new hb(t,i))}}return n.\u0275fac=function(t){return new(t||n)(k($n),k(Tn),k(hl,9))},n.\u0275dir=me({type:n,selectors:[["","ngSwitchDefault",""]]}),n})(),gr=(()=>{class n{constructor(t){this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(t){if(t.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&t.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(t){return new(t||n)(k($n))},n.\u0275dir=me({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[Bi]}),n})(),tr=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({}),n})();let r8=(()=>{class n{}return n.\u0275prov=Ye({token:n,providedIn:"root",factory:()=>new o8(ke(Ii),window)}),n})();class o8{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function s8(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const o=r.shadowRoot;if(o){const s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(i-o[0],r-o[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=sA(this.window.history)||sA(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function sA(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class gb extends class l8 extends class LG{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function kG(n){cg||(cg=n)}(new gb)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function c8(){return hh=hh||document.querySelector("base"),hh?hh.getAttribute("href"):null}();return null==t?null:function u8(n){wg=wg||document.createElement("a"),wg.setAttribute("href",n);const e=wg.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){hh=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function C5(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,o]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}(document.cookie,e)}}let wg,hh=null;const aA=new wt("TRANSITION_ID"),h8=[{provide:Vv,useFactory:function d8(n,e,t){return()=>{t.get(Hv).donePromise.then(()=>{const i=Qo(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let o=0;o<r.length;o++)i.remove(r[o])})}},deps:[aA,Ii,Ti],multi:!0}];class mb{static init(){!function cG(n){qv=n}(new mb)}addToWindow(e){un.getAngularTestability=(i,r=!0)=>{const o=e.findTestabilityInTree(i,r);if(null==o)throw new Error("Could not find testability for element.");return o},un.getAllAngularTestabilities=()=>e.getAllTestabilities(),un.getAllAngularRootElements=()=>e.getAllRootElements(),un.frameworkStabilizers||(un.frameworkStabilizers=[]),un.frameworkStabilizers.push(i=>{const r=un.getAllAngularTestabilities();let o=r.length,s=!1;const a=function(l){s=s||l,o--,0==o&&i(s)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Qo().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let f8=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();const xg=new wt("EventManagerPlugins");let Mg=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let o=0;o<r.length;o++){const s=r[o];if(s.supports(t))return this._eventNameToPlugin.set(t,s),s}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(ke(xg),ke(an))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();class lA{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Qo().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let cA=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})(),fh=(()=>{class n extends cA{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,r.push(i.appendChild(s))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(uA),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(uA))}}return n.\u0275fac=function(t){return new(t||n)(ke(Ii))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();function uA(n){Qo().remove(n)}const _b={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},yb=/%COMP%/g;function Dg(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?Dg(n,r,t):(r=r.replace(yb,n),t.push(r))}return t}function fA(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let vb=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new bb(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case zo.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new v8(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case zo.ShadowDom:return new b8(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=Dg(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(ke(Mg),ke(fh),ke(ah))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();class bb{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(_b[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const o=_b[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=_b[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Cr.DashCase|Cr.Important)?e.style.setProperty(t,i,r&Cr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Cr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,fA(i)):this.eventManager.addEventListener(e,t,fA(i))}}class v8 extends bb{constructor(e,t,i,r){super(e),this.component=i;const o=Dg(r+"-"+i.id,i.styles,[]);t.addStyles(o),this.contentAttr=function m8(n){return"_ngcontent-%COMP%".replace(yb,n)}(r+"-"+i.id),this.hostAttr=function _8(n){return"_nghost-%COMP%".replace(yb,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class b8 extends bb{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=Dg(r.id,r.styles,[]);for(let s=0;s<o.length;s++){const a=document.createElement("style");a.textContent=o[s],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let w8=(()=>{class n extends lA{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(ke(Ii))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();const gA=["alt","control","meta","shift"],M8={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},mA={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},D8={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let S8=(()=>{class n extends lA{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const o=n.parseEventName(i),s=n.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Qo().onAndCancel(t,o.domEventName,s))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=n._normalizeKey(i.pop());let s="";if(gA.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),s+=l+".")}),s+=o,0!=i.length||0===o.length)return null;const a={};return a.domEventName=r,a.fullKey=s,a}static getEventFullKey(t){let i="",r=function E8(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&mA.hasOwnProperty(e)&&(e=mA[e]))}return M8[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),gA.forEach(o=>{o!=r&&D8[o](t)&&(i+=o+".")}),i+=r,i}static eventCallback(t,i,r){return o=>{n.getEventFullKey(o)===t&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(ke(Ii))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();const I8=CT(PG,"browser",[{provide:zv,useValue:"browser"},{provide:vT,useValue:function C8(){gb.makeCurrent(),mb.init()},multi:!0},{provide:Ii,useFactory:function A8(){return function X3(n){B0=n}(document),document},deps:[]}]),R8=[{provide:Qy,useValue:"root"},{provide:zd,useFactory:function T8(){return new zd},deps:[]},{provide:xg,useClass:w8,multi:!0,deps:[Ii,an,zv]},{provide:xg,useClass:S8,multi:!0,deps:[Ii]},{provide:vb,useClass:vb,deps:[Mg,fh,ah]},{provide:xv,useExisting:vb},{provide:cA,useExisting:fh},{provide:fh,useClass:fh,deps:[Ii]},{provide:$v,useClass:$v,deps:[an]},{provide:Mg,useClass:Mg,deps:[xg,an]},{provide:class a8{},useClass:f8,deps:[]}];let _A=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:ah,useValue:t.appId},{provide:aA,useExisting:ah},h8]}}}return n.\u0275fac=function(t){return new(t||n)(ke(n,12))},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({providers:R8,imports:[tr,OG]}),n})();function ft(...n){return xi(n,bd(n))}"undefined"!=typeof window&&window;class kn extends Ft{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const{isArray:z8}=Array,{getPrototypeOf:G8,prototype:j8,keys:W8}=Object;function bA(n){if(1===n.length){const e=n[0];if(z8(e))return{args:e,keys:null};if(function $8(n){return n&&"object"==typeof n&&G8(n)===j8}(e)){const t=W8(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:q8}=Array;function xb(n){return Bt(e=>function Y8(n,e){return q8(e)?n(...e):n(e)}(n,e))}function wA(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function xA(n,e,t){n?_s(t,n,e):e()}function Sg(n,e){const t=At(n)?n:()=>n,i=r=>r.error(t());return new pn(e?r=>e.schedule(i,0,r):i)}const Eg=Mn(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function ph(...n){return function X8(){return vd(1)}()(xi(n,bd(n)))}function MA(n){return new pn(e=>{Fi(n()).subscribe(e)})}function DA(){return Vn((n,e)=>{let t=null;n._refCount++;const i=vn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,o=t;t=null,r&&(!o||r===o)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class K8 extends pn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,eM(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ve;const t=this.getSubject();e.add(this.source.subscribe(vn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ve.EMPTY)}return e}refCount(){return DA()(this)}}function Ts(n,e){return Vn((t,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();t.subscribe(vn(i,l=>{null==r||r.unsubscribe();let c=0;const u=o++;Fi(n(l,u)).subscribe(r=vn(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Cg(...n){const e=bd(n);return Vn((t,i)=>{(e?ph(n,t,e):ph(n,t)).subscribe(i)})}function J8(n,e,t,i,r){return(o,s)=>{let a=t,l=e,c=0;o.subscribe(vn(s,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&s.next(l)},r&&(()=>{a&&s.next(l),s.complete()})))}}function SA(n,e){return Vn(J8(n,e,arguments.length>=2,!0))}function nr(n,e){return Vn((t,i)=>{let r=0;t.subscribe(vn(i,o=>n.call(e,o,r++)&&i.next(o)))})}function ha(n){return Vn((e,t)=>{let o,i=null,r=!1;i=e.subscribe(vn(t,void 0,void 0,s=>{o=Fi(n(s,ha(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function gh(n,e){return At(e)?ei(n,e,1):ei(n,1)}function Db(n){return n<=0?()=>fo:Vn((e,t)=>{let i=[];e.subscribe(vn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function EA(n=Q8){return Vn((e,t)=>{let i=!1;e.subscribe(vn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function Q8(){return new Eg}function CA(n){return Vn((e,t)=>{let i=!1;e.subscribe(vn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function $c(n,e){const t=arguments.length>=2;return i=>i.pipe(n?nr((r,o)=>n(r,o,i)):ms,ui(1),t?CA(e):EA(()=>new Eg))}function ir(n,e,t){const i=At(n)||e||t?{next:n,error:e,complete:t}:n;return i?Vn((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe(vn(o,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),o.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),o.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),o.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):ms}class As{constructor(e,t){this.id=e,this.url=t}}class Sb extends As{constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class mh extends As{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class TA extends As{constructor(e,t,i){super(e,t),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class n6 extends As{constructor(e,t,i){super(e,t),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class i6 extends As{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class r6 extends As{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class o6 extends As{constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class s6 extends As{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class a6 extends As{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class AA{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class IA{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class l6{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class c6{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class u6{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class d6{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class RA{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Ct="primary";class h6{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function qc(n){return new h6(n)}const NA="ngNavigationCancelingError";function Eb(n){const e=Error("NavigationCancelingError: "+n);return e[NA]=!0,e}function p6(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let o=0;o<i.length;o++){const s=i[o],a=n[o];if(s.startsWith(":"))r[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function es(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!PA(n[r],e[r]))return!1;return!0}function PA(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}return n===e}function OA(n){return Array.prototype.concat.apply([],n)}function FA(n){return n.length>0?n[n.length-1]:null}function Ni(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function ts(n){return hv(n)?n:Xd(n)?xi(Promise.resolve(n)):ft(n)}const _6={exact:function BA(n,e,t){if(!pl(n.segments,e.segments)||!Tg(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!BA(n.children[i],e.children[i],t))return!1;return!0},subset:VA},kA={exact:function y6(n,e){return es(n,e)},subset:function v6(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>PA(n[t],e[t]))},ignored:()=>!0};function LA(n,e,t){return _6[t.paths](n.root,e.root,t.matrixParams)&&kA[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function VA(n,e,t){return HA(n,e,e.segments,t)}function HA(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!pl(r,t)||e.hasChildren()||!Tg(r,t,i))}if(n.segments.length===t.length){if(!pl(n.segments,t)||!Tg(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!VA(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!!(pl(n.segments,r)&&Tg(n.segments,r,i)&&n.children[Ct])&&HA(n.children[Ct],e,o,i)}}function Tg(n,e,t){return e.every((i,r)=>kA[t](n[r].parameters,i.parameters))}class fl{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=qc(this.queryParams)),this._queryParamMap}toString(){return x6.serialize(this)}}class kt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Ni(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ag(this)}}class _h{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=qc(this.parameters)),this._parameterMap}toString(){return WA(this)}}function pl(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}class UA{}class zA{parse(e){const t=new R6(e);return new fl(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${yh(e.root,!0)}`,i=function S6(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Ig(t)}=${Ig(r)}`).join("&"):`${Ig(t)}=${Ig(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function M6(n){return encodeURI(n)}(e.fragment)}`:""}`}}const x6=new zA;function Ag(n){return n.segments.map(e=>WA(e)).join("/")}function yh(n,e){if(!n.hasChildren())return Ag(n);if(e){const t=n.children[Ct]?yh(n.children[Ct],!1):"",i=[];return Ni(n.children,(r,o)=>{o!==Ct&&i.push(`${o}:${yh(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function w6(n,e){let t=[];return Ni(n.children,(i,r)=>{r===Ct&&(t=t.concat(e(i,r)))}),Ni(n.children,(i,r)=>{r!==Ct&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===Ct?[yh(n.children[Ct],!1)]:[`${r}:${yh(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Ct]?`${Ag(n)}/${t[0]}`:`${Ag(n)}/(${t.join("//")})`}}function GA(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ig(n){return GA(n).replace(/%3B/gi,";")}function Cb(n){return GA(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Rg(n){return decodeURIComponent(n)}function jA(n){return Rg(n.replace(/\+/g,"%20"))}function WA(n){return`${Cb(n.path)}${function D6(n){return Object.keys(n).map(e=>`;${Cb(e)}=${Cb(n[e])}`).join("")}(n.parameters)}`}const E6=/^[^\/()?;=#]+/;function Ng(n){const e=n.match(E6);return e?e[0]:""}const C6=/^[^=?&#]+/,A6=/^[^&#]+/;class R6{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new kt([],{}):new kt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Ct]=new kt(e,t)),i}parseSegment(){const e=Ng(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new _h(Rg(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Ng(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Ng(this.remaining);r&&(i=r,this.capture(i))}e[Rg(t)]=Rg(i)}parseQueryParam(e){const t=function T6(n){const e=n.match(C6);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const s=function I6(n){const e=n.match(A6);return e?e[0]:""}(this.remaining);s&&(i=s,this.capture(i))}const r=jA(t),o=jA(i);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Ng(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let o;i.indexOf(":")>-1?(o=i.substr(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Ct);const s=this.parseChildren();t[o]=1===Object.keys(s).length?s[Ct]:new kt([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class $A{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Tb(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Tb(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Ab(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Ab(e,this._root).map(t=>t.value)}}function Tb(n,e){if(n===e.value)return e;for(const t of e.children){const i=Tb(n,t);if(i)return i}return null}function Ab(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Ab(n,t);if(i.length)return i.unshift(e),i}return[]}class Is{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Yc(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class qA extends $A{constructor(e,t){super(e),this.snapshot=t,Ib(this,e)}toString(){return this.snapshot.toString()}}function YA(n,e){const t=function N6(n,e){const s=new Pg([],{},{},"",{},Ct,e,null,n.root,-1,{});return new XA("",new Is(s,[]))}(n,e),i=new kn([new _h("",{})]),r=new kn({}),o=new kn({}),s=new kn({}),a=new kn(""),l=new Zc(i,r,s,a,o,Ct,e,t.root);return l.snapshot=t.root,new qA(new Is(l,[]),t)}class Zc{constructor(e,t,i,r,o,s,a,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Bt(e=>qc(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Bt(e=>qc(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ZA(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],o=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(o.component)break;i--}}return function P6(n){return n.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Pg{constructor(e,t,i,r,o,s,a,l,c,u,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=qc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=qc(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class XA extends $A{constructor(e,t){super(t),this.url=e,Ib(this,t)}toString(){return KA(this._root)}}function Ib(n,e){e.value._routerState=n,e.children.forEach(t=>Ib(n,t))}function KA(n){const e=n.children.length>0?` { ${n.children.map(KA).join(", ")} } `:"";return`${n.value}${e}`}function Rb(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,es(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),es(e.params,t.params)||n.params.next(t.params),function g6(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!es(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),es(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function Nb(n,e){const t=es(n.params,e.params)&&function b6(n,e){return pl(n,e)&&n.every((t,i)=>es(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Nb(n.parent,e.parent))}function vh(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function F6(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return vh(n,i,r);return vh(n,i)})}(n,e,t);return new Is(i,r)}{if(n.shouldAttach(e.value)){const o=n.retrieve(e.value);if(null!==o){const s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>vh(n,a)),s}}const i=function k6(n){return new Zc(new kn(n.url),new kn(n.params),new kn(n.queryParams),new kn(n.fragment),new kn(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(o=>vh(n,o));return new Is(i,r)}}function Og(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function bh(n){return"object"==typeof n&&null!=n&&n.outlets}function Pb(n,e,t,i,r){let o={};if(i&&Ni(i,(a,l)=>{o[l]=Array.isArray(a)?a.map(c=>`${c}`):`${a}`}),n===e)return new fl(t,o,r);const s=JA(n,e,t);return new fl(s,o,r)}function JA(n,e,t){const i={};return Ni(n.children,(r,o)=>{i[o]=r===e?t:JA(r,e,t)}),new kt(n.segments,i)}class QA{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Og(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(bh);if(r&&r!==FA(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Ob{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function eI(n,e,t){if(n||(n=new kt([],{})),0===n.segments.length&&n.hasChildren())return Fg(n,e,t);const i=function z6(n,e,t){let i=0,r=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;const s=n.segments[r],a=t[i];if(bh(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!nI(l,c,s))return o;i+=2}else{if(!nI(l,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const o=new kt(n.segments.slice(0,i.pathIndex),{});return o.children[Ct]=new kt(n.segments.slice(i.pathIndex),n.children),Fg(o,0,r)}return i.match&&0===r.length?new kt(n.segments,{}):i.match&&!n.hasChildren()?Fb(n,e,t):i.match?Fg(n,0,r):Fb(n,e,t)}function Fg(n,e,t){if(0===t.length)return new kt(n.segments,{});{const i=function U6(n){return bh(n[0])?n[0].outlets:{[Ct]:n}}(t),r={};return Ni(i,(o,s)=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=eI(n.children[s],e,o))}),Ni(n.children,(o,s)=>{void 0===i[s]&&(r[s]=o)}),new kt(n.segments,r)}}function Fb(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const o=t[r];if(bh(o)){const l=G6(o.outlets);return new kt(i,l)}if(0===r&&Og(t[0])){i.push(new _h(n.segments[e].path,tI(t[0]))),r++;continue}const s=bh(o)?o.outlets[Ct]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&Og(a)?(i.push(new _h(s,tI(a))),r+=2):(i.push(new _h(s,{})),r++)}return new kt(i,{})}function G6(n){const e={};return Ni(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=Fb(new kt([],{}),0,t))}),e}function tI(n){const e={};return Ni(n,(t,i)=>e[i]=`${t}`),e}function nI(n,e,t){return n==t.path&&es(e,t.parameters)}class W6{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),Rb(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Yc(t);e.children.forEach(o=>{const s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Ni(r,(o,s)=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){const r=e.value,o=t?t.value:null;if(r===o)if(r.component){const s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Yc(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],r);if(i&&i.outlet){const s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Yc(e);for(const s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=Yc(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new d6(o.value.snapshot))}),e.children.length&&this.forwardEvent(new c6(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,o=t?t.value:null;if(Rb(r),r===o)if(r.component){const s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),Rb(a.route.value),this.activateChildRoutes(e,null,s.children)}else{const a=function $6(n){for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),l=a?a.module.componentFactoryResolver:null;s.attachRef=null,s.route=r,s.resolver=l,s.outlet&&s.outlet.activateWith(r,l),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,i)}}class kb{constructor(e,t){this.routes=e,this.module=t}}function fa(n){return"function"==typeof n}function gl(n){return n instanceof fl}const wh=Symbol("INITIAL_VALUE");function xh(){return Ts(n=>function Mb(...n){const e=bd(n),t=np(n),{args:i,keys:r}=bA(n);if(0===i.length)return xi([],e);const o=new pn(function Z8(n,e,t=ms){return i=>{xA(e,()=>{const{length:r}=n,o=new Array(r);let s=r,a=r;for(let l=0;l<r;l++)xA(e,()=>{const c=xi(n[l],e);let u=!1;c.subscribe(vn(i,d=>{o[l]=d,u||(u=!0,a--),a||i.next(t(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}(i,e,r?s=>wA(r,s):ms));return t?o.pipe(xb(t)):o}(n.map(e=>e.pipe(ui(1),Cg(wh)))).pipe(SA((e,t)=>{let i=!1;return t.reduce((r,o,s)=>r!==wh?r:(o===wh&&(i=!0),i||!1!==o&&s!==t.length-1&&!gl(o)?r:o),e)},wh),nr(e=>e!==wh),Bt(e=>gl(e)?e:!0===e),ui(1)))}class J6{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Mh,this.attachRef=null}}class Mh{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new J6,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let Lb=(()=>{class n{constructor(t,i,r,o,s){this.parentContexts=t,this.location=i,this.resolver=r,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new Ne,this.deactivateEvents=new Ne,this.attachEvents=new Ne,this.detachEvents=new Ne,this.name=o||Ct,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const s=(i=i||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new Q6(t,a,this.location.injector);this.activated=this.location.createComponent(s,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(k(Mh),k($n),k(Uc),rl("name"),k(Kr))},n.\u0275dir=me({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class Q6{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Zc?this.route:e===Mh?this.childContexts:this.parent.get(e,t)}}let iI=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,i){1&t&&he(0,"router-outlet")},directives:[Lb],encapsulation:2}),n})();function rI(n,e=""){for(let t=0;t<n.length;t++){const i=n[t];ej(i,tj(e,i))}}function ej(n,e){n.children&&rI(n.children,e)}function tj(n,e){return e?n||e.path?n&&!e.path?`${n}/`:!n&&e.path?e.path:`${n}/${e.path}`:"":n}function Bb(n){const e=n.children&&n.children.map(Bb),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ct&&(t.component=iI),t}function eo(n){return n.outlet||Ct}function oI(n,e){const t=n.filter(i=>eo(i)===e);return t.push(...n.filter(i=>eo(i)!==e)),t}const sI={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function kg(n,e,t){var i;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},sI):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const o=(e.matcher||p6)(t,n,e);if(!o)return Object.assign({},sI);const s={};Ni(o.posParams,(l,c)=>{s[c]=l.path});const a=o.consumed.length>0?Object.assign(Object.assign({},s),o.consumed[o.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:o.consumed,remainingSegments:t.slice(o.consumed.length),parameters:a,positionalParamSegments:null!==(i=o.posParams)&&void 0!==i?i:{}}}function Lg(n,e,t,i,r="corrected"){if(t.length>0&&function rj(n,e,t){return t.some(i=>Bg(n,e,i)&&eo(i)!==Ct)}(n,t,i)){const s=new kt(e,function ij(n,e,t,i){const r={};r[Ct]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const o of t)if(""===o.path&&eo(o)!==Ct){const s=new kt([],{});s._sourceSegment=n,s._segmentIndexShift=e.length,r[eo(o)]=s}return r}(n,e,i,new kt(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function oj(n,e,t){return t.some(i=>Bg(n,e,i))}(n,t,i)){const s=new kt(n.segments,function nj(n,e,t,i,r,o){const s={};for(const a of i)if(Bg(n,t,a)&&!r[eo(a)]){const l=new kt([],{});l._sourceSegment=n,l._segmentIndexShift="legacy"===o?n.segments.length:e.length,s[eo(a)]=l}return Object.assign(Object.assign({},r),s)}(n,e,t,i,n.children,r));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const o=new kt(n.segments,n.children);return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}function Bg(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function aI(n,e,t,i){return!!(eo(n)===i||i!==Ct&&Bg(e,t,n))&&("**"===n.path||kg(e,n,t).matched)}function lI(n,e,t){return 0===e.length&&!n.children[t]}class Vg{constructor(e){this.segmentGroup=e||null}}class cI{constructor(e){this.urlTree=e}}function Dh(n){return Sg(new Vg(n))}function uI(n){return Sg(new cI(n))}class cj{constructor(e,t,i,r,o){this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=o,this.allowRedirects=!0,this.ngModule=e.get(Ss)}apply(){const e=Lg(this.urlTree.root,[],[],this.config).segmentGroup,t=new kt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,Ct).pipe(Bt(o=>this.createUrlTree(Vb(o),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ha(o=>{if(o instanceof cI)return this.allowRedirects=!1,this.match(o.urlTree);throw o instanceof Vg?this.noMatchError(o):o}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,Ct).pipe(Bt(r=>this.createUrlTree(Vb(r),e.queryParams,e.fragment))).pipe(ha(r=>{throw r instanceof Vg?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,i){const r=e.segments.length>0?new kt([],{[Ct]:e}):e;return new fl(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(Bt(o=>new kt([],o))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const o of Object.keys(i.children))"primary"===o?r.unshift(o):r.push(o);return xi(r).pipe(gh(o=>{const s=i.children[o],a=oI(t,o);return this.expandSegmentGroup(e,a,s,o).pipe(Bt(l=>({segment:l,outlet:o})))}),SA((o,s)=>(o[s.outlet]=s.segment,o),{}),function e6(n,e){const t=arguments.length>=2;return i=>i.pipe(n?nr((r,o)=>n(r,o,i)):ms,Db(1),t?CA(e):EA(()=>new Eg))}())}expandSegment(e,t,i,r,o,s){return xi(i).pipe(gh(a=>this.expandSegmentAgainstRoute(e,t,i,a,r,o,s).pipe(ha(c=>{if(c instanceof Vg)return ft(null);throw c}))),$c(a=>!!a),ha((a,l)=>{if(a instanceof Eg||"EmptyError"===a.name)return lI(t,r,o)?ft(new kt([],{})):Dh(t);throw a}))}expandSegmentAgainstRoute(e,t,i,r,o,s,a){return aI(r,t,o,s)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,o,s):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s):Dh(t):Dh(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,s):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const o=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?uI(o):this.lineralizeSegments(i,o).pipe(ei(s=>{const a=new kt(s,{});return this.expandSegment(e,a,t,s,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,o,s){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=kg(t,r,o);if(!a)return Dh(t);const d=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?uI(d):this.lineralizeSegments(r,d).pipe(ei(h=>this.expandSegment(e,t,i,h.concat(c),s,!1)))}matchSegmentAgainstRoute(e,t,i,r,o){if("**"===i.path)return i.loadChildren?(i._loadedConfig?ft(i._loadedConfig):this.configLoader.load(e.injector,i)).pipe(Bt(d=>(i._loadedConfig=d,new kt(r,{})))):ft(new kt(r,{}));const{matched:s,consumedSegments:a,remainingSegments:l}=kg(t,i,r);return s?this.getChildConfig(e,i,r).pipe(ei(u=>{const d=u.module,h=u.routes,{segmentGroup:f,slicedSegments:g}=Lg(t,a,l,h),p=new kt(f.segments,f.children);if(0===g.length&&p.hasChildren())return this.expandChildren(d,h,p).pipe(Bt(v=>new kt(a,v)));if(0===h.length&&0===g.length)return ft(new kt(a,{}));const m=eo(i)===o;return this.expandSegment(d,p,h,g,m?Ct:o,!0).pipe(Bt(_=>new kt(a.concat(_.segments),_.children)))})):Dh(t)}getChildConfig(e,t,i){return t.children?ft(new kb(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?ft(t._loadedConfig):this.runCanLoadGuards(e.injector,t,i).pipe(ei(r=>r?this.configLoader.load(e.injector,t).pipe(Bt(o=>(t._loadedConfig=o,o))):function aj(n){return Sg(Eb(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`))}(t))):ft(new kb([],e))}runCanLoadGuards(e,t,i){const r=t.canLoad;return r&&0!==r.length?ft(r.map(s=>{const a=e.get(s);let l;if(function Y6(n){return n&&fa(n.canLoad)}(a))l=a.canLoad(t,i);else{if(!fa(a))throw new Error("Invalid CanLoad guard");l=a(t,i)}return ts(l)})).pipe(xh(),ir(s=>{if(!gl(s))return;const a=Eb(`Redirecting to "${this.urlSerializer.serialize(s)}"`);throw a.url=s,a}),Bt(s=>!0===s)):ft(!0)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return ft(i);if(r.numberOfChildren>1||!r.children[Ct])return Sg(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));r=r.children[Ct]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreatreUrlTree(e,t,i,r){const o=this.createSegmentGroup(e,t.root,i,r);return new fl(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Ni(e,(r,o)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[o]=t[a]}else i[o]=r}),i}createSegmentGroup(e,t,i,r){const o=this.createSegments(e,t.segments,i,r);let s={};return Ni(t.children,(a,l)=>{s[l]=this.createSegmentGroup(e,a,i,r)}),new kt(o,s)}createSegments(e,t,i,r){return t.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}function Vb(n){const e={};for(const i of Object.keys(n.children)){const o=Vb(n.children[i]);(o.segments.length>0||o.hasChildren())&&(e[i]=o)}return function uj(n){if(1===n.numberOfChildren&&n.children[Ct]){const e=n.children[Ct];return new kt(n.segments.concat(e.segments),e.children)}return n}(new kt(n.segments,e))}class dI{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Hg{constructor(e,t){this.component=e,this.route=t}}function hj(n,e,t){const i=n._root;return Sh(i,e?e._root:null,t,[i.value])}function Ug(n,e,t){const i=function pj(n){if(!n)return null;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(i?i.module.injector:t).get(n)}function Sh(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=Yc(e);return n.children.forEach(s=>{(function gj(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){const l=function mj(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!pl(n.url,e.url);case"pathParamsOrQueryParamsChange":return!pl(n.url,e.url)||!es(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Nb(n,e)||!es(n.queryParams,e.queryParams);default:return!Nb(n,e)}}(s,o,o.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new dI(i)):(o.data=s.data,o._resolvedData=s._resolvedData),Sh(n,e,o.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Hg(a.outlet.component,s))}else s&&Eh(e,a,r),r.canActivateChecks.push(new dI(i)),Sh(n,null,o.component?a?a.children:null:t,i,r)})(s,o[s.value.outlet],t,i.concat([s.value]),r),delete o[s.value.outlet]}),Ni(o,(s,a)=>Eh(s,t.getContext(a),r)),r}function Eh(n,e,t){const i=Yc(n),r=n.value;Ni(i,(o,s)=>{Eh(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new Hg(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class Sj{}function hI(n){return new pn(e=>e.error(n))}class Cj{constructor(e,t,i,r,o,s){this.rootComponentType=e,this.config=t,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=s}recognize(){const e=Lg(this.urlTree.root,[],[],this.config.filter(s=>void 0===s.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,Ct);if(null===t)return null;const i=new Pg([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ct,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Is(i,t),o=new XA(this.url,r);return this.inheritParamsAndData(o._root),o}inheritParamsAndData(e){const t=e.value,i=ZA(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}processChildren(e,t){const i=[];for(const o of Object.keys(t.children)){const s=t.children[o],a=oI(e,o),l=this.processSegmentGroup(a,s,o);if(null===l)return null;i.push(...l)}const r=fI(i);return function Tj(n){n.sort((e,t)=>e.value.outlet===Ct?-1:t.value.outlet===Ct?1:e.value.outlet.localeCompare(t.value.outlet))}(r),r}processSegment(e,t,i,r){for(const o of e){const s=this.processSegmentAgainstRoute(o,t,i,r);if(null!==s)return s}return lI(t,i,r)?[]:null}processSegmentAgainstRoute(e,t,i,r){if(e.redirectTo||!aI(e,t,i,r))return null;let o,s=[],a=[];if("**"===e.path){const f=i.length>0?FA(i).parameters:{};o=new Pg(i,f,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,mI(e),eo(e),e.component,e,pI(t),gI(t)+i.length,_I(e))}else{const f=kg(t,e,i);if(!f.matched)return null;s=f.consumedSegments,a=f.remainingSegments,o=new Pg(s,f.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,mI(e),eo(e),e.component,e,pI(t),gI(t)+s.length,_I(e))}const l=function Aj(n){return n.children?n.children:n.loadChildren?n._loadedConfig.routes:[]}(e),{segmentGroup:c,slicedSegments:u}=Lg(t,s,a,l.filter(f=>void 0===f.redirectTo),this.relativeLinkResolution);if(0===u.length&&c.hasChildren()){const f=this.processChildren(l,c);return null===f?null:[new Is(o,f)]}if(0===l.length&&0===u.length)return[new Is(o,[])];const d=eo(e)===r,h=this.processSegment(l,c,u,d?Ct:r);return null===h?null:[new Is(o,h)]}}function Ij(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function fI(n){const e=[],t=new Set;for(const i of n){if(!Ij(i)){e.push(i);continue}const r=e.find(o=>i.value.routeConfig===o.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=fI(i.children);e.push(new Is(i.value,r))}return e.filter(i=>!t.has(i))}function pI(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function gI(n){let e=n,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function mI(n){return n.data||{}}function _I(n){return n.resolve||{}}function yI(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Hb(n){return Ts(e=>{const t=n(e);return t?xi(t).pipe(Bt(()=>e)):ft(e)})}class Bj extends class Lj{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Ub=new wt("ROUTES");class vI{constructor(e,t,i,r){this.injector=e,this.compiler=t,this.onLoadStartListener=i,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const r=this.loadModuleFactory(t.loadChildren).pipe(Bt(o=>{this.onLoadEndListener&&this.onLoadEndListener(t);const s=o.create(e);return new kb(OA(s.injector.get(Ub,void 0,at.Self|at.Optional)).map(Bb),s)}),ha(o=>{throw t._loader$=void 0,o}));return t._loader$=new K8(r,()=>new Ft).pipe(DA()),t._loader$}loadModuleFactory(e){return ts(e()).pipe(ei(t=>t instanceof VC?ft(t):xi(this.compiler.compileModuleAsync(t))))}}class Hj{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function Uj(n){throw n}function zj(n,e,t){return e.parse("/")}function bI(n,e){return ft(null)}const Gj={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},jj={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ir=(()=>{class n{constructor(t,i,r,o,s,a,l){this.rootComponentType=t,this.urlSerializer=i,this.rootContexts=r,this.location=o,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Ft,this.errorHandler=Uj,this.malformedUriErrorHandler=zj,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:bI,afterPreactivation:bI},this.urlHandlingStrategy=new Hj,this.routeReuseStrategy=new Bj,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=s.get(Ss),this.console=s.get(X4);const d=s.get(an);this.isNgZoneEnabled=d instanceof an&&an.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function m6(){return new fl(new kt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new vI(s,a,h=>this.triggerEvent(new AA(h)),h=>this.triggerEvent(new IA(h))),this.routerState=YA(this.currentUrlTree,this.rootComponentType),this.transitions=new kn({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const i=this.events;return t.pipe(nr(r=>0!==r.id),Bt(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Ts(r=>{let o=!1,s=!1;return ft(r).pipe(ir(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Ts(a=>{const l=this.browserUrlTree.toString(),c=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return wI(a.source)&&(this.browserUrlTree=a.extractedUrl),ft(a).pipe(Ts(d=>{const h=this.transitions.getValue();return i.next(new Sb(d.id,this.serializeUrl(d.extractedUrl),d.source,d.restoredState)),h!==this.transitions.getValue()?fo:Promise.resolve(d)}),function dj(n,e,t,i){return Ts(r=>function lj(n,e,t,i,r){return new cj(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(Bt(o=>Object.assign(Object.assign({},r),{urlAfterRedirects:o}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),ir(d=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:d.urlAfterRedirects})}),function Rj(n,e,t,i,r){return ei(o=>function Ej(n,e,t,i,r="emptyOnly",o="legacy"){try{const s=new Cj(n,e,t,i,r,o).recognize();return null===s?hI(new Sj):ft(s)}catch(s){return hI(s)}}(n,e,o.urlAfterRedirects,t(o.urlAfterRedirects),i,r).pipe(Bt(s=>Object.assign(Object.assign({},o),{targetSnapshot:s}))))}(this.rootComponentType,this.config,d=>this.serializeUrl(d),this.paramsInheritanceStrategy,this.relativeLinkResolution),ir(d=>{if("eager"===this.urlUpdateStrategy){if(!d.extras.skipLocationChange){const f=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);this.setBrowserUrl(f,d)}this.browserUrlTree=d.urlAfterRedirects}const h=new i6(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);i.next(h)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:h,extractedUrl:f,source:g,restoredState:p,extras:m}=a,y=new Sb(h,this.serializeUrl(f),g,p);i.next(y);const _=YA(f,this.rootComponentType).snapshot;return ft(Object.assign(Object.assign({},a),{targetSnapshot:_,urlAfterRedirects:f,extras:Object.assign(Object.assign({},m),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),fo}),Hb(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:d,extras:{skipLocationChange:h,replaceUrl:f}}=a;return this.hooks.beforePreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:d,skipLocationChange:!!h,replaceUrl:!!f})}),ir(a=>{const l=new r6(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),Bt(a=>Object.assign(Object.assign({},a),{guards:hj(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function _j(n,e){return ei(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return 0===s.length&&0===o.length?ft(Object.assign(Object.assign({},t),{guardsResult:!0})):function yj(n,e,t,i){return xi(n).pipe(ei(r=>function Dj(n,e,t,i,r){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?ft(o.map(a=>{const l=Ug(a,e,r);let c;if(function K6(n){return n&&fa(n.canDeactivate)}(l))c=ts(l.canDeactivate(n,e,t,i));else{if(!fa(l))throw new Error("Invalid CanDeactivate guard");c=ts(l(n,e,t,i))}return c.pipe($c())})).pipe(xh()):ft(!0)}(r.component,r.route,t,e,i)),$c(r=>!0!==r,!0))}(s,i,r,n).pipe(ei(a=>a&&function q6(n){return"boolean"==typeof n}(a)?function vj(n,e,t,i){return xi(e).pipe(gh(r=>ph(function wj(n,e){return null!==n&&e&&e(new l6(n)),ft(!0)}(r.route.parent,i),function bj(n,e){return null!==n&&e&&e(new u6(n)),ft(!0)}(r.route,i),function Mj(n,e,t){const i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>function fj(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(s)).filter(s=>null!==s).map(s=>MA(()=>ft(s.guards.map(l=>{const c=Ug(l,s.node,t);let u;if(function X6(n){return n&&fa(n.canActivateChild)}(c))u=ts(c.canActivateChild(i,n));else{if(!fa(c))throw new Error("Invalid CanActivateChild guard");u=ts(c(i,n))}return u.pipe($c())})).pipe(xh())));return ft(o).pipe(xh())}(n,r.path,t),function xj(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return ft(!0);const r=i.map(o=>MA(()=>{const s=Ug(o,e,t);let a;if(function Z6(n){return n&&fa(n.canActivate)}(s))a=ts(s.canActivate(e,n));else{if(!fa(s))throw new Error("Invalid CanActivate guard");a=ts(s(e,n))}return a.pipe($c())}));return ft(r).pipe(xh())}(n,r.route,t))),$c(r=>!0!==r,!0))}(i,o,n,e):ft(a)),Bt(a=>Object.assign(Object.assign({},t),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),ir(a=>{if(gl(a.guardsResult)){const c=Eb(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw c.url=a.guardsResult,c}const l=new o6(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),nr(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),Hb(a=>{if(a.guards.canActivateChecks.length)return ft(a).pipe(ir(l=>{const c=new s6(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),Ts(l=>{let c=!1;return ft(l).pipe(function Nj(n,e){return ei(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return ft(t);let o=0;return xi(r).pipe(gh(s=>function Pj(n,e,t,i){return function Oj(n,e,t,i){const r=yI(n);if(0===r.length)return ft({});const o={};return xi(r).pipe(ei(s=>function Fj(n,e,t,i){const r=Ug(n,e,i);return ts(r.resolve?r.resolve(e,t):r(e,t))}(n[s],e,t,i).pipe(ir(a=>{o[s]=a}))),Db(1),ei(()=>yI(o).length===r.length?ft(o):fo))}(n._resolve,n,e,i).pipe(Bt(o=>(n._resolvedData=o,n.data=Object.assign(Object.assign({},n.data),ZA(n,t).resolve),null)))}(s.route,i,n,e)),ir(()=>o++),Db(1),ei(s=>o===r.length?ft(t):fo))})}(this.paramsInheritanceStrategy,this.ngModule.injector),ir({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),ir(l=>{const c=new a6(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}))}),Hb(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:d,extras:{skipLocationChange:h,replaceUrl:f}}=a;return this.hooks.afterPreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:d,skipLocationChange:!!h,replaceUrl:!!f})}),Bt(a=>{const l=function O6(n,e,t){const i=vh(n,e._root,t?t._root:void 0);return new qA(i,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),ir(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((n,e,t)=>Bt(i=>(new W6(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),ir({next(){o=!0},complete(){o=!0}}),function t6(n){return Vn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}(()=>{var a;o||s||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===r.id&&(this.currentNavigation=null)}),ha(a=>{if(s=!0,function f6(n){return n&&n[NA]}(a)){const l=gl(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const c=new TA(r.id,this.serializeUrl(r.extractedUrl),a.message);i.next(c),l?setTimeout(()=>{const u=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),d={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||wI(r.source)};this.scheduleNavigation(u,"imperative",null,d,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new n6(r.id,this.serializeUrl(r.extractedUrl),a);i.next(l);try{r.resolve(this.errorHandler(a))}catch(c){r.reject(c)}}return fo}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var r;const o={replaceUrl:!0},s=(null===(r=t.state)||void 0===r?void 0:r.navigationId)?t.state:null;if(s){const l=Object.assign({},s);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(o.state=l)}const a=this.parseUrl(t.url);this.scheduleNavigation(a,i,s,o)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){rI(t),this.config=t.map(Bb),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:l}=i,c=r||this.routerState.root,u=l?this.currentUrlTree.fragment:s;let d=null;switch(a){case"merge":d=Object.assign(Object.assign({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}return null!==d&&(d=this.removeEmptyProps(d)),function L6(n,e,t,i,r){if(0===t.length)return Pb(e.root,e.root,e.root,i,r);const o=function B6(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new QA(!0,0,n);let e=0,t=!1;const i=n.reduce((r,o,s)=>{if("object"==typeof o&&null!=o){if(o.outlets){const a={};return Ni(o.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return"string"!=typeof o?[...r,o]:0===s?(o.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,o]},[]);return new QA(t,e,i)}(t);if(o.toRoot())return Pb(e.root,e.root,new kt([],{}),i,r);const s=function V6(n,e,t){if(n.isAbsolute)return new Ob(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const o=t.snapshot._urlSegment;return new Ob(o,o===e.root,0)}const i=Og(n.commands[0])?0:1;return function H6(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new Ob(i,!1,r-o)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+i,n.numberOfDoubleDots)}(o,e,n),a=s.processChildren?Fg(s.segmentGroup,s.index,o.commands):eI(s.segmentGroup,s.index,o.commands);return Pb(e.root,s.segmentGroup,a,i,r)}(c,this.currentUrlTree,t,d,null!=u?u:null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=gl(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,"imperative",null,i)}navigate(t,i={skipLocationChange:!1}){return function Wj(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?Object.assign({},Gj):!1===i?Object.assign({},jj):i,gl(t))return LA(this.currentUrlTree,t,r);const o=this.parseUrl(t);return LA(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const o=t[r];return null!=o&&(i[r]=o),i},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new mh(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,i,r,o,s){var a,l;if(this.disposed)return Promise.resolve(!1);let c,u,d;s?(c=s.resolve,u=s.reject,d=s.promise):d=new Promise((g,p)=>{c=g,u=p});const h=++this.navigationId;let f;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),f=r&&r.\u0275routerPageId?r.\u0275routerPageId:o.replaceUrl||o.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):f=0,this.setTransition({id:h,targetPageId:f,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:o,resolve:c,reject:u,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(g=>Promise.reject(g))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),o=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",o):this.location.go(r,"",o)}restoreHistory(t,i=!1){var r,o;if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===s?this.currentUrlTree===(null===(o=this.currentNavigation)||void 0===o?void 0:o.finalUrl)&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,i){const r=new TA(t.id,this.serializeUrl(t.extractedUrl),i);this.triggerEvent(r),t.resolve(!1)}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){uv()},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();function wI(n){return"imperative"!==n}class xI{}class MI{preload(e,t){return ft(null)}}let DI=(()=>{class n{constructor(t,i,r,o){this.router=t,this.injector=r,this.preloadingStrategy=o,this.loader=new vI(r,i,l=>t.triggerEvent(new AA(l)),l=>t.triggerEvent(new IA(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(nr(t=>t instanceof mh),gh(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Ss);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const o of i)if(o.loadChildren&&!o.canLoad&&o._loadedConfig){const s=o._loadedConfig;r.push(this.processRoutes(s.module,s.routes))}else o.loadChildren&&!o.canLoad?r.push(this.preloadConfig(t,o)):o.children&&r.push(this.processRoutes(t,o.children));return xi(r).pipe(vd(),Bt(o=>{}))}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?ft(i._loadedConfig):this.loader.load(t.injector,i)).pipe(ei(o=>(i._loadedConfig=o,this.processRoutes(o.module,o.routes)))))}}return n.\u0275fac=function(t){return new(t||n)(ke(Ir),ke(wT),ke(Ti),ke(xI))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})(),jb=(()=>{class n{constructor(t,i,r={}){this.router=t,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Sb?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof mh&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof RA&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.router.triggerEvent(new RA(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){uv()},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();const ml=new wt("ROUTER_CONFIGURATION"),SI=new wt("ROUTER_FORROOT_GUARD"),Zj=[nb,{provide:UA,useClass:zA},{provide:Ir,useFactory:function eW(n,e,t,i,r,o,s={},a,l){const c=new Ir(null,n,e,t,i,r,OA(o));return a&&(c.urlHandlingStrategy=a),l&&(c.routeReuseStrategy=l),function tW(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(s,c),s.enableTracing&&c.events.subscribe(u=>{var d,h;null===(d=console.group)||void 0===d||d.call(console,`Router Event: ${u.constructor.name}`),console.log(u.toString()),console.log(u),null===(h=console.groupEnd)||void 0===h||h.call(console)}),c},deps:[UA,Mh,nb,Ti,wT,Ub,ml,[class Vj{},new ra],[class kj{},new ra]]},Mh,{provide:Zc,useFactory:function nW(n){return n.routerState.root},deps:[Ir]},DI,MI,class Yj{preload(e,t){return t().pipe(ha(()=>ft(null)))}},{provide:ml,useValue:{enableTracing:!1}}];function Xj(){return new ET("Router",Ir)}let EI=(()=>{class n{constructor(t,i){}static forRoot(t,i){return{ngModule:n,providers:[Zj,CI(t),{provide:SI,useFactory:Qj,deps:[[Ir,new ra,new kd]]},{provide:ml,useValue:i||{}},{provide:Wc,useFactory:Jj,deps:[dl,[new Tp(tb),new ra],ml]},{provide:jb,useFactory:Kj,deps:[Ir,r8,ml]},{provide:xI,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:MI},{provide:ET,multi:!0,useFactory:Xj},[Wb,{provide:Vv,multi:!0,useFactory:iW,deps:[Wb]},{provide:TI,useFactory:rW,deps:[Wb]},{provide:bT,multi:!0,useExisting:TI}]]}}static forChild(t){return{ngModule:n,providers:[CI(t)]}}}return n.\u0275fac=function(t){return new(t||n)(ke(SI,8),ke(Ir,8))},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({}),n})();function Kj(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new jb(n,e,t)}function Jj(n,e,t={}){return t.useHash?new zG(n,e):new WT(n,e)}function Qj(n){return"guarded"}function CI(n){return[{provide:NL,multi:!0,useValue:n},{provide:Ub,multi:!0,useValue:n}]}let Wb=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Ft}appInitializer(){return this.injector.get(VG,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(a=>i=a),o=this.injector.get(Ir),s=this.injector.get(ml);return"disabled"===s.initialNavigation?(o.setUpLocationChangeListener(),i(!0)):"enabled"===s.initialNavigation||"enabledBlocking"===s.initialNavigation?(o.hooks.afterPreactivation=()=>this.initNavigation?ft(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),o.initialNavigation()):i(!0),r})}bootstrapListener(t){const i=this.injector.get(ml),r=this.injector.get(DI),o=this.injector.get(jb),s=this.injector.get(Ir),a=this.injector.get(og);t===a.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&s.initialNavigation(),r.setUpPreloading(),o.init(),s.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(ke(Ti))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();function iW(n){return n.appInitializer.bind(n)}function rW(n){return n.bootstrapListener.bind(n)}const TI=new wt("Router Initializer");let $b=(()=>{class n{constructor(){this.themeSource$=new kn("vs"),this.theme$=this.themeSource$.asObservable()}get theme(){return this.themeSource$.getValue()}set theme(t){this.themeSource$.next(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();function AI(n,e,t,i,r,o,s){try{var a=n[o](s),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Ch(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var o=n.apply(e,t);function s(l){AI(o,i,r,s,a,"next",l)}function a(l){AI(o,i,r,s,a,"throw",l)}s(void 0)})}}const qb={now:()=>(qb.delegate||Date).now(),delegate:void 0};class Yb extends Ft{constructor(e=1/0,t=1/0,i=qb){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:o,_windowTime:s}=this;t||(i.push(e),!r&&i.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,o=r.slice();for(let s=0;s<o.length&&!e.closed;s+=i?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,o=(r?1:2)*e;if(e<1/0&&o<i.length&&i.splice(0,i.length-o),!r){const s=t.now();let a=0;for(let l=1;l<i.length&&i[l]<=s;l+=2)a=l;a&&i.splice(0,a+1)}}}class Zb{static is(e,t){return e.type===t.name||Object.getPrototypeOf(e)instanceof t||Object.getPrototypeOf(e).constructor.name===t.name}static arrayEqual(e,t){const i=new Set(e),r=new Set(t);return e.every(o=>r.has(o))&&t.every(o=>i.has(o))}static find(e,t){for(const i of e)if(t(i))return i}}const tu=1e3,ji=1001,gi=1003,oi=1006,bl=1009,Nh=1012,ma=1015,iu=1016,ru=1020,to=1023,wl=1026,ou=1027,su=2400,au=2401,Ns=3e3,hn=3001,Ps="srgb",xl="srgb-linear",Ph=35044,Oh=35048;class _a{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const o=r.indexOf(t);-1!==o&&r.splice(o,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let o=0,s=r.length;o<s;o++)r[o].call(this,e);e.target=null}}}const Pi=[];for(let n=0;n<256;n++)Pi[n]=(n<16?"0":"")+n.toString(16);let hR=1234567;const Ml=Math.PI/180,Fh=180/Math.PI;function Nr(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Pi[255&n]+Pi[n>>8&255]+Pi[n>>16&255]+Pi[n>>24&255]+"-"+Pi[255&e]+Pi[e>>8&255]+"-"+Pi[e>>16&15|64]+Pi[e>>24&255]+"-"+Pi[63&t|128]+Pi[t>>8&255]+"-"+Pi[t>>16&255]+Pi[t>>24&255]+Pi[255&i]+Pi[i>>8&255]+Pi[i>>16&255]+Pi[i>>24&255]).toLowerCase()}function Zn(n,e,t){return Math.max(e,Math.min(t,n))}function c1(n,e){return(n%e+e)%e}function kh(n,e,t){return(1-t)*n+t*e}function u1(n){return 0==(n&n-1)&&0!==n}function fR(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Yg(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}var no=Object.freeze({__proto__:null,DEG2RAD:Ml,RAD2DEG:Fh,generateUUID:Nr,clamp:Zn,euclideanModulo:c1,mapLinear:function n$(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},inverseLerp:function i$(n,e,t){return n!==e?(t-n)/(e-n):0},lerp:kh,damp:function r$(n,e,t,i){return kh(n,e,1-Math.exp(-t*i))},pingpong:function o$(n,e=1){return e-Math.abs(c1(n,2*e)-e)},smoothstep:function s$(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)},smootherstep:function a$(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},randInt:function l$(n,e){return n+Math.floor(Math.random()*(e-n+1))},randFloat:function c$(n,e){return n+Math.random()*(e-n)},randFloatSpread:function u$(n){return n*(.5-Math.random())},seededRandom:function d$(n){void 0!==n&&(hR=n);let e=hR+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function h$(n){return n*Ml},radToDeg:function f$(n){return n*Fh},isPowerOfTwo:u1,ceilPowerOfTwo:fR,floorPowerOfTwo:Yg,setQuaternionFromProperEuler:function p$(n,e,t,i,r){const o=Math.cos,s=Math.sin,a=o(t/2),l=s(t/2),c=o((e+i)/2),u=s((e+i)/2),d=o((e-i)/2),h=s((e-i)/2),f=o((i-e)/2),g=s((i-e)/2);switch(r){case"XYX":n.set(a*u,l*d,l*h,a*c);break;case"YZY":n.set(l*h,a*u,l*d,a*c);break;case"ZXZ":n.set(l*d,l*h,a*u,a*c);break;case"XZX":n.set(a*u,l*g,l*f,a*c);break;case"YXY":n.set(l*f,a*u,l*g,a*c);break;case"ZYZ":n.set(l*g,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:function m$(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}},denormalize:function g$(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}});class re{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),o=this.x-e.x,s=this.y-e.y;return this.x=o*i-s*r+e.x,this.y=o*r+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}re.prototype.isVector2=!0;class mi{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,o,s,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=o,u[5]=l,u[6]=i,u[7]=s,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],g=i[8],p=r[0],m=r[3],y=r[6],_=r[1],v=r[4],b=r[7],w=r[2],D=r[5],C=r[8];return o[0]=s*p+a*_+l*w,o[3]=s*m+a*v+l*D,o[6]=s*y+a*b+l*C,o[1]=c*p+u*_+d*w,o[4]=c*m+u*v+d*D,o[7]=c*y+u*b+d*C,o[2]=h*p+f*_+g*w,o[5]=h*m+f*v+g*D,o[8]=h*y+f*b+g*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*s*u-t*a*c-i*o*u+i*a*l+r*o*c-r*s*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*s-a*c,h=a*l-u*o,f=c*o-s*l,g=t*d+i*h+r*f;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);const p=1/g;return e[0]=d*p,e[1]=(r*c-u*i)*p,e[2]=(a*i-r*s)*p,e[3]=h*p,e[4]=(u*t-r*l)*p,e[5]=(r*o-a*t)*p,e[6]=f*p,e[7]=(i*l-c*t)*p,e[8]=(s*t-i*o)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,o,s,a){const l=Math.cos(o),c=Math.sin(o);return this.set(i*l,i*c,-i*(l*s+c*a)+s+e,-r*c,r*l,-r*(-c*s+l*a)+a+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,o=r[0],s=r[3],a=r[6],l=r[1],c=r[4],u=r[7];return r[0]=t*o+i*l,r[3]=t*s+i*c,r[6]=t*a+i*u,r[1]=-i*o+t*l,r[4]=-i*s+t*c,r[7]=-i*a+t*u,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function pR(n){for(let e=n.length-1;e>=0;--e)if(n[e]>65535)return!0;return!1}function Lh(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Dl(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function Zg(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}mi.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const d1={[Ps]:{[xl]:Dl},[xl]:{[Ps]:Zg}},Eo={legacyMode:!0,get workingColorSpace(){return xl},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(d1[e]&&void 0!==d1[e][t]){const i=d1[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},gR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_i={r:0,g:0,b:0},Co={h:0,s:0,l:0},Xg={h:0,s:0,l:0};function h1(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}function Kg(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}let uu,ve=(()=>{class n{constructor(t,i,r){return void 0===i&&void 0===r?this.set(t):this.setRGB(t,i,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,i=Ps){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,Eo.toWorkingColorSpace(this,i),this}setRGB(t,i,r,o=xl){return this.r=t,this.g=i,this.b=r,Eo.toWorkingColorSpace(this,o),this}setHSL(t,i,r,o=xl){if(t=c1(t,1),i=Zn(i,0,1),r=Zn(r,0,1),0===i)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+i):r+i-r*i,a=2*r-s;this.r=h1(a,s,t+1/3),this.g=h1(a,s,t),this.b=h1(a,s,t-1/3)}return Eo.toWorkingColorSpace(this,o),this}setStyle(t,i=Ps){function r(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let o;if(o=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let s;const l=o[2];switch(o[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Eo.toWorkingColorSpace(this,i),r(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Eo.toWorkingColorSpace(this,i),r(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const c=parseFloat(s[1])/360,u=parseInt(s[2],10)/100,d=parseInt(s[3],10)/100;return r(s[4]),this.setHSL(c,u,d,i)}}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=o[1],a=s.length;if(3===a)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Eo.toWorkingColorSpace(this,i),this;if(6===a)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Eo.toWorkingColorSpace(this,i),this}return t&&t.length>0?this.setColorName(t,i):this}setColorName(t,i=Ps){const r=gR[t.toLowerCase()];return void 0!==r?this.setHex(r,i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Dl(t.r),this.g=Dl(t.g),this.b=Dl(t.b),this}copyLinearToSRGB(t){return this.r=Zg(t.r),this.g=Zg(t.g),this.b=Zg(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Ps){return Eo.fromWorkingColorSpace(Kg(this,_i),t),Zn(255*_i.r,0,255)<<16^Zn(255*_i.g,0,255)<<8^Zn(255*_i.b,0,255)<<0}getHexString(t=Ps){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,i=xl){Eo.fromWorkingColorSpace(Kg(this,_i),i);const r=_i.r,o=_i.g,s=_i.b,a=Math.max(r,o,s),l=Math.min(r,o,s);let c,u;const d=(l+a)/2;if(l===a)c=0,u=0;else{const h=a-l;switch(u=d<=.5?h/(a+l):h/(2-a-l),a){case r:c=(o-s)/h+(o<s?6:0);break;case o:c=(s-r)/h+2;break;case s:c=(r-o)/h+4}c/=6}return t.h=c,t.s=u,t.l=d,t}getRGB(t,i=xl){return Eo.fromWorkingColorSpace(Kg(this,_i),i),t.r=_i.r,t.g=_i.g,t.b=_i.b,t}getStyle(t=Ps){return Eo.fromWorkingColorSpace(Kg(this,_i),t),t!==Ps?`color(${t} ${_i.r} ${_i.g} ${_i.b})`:`rgb(${255*_i.r|0},${255*_i.g|0},${255*_i.b|0})`}offsetHSL(t,i,r){return this.getHSL(Co),Co.h+=t,Co.s+=i,Co.l+=r,this.setHSL(Co.h,Co.s,Co.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,r){return this.r=t.r+(i.r-t.r)*r,this.g=t.g+(i.g-t.g)*r,this.b=t.b+(i.b-t.b)*r,this}lerpHSL(t,i){this.getHSL(Co),t.getHSL(Xg);const r=kh(Co.h,Xg.h,i),o=kh(Co.s,Xg.s,i),s=kh(Co.l,Xg.l,i);return this.setHSL(r,o,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return n.NAMES=gR,n})();ve.prototype.isColor=!0,ve.prototype.r=1,ve.prototype.g=1,ve.prototype.b=1;class Sl{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===uu&&(uu=Lh("canvas")),uu.width=e.width,uu.height=e.height;const i=uu.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=uu}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Lh("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),o=r.data;for(let s=0;s<o.length;s++)o[s]=255*Dl(o[s]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Dl(t[i]/255)):Dl(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class du{constructor(e=null){this.uuid=Nr(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)o.push(f1(r[s].isDataTexture?r[s].image:r[s]))}else o=f1(r);i.url=o}return t||(e.images[this.uuid]=i),i}}function f1(n){return"undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&n instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?Sl.getDataURL(n):n.data?{data:Array.prototype.slice.call(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}du.prototype.isSource=!0;let y$=0,Di=(()=>{class n extends _a{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=ji,o=ji,s=oi,a=1008,l=to,c=bl,u=1,d=Ns){super(),Object.defineProperty(this,"id",{value:y$++}),this.uuid=Nr(),this.name="",this.source=new du(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=o,this.magFilter=s,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new re(0,0),this.repeat=new re(1,1),this.center=new re(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new mi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case tu:t.x=t.x-Math.floor(t.x);break;case ji:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case tu:t.y=t.y-Math.floor(t.y);break;case ji:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n})();Di.prototype.isTexture=!0;class Zt{constructor(e=0,t=0,i=0,r=1){this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r+s[12]*o,this.y=s[1]*t+s[5]*i+s[9]*r+s[13]*o,this.z=s[2]*t+s[6]*i+s[10]*r+s[14]*o,this.w=s[3]*t+s[7]*i+s[11]*r+s[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,o;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],g=l[9],p=l[2],m=l[6],y=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-p)<.01&&Math.abs(g-m)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+p)<.1&&Math.abs(g+m)<.1&&Math.abs(c+f+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const v=(c+1)/2,b=(f+1)/2,w=(y+1)/2,D=(u+h)/4,C=(d+p)/4,T=(g+m)/4;return v>b&&v>w?v<.01?(i=0,r=.707106781,o=.707106781):(i=Math.sqrt(v),r=D/i,o=C/i):b>w?b<.01?(i=.707106781,r=0,o=.707106781):(r=Math.sqrt(b),i=D/r,o=T/r):w<.01?(i=.707106781,r=.707106781,o=0):(o=Math.sqrt(w),i=C/o,r=T/o),this.set(i,r,o,t),this}let _=Math.sqrt((m-g)*(m-g)+(d-p)*(d-p)+(h-u)*(h-u));return Math.abs(_)<.001&&(_=1),this.x=(m-g)/_,this.y=(d-p)/_,this.z=(h-u)/_,this.w=Math.acos((c+f+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Zt.prototype.isVector4=!0;class Pr extends _a{constructor(e,t,i={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Zt(0,0,e,t),this.scissorTest=!1,this.viewport=new Zt(0,0,e,t),this.texture=new Di({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:oi,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0,this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}Pr.prototype.isWebGLRenderTarget=!0;class Jg extends Di{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=gi,this.minFilter=gi,this.wrapR=ji,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Jg.prototype.isDataArrayTexture=!0,class v$ extends Pr{constructor(e,t,i){super(e,t),this.depth=i,this.texture=new Jg(null,e,t,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGLArrayRenderTarget=!0;class p1 extends Di{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=gi,this.minFilter=gi,this.wrapR=ji,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}p1.prototype.isData3DTexture=!0,class b$ extends Pr{constructor(e,t,i){super(e,t),this.depth=i,this.texture=new p1(null,e,t,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGL3DRenderTarget=!0,class w$ extends Pr{constructor(e,t,i,r={}){super(e,t,r);const o=this.texture;this.texture=[];for(let s=0;s<i;s++)this.texture[s]=o.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,o=this.texture.length;r<o;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class Jt{constructor(e=0,t=0,i=0,r=1){this._x=e,this._y=t,this._z=i,this._w=r}static slerp(e,t,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,r)}static slerpFlat(e,t,i,r,o,s,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=o[s+0],f=o[s+1],g=o[s+2],p=o[s+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=g,void(e[t+3]=p);if(d!==p||l!==h||c!==f||u!==g){let m=1-a;const y=l*h+c*f+u*g+d*p,_=y>=0?1:-1,v=1-y*y;if(v>Number.EPSILON){const w=Math.sqrt(v),D=Math.atan2(w,y*_);m=Math.sin(m*D)/w,a=Math.sin(a*D)/w}const b=a*_;if(l=l*m+h*b,c=c*m+f*b,u=u*m+g*b,d=d*m+p*b,m===1-a){const w=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=w,c*=w,u*=w,d*=w}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,o,s){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=o[s],h=o[s+1],f=o[s+2],g=o[s+3];return e[t]=a*g+u*d+l*f-c*h,e[t+1]=l*g+u*h+c*d-a*f,e[t+2]=c*g+u*f+a*h-l*d,e[t+3]=u*g-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,o=e._z,s=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(o/2),h=l(i/2),f=l(r/2),g=l(o/2);switch(s){case"XYZ":this._x=h*u*d+c*f*g,this._y=c*f*d-h*u*g,this._z=c*u*g+h*f*d,this._w=c*u*d-h*f*g;break;case"YXZ":this._x=h*u*d+c*f*g,this._y=c*f*d-h*u*g,this._z=c*u*g-h*f*d,this._w=c*u*d+h*f*g;break;case"ZXY":this._x=h*u*d-c*f*g,this._y=c*f*d+h*u*g,this._z=c*u*g+h*f*d,this._w=c*u*d-h*f*g;break;case"ZYX":this._x=h*u*d-c*f*g,this._y=c*f*d+h*u*g,this._z=c*u*g-h*f*d,this._w=c*u*d+h*f*g;break;case"YZX":this._x=h*u*d+c*f*g,this._y=c*f*d+h*u*g,this._z=c*u*g-h*f*d,this._w=c*u*d-h*f*g;break;case"XZY":this._x=h*u*d-c*f*g,this._y=c*f*d-h*u*g,this._z=c*u*g+h*f*d,this._w=c*u*d+h*f*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],o=t[8],s=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(o-c)*f,this._z=(s-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+s)/f,this._z=(o+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(o-c)/f,this._x=(r+s)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(s-r)/f,this._x=(o+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Zn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,o=e._z,s=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+s*a+r*c-o*l,this._y=r*u+s*l+o*a-i*c,this._z=o*u+s*c+i*l-r*a,this._w=s*u-i*a-r*l-o*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,o=this._z,s=this._w;let a=s*e._w+i*e._x+r*e._y+o*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=i,this._y=r,this._z=o,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*s+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*o+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=s*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=o*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(o),i*Math.cos(o),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Jt.prototype.isQuaternion=!0;class M{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(mR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(mR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*r,this.y=o[1]*t+o[4]*i+o[7]*r,this.z=o[2]*t+o[5]*i+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=e.elements,s=1/(o[3]*t+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*r+o[12])*s,this.y=(o[1]*t+o[5]*i+o[9]*r+o[13])*s,this.z=(o[2]*t+o[6]*i+o[10]*r+o[14])*s,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,o=e.x,s=e.y,a=e.z,l=e.w,c=l*t+s*r-a*i,u=l*i+a*t-o*r,d=l*r+o*i-s*t,h=-o*t-s*i-a*r;return this.x=c*l+h*-o+u*-a-d*-s,this.y=u*l+h*-s+d*-o-c*-a,this.z=d*l+h*-a+c*-s-u*-o,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r,this.y=o[1]*t+o[5]*i+o[9]*r,this.z=o[2]*t+o[6]*i+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,o=e.z,s=t.x,a=t.y,l=t.z;return this.x=r*l-o*a,this.y=o*s-i*l,this.z=i*a-r*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return g1.copy(this).projectOnVector(e),this.sub(g1)}reflect(e){return this.sub(g1.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Zn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}M.prototype.isVector3=!0;const g1=new M,mR=new Jt;class Or{constructor(e=new M(1/0,1/0,1/0),t=new M(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],d=e[l+1],h=e[l+2];u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>o&&(o=u),d>s&&(s=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(o,s,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,o=-1/0,s=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),d=e.getY(l),h=e.getZ(l);u<t&&(t=u),d<i&&(i=d),h<r&&(r=h),u>o&&(o=u),d>s&&(s=d),h>a&&(a=h)}return this.min.set(t,i,r),this.max.set(o,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=El.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const o=i.attributes.position;for(let s=0,a=o.count;s<a;s++)El.fromBufferAttribute(o,s).applyMatrix4(e.matrixWorld),this.expandByPoint(El)}else null===i.boundingBox&&i.computeBoundingBox(),m1.copy(i.boundingBox),m1.applyMatrix4(e.matrixWorld),this.union(m1);const r=e.children;for(let o=0,s=r.length;o<s;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,El),El.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Bh),Qg.subVectors(this.max,Bh),hu.subVectors(e.a,Bh),fu.subVectors(e.b,Bh),pu.subVectors(e.c,Bh),ya.subVectors(fu,hu),va.subVectors(pu,fu),Cl.subVectors(hu,pu);let t=[0,-ya.z,ya.y,0,-va.z,va.y,0,-Cl.z,Cl.y,ya.z,0,-ya.x,va.z,0,-va.x,Cl.z,0,-Cl.x,-ya.y,ya.x,0,-va.y,va.x,0,-Cl.y,Cl.x,0];return!(!_1(t,hu,fu,pu,Qg)||(t=[1,0,0,0,1,0,0,0,1],!_1(t,hu,fu,pu,Qg)))&&(em.crossVectors(ya,va),t=[em.x,em.y,em.z],_1(t,hu,fu,pu,Qg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return El.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(El).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Os[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Os[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Os[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Os[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Os[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Os[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Os[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Os[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Os)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Or.prototype.isBox3=!0;const Os=[new M,new M,new M,new M,new M,new M,new M,new M],El=new M,m1=new Or,hu=new M,fu=new M,pu=new M,ya=new M,va=new M,Cl=new M,Bh=new M,Qg=new M,em=new M,Tl=new M;function _1(n,e,t,i,r){for(let o=0,s=n.length-3;o<=s;o+=3){Tl.fromArray(n,o);const a=r.x*Math.abs(Tl.x)+r.y*Math.abs(Tl.y)+r.z*Math.abs(Tl.z),l=e.dot(Tl),c=t.dot(Tl),u=i.dot(Tl);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const x$=new Or,_R=new M,tm=new M,y1=new M;class Al{constructor(e=new M,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):x$.setFromPoints(e).getCenter(i);let r=0;for(let o=0,s=e.length;o<s;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){y1.subVectors(e,this.center);const t=y1.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.add(y1.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?tm.set(0,0,1).multiplyScalar(e.radius):tm.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(_R.copy(e.center).add(tm)),this.expandByPoint(_R.copy(e.center).sub(tm)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Fs=new M,v1=new M,nm=new M,ba=new M,b1=new M,im=new M,w1=new M;class Il{constructor(e=new M,t=new M(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Fs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Fs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Fs.copy(this.direction).multiplyScalar(t).add(this.origin),Fs.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){v1.copy(e).add(t).multiplyScalar(.5),nm.copy(t).sub(e).normalize(),ba.copy(this.origin).sub(v1);const o=.5*e.distanceTo(t),s=-this.direction.dot(nm),a=ba.dot(this.direction),l=-ba.dot(nm),c=ba.lengthSq(),u=Math.abs(1-s*s);let d,h,f,g;if(u>0)if(d=s*l-a,h=s*a-l,g=o*u,d>=0)if(h>=-g)if(h<=g){const p=1/u;d*=p,h*=p,f=d*(d+s*h+2*a)+h*(s*d+h+2*l)+c}else h=o,d=Math.max(0,-(s*h+a)),f=-d*d+h*(h+2*l)+c;else h=-o,d=Math.max(0,-(s*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-g?(d=Math.max(0,-(-s*o+a)),h=d>0?-o:Math.min(Math.max(-o,-l),o),f=-d*d+h*(h+2*l)+c):h<=g?(d=0,h=Math.min(Math.max(-o,-l),o),f=h*(h+2*l)+c):(d=Math.max(0,-(s*o+a)),h=d>0?o:Math.min(Math.max(-o,-l),o),f=-d*d+h*(h+2*l)+c);else h=s>0?-o:o,d=Math.max(0,-(s*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.direction).multiplyScalar(d).add(this.origin),r&&r.copy(nm).multiplyScalar(h).add(v1),f}intersectSphere(e,t){Fs.subVectors(e.center,this.origin);const i=Fs.dot(this.direction),r=Fs.dot(Fs)-i*i,o=e.radius*e.radius;if(r>o)return null;const s=Math.sqrt(o-r),a=i-s,l=i+s;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,o,s,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(o=(e.min.y-h.y)*u,s=(e.max.y-h.y)*u):(o=(e.max.y-h.y)*u,s=(e.min.y-h.y)*u),i>s||o>r||((o>i||i!=i)&&(i=o),(s<r||r!=r)&&(r=s),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Fs)}intersectTriangle(e,t,i,r,o){b1.subVectors(t,e),im.subVectors(i,e),w1.crossVectors(b1,im);let a,s=this.direction.dot(w1);if(s>0){if(r)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}ba.subVectors(this.origin,e);const l=a*this.direction.dot(im.crossVectors(ba,im));if(l<0)return null;const c=a*this.direction.dot(b1.cross(ba));if(c<0||l+c>s)return null;const u=-a*ba.dot(w1);return u<0?null:this.at(u/s,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ye{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,o,s,a,l,c,u,d,h,f,g,p,m){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=o,y[5]=s,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=d,y[14]=h,y[3]=f,y[7]=g,y[11]=p,y[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ye).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/gu.setFromMatrixColumn(e,0).length(),o=1/gu.setFromMatrixColumn(e,1).length(),s=1/gu.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,r=e.y,o=e.z,s=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(o),d=Math.sin(o);if("XYZ"===e.order){const h=s*u,f=s*d,g=a*u,p=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+g*c,t[5]=h-p*c,t[9]=-a*l,t[2]=p-h*c,t[6]=g+f*c,t[10]=s*l}else if("YXZ"===e.order){const h=l*u,f=l*d,g=c*u,p=c*d;t[0]=h+p*a,t[4]=g*a-f,t[8]=s*c,t[1]=s*d,t[5]=s*u,t[9]=-a,t[2]=f*a-g,t[6]=p+h*a,t[10]=s*l}else if("ZXY"===e.order){const h=l*u,f=l*d,g=c*u,p=c*d;t[0]=h-p*a,t[4]=-s*d,t[8]=g+f*a,t[1]=f+g*a,t[5]=s*u,t[9]=p-h*a,t[2]=-s*c,t[6]=a,t[10]=s*l}else if("ZYX"===e.order){const h=s*u,f=s*d,g=a*u,p=a*d;t[0]=l*u,t[4]=g*c-f,t[8]=h*c+p,t[1]=l*d,t[5]=p*c+h,t[9]=f*c-g,t[2]=-c,t[6]=a*l,t[10]=s*l}else if("YZX"===e.order){const h=s*l,f=s*c,g=a*l,p=a*c;t[0]=l*u,t[4]=p-h*d,t[8]=g*d+f,t[1]=d,t[5]=s*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+g,t[10]=h-p*d}else if("XZY"===e.order){const h=s*l,f=s*c,g=a*l,p=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+p,t[5]=s*u,t[9]=f*d-g,t[2]=g*d-f,t[6]=a*u,t[10]=p*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(M$,e,D$)}lookAt(e,t,i){const r=this.elements;return Fr.subVectors(e,t),0===Fr.lengthSq()&&(Fr.z=1),Fr.normalize(),wa.crossVectors(i,Fr),0===wa.lengthSq()&&(1===Math.abs(i.z)?Fr.x+=1e-4:Fr.z+=1e-4,Fr.normalize(),wa.crossVectors(i,Fr)),wa.normalize(),rm.crossVectors(Fr,wa),r[0]=wa.x,r[4]=rm.x,r[8]=Fr.x,r[1]=wa.y,r[5]=rm.y,r[9]=Fr.y,r[2]=wa.z,r[6]=rm.z,r[10]=Fr.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,s=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],g=i[2],p=i[6],m=i[10],y=i[14],_=i[3],v=i[7],b=i[11],w=i[15],D=r[0],C=r[4],T=r[8],G=r[12],O=r[1],x=r[5],N=r[9],q=r[13],L=r[2],j=r[6],z=r[10],$=r[14],U=r[3],X=r[7],ee=r[11],se=r[15];return o[0]=s*D+a*O+l*L+c*U,o[4]=s*C+a*x+l*j+c*X,o[8]=s*T+a*N+l*z+c*ee,o[12]=s*G+a*q+l*$+c*se,o[1]=u*D+d*O+h*L+f*U,o[5]=u*C+d*x+h*j+f*X,o[9]=u*T+d*N+h*z+f*ee,o[13]=u*G+d*q+h*$+f*se,o[2]=g*D+p*O+m*L+y*U,o[6]=g*C+p*x+m*j+y*X,o[10]=g*T+p*N+m*z+y*ee,o[14]=g*G+p*q+m*$+y*se,o[3]=_*D+v*O+b*L+w*U,o[7]=_*C+v*x+b*j+w*X,o[11]=_*T+v*N+b*z+w*ee,o[15]=_*G+v*q+b*$+w*se,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],o=e[12],s=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+o*l*d-r*c*d-o*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+o*s*h-r*s*f+r*c*u-o*l*u)+e[11]*(+t*c*d-t*a*f-o*s*d+i*s*f+o*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*s*d-i*s*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],g=e[12],p=e[13],m=e[14],y=e[15],_=d*m*c-p*h*c+p*l*f-a*m*f-d*l*y+a*h*y,v=g*h*c-u*m*c-g*l*f+s*m*f+u*l*y-s*h*y,b=u*p*c-g*d*c+g*a*f-s*p*f-u*a*y+s*d*y,w=g*d*l-u*p*l-g*a*h+s*p*h+u*a*m-s*d*m,D=t*_+i*v+r*b+o*w;if(0===D)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/D;return e[0]=_*C,e[1]=(p*h*o-d*m*o-p*r*f+i*m*f+d*r*y-i*h*y)*C,e[2]=(a*m*o-p*l*o+p*r*c-i*m*c-a*r*y+i*l*y)*C,e[3]=(d*l*o-a*h*o-d*r*c+i*h*c+a*r*f-i*l*f)*C,e[4]=v*C,e[5]=(u*m*o-g*h*o+g*r*f-t*m*f-u*r*y+t*h*y)*C,e[6]=(g*l*o-s*m*o-g*r*c+t*m*c+s*r*y-t*l*y)*C,e[7]=(s*h*o-u*l*o+u*r*c-t*h*c-s*r*f+t*l*f)*C,e[8]=b*C,e[9]=(g*d*o-u*p*o-g*i*f+t*p*f+u*i*y-t*d*y)*C,e[10]=(s*p*o-g*a*o+g*i*c-t*p*c-s*i*y+t*a*y)*C,e[11]=(u*a*o-s*d*o-u*i*c+t*d*c+s*i*f-t*a*f)*C,e[12]=w*C,e[13]=(u*p*r-g*d*r+g*i*h-t*p*h-u*i*m+t*d*m)*C,e[14]=(g*a*r-s*p*r-g*i*l+t*p*l+s*i*m-t*a*m)*C,e[15]=(s*d*r-u*a*r+u*i*l-t*d*l-s*i*h+t*a*h)*C,this}scale(e){const t=this.elements,i=e.x,r=e.y,o=e.z;return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),o=1-i,s=e.x,a=e.y,l=e.z,c=o*s,u=o*a;return this.set(c*s+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*s,0,c*l-r*a,u*l+r*s,o*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,o,s){return this.set(1,i,o,0,e,1,s,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,o=t._x,s=t._y,a=t._z,l=t._w,c=o+o,u=s+s,d=a+a,h=o*c,f=o*u,g=o*d,p=s*u,m=s*d,y=a*d,_=l*c,v=l*u,b=l*d,w=i.x,D=i.y,C=i.z;return r[0]=(1-(p+y))*w,r[1]=(f+b)*w,r[2]=(g-v)*w,r[3]=0,r[4]=(f-b)*D,r[5]=(1-(h+y))*D,r[6]=(m+_)*D,r[7]=0,r[8]=(g+v)*C,r[9]=(m-_)*C,r[10]=(1-(h+p))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let o=gu.set(r[0],r[1],r[2]).length();const s=gu.set(r[4],r[5],r[6]).length(),a=gu.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],To.copy(this);const c=1/o,u=1/s,d=1/a;return To.elements[0]*=c,To.elements[1]*=c,To.elements[2]*=c,To.elements[4]*=u,To.elements[5]*=u,To.elements[6]*=u,To.elements[8]*=d,To.elements[9]*=d,To.elements[10]*=d,t.setFromRotationMatrix(To),i.x=o,i.y=s,i.z=a,this}makePerspective(e,t,i,r,o,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*o/(i-r),u=(t+e)/(t-e),d=(i+r)/(i-r),h=-(s+o)/(s-o),f=-2*s*o/(s-o);return a[0]=2*o/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,r,o,s){const a=this.elements,l=1/(t-e),c=1/(i-r),u=1/(s-o),d=(t+e)*l,h=(i+r)*c,f=(s+o)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}ye.prototype.isMatrix4=!0;const gu=new M,To=new ye,M$=new M(0,0,0),D$=new M(1,1,1),wa=new M,rm=new M,Fr=new M,yR=new ye,vR=new Jt;class kr{constructor(e=0,t=0,i=0,r=kr.DefaultOrder){this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,o=r[0],s=r[4],a=r[8],l=r[1],c=r[5],u=r[9],d=r[2],h=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(Zn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Zn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(Zn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-s,c)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-Zn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-s,c));break;case"YZX":this._z=Math.asin(Zn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-Zn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===i&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return yR.makeRotationFromQuaternion(e),this.setFromRotationMatrix(yR,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return vR.setFromEuler(this),this.setFromQuaternion(vR,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}kr.prototype.isEuler=!0,kr.DefaultOrder="XYZ",kr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class x1{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let S$=0;const bR=new M,mu=new Jt,ks=new ye,om=new M,Vh=new M,E$=new M,C$=new Jt,wR=new M(1,0,0),xR=new M(0,1,0),MR=new M(0,0,1),T$={type:"added"},DR={type:"removed"};class Dt extends _a{constructor(){super(),Object.defineProperty(this,"id",{value:S$++}),this.uuid=Nr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Dt.DefaultUp.clone();const e=new M,t=new kr,i=new Jt,r=new M(1,1,1);t._onChange(function o(){i.setFromEuler(t,!1)}),i._onChange(function s(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ye},normalMatrix:{value:new mi}}),this.matrix=new ye,this.matrixWorld=new ye,this.matrixAutoUpdate=Dt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new x1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return mu.setFromAxisAngle(e,t),this.quaternion.multiply(mu),this}rotateOnWorldAxis(e,t){return mu.setFromAxisAngle(e,t),this.quaternion.premultiply(mu),this}rotateX(e){return this.rotateOnAxis(wR,e)}rotateY(e){return this.rotateOnAxis(xR,e)}rotateZ(e){return this.rotateOnAxis(MR,e)}translateOnAxis(e,t){return bR.copy(e).applyQuaternion(this.quaternion),this.position.add(bR.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(wR,e)}translateY(e){return this.translateOnAxis(xR,e)}translateZ(e){return this.translateOnAxis(MR,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(ks.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?om.copy(e):om.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Vh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ks.lookAt(Vh,om,this.up):ks.lookAt(om,Vh,this.up),this.quaternion.setFromRotationMatrix(ks),r&&(ks.extractRotation(r.matrixWorld),mu.setFromRotationMatrix(ks),this.quaternion.premultiply(mu.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(T$)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(DR)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(DR)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),ks.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),ks.multiply(e.parent.matrixWorld)),e.applyMatrix4(ks),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const s=this.children[i].getObjectByProperty(e,t);if(void 0!==s)return s}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Vh,e,E$),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Vh,C$,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const r=this.children;for(let o=0,s=r.length;o<s;o++)r[o].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function o(a,l){return void 0===a[l.uuid]&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(e.geometries,this.geometry);const a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++)o(e.shapes,l[c]);else o(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(o(e.materials,this.material[l]));r.material=a}else r.material=o(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++)r.animations.push(o(e.animations,this.animations[a]))}if(t){const a=s(e.geometries),l=s(e.materials),c=s(e.textures),u=s(e.images),d=s(e.shapes),h=s(e.skeletons),f=s(e.animations),g=s(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),d.length>0&&(i.shapes=d),h.length>0&&(i.skeletons=h),f.length>0&&(i.animations=f),g.length>0&&(i.nodes=g)}return i.object=r,i;function s(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let i=0;i<e.children.length;i++)this.add(e.children[i].clone());return this}}Dt.DefaultUp=new M(0,1,0),Dt.DefaultMatrixAutoUpdate=!0,Dt.prototype.isObject3D=!0;const Ao=new M,Ls=new M,M1=new M,Bs=new M,_u=new M,yu=new M,SR=new M,D1=new M,S1=new M,E1=new M;class si{constructor(e=new M,t=new M,i=new M){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Ao.subVectors(e,t),r.cross(Ao);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,i,r,o){Ao.subVectors(r,t),Ls.subVectors(i,t),M1.subVectors(e,t);const s=Ao.dot(Ao),a=Ao.dot(Ls),l=Ao.dot(M1),c=Ls.dot(Ls),u=Ls.dot(M1),d=s*c-a*a;if(0===d)return o.set(-2,-1,-1);const h=1/d,f=(c*l-a*u)*h,g=(s*u-a*l)*h;return o.set(1-f-g,g,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Bs),Bs.x>=0&&Bs.y>=0&&Bs.x+Bs.y<=1}static getUV(e,t,i,r,o,s,a,l){return this.getBarycoord(e,t,i,r,Bs),l.set(0,0),l.addScaledVector(o,Bs.x),l.addScaledVector(s,Bs.y),l.addScaledVector(a,Bs.z),l}static isFrontFacing(e,t,i,r){return Ao.subVectors(i,t),Ls.subVectors(e,t),Ao.cross(Ls).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ao.subVectors(this.c,this.b),Ls.subVectors(this.a,this.b),.5*Ao.cross(Ls).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return si.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return si.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,o){return si.getUV(e,this.a,this.b,this.c,t,i,r,o)}containsPoint(e){return si.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return si.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,o=this.c;let s,a;_u.subVectors(r,i),yu.subVectors(o,i),D1.subVectors(e,i);const l=_u.dot(D1),c=yu.dot(D1);if(l<=0&&c<=0)return t.copy(i);S1.subVectors(e,r);const u=_u.dot(S1),d=yu.dot(S1);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return s=l/(l-u),t.copy(i).addScaledVector(_u,s);E1.subVectors(e,o);const f=_u.dot(E1),g=yu.dot(E1);if(g>=0&&f<=g)return t.copy(o);const p=f*c-l*g;if(p<=0&&c>=0&&g<=0)return a=c/(c-g),t.copy(i).addScaledVector(yu,a);const m=u*g-f*d;if(m<=0&&d-u>=0&&f-g>=0)return SR.subVectors(o,r),a=(d-u)/(d-u+(f-g)),t.copy(r).addScaledVector(SR,a);const y=1/(m+p+h);return s=p*y,a=h*y,t.copy(i).addScaledVector(_u,s).addScaledVector(yu,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let A$=0;class Ln extends _a{constructor(){super(),Object.defineProperty(this,"id",{value:A$++}),this.uuid=Nr(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(o){const s=[];for(const a in o){const l=o[a];delete l.metadata,s.push(l)}return s}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){const o=r(e.textures),s=r(e.images);o.length>0&&(i.textures=o),s.length>0&&(i.images=s)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}Ln.prototype.isMaterial=!0,Ln.fromType=function(){return null};class io extends Ln{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new ve(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}io.prototype.isMeshBasicMaterial=!0;const ai=new M,sm=new re;class xn{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.usage=Ph,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let s=e[r];void 0===s&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),s=new ve),t[i++]=s.r,t[i++]=s.g,t[i++]=s.b}return this}copyVector2sArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let s=e[r];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),s=new re),t[i++]=s.x,t[i++]=s.y}return this}copyVector3sArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let s=e[r];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),s=new M),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z}return this}copyVector4sArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let s=e[r];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),s=new Zt),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z,t[i++]=s.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)sm.fromBufferAttribute(this,t),sm.applyMatrix3(e),this.setXY(t,sm.x,sm.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)ai.fromBufferAttribute(this,t),ai.applyMatrix3(e),this.setXYZ(t,ai.x,ai.y,ai.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)ai.fromBufferAttribute(this,t),ai.applyMatrix4(e),this.setXYZ(t,ai.x,ai.y,ai.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ai.fromBufferAttribute(this,t),ai.applyNormalMatrix(e),this.setXYZ(t,ai.x,ai.y,ai.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ai.fromBufferAttribute(this,t),ai.transformDirection(e),this.setXYZ(t,ai.x,ai.y,ai.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,o){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Ph&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}xn.prototype.isBufferAttribute=!0;class C1 extends xn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class ER extends xn{constructor(e,t,i){super(new Uint32Array(e),t,i)}}(class I$ extends xn{constructor(e,t,i){super(new Uint16Array(e),t,i)}}).prototype.isFloat16BufferAttribute=!0;class Fe extends xn{constructor(e,t,i){super(new Float32Array(e),t,i)}}let R$=0;const ro=new ye,T1=new Dt,vu=new M,Lr=new Or,Hh=new Or,Si=new M;class je extends _a{constructor(){super(),Object.defineProperty(this,"id",{value:R$++}),this.uuid=Nr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(pR(e)?ER:C1)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const o=(new mi).getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return ro.makeRotationFromQuaternion(e),this.applyMatrix4(ro),this}rotateX(e){return ro.makeRotationX(e),this.applyMatrix4(ro),this}rotateY(e){return ro.makeRotationY(e),this.applyMatrix4(ro),this}rotateZ(e){return ro.makeRotationZ(e),this.applyMatrix4(ro),this}translate(e,t,i){return ro.makeTranslation(e,t,i),this.applyMatrix4(ro),this}scale(e,t,i){return ro.makeScale(e,t,i),this.applyMatrix4(ro),this}lookAt(e){return T1.lookAt(e),T1.updateMatrix(),this.applyMatrix4(T1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(vu).negate(),this.translate(vu.x,vu.y,vu.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const o=e[i];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Fe(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Or);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new M(-1/0,-1/0,-1/0),new M(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Lr.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(Si.addVectors(this.boundingBox.min,Lr.min),this.boundingBox.expandByPoint(Si),Si.addVectors(this.boundingBox.max,Lr.max),this.boundingBox.expandByPoint(Si)):(this.boundingBox.expandByPoint(Lr.min),this.boundingBox.expandByPoint(Lr.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Al);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new M,1/0);if(e){const i=this.boundingSphere.center;if(Lr.setFromBufferAttribute(e),t)for(let o=0,s=t.length;o<s;o++)Hh.setFromBufferAttribute(t[o]),this.morphTargetsRelative?(Si.addVectors(Lr.min,Hh.min),Lr.expandByPoint(Si),Si.addVectors(Lr.max,Hh.max),Lr.expandByPoint(Si)):(Lr.expandByPoint(Hh.min),Lr.expandByPoint(Hh.max));Lr.getCenter(i);let r=0;for(let o=0,s=e.count;o<s;o++)Si.fromBufferAttribute(e,o),r=Math.max(r,i.distanceToSquared(Si));if(t)for(let o=0,s=t.length;o<s;o++){const a=t[o],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Si.fromBufferAttribute(a,c),l&&(vu.fromBufferAttribute(e,c),Si.add(vu)),r=Math.max(r,i.distanceToSquared(Si))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,o=t.normal.array,s=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new xn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let O=0;O<a;O++)c[O]=new M,u[O]=new M;const d=new M,h=new M,f=new M,g=new re,p=new re,m=new re,y=new M,_=new M;function v(O,x,N){d.fromArray(r,3*O),h.fromArray(r,3*x),f.fromArray(r,3*N),g.fromArray(s,2*O),p.fromArray(s,2*x),m.fromArray(s,2*N),h.sub(d),f.sub(d),p.sub(g),m.sub(g);const q=1/(p.x*m.y-m.x*p.y);!isFinite(q)||(y.copy(h).multiplyScalar(m.y).addScaledVector(f,-p.y).multiplyScalar(q),_.copy(f).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(q),c[O].add(y),c[x].add(y),c[N].add(y),u[O].add(_),u[x].add(_),u[N].add(_))}let b=this.groups;0===b.length&&(b=[{start:0,count:i.length}]);for(let O=0,x=b.length;O<x;++O){const N=b[O],q=N.start;for(let j=q,z=q+N.count;j<z;j+=3)v(i[j+0],i[j+1],i[j+2])}const w=new M,D=new M,C=new M,T=new M;function G(O){C.fromArray(o,3*O),T.copy(C);const x=c[O];w.copy(x),w.sub(C.multiplyScalar(C.dot(x))).normalize(),D.crossVectors(T,x);const q=D.dot(u[O])<0?-1:1;l[4*O]=w.x,l[4*O+1]=w.y,l[4*O+2]=w.z,l[4*O+3]=q}for(let O=0,x=b.length;O<x;++O){const N=b[O],q=N.start;for(let j=q,z=q+N.count;j<z;j+=3)G(i[j+0]),G(i[j+1]),G(i[j+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new xn(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new M,o=new M,s=new M,a=new M,l=new M,c=new M,u=new M,d=new M;if(e)for(let h=0,f=e.count;h<f;h+=3){const g=e.getX(h+0),p=e.getX(h+1),m=e.getX(h+2);r.fromBufferAttribute(t,g),o.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),u.subVectors(s,o),d.subVectors(r,o),u.cross(d),a.fromBufferAttribute(i,g),l.fromBufferAttribute(i,p),c.fromBufferAttribute(i,m),a.add(u),l.add(u),c.add(u),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(p,l.x,l.y,l.z),i.setXYZ(m,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),o.fromBufferAttribute(t,h+1),s.fromBufferAttribute(t,h+2),u.subVectors(s,o),d.subVectors(r,o),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const r in i){if(void 0===e.attributes[r])continue;const s=i[r].array,a=e.attributes[r],l=a.array,c=a.itemSize*t,u=Math.min(l.length,s.length-c);for(let d=0,h=c;d<u;d++,h++)s[h]=l[d]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Si.fromBufferAttribute(e,t),Si.normalize(),e.setXYZ(t,Si.x,Si.y,Si.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,g=0;for(let p=0,m=l.length;p<m;p++){f=a.isInterleavedBufferAttribute?l[p]*a.data.stride+a.offset:l[p]*u;for(let y=0;y<u;y++)h[g++]=c[f++]}return new xn(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new je,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const o=this.morphAttributes;for(const a in o){const l=[],c=o[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,l=s.length;a<l;a++){const c=s[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let o=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const o=e.morphAttributes;for(const c in o){const u=[],d=o[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let c=0,u=s.length;c<u;c++){const d=s[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}je.prototype.isBufferGeometry=!0;const CR=new ye,bu=new Il,A1=new Al,xa=new M,Ma=new M,Da=new M,I1=new M,R1=new M,N1=new M,am=new M,lm=new M,cm=new M,um=new re,dm=new re,hm=new re,P1=new M,fm=new M;class we extends Dt{constructor(e=new je,t=new io){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const i=this.geometry,r=this.material,o=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),A1.copy(i.boundingSphere),A1.applyMatrix4(o),!1===e.ray.intersectsSphere(A1))||(CR.copy(o).invert(),bu.copy(e.ray).applyMatrix4(CR),null!==i.boundingBox&&!1===bu.intersectsBox(i.boundingBox)))return;let s;if(i.isBufferGeometry){const a=i.index,l=i.attributes.position,c=i.morphAttributes.position,u=i.morphTargetsRelative,d=i.attributes.uv,h=i.attributes.uv2,f=i.groups,g=i.drawRange;if(null!==a)if(Array.isArray(r))for(let p=0,m=f.length;p<m;p++){const y=f[p],_=r[y.materialIndex];for(let w=Math.max(y.start,g.start),D=Math.min(a.count,Math.min(y.start+y.count,g.start+g.count));w<D;w+=3){const C=a.getX(w),T=a.getX(w+1),G=a.getX(w+2);s=pm(this,_,e,bu,l,c,u,d,h,C,T,G),s&&(s.faceIndex=Math.floor(w/3),s.face.materialIndex=y.materialIndex,t.push(s))}}else for(let y=Math.max(0,g.start),_=Math.min(a.count,g.start+g.count);y<_;y+=3){const v=a.getX(y),b=a.getX(y+1),w=a.getX(y+2);s=pm(this,r,e,bu,l,c,u,d,h,v,b,w),s&&(s.faceIndex=Math.floor(y/3),t.push(s))}else if(void 0!==l)if(Array.isArray(r))for(let p=0,m=f.length;p<m;p++){const y=f[p],_=r[y.materialIndex];for(let w=Math.max(y.start,g.start),D=Math.min(l.count,Math.min(y.start+y.count,g.start+g.count));w<D;w+=3)s=pm(this,_,e,bu,l,c,u,d,h,w,w+1,w+2),s&&(s.faceIndex=Math.floor(w/3),s.face.materialIndex=y.materialIndex,t.push(s))}else for(let y=Math.max(0,g.start),_=Math.min(l.count,g.start+g.count);y<_;y+=3)s=pm(this,r,e,bu,l,c,u,d,h,y,y+1,y+2),s&&(s.faceIndex=Math.floor(y/3),t.push(s))}else i.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function pm(n,e,t,i,r,o,s,a,l,c,u,d){xa.fromBufferAttribute(r,c),Ma.fromBufferAttribute(r,u),Da.fromBufferAttribute(r,d);const h=n.morphTargetInfluences;if(o&&h){am.set(0,0,0),lm.set(0,0,0),cm.set(0,0,0);for(let g=0,p=o.length;g<p;g++){const m=h[g],y=o[g];0!==m&&(I1.fromBufferAttribute(y,c),R1.fromBufferAttribute(y,u),N1.fromBufferAttribute(y,d),s?(am.addScaledVector(I1,m),lm.addScaledVector(R1,m),cm.addScaledVector(N1,m)):(am.addScaledVector(I1.sub(xa),m),lm.addScaledVector(R1.sub(Ma),m),cm.addScaledVector(N1.sub(Da),m)))}xa.add(am),Ma.add(lm),Da.add(cm)}n.isSkinnedMesh&&(n.boneTransform(c,xa),n.boneTransform(u,Ma),n.boneTransform(d,Da));const f=function N$(n,e,t,i,r,o,s,a){let l;if(l=1===e.side?i.intersectTriangle(s,o,r,!0,a):i.intersectTriangle(r,o,s,2!==e.side,a),null===l)return null;fm.copy(a),fm.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(fm);return c<t.near||c>t.far?null:{distance:c,point:fm.clone(),object:n}}(n,e,t,i,xa,Ma,Da,P1);if(f){a&&(um.fromBufferAttribute(a,c),dm.fromBufferAttribute(a,u),hm.fromBufferAttribute(a,d),f.uv=si.getUV(P1,xa,Ma,Da,um,dm,hm,new re)),l&&(um.fromBufferAttribute(l,c),dm.fromBufferAttribute(l,u),hm.fromBufferAttribute(l,d),f.uv2=si.getUV(P1,xa,Ma,Da,um,dm,hm,new re));const g={a:c,b:u,c:d,normal:new M,materialIndex:0};si.getNormal(xa,Ma,Da,g.normal),f.face=g}return f}we.prototype.isMesh=!0;class In extends je{constructor(e=1,t=1,i=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:o,depthSegments:s};const a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);const l=[],c=[],u=[],d=[];let h=0,f=0;function g(p,m,y,_,v,b,w,D,C,T,G){const O=b/C,x=w/T,N=b/2,q=w/2,L=D/2,j=C+1,z=T+1;let $=0,U=0;const X=new M;for(let ee=0;ee<z;ee++){const se=ee*x-q;for(let ie=0;ie<j;ie++)X[p]=(ie*O-N)*_,X[m]=se*v,X[y]=L,c.push(X.x,X.y,X.z),X[p]=0,X[m]=0,X[y]=D>0?1:-1,u.push(X.x,X.y,X.z),d.push(ie/C),d.push(1-ee/T),$+=1}for(let ee=0;ee<T;ee++)for(let se=0;se<C;se++){const Ae=h+se+j*(ee+1),Le=h+(se+1)+j*(ee+1),Ie=h+(se+1)+j*ee;l.push(h+se+j*ee,Ae,Ie),l.push(Ae,Le,Ie),U+=6}a.addGroup(f,U,G),f+=U,h+=$}g("z","y","x",-1,-1,i,t,e,s,o,0),g("z","y","x",1,-1,i,t,-e,s,o,1),g("x","z","y",1,1,e,i,t,r,s,2),g("x","z","y",1,-1,e,i,-t,r,s,3),g("x","y","z",1,-1,e,t,i,r,o,4),g("x","y","z",-1,-1,e,t,-i,r,o,5),this.setIndex(l),this.setAttribute("position",new Fe(c,3)),this.setAttribute("normal",new Fe(u,3)),this.setAttribute("uv",new Fe(d,2))}static fromJSON(e){return new In(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function wu(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function Wi(n){const e={};for(let t=0;t<n.length;t++){const i=wu(n[t]);for(const r in i)e[r]=i[r]}return e}const P$={clone:wu,merge:Wi};class Io extends Ln{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=wu(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const s=this.uniforms[r].value;t.uniforms[r]=s&&s.isTexture?{type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?{type:"c",value:s.getHex()}:s&&s.isVector2?{type:"v2",value:s.toArray()}:s&&s.isVector3?{type:"v3",value:s.toArray()}:s&&s.isVector4?{type:"v4",value:s.toArray()}:s&&s.isMatrix3?{type:"m3",value:s.toArray()}:s&&s.isMatrix4?{type:"m4",value:s.toArray()}:{value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}Io.prototype.isShaderMaterial=!0;class gm extends Dt{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new ye,this.projectionMatrix=new ye,this.projectionMatrixInverse=new ye}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}gm.prototype.isCamera=!0;class yi extends gm{constructor(e=50,t=1,i=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Fh*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ml*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Fh*Math.atan(Math.tan(.5*Ml*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,o,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ml*this.fov)/this.zoom,i=2*t,r=this.aspect*i,o=-.5*r;const s=this.view;if(null!==this.view&&this.view.enabled){const l=s.fullWidth,c=s.fullHeight;o+=s.offsetX*r/l,t-=s.offsetY*i/c,r*=s.width/l,i*=s.height/c}const a=this.filmOffset;0!==a&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}yi.prototype.isPerspectiveCamera=!0;class O1 extends Dt{constructor(e,t,i){if(super(),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const r=new yi(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new M(1,0,0)),this.add(r);const o=new yi(90,1,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new M(-1,0,0)),this.add(o);const s=new yi(90,1,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new M(0,1,0)),this.add(s);const a=new yi(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new M(0,-1,0)),this.add(a);const l=new yi(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new M(0,0,1)),this.add(l);const c=new yi(90,1,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new M(0,0,-1)),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,o,s,a,l,c]=this.children,u=e.getRenderTarget(),d=e.outputEncoding,h=e.toneMapping,f=e.xr.enabled;e.outputEncoding=Ns,e.toneMapping=0,e.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,o),e.setRenderTarget(i,2),e.render(t,s),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,l),i.texture.generateMipmaps=g,e.setRenderTarget(i,5),e.render(t,c),e.setRenderTarget(u),e.outputEncoding=d,e.toneMapping=h,e.xr.enabled=f,i.texture.needsPMREMUpdate=!0}}class Uh extends Di{constructor(e,t,i,r,o,s,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:301,i,r,o,s,a,l,c,u),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Uh.prototype.isCubeTexture=!0;class TR extends Pr{constructor(e,t={}){super(e,e,t);const i={width:e,height:e,depth:1};this.texture=new Uh([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:oi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new In(5,5,5),o=new Io({name:"CubemapFromEquirect",uniforms:wu(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});o.uniforms.tEquirect.value=t;const s=new we(r,o),a=t.minFilter;return 1008===t.minFilter&&(t.minFilter=oi),new O1(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,i,r){const o=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,i,r);e.setRenderTarget(o)}}TR.prototype.isWebGLCubeRenderTarget=!0;const F1=new M,k$=new M,L$=new mi;class Vs{constructor(e=new M(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=F1.subVectors(i,t).cross(k$.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(F1),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(i).multiplyScalar(o).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||L$.getNormalMatrix(e),r=this.coplanarPoint(F1).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Vs.prototype.isPlane=!0;const Du=new Al,mm=new M;class _m{constructor(e=new Vs,t=new Vs,i=new Vs,r=new Vs,o=new Vs,s=new Vs){this.planes=[e,t,i,r,o,s]}set(e,t,i,r,o,s){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],o=i[1],s=i[2],a=i[3],l=i[4],c=i[5],u=i[6],d=i[7],h=i[8],f=i[9],g=i[10],p=i[11],m=i[12],y=i[13],_=i[14],v=i[15];return t[0].setComponents(a-r,d-l,p-h,v-m).normalize(),t[1].setComponents(a+r,d+l,p+h,v+m).normalize(),t[2].setComponents(a+o,d+c,p+f,v+y).normalize(),t[3].setComponents(a-o,d-c,p-f,v-y).normalize(),t[4].setComponents(a-s,d-u,p-g,v-_).normalize(),t[5].setComponents(a+s,d+u,p+g,v+_).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Du.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Du)}intersectsSprite(e){return Du.center.set(0,0,0),Du.radius=.7071067811865476,Du.applyMatrix4(e.matrixWorld),this.intersectsSphere(Du)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(mm.x=r.normal.x>0?e.max.x:e.min.x,mm.y=r.normal.y>0?e.max.y:e.min.y,mm.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(mm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function AR(){let n=null,e=!1,t=null,i=null;function r(o,s){t(o,s),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function B$(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function s(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const h=i.get(c);return void((!h||h.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const d=i.get(c);void 0===d?i.set(c,function r(c,u){const d=c.array,h=c.usage,f=n.createBuffer();let g;if(n.bindBuffer(u,f),n.bufferData(u,d,h),c.onUploadCallback(),d instanceof Float32Array)g=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");g=5131}else g=5123;else if(d instanceof Int16Array)g=5122;else if(d instanceof Uint32Array)g=5125;else if(d instanceof Int32Array)g=5124;else if(d instanceof Int8Array)g=5120;else if(d instanceof Uint8Array)g=5121;else{if(!(d instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);g=5121}return{buffer:f,type:g,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}(c,u)):d.version<c.version&&(function o(c,u,d){const h=u.array,f=u.updateRange;n.bindBuffer(d,c),-1===f.count?n.bufferSubData(d,0,h):(t?n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):n.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1)}(d.buffer,c,u),d.version=c.version)}}}class Su extends je{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const o=e/2,s=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],g=[],p=[],m=[];for(let y=0;y<u;y++){const _=y*h-s;for(let v=0;v<c;v++)g.push(v*d-o,-_,0),p.push(0,0,1),m.push(v/a),m.push(1-y/l)}for(let y=0;y<l;y++)for(let _=0;_<a;_++){const b=_+c*(y+1),w=_+1+c*(y+1),D=_+1+c*y;f.push(_+c*y,b,D),f.push(b,w,D)}this.setIndex(f),this.setAttribute("position",new Fe(g,3)),this.setAttribute("normal",new Fe(p,3)),this.setAttribute("uv",new Fe(m,2))}static fromJSON(e){return new Su(e.width,e.height,e.widthSegments,e.heightSegments)}}const Pt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Ce={common:{diffuse:{value:new ve(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new mi},uv2Transform:{value:new mi},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new re(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ve(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ve(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new mi}},sprite:{diffuse:{value:new ve(16777215)},opacity:{value:1},center:{value:new re(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new mi}}},ns={basic:{uniforms:Wi([Ce.common,Ce.specularmap,Ce.envmap,Ce.aomap,Ce.lightmap,Ce.fog]),vertexShader:Pt.meshbasic_vert,fragmentShader:Pt.meshbasic_frag},lambert:{uniforms:Wi([Ce.common,Ce.specularmap,Ce.envmap,Ce.aomap,Ce.lightmap,Ce.emissivemap,Ce.fog,Ce.lights,{emissive:{value:new ve(0)}}]),vertexShader:Pt.meshlambert_vert,fragmentShader:Pt.meshlambert_frag},phong:{uniforms:Wi([Ce.common,Ce.specularmap,Ce.envmap,Ce.aomap,Ce.lightmap,Ce.emissivemap,Ce.bumpmap,Ce.normalmap,Ce.displacementmap,Ce.fog,Ce.lights,{emissive:{value:new ve(0)},specular:{value:new ve(1118481)},shininess:{value:30}}]),vertexShader:Pt.meshphong_vert,fragmentShader:Pt.meshphong_frag},standard:{uniforms:Wi([Ce.common,Ce.envmap,Ce.aomap,Ce.lightmap,Ce.emissivemap,Ce.bumpmap,Ce.normalmap,Ce.displacementmap,Ce.roughnessmap,Ce.metalnessmap,Ce.fog,Ce.lights,{emissive:{value:new ve(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pt.meshphysical_vert,fragmentShader:Pt.meshphysical_frag},toon:{uniforms:Wi([Ce.common,Ce.aomap,Ce.lightmap,Ce.emissivemap,Ce.bumpmap,Ce.normalmap,Ce.displacementmap,Ce.gradientmap,Ce.fog,Ce.lights,{emissive:{value:new ve(0)}}]),vertexShader:Pt.meshtoon_vert,fragmentShader:Pt.meshtoon_frag},matcap:{uniforms:Wi([Ce.common,Ce.bumpmap,Ce.normalmap,Ce.displacementmap,Ce.fog,{matcap:{value:null}}]),vertexShader:Pt.meshmatcap_vert,fragmentShader:Pt.meshmatcap_frag},points:{uniforms:Wi([Ce.points,Ce.fog]),vertexShader:Pt.points_vert,fragmentShader:Pt.points_frag},dashed:{uniforms:Wi([Ce.common,Ce.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pt.linedashed_vert,fragmentShader:Pt.linedashed_frag},depth:{uniforms:Wi([Ce.common,Ce.displacementmap]),vertexShader:Pt.depth_vert,fragmentShader:Pt.depth_frag},normal:{uniforms:Wi([Ce.common,Ce.bumpmap,Ce.normalmap,Ce.displacementmap,{opacity:{value:1}}]),vertexShader:Pt.meshnormal_vert,fragmentShader:Pt.meshnormal_frag},sprite:{uniforms:Wi([Ce.sprite,Ce.fog]),vertexShader:Pt.sprite_vert,fragmentShader:Pt.sprite_frag},background:{uniforms:{uvTransform:{value:new mi},t2D:{value:null}},vertexShader:Pt.background_vert,fragmentShader:Pt.background_frag},cube:{uniforms:Wi([Ce.envmap,{opacity:{value:1}}]),vertexShader:Pt.cube_vert,fragmentShader:Pt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pt.equirect_vert,fragmentShader:Pt.equirect_frag},distanceRGBA:{uniforms:Wi([Ce.common,Ce.displacementmap,{referencePosition:{value:new M},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pt.distanceRGBA_vert,fragmentShader:Pt.distanceRGBA_frag},shadow:{uniforms:Wi([Ce.lights,Ce.fog,{color:{value:new ve(0)},opacity:{value:1}}]),vertexShader:Pt.shadow_vert,fragmentShader:Pt.shadow_frag}};function O9(n,e,t,i,r,o){const s=new ve(0);let l,c,a=!0===r?0:1,u=null,d=0,h=null;function g(p,m){t.buffers.color.setClear(p.r,p.g,p.b,m,o)}return{getClearColor:function(){return s},setClearColor:function(p,m=1){s.set(p),a=m,g(s,a)},getClearAlpha:function(){return a},setClearAlpha:function(p){a=p,g(s,a)},render:function f(p,m){let y=!1,_=!0===m.isScene?m.background:null;_&&_.isTexture&&(_=e.get(_));const v=n.xr,b=v.getSession&&v.getSession();b&&"additive"===b.environmentBlendMode&&(_=null),null===_?g(s,a):_&&_.isColor&&(g(_,1),y=!0),(n.autoClear||y)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),_&&(_.isCubeTexture||306===_.mapping)?(void 0===c&&(c=new we(new In(1,1,1),new Io({name:"BackgroundCubeMaterial",uniforms:wu(ns.cube.uniforms),vertexShader:ns.cube.vertexShader,fragmentShader:ns.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(w,D,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=_,c.material.uniforms.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,(u!==_||d!==_.version||h!==n.toneMapping)&&(c.material.needsUpdate=!0,u=_,d=_.version,h=n.toneMapping),p.unshift(c,c.geometry,c.material,0,0,null)):_&&_.isTexture&&(void 0===l&&(l=new we(new Su(2,2),new Io({name:"BackgroundMaterial",uniforms:wu(ns.background.uniforms),vertexShader:ns.background.vertexShader,fragmentShader:ns.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=_,!0===_.matrixAutoUpdate&&_.updateMatrix(),l.material.uniforms.uvTransform.value.copy(_.matrix),(u!==_||d!==_.version||h!==n.toneMapping)&&(l.material.needsUpdate=!0,u=_,d=_.version,h=n.toneMapping),p.unshift(l,l.geometry,l.material,0,0,null))}}}function F9(n,e,t,i){const r=n.getParameter(34921),o=i.isWebGL2?null:e.get("OES_vertex_array_object"),s=i.isWebGL2||null!==o,a={},l=m(null);let c=l,u=!1;function f(L){return i.isWebGL2?n.bindVertexArray(L):o.bindVertexArrayOES(L)}function g(L){return i.isWebGL2?n.deleteVertexArray(L):o.deleteVertexArrayOES(L)}function m(L){const j=[],z=[],$=[];for(let U=0;U<r;U++)j[U]=0,z[U]=0,$[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:z,attributeDivisors:$,object:L,attributes:{},index:null}}function v(){const L=c.newAttributes;for(let j=0,z=L.length;j<z;j++)L[j]=0}function b(L){w(L,0)}function w(L,j){const $=c.enabledAttributes,U=c.attributeDivisors;c.newAttributes[L]=1,0===$[L]&&(n.enableVertexAttribArray(L),$[L]=1),U[L]!==j&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,j),U[L]=j)}function D(){const L=c.newAttributes,j=c.enabledAttributes;for(let z=0,$=j.length;z<$;z++)j[z]!==L[z]&&(n.disableVertexAttribArray(z),j[z]=0)}function C(L,j,z,$,U,X){!0!==i.isWebGL2||5124!==z&&5125!==z?n.vertexAttribPointer(L,j,z,$,U,X):n.vertexAttribIPointer(L,j,z,U,X)}function N(){q(),u=!0,c!==l&&(c=l,f(c.object))}function q(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function d(L,j,z,$,U){let X=!1;if(s){const ee=function p(L,j,z){const $=!0===z.wireframe;let U=a[L.id];void 0===U&&(U={},a[L.id]=U);let X=U[j.id];void 0===X&&(X={},U[j.id]=X);let ee=X[$];return void 0===ee&&(ee=m(function h(){return i.isWebGL2?n.createVertexArray():o.createVertexArrayOES()}()),X[$]=ee),ee}($,z,j);c!==ee&&(c=ee,f(c.object)),X=function y(L,j){const z=c.attributes,$=L.attributes;let U=0;for(const X in $){const ee=z[X],se=$[X];if(void 0===ee||ee.attribute!==se||ee.data!==se.data)return!0;U++}return c.attributesNum!==U||c.index!==j}($,U),X&&function _(L,j){const z={},$=L.attributes;let U=0;for(const X in $){const ee=$[X],se={};se.attribute=ee,ee.data&&(se.data=ee.data),z[X]=se,U++}c.attributes=z,c.attributesNum=U,c.index=j}($,U)}else{const ee=!0===j.wireframe;(c.geometry!==$.id||c.program!==z.id||c.wireframe!==ee)&&(c.geometry=$.id,c.program=z.id,c.wireframe=ee,X=!0)}!0===L.isInstancedMesh&&(X=!0),null!==U&&t.update(U,34963),(X||u)&&(u=!1,function T(L,j,z,$){if(!1===i.isWebGL2&&(L.isInstancedMesh||$.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;v();const U=$.attributes,X=z.getAttributes(),ee=j.defaultAttributeValues;for(const se in X){const ie=X[se];if(ie.location>=0){let Ae=U[se];if(void 0===Ae&&("instanceMatrix"===se&&L.instanceMatrix&&(Ae=L.instanceMatrix),"instanceColor"===se&&L.instanceColor&&(Ae=L.instanceColor)),void 0!==Ae){const Le=Ae.normalized,Ie=Ae.itemSize,te=t.get(Ae);if(void 0===te)continue;const pt=te.buffer,ze=te.type,Qe=te.bytesPerElement;if(Ae.isInterleavedBufferAttribute){const _e=Ae.data,it=_e.stride,ne=Ae.offset;if(_e.isInstancedInterleavedBuffer){for(let oe=0;oe<ie.locationSize;oe++)w(ie.location+oe,_e.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===$._maxInstanceCount&&($._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let oe=0;oe<ie.locationSize;oe++)b(ie.location+oe);n.bindBuffer(34962,pt);for(let oe=0;oe<ie.locationSize;oe++)C(ie.location+oe,Ie/ie.locationSize,ze,Le,it*Qe,(ne+Ie/ie.locationSize*oe)*Qe)}else{if(Ae.isInstancedBufferAttribute){for(let _e=0;_e<ie.locationSize;_e++)w(ie.location+_e,Ae.meshPerAttribute);!0!==L.isInstancedMesh&&void 0===$._maxInstanceCount&&($._maxInstanceCount=Ae.meshPerAttribute*Ae.count)}else for(let _e=0;_e<ie.locationSize;_e++)b(ie.location+_e);n.bindBuffer(34962,pt);for(let _e=0;_e<ie.locationSize;_e++)C(ie.location+_e,Ie/ie.locationSize,ze,Le,Ie*Qe,Ie/ie.locationSize*_e*Qe)}}else if(void 0!==ee){const Le=ee[se];if(void 0!==Le)switch(Le.length){case 2:n.vertexAttrib2fv(ie.location,Le);break;case 3:n.vertexAttrib3fv(ie.location,Le);break;case 4:n.vertexAttrib4fv(ie.location,Le);break;default:n.vertexAttrib1fv(ie.location,Le)}}}}D()}(L,j,z,$),null!==U&&n.bindBuffer(34963,t.get(U).buffer))},reset:N,resetDefaultState:q,dispose:function G(){N();for(const L in a){const j=a[L];for(const z in j){const $=j[z];for(const U in $)g($[U].object),delete $[U];delete j[z]}delete a[L]}},releaseStatesOfGeometry:function O(L){if(void 0===a[L.id])return;const j=a[L.id];for(const z in j){const $=j[z];for(const U in $)g($[U].object),delete $[U];delete j[z]}delete a[L.id]},releaseStatesOfProgram:function x(L){for(const j in a){const z=a[j];if(void 0===z[L.id])continue;const $=z[L.id];for(const U in $)g($[U].object),delete $[U];delete z[L.id]}},initAttributes:v,enableAttribute:b,disableUnusedAttributes:D}}function k9(n,e,t,i){const r=i.isWebGL2;let o;this.setMode=function s(c){o=c},this.render=function a(c,u){n.drawArrays(o,c,u),t.update(u,o,1)},this.renderInstances=function l(c,u,d){if(0===d)return;let h,f;if(r)h=n,f="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===h)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](o,c,u,d),t.update(u,o,d)}}function L9(n,e,t){let i;function o(C){if("highp"===C){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";C="mediump"}return"mediump"===C&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&n instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=o(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=s||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,d=n.getParameter(34930),h=n.getParameter(35660),f=n.getParameter(3379),g=n.getParameter(34076),p=n.getParameter(34921),m=n.getParameter(36347),y=n.getParameter(36348),_=n.getParameter(36349),v=h>0,b=s||e.has("OES_texture_float");return{isWebGL2:s,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const C=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:o,precision:a,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:g,maxAttributes:p,maxVertexUniforms:m,maxVaryings:y,maxFragmentUniforms:_,vertexTextures:v,floatFragmentTextures:b,floatVertexTextures:v&&b,maxSamples:s?n.getParameter(36183):0}}function B9(n){const e=this;let t=null,i=0,r=!1,o=!1;const s=new Vs,a=new mi,l={value:null,needsUpdate:!1};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(d,h,f,g){const p=null!==d?d.length:0;let m=null;if(0!==p){if(m=l.value,!0!==g||null===m){const y=f+4*p,_=h.matrixWorldInverse;a.getNormalMatrix(_),(null===m||m.length<y)&&(m=new Float32Array(y));for(let v=0,b=f;v!==p;++v,b+=4)s.copy(d[v]).applyMatrix4(_,a),s.normal.toArray(m,b),m[b+3]=s.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=p,e.numIntersection=0,m}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h,f){const g=0!==d.length||h||0!==i||r;return r=h,t=u(d,f,0),i=d.length,g},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1,c()},this.setState=function(d,h,f){const g=d.clippingPlanes,p=d.clipIntersection,m=d.clipShadows,y=n.get(d);if(!r||null===g||0===g.length||o&&!m)o?u(null):c();else{const _=o?0:i,v=4*_;let b=y.clippingState||null;l.value=b,b=u(g,h,v,f);for(let w=0;w!==v;++w)b[w]=t[w];y.clippingState=b,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=_}}}function V9(n){let e=new WeakMap;function t(s,a){return 303===a?s.mapping=301:304===a&&(s.mapping=302),s}function r(s){const a=s.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(s){if(s&&s.isTexture&&!1===s.isRenderTargetTexture){const a=s.mapping;if(303===a||304===a){if(e.has(s))return t(e.get(s).texture,s.mapping);{const l=s.image;if(l&&l.height>0){const c=new TR(l.height/2);return c.fromEquirectangularTexture(n,s),e.set(s,c),s.addEventListener("dispose",r),t(c.texture,s.mapping)}return null}}}return s},dispose:function o(){e=new WeakMap}}}ns.physical={uniforms:Wi([ns.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new re(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new ve(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new re},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ve(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ve(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Pt.meshphysical_vert,fragmentShader:Pt.meshphysical_frag};class zh extends gm{constructor(e=-1,t=1,i=1,r=-1,o=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,o,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=i-e,s=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=c*this.view.offsetX,s=o+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}zh.prototype.isOrthographicCamera=!0;const IR=[.125,.215,.35,.446,.526,.582],k1=new zh,RR=new ve;let L1=null;const Nl=(1+Math.sqrt(5))/2,Cu=1/Nl,NR=[new M(1,1,1),new M(-1,1,1),new M(1,1,-1),new M(-1,1,-1),new M(0,Nl,Cu),new M(0,Nl,-Cu),new M(Cu,0,Nl),new M(-Cu,0,Nl),new M(Nl,Cu,0),new M(-Nl,Cu,0)];class PR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){L1=this._renderer.getRenderTarget(),this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,r,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=kR(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=FR(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(L1),e.scissorTest=!1,ym(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),L1=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize-32,i={magFilter:oi,minFilter:oi,generateMipmaps:!1,type:iu,format:to,encoding:Ns,depthBuffer:!1},r=OR(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=OR(e,t,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function H9(n){const e=[],t=[],i=[];let r=n;const o=n-4+1+IR.length;for(let s=0;s<o;s++){const a=Math.pow(2,r);t.push(a);let l=1/a;s>n-4?l=IR[s-n+4-1]:0===s&&(l=0),i.push(l);const c=1/(a-1),u=-c/2,d=1+c/2,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,g=6,p=3,m=2,y=1,_=new Float32Array(p*g*f),v=new Float32Array(m*g*f),b=new Float32Array(y*g*f);for(let D=0;D<f;D++){const C=D%3*2/3-1,T=D>2?0:-1;_.set([C,T,0,C+2/3,T,0,C+2/3,T+1,0,C,T,0,C+2/3,T+1,0,C,T+1,0],p*g*D),v.set(h,m*g*D),b.set([D,D,D,D,D,D],y*g*D)}const w=new je;w.setAttribute("position",new xn(_,p)),w.setAttribute("uv",new xn(v,m)),w.setAttribute("faceIndex",new xn(b,y)),e.push(w),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(o)),this._blurMaterial=function U9(n,e,t){const i=new Float32Array(20),r=new M(0,1,0);return new Io({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(o,e,t)}return r}_compileMaterial(e){const t=new we(this._lodPlanes[0],e);this._renderer.compile(t,k1)}_sceneToCubeUV(e,t,i,r){const a=new yi(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(RR),u.toneMapping=0,u.autoClear=!1;const f=new io({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),g=new we(new In,f);let p=!1;const m=e.background;m?m.isColor&&(f.color.copy(m),e.background=null,p=!0):(f.color.copy(RR),p=!0);for(let y=0;y<6;y++){const _=y%3;0===_?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===_?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const v=this._cubeSize;ym(r,_*v,y>2?v:0,v,v),u.setRenderTarget(r),p&&u.render(g,a),u.render(e,a)}g.geometry.dispose(),g.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=m}_textureToCubeUV(e,t){const i=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=kR()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=FR());const o=r?this._cubemapMaterial:this._equirectMaterial,s=new we(this._lodPlanes[0],o);o.uniforms.envMap.value=e;const l=this._cubeSize;ym(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(s,k1)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,o,NR[(r-1)%NR.length])}t.autoClear=i}_blur(e,t,i,r,o){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,r,"latitudinal",o),this._halfBlur(s,e,i,i,r,"longitudinal",o)}_halfBlur(e,t,i,r,o,s,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new we(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,g=isFinite(o)?Math.PI/(2*f):2*Math.PI/39,p=o/g,m=isFinite(o)?1+Math.floor(3*p):20;m>20&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const y=[];let _=0;for(let C=0;C<20;++C){const T=C/p,G=Math.exp(-T*T/2);y.push(G),0===C?_+=G:C<m&&(_+=2*G)}for(let C=0;C<y.length;C++)y[C]=y[C]/_;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=y,h.latitudinal.value="latitudinal"===s,a&&(h.poleAxis.value=a);const{_lodMax:v}=this;h.dTheta.value=g,h.mipInt.value=v-i;const b=this._sizeLods[r];ym(t,3*b*(r>v-4?r-v+4:0),4*(this._cubeSize-b),3*b,2*b),l.setRenderTarget(t),l.render(d,k1)}}function OR(n,e,t){const i=new Pr(n,e,t);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function ym(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function FR(){return new Io({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function kR(){return new Io({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function z9(n){let e=new WeakMap,t=null;function o(a){const l=a.target;l.removeEventListener("dispose",o);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,u=301===l||302===l;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let d=e.get(a);return null===t&&(t=new PR(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),e.set(a,d),d.texture}if(e.has(a))return e.get(a).texture;{const d=a.image;if(c&&d&&d.height>0||u&&d&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(d)){null===t&&(t=new PR(n));const h=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",o),h.texture}return null}}}return a},dispose:function s(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function G9(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function j9(n,e,t,i){const r={},o=new WeakMap;function s(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const g in h.attributes)e.remove(h.attributes[g]);h.removeEventListener("dispose",s),delete r[h.id];const f=o.get(h);f&&(e.remove(f),o.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,g=d.attributes.position;let p=0;if(null!==f){const _=f.array;p=f.version;for(let v=0,b=_.length;v<b;v+=3){const w=_[v+0],D=_[v+1],C=_[v+2];h.push(w,D,D,C,C,w)}}else{p=g.version;for(let v=0,b=g.array.length/3-1;v<b;v+=3){const w=v+0,D=v+1,C=v+2;h.push(w,D,D,C,C,w)}}const m=new(pR(h)?ER:C1)(h,1);m.version=p;const y=o.get(d);y&&e.remove(y),o.set(d,m)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",s),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const g in h)e.update(h[g],34962);const f=d.morphAttributes;for(const g in f){const p=f[g];for(let m=0,y=p.length;m<y;m++)e.update(p[m],34962)}},getWireframeAttribute:function u(d){const h=o.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return o.get(d)}}}function W9(n,e,t,i){const r=i.isWebGL2;let o,a,l;this.setMode=function s(h){o=h},this.setIndex=function c(h){a=h.type,l=h.bytesPerElement},this.render=function u(h,f){n.drawElements(o,f,a,h*l),t.update(f,o,1)},this.renderInstances=function d(h,f,g){if(0===g)return;let p,m;if(r)p=n,m="drawElementsInstanced";else if(p=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",null===p)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p[m](o,f,a,h*l,g),t.update(f,o,g)}}function $9(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(o,s,a){switch(t.calls++,s){case 4:t.triangles+=a*(o/3);break;case 1:t.lines+=a*(o/2);break;case 3:t.lines+=a*(o-1);break;case 2:t.lines+=a*o;break;case 0:t.points+=a*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s)}}}}function q9(n,e){return n[0]-e[0]}function Y9(n,e){return Math.abs(e[1])-Math.abs(n[1])}function V1(n,e){let t=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?t=127:i instanceof Int16Array?t=32767:i instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),n.divideScalar(t)}function Z9(n,e,t){const i={},r=new Float32Array(8),o=new WeakMap,s=new Zt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,d,h){const f=c.morphTargetInfluences;if(!0===e.isWebGL2){const g=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==g?g.length:0;let m=o.get(u);if(void 0===m||m.count!==p){let j=function(){q.dispose(),o.delete(u),u.removeEventListener("dispose",j)};void 0!==m&&m.texture.dispose();const v=void 0!==u.morphAttributes.position,b=void 0!==u.morphAttributes.normal,w=void 0!==u.morphAttributes.color,D=u.morphAttributes.position||[],C=u.morphAttributes.normal||[],T=u.morphAttributes.color||[];let G=0;!0===v&&(G=1),!0===b&&(G=2),!0===w&&(G=3);let O=u.attributes.position.count*G,x=1;O>e.maxTextureSize&&(x=Math.ceil(O/e.maxTextureSize),O=e.maxTextureSize);const N=new Float32Array(O*x*4*p),q=new Jg(N,O,x,p);q.type=ma,q.needsUpdate=!0;const L=4*G;for(let z=0;z<p;z++){const $=D[z],U=C[z],X=T[z],ee=O*x*4*z;for(let se=0;se<$.count;se++){const ie=se*L;!0===v&&(s.fromBufferAttribute($,se),!0===$.normalized&&V1(s,$),N[ee+ie+0]=s.x,N[ee+ie+1]=s.y,N[ee+ie+2]=s.z,N[ee+ie+3]=0),!0===b&&(s.fromBufferAttribute(U,se),!0===U.normalized&&V1(s,U),N[ee+ie+4]=s.x,N[ee+ie+5]=s.y,N[ee+ie+6]=s.z,N[ee+ie+7]=0),!0===w&&(s.fromBufferAttribute(X,se),!0===X.normalized&&V1(s,X),N[ee+ie+8]=s.x,N[ee+ie+9]=s.y,N[ee+ie+10]=s.z,N[ee+ie+11]=4===X.itemSize?s.w:1)}}m={count:p,texture:q,size:new re(O,x)},o.set(u,m),u.addEventListener("dispose",j)}let y=0;for(let v=0;v<f.length;v++)y+=f[v];const _=u.morphTargetsRelative?1:1-y;h.getUniforms().setValue(n,"morphTargetBaseInfluence",_),h.getUniforms().setValue(n,"morphTargetInfluences",f),h.getUniforms().setValue(n,"morphTargetsTexture",m.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",m.size)}else{const g=void 0===f?0:f.length;let p=i[u.id];if(void 0===p||p.length!==g){p=[];for(let b=0;b<g;b++)p[b]=[b,0];i[u.id]=p}for(let b=0;b<g;b++){const w=p[b];w[0]=b,w[1]=f[b]}p.sort(Y9);for(let b=0;b<8;b++)b<g&&p[b][1]?(a[b][0]=p[b][0],a[b][1]=p[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(q9);const m=u.morphAttributes.position,y=u.morphAttributes.normal;let _=0;for(let b=0;b<8;b++){const w=a[b],D=w[0],C=w[1];D!==Number.MAX_SAFE_INTEGER&&C?(m&&u.getAttribute("morphTarget"+b)!==m[D]&&u.setAttribute("morphTarget"+b,m[D]),y&&u.getAttribute("morphNormal"+b)!==y[D]&&u.setAttribute("morphNormal"+b,y[D]),r[b]=C,_+=C):(m&&!0===u.hasAttribute("morphTarget"+b)&&u.deleteAttribute("morphTarget"+b),y&&!0===u.hasAttribute("morphNormal"+b)&&u.deleteAttribute("morphNormal"+b),r[b]=0)}const v=u.morphTargetsRelative?1:1-_;h.getUniforms().setValue(n,"morphTargetBaseInfluence",v),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function X9(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function o(l){const c=i.render.frame,d=e.get(l,l.geometry);return r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),d},dispose:function s(){r=new WeakMap}}}const LR=new Di,BR=new Jg,VR=new p1,HR=new Uh,UR=[],zR=[],GR=new Float32Array(16),jR=new Float32Array(9),WR=new Float32Array(4);function Tu(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let o=UR[r];if(void 0===o&&(o=new Float32Array(r),UR[r]=o),0!==e){i.toArray(o,0);for(let s=1,a=0;s!==e;++s)a+=t,n[s].toArray(o,a)}return o}function rr(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function $i(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function vm(n,e){let t=zR[e];void 0===t&&(t=new Int32Array(e),zR[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function K9(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function J9(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(rr(t,e))return;n.uniform2fv(this.addr,e),$i(t,e)}}function Q9(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(rr(t,e))return;n.uniform3fv(this.addr,e),$i(t,e)}}function eq(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(rr(t,e))return;n.uniform4fv(this.addr,e),$i(t,e)}}function tq(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(rr(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),$i(t,e)}else{if(rr(t,i))return;WR.set(i),n.uniformMatrix2fv(this.addr,!1,WR),$i(t,i)}}function nq(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(rr(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),$i(t,e)}else{if(rr(t,i))return;jR.set(i),n.uniformMatrix3fv(this.addr,!1,jR),$i(t,i)}}function iq(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(rr(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),$i(t,e)}else{if(rr(t,i))return;GR.set(i),n.uniformMatrix4fv(this.addr,!1,GR),$i(t,i)}}function rq(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function oq(n,e){const t=this.cache;rr(t,e)||(n.uniform2iv(this.addr,e),$i(t,e))}function sq(n,e){const t=this.cache;rr(t,e)||(n.uniform3iv(this.addr,e),$i(t,e))}function aq(n,e){const t=this.cache;rr(t,e)||(n.uniform4iv(this.addr,e),$i(t,e))}function lq(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function cq(n,e){const t=this.cache;rr(t,e)||(n.uniform2uiv(this.addr,e),$i(t,e))}function uq(n,e){const t=this.cache;rr(t,e)||(n.uniform3uiv(this.addr,e),$i(t,e))}function dq(n,e){const t=this.cache;rr(t,e)||(n.uniform4uiv(this.addr,e),$i(t,e))}function hq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||LR,r)}function fq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||VR,r)}function pq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||HR,r)}function gq(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||BR,r)}function _q(n,e){n.uniform1fv(this.addr,e)}function yq(n,e){const t=Tu(e,this.size,2);n.uniform2fv(this.addr,t)}function vq(n,e){const t=Tu(e,this.size,3);n.uniform3fv(this.addr,t)}function bq(n,e){const t=Tu(e,this.size,4);n.uniform4fv(this.addr,t)}function wq(n,e){const t=Tu(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function xq(n,e){const t=Tu(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Mq(n,e){const t=Tu(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function Dq(n,e){n.uniform1iv(this.addr,e)}function Sq(n,e){n.uniform2iv(this.addr,e)}function Eq(n,e){n.uniform3iv(this.addr,e)}function Cq(n,e){n.uniform4iv(this.addr,e)}function Tq(n,e){n.uniform1uiv(this.addr,e)}function Aq(n,e){n.uniform2uiv(this.addr,e)}function Iq(n,e){n.uniform3uiv(this.addr,e)}function Rq(n,e){n.uniform4uiv(this.addr,e)}function Nq(n,e,t){const i=e.length,r=vm(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture2D(e[o]||LR,r[o])}function Pq(n,e,t){const i=e.length,r=vm(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture3D(e[o]||VR,r[o])}function Oq(n,e,t){const i=e.length,r=vm(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTextureCube(e[o]||HR,r[o])}function Fq(n,e,t){const i=e.length,r=vm(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||BR,r[o])}function Lq(n,e,t){this.id=n,this.addr=t,this.cache=[],this.setValue=function mq(n){switch(n){case 5126:return K9;case 35664:return J9;case 35665:return Q9;case 35666:return eq;case 35674:return tq;case 35675:return nq;case 35676:return iq;case 5124:case 35670:return rq;case 35667:case 35671:return oq;case 35668:case 35672:return sq;case 35669:case 35673:return aq;case 5125:return lq;case 36294:return cq;case 36295:return uq;case 36296:return dq;case 35678:case 36198:case 36298:case 36306:case 35682:return hq;case 35679:case 36299:case 36307:return fq;case 35680:case 36300:case 36308:case 36293:return pq;case 36289:case 36303:case 36311:case 36292:return gq}}(e.type)}function $R(n,e,t){this.id=n,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function kq(n){switch(n){case 5126:return _q;case 35664:return yq;case 35665:return vq;case 35666:return bq;case 35674:return wq;case 35675:return xq;case 35676:return Mq;case 5124:case 35670:return Dq;case 35667:case 35671:return Sq;case 35668:case 35672:return Eq;case 35669:case 35673:return Cq;case 5125:return Tq;case 36294:return Aq;case 36295:return Iq;case 36296:return Rq;case 35678:case 36198:case 36298:case 36306:case 35682:return Nq;case 35679:case 36299:case 36307:return Pq;case 35680:case 36300:case 36308:case 36293:return Oq;case 36289:case 36303:case 36311:case 36292:return Fq}}(e.type)}function qR(n){this.id=n,this.seq=[],this.map={}}$R.prototype.updateCache=function(n){const e=this.cache;n instanceof Float32Array&&e.length!==n.length&&(this.cache=new Float32Array(n.length)),$i(e,n)},qR.prototype.setValue=function(n,e,t){const i=this.seq;for(let r=0,o=i.length;r!==o;++r){const s=i[r];s.setValue(n,e[s.id],t)}};const H1=/(\w+)(\])?(\[|\.)?/g;function YR(n,e){n.seq.push(e),n.map[e.id]=e}function Bq(n,e,t){const i=n.name,r=i.length;for(H1.lastIndex=0;;){const o=H1.exec(i),s=H1.lastIndex;let a=o[1];const c=o[3];if("]"===o[2]&&(a|=0),void 0===c||"["===c&&s+2===r){YR(t,void 0===c?new Lq(a,n,e):new $R(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new qR(a),YR(t,d)),t=d}}}function Sa(n,e){this.seq=[],this.map={};const t=n.getProgramParameter(e,35718);for(let i=0;i<t;++i){const r=n.getActiveUniform(e,i);Bq(r,n.getUniformLocation(e,r.name),this)}}function ZR(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}Sa.prototype.setValue=function(n,e,t,i){const r=this.map[e];void 0!==r&&r.setValue(n,t,i)},Sa.prototype.setOptional=function(n,e,t){const i=e[t];void 0!==i&&this.setValue(n,t,i)},Sa.upload=function(n,e,t,i){for(let r=0,o=e.length;r!==o;++r){const s=e[r],a=t[s.id];!1!==a.needsUpdate&&s.setValue(n,a.value,i)}},Sa.seqWithValue=function(n,e){const t=[];for(let i=0,r=n.length;i!==r;++i){const o=n[i];o.id in e&&t.push(o)}return t};let Vq=0;function XR(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const o=parseInt(/ERROR: 0:(\d+)/.exec(r)[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function Hq(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let s=r;s<o;s++)i.push(s+1+": "+t[s]);return i.join("\n")}(n.getShaderSource(e),o)}function zq(n,e){const t=function Uq(n){switch(n){case Ns:return["Linear","( value )"];case hn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Gq(n,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function Gh(n){return""!==n}function KR(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function JR(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const qq=/^[ \t]*#include +<([\w\d./]+)>/gm;function U1(n){return n.replace(qq,Yq)}function Yq(n,e){const t=Pt[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return U1(t)}const Zq=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Xq=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function QR(n){return n.replace(Xq,eN).replace(Zq,Kq)}function Kq(n,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),eN(0,e,t,i)}function eN(n,e,t,i){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function tN(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function iY(n,e,t,i){const r=n.getContext(),o=t.defines;let s=t.vertexShader,a=t.fragmentShader;const l=function Jq(n){let e="SHADOWMAP_TYPE_BASIC";return 1===n.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===n.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===n.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function Qq(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function eY(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&302===n.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function tY(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function nY(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e/32+1)+3,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=t.isWebGL2?"":function jq(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Gh).join("\n")}(t),g=function Wq(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(o),p=r.createProgram();let m,y,_=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(m=[g].filter(Gh).join("\n"),m.length>0&&(m+="\n"),y=[f,g].filter(Gh).join("\n"),y.length>0&&(y+="\n")):(m=[tN(t),"#define SHADER_NAME "+t.shaderName,g,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Gh).join("\n"),y=[f,tN(t),"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Pt.tonemapping_pars_fragment:"",0!==t.toneMapping?Gq("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pt.encodings_pars_fragment,zq("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(Gh).join("\n")),s=U1(s),s=KR(s,t),s=JR(s,t),a=U1(a),a=KR(a,t),a=JR(a,t),s=QR(s),a=QR(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(_="#version 300 es\n",m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,y=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const b=_+y+a,w=ZR(r,35633,_+m+s),D=ZR(r,35632,b);if(r.attachShader(p,w),r.attachShader(p,D),void 0!==t.index0AttributeName?r.bindAttribLocation(p,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(p,0,"position"),r.linkProgram(p),n.debug.checkShaderErrors){const G=r.getProgramInfoLog(p).trim(),O=r.getShaderInfoLog(w).trim(),x=r.getShaderInfoLog(D).trim();let N=!0,q=!0;if(!1===r.getProgramParameter(p,35714)){N=!1;const L=XR(r,w,"vertex"),j=XR(r,D,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(p,35715)+"\n\nProgram Info Log: "+G+"\n"+L+"\n"+j)}else""!==G?console.warn("THREE.WebGLProgram: Program Info Log:",G):(""===O||""===x)&&(q=!1);q&&(this.diagnostics={runnable:N,programLog:G,vertexShader:{log:O,prefix:m},fragmentShader:{log:x,prefix:y}})}let C,T;return r.deleteShader(w),r.deleteShader(D),this.getUniforms=function(){return void 0===C&&(C=new Sa(r,p)),C},this.getAttributes=function(){return void 0===T&&(T=function $q(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const o=n.getActiveAttrib(e,r),s=o.name;let a=1;35674===o.type&&(a=2),35675===o.type&&(a=3),35676===o.type&&(a=4),t[s]={type:o.type,location:n.getAttribLocation(e,s),locationSize:a}}return t}(r,p)),T},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(p),this.program=void 0},this.name=t.shaderName,this.id=Vq++,this.cacheKey=e,this.usedTimes=1,this.program=p,this.vertexShader=w,this.fragmentShader=D,this}let rY=0;class oY{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),o=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return!1===s.has(r)&&(s.add(r),r.usedTimes++),!1===s.has(o)&&(s.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const i=new sY(e);t.set(e,i)}return t.get(e)}}class sY{constructor(e){this.id=rY++,this.code=e,this.usedTimes=0}}function aY(n,e,t,i,r,o,s){const a=new x1,l=new oY,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,h=r.floatVertexTextures,f=r.maxVertexUniforms,g=r.vertexTextures;let p=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function _(x,N,q,L,j){const z=L.fog,$=j.geometry,X=(x.isMeshStandardMaterial?t:e).get(x.envMap||(x.isMeshStandardMaterial?L.environment:null)),ee=X&&306===X.mapping?X.image.height:null,se=m[x.type],ie=j.isSkinnedMesh?function y(x){const q=x.skeleton.bones;if(h)return 1024;{const j=Math.floor((f-20)/4),z=Math.min(j,q.length);return z<q.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+q.length+" bones. This GPU supports "+z+"."),0):z}}(j):0;null!==x.precision&&(p=r.getMaxPrecision(x.precision),p!==x.precision&&console.warn("THREE.WebGLProgram.getParameters:",x.precision,"not supported, using",p,"instead."));const Ae=$.morphAttributes.position||$.morphAttributes.normal||$.morphAttributes.color,Le=void 0!==Ae?Ae.length:0;let te,pt,ze,Qe,Ie=0;if(void 0!==$.morphAttributes.position&&(Ie=1),void 0!==$.morphAttributes.normal&&(Ie=2),void 0!==$.morphAttributes.color&&(Ie=3),se){const fe=ns[se];te=fe.vertexShader,pt=fe.fragmentShader}else te=x.vertexShader,pt=x.fragmentShader,l.update(x),ze=l.getVertexShaderID(x),Qe=l.getFragmentShaderID(x);const _e=n.getRenderTarget(),ne=x.clearcoat>0;return{isWebGL2:u,shaderID:se,shaderName:x.type,vertexShader:te,fragmentShader:pt,defines:x.defines,customVertexShaderID:ze,customFragmentShaderID:Qe,isRawShaderMaterial:!0===x.isRawShaderMaterial,glslVersion:x.glslVersion,precision:p,instancing:!0===j.isInstancedMesh,instancingColor:!0===j.isInstancedMesh&&null!==j.instanceColor,supportsVertexTextures:g,outputEncoding:null===_e?n.outputEncoding:!0===_e.isXRRenderTarget?_e.texture.encoding:Ns,map:!!x.map,matcap:!!x.matcap,envMap:!!X,envMapMode:X&&X.mapping,envMapCubeUVHeight:ee,lightMap:!!x.lightMap,aoMap:!!x.aoMap,emissiveMap:!!x.emissiveMap,bumpMap:!!x.bumpMap,normalMap:!!x.normalMap,objectSpaceNormalMap:1===x.normalMapType,tangentSpaceNormalMap:0===x.normalMapType,decodeVideoTexture:!!x.map&&!0===x.map.isVideoTexture&&x.map.encoding===hn,clearcoat:ne,clearcoatMap:ne&&!!x.clearcoatMap,clearcoatRoughnessMap:ne&&!!x.clearcoatRoughnessMap,clearcoatNormalMap:ne&&!!x.clearcoatNormalMap,displacementMap:!!x.displacementMap,roughnessMap:!!x.roughnessMap,metalnessMap:!!x.metalnessMap,specularMap:!!x.specularMap,specularIntensityMap:!!x.specularIntensityMap,specularColorMap:!!x.specularColorMap,opaque:!1===x.transparent&&1===x.blending,alphaMap:!!x.alphaMap,alphaTest:x.alphaTest>0,gradientMap:!!x.gradientMap,sheen:x.sheen>0,sheenColorMap:!!x.sheenColorMap,sheenRoughnessMap:!!x.sheenRoughnessMap,transmission:x.transmission>0,transmissionMap:!!x.transmissionMap,thicknessMap:!!x.thicknessMap,combine:x.combine,vertexTangents:!!x.normalMap&&!!$.attributes.tangent,vertexColors:x.vertexColors,vertexAlphas:!0===x.vertexColors&&!!$.attributes.color&&4===$.attributes.color.itemSize,vertexUvs:!!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatMap||x.clearcoatRoughnessMap||x.clearcoatNormalMap||x.displacementMap||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheenColorMap||x.sheenRoughnessMap),uvsVertexOnly:!(x.map||x.bumpMap||x.normalMap||x.specularMap||x.alphaMap||x.emissiveMap||x.roughnessMap||x.metalnessMap||x.clearcoatNormalMap||x.transmission>0||x.transmissionMap||x.thicknessMap||x.specularIntensityMap||x.specularColorMap||x.sheen>0||x.sheenColorMap||x.sheenRoughnessMap||!x.displacementMap),fog:!!z,useFog:x.fog,fogExp2:z&&z.isFogExp2,flatShading:!!x.flatShading,sizeAttenuation:x.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===j.isSkinnedMesh&&ie>0,maxBones:ie,useVertexTexture:h,morphTargets:void 0!==$.morphAttributes.position,morphNormals:void 0!==$.morphAttributes.normal,morphColors:void 0!==$.morphAttributes.color,morphTargetsCount:Le,morphTextureStride:Ie,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:x.dithering,shadowMapEnabled:n.shadowMap.enabled&&q.length>0,shadowMapType:n.shadowMap.type,toneMapping:x.toneMapped?n.toneMapping:0,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:x.premultipliedAlpha,doubleSided:2===x.side,flipSided:1===x.side,depthPacking:void 0!==x.depthPacking&&x.depthPacking,index0AttributeName:x.index0AttributeName,extensionDerivatives:x.extensions&&x.extensions.derivatives,extensionFragDepth:x.extensions&&x.extensions.fragDepth,extensionDrawBuffers:x.extensions&&x.extensions.drawBuffers,extensionShaderTextureLOD:x.extensions&&x.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:x.customProgramCacheKey()}},getProgramCacheKey:function v(x){const N=[];if(x.shaderID?N.push(x.shaderID):(N.push(x.customVertexShaderID),N.push(x.customFragmentShaderID)),void 0!==x.defines)for(const q in x.defines)N.push(q),N.push(x.defines[q]);return!1===x.isRawShaderMaterial&&(function b(x,N){x.push(N.precision),x.push(N.outputEncoding),x.push(N.envMapMode),x.push(N.envMapCubeUVHeight),x.push(N.combine),x.push(N.vertexUvs),x.push(N.fogExp2),x.push(N.sizeAttenuation),x.push(N.maxBones),x.push(N.morphTargetsCount),x.push(N.morphAttributeCount),x.push(N.numDirLights),x.push(N.numPointLights),x.push(N.numSpotLights),x.push(N.numHemiLights),x.push(N.numRectAreaLights),x.push(N.numDirLightShadows),x.push(N.numPointLightShadows),x.push(N.numSpotLightShadows),x.push(N.shadowMapType),x.push(N.toneMapping),x.push(N.numClippingPlanes),x.push(N.numClipIntersection)}(N,x),function w(x,N){a.disableAll(),N.isWebGL2&&a.enable(0),N.supportsVertexTextures&&a.enable(1),N.instancing&&a.enable(2),N.instancingColor&&a.enable(3),N.map&&a.enable(4),N.matcap&&a.enable(5),N.envMap&&a.enable(6),N.lightMap&&a.enable(7),N.aoMap&&a.enable(8),N.emissiveMap&&a.enable(9),N.bumpMap&&a.enable(10),N.normalMap&&a.enable(11),N.objectSpaceNormalMap&&a.enable(12),N.tangentSpaceNormalMap&&a.enable(13),N.clearcoat&&a.enable(14),N.clearcoatMap&&a.enable(15),N.clearcoatRoughnessMap&&a.enable(16),N.clearcoatNormalMap&&a.enable(17),N.displacementMap&&a.enable(18),N.specularMap&&a.enable(19),N.roughnessMap&&a.enable(20),N.metalnessMap&&a.enable(21),N.gradientMap&&a.enable(22),N.alphaMap&&a.enable(23),N.alphaTest&&a.enable(24),N.vertexColors&&a.enable(25),N.vertexAlphas&&a.enable(26),N.vertexUvs&&a.enable(27),N.vertexTangents&&a.enable(28),N.uvsVertexOnly&&a.enable(29),N.fog&&a.enable(30),x.push(a.mask),a.disableAll(),N.useFog&&a.enable(0),N.flatShading&&a.enable(1),N.logarithmicDepthBuffer&&a.enable(2),N.skinning&&a.enable(3),N.useVertexTexture&&a.enable(4),N.morphTargets&&a.enable(5),N.morphNormals&&a.enable(6),N.morphColors&&a.enable(7),N.premultipliedAlpha&&a.enable(8),N.shadowMapEnabled&&a.enable(9),N.physicallyCorrectLights&&a.enable(10),N.doubleSided&&a.enable(11),N.flipSided&&a.enable(12),N.depthPacking&&a.enable(13),N.dithering&&a.enable(14),N.specularIntensityMap&&a.enable(15),N.specularColorMap&&a.enable(16),N.transmission&&a.enable(17),N.transmissionMap&&a.enable(18),N.thicknessMap&&a.enable(19),N.sheen&&a.enable(20),N.sheenColorMap&&a.enable(21),N.sheenRoughnessMap&&a.enable(22),N.decodeVideoTexture&&a.enable(23),N.opaque&&a.enable(24),x.push(a.mask)}(N,x),N.push(n.outputEncoding)),N.push(x.customProgramCacheKey),N.join()},getUniforms:function D(x){const N=m[x.type];let q;return q=N?P$.clone(ns[N].uniforms):x.uniforms,q},acquireProgram:function C(x,N){let q;for(let L=0,j=c.length;L<j;L++){const z=c[L];if(z.cacheKey===N){q=z,++q.usedTimes;break}}return void 0===q&&(q=new iY(n,N,x,o),c.push(q)),q},releaseProgram:function T(x){if(0==--x.usedTimes){const N=c.indexOf(x);c[N]=c[c.length-1],c.pop(),x.destroy()}},releaseShaderCache:function G(x){l.remove(x)},programs:c,dispose:function O(){l.dispose()}}}function lY(){let n=new WeakMap;return{get:function e(o){let s=n.get(o);return void 0===s&&(s={},n.set(o,s)),s},remove:function t(o){n.delete(o)},update:function i(o,s,a){n.get(o)[s]=a},dispose:function r(){n=new WeakMap}}}function cY(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function nN(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function iN(){const n=[];let e=0;const t=[],i=[],r=[];function s(d,h,f,g,p,m){let y=n[e];return void 0===y?(y={id:d.id,object:d,geometry:h,material:f,groupOrder:g,renderOrder:d.renderOrder,z:p,group:m},n[e]=y):(y.id=d.id,y.object=d,y.geometry=h,y.material=f,y.groupOrder=g,y.renderOrder=d.renderOrder,y.z=p,y.group=m),e++,y}return{opaque:t,transmissive:i,transparent:r,init:function o(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,g,p,m){const y=s(d,h,f,g,p,m);f.transmission>0?i.push(y):!0===f.transparent?r.push(y):t.push(y)},unshift:function l(d,h,f,g,p,m){const y=s(d,h,f,g,p,m);f.transmission>0?i.unshift(y):!0===f.transparent?r.unshift(y):t.unshift(y)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||cY),i.length>1&&i.sort(h||nN),r.length>1&&r.sort(h||nN)}}}function uY(){let n=new WeakMap;return{get:function e(i,r){let o;return!1===n.has(i)?(o=new iN,n.set(i,[o])):r>=n.get(i).length?(o=new iN,n.get(i).push(o)):o=n.get(i)[r],o},dispose:function t(){n=new WeakMap}}}function dY(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new M,color:new ve};break;case"SpotLight":t={position:new M,direction:new M,color:new ve,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new M,color:new ve,distance:0,decay:0};break;case"HemisphereLight":t={direction:new M,skyColor:new ve,groundColor:new ve};break;case"RectAreaLight":t={color:new ve,position:new M,halfWidth:new M,halfHeight:new M}}return n[e.id]=t,t}}}let fY=0;function pY(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function gY(n,e){const t=new dY,i=function hY(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new re,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new M);const o=new M,s=new ye,a=new ye;return{setup:function l(u,d){let h=0,f=0,g=0;for(let G=0;G<9;G++)r.probe[G].set(0,0,0);let p=0,m=0,y=0,_=0,v=0,b=0,w=0,D=0;u.sort(pY);const C=!0!==d?Math.PI:1;for(let G=0,O=u.length;G<O;G++){const x=u[G],N=x.color,q=x.intensity,L=x.distance,j=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)h+=N.r*q*C,f+=N.g*q*C,g+=N.b*q*C;else if(x.isLightProbe)for(let z=0;z<9;z++)r.probe[z].addScaledVector(x.sh.coefficients[z],q);else if(x.isDirectionalLight){const z=t.get(x);if(z.color.copy(x.color).multiplyScalar(x.intensity*C),x.castShadow){const $=x.shadow,U=i.get(x);U.shadowBias=$.bias,U.shadowNormalBias=$.normalBias,U.shadowRadius=$.radius,U.shadowMapSize=$.mapSize,r.directionalShadow[p]=U,r.directionalShadowMap[p]=j,r.directionalShadowMatrix[p]=x.shadow.matrix,b++}r.directional[p]=z,p++}else if(x.isSpotLight){const z=t.get(x);if(z.position.setFromMatrixPosition(x.matrixWorld),z.color.copy(N).multiplyScalar(q*C),z.distance=L,z.coneCos=Math.cos(x.angle),z.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),z.decay=x.decay,x.castShadow){const $=x.shadow,U=i.get(x);U.shadowBias=$.bias,U.shadowNormalBias=$.normalBias,U.shadowRadius=$.radius,U.shadowMapSize=$.mapSize,r.spotShadow[y]=U,r.spotShadowMap[y]=j,r.spotShadowMatrix[y]=x.shadow.matrix,D++}r.spot[y]=z,y++}else if(x.isRectAreaLight){const z=t.get(x);z.color.copy(N).multiplyScalar(q),z.halfWidth.set(.5*x.width,0,0),z.halfHeight.set(0,.5*x.height,0),r.rectArea[_]=z,_++}else if(x.isPointLight){const z=t.get(x);if(z.color.copy(x.color).multiplyScalar(x.intensity*C),z.distance=x.distance,z.decay=x.decay,x.castShadow){const $=x.shadow,U=i.get(x);U.shadowBias=$.bias,U.shadowNormalBias=$.normalBias,U.shadowRadius=$.radius,U.shadowMapSize=$.mapSize,U.shadowCameraNear=$.camera.near,U.shadowCameraFar=$.camera.far,r.pointShadow[m]=U,r.pointShadowMap[m]=j,r.pointShadowMatrix[m]=x.shadow.matrix,w++}r.point[m]=z,m++}else if(x.isHemisphereLight){const z=t.get(x);z.skyColor.copy(x.color).multiplyScalar(q*C),z.groundColor.copy(x.groundColor).multiplyScalar(q*C),r.hemi[v]=z,v++}}_>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=Ce.LTC_FLOAT_1,r.rectAreaLTC2=Ce.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Ce.LTC_HALF_1,r.rectAreaLTC2=Ce.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=f,r.ambient[2]=g;const T=r.hash;(T.directionalLength!==p||T.pointLength!==m||T.spotLength!==y||T.rectAreaLength!==_||T.hemiLength!==v||T.numDirectionalShadows!==b||T.numPointShadows!==w||T.numSpotShadows!==D)&&(r.directional.length=p,r.spot.length=y,r.rectArea.length=_,r.point.length=m,r.hemi.length=v,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=w,r.pointShadowMap.length=w,r.spotShadow.length=D,r.spotShadowMap.length=D,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=w,r.spotShadowMatrix.length=D,T.directionalLength=p,T.pointLength=m,T.spotLength=y,T.rectAreaLength=_,T.hemiLength=v,T.numDirectionalShadows=b,T.numPointShadows=w,T.numSpotShadows=D,r.version=fY++)},setupView:function c(u,d){let h=0,f=0,g=0,p=0,m=0;const y=d.matrixWorldInverse;for(let _=0,v=u.length;_<v;_++){const b=u[_];if(b.isDirectionalLight){const w=r.directional[h];w.direction.setFromMatrixPosition(b.matrixWorld),o.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(o),w.direction.transformDirection(y),h++}else if(b.isSpotLight){const w=r.spot[g];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(y),w.direction.setFromMatrixPosition(b.matrixWorld),o.setFromMatrixPosition(b.target.matrixWorld),w.direction.sub(o),w.direction.transformDirection(y),g++}else if(b.isRectAreaLight){const w=r.rectArea[p];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(y),a.identity(),s.copy(b.matrixWorld),s.premultiply(y),a.extractRotation(s),w.halfWidth.set(.5*b.width,0,0),w.halfHeight.set(0,.5*b.height,0),w.halfWidth.applyMatrix4(a),w.halfHeight.applyMatrix4(a),p++}else if(b.isPointLight){const w=r.point[f];w.position.setFromMatrixPosition(b.matrixWorld),w.position.applyMatrix4(y),f++}else if(b.isHemisphereLight){const w=r.hemi[m];w.direction.setFromMatrixPosition(b.matrixWorld),w.direction.transformDirection(y),w.direction.normalize(),m++}}},state:r}}function rN(n,e){const t=new gY(n,e),i=[],r=[];return{init:function o(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function l(d){t.setup(i,d)},setupLightsView:function c(d){t.setupView(i,d)},pushLight:function s(d){i.push(d)},pushShadow:function a(d){r.push(d)}}}function mY(n,e){let t=new WeakMap;return{get:function i(o,s=0){let a;return!1===t.has(o)?(a=new rN(n,e),t.set(o,[a])):s>=t.get(o).length?(a=new rN(n,e),t.get(o).push(a)):a=t.get(o)[s],a},dispose:function r(){t=new WeakMap}}}class z1 extends Ln{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}z1.prototype.isMeshDepthMaterial=!0;class G1 extends Ln{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new M,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function oN(n,e,t){let i=new _m;const r=new re,o=new re,s=new Zt,a=new z1({depthPacking:3201}),l=new G1,c={},u=t.maxTextureSize,d={0:1,1:0,2:2},h=new Io({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new re},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const g=new je;g.setAttribute("position",new xn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new we(g,h),m=this;function y(b,w){const D=e.update(p);h.defines.VSM_SAMPLES!==b.blurSamples&&(h.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),h.uniforms.shadow_pass.value=b.map.texture,h.uniforms.resolution.value=b.mapSize,h.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(w,null,D,h,p,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(w,null,D,f,p,null)}function _(b,w,D,C,T,G){let O=null;const x=!0===D.isPointLight?b.customDistanceMaterial:b.customDepthMaterial;if(O=void 0!==x?x:!0===D.isPointLight?l:a,n.localClippingEnabled&&!0===w.clipShadows&&0!==w.clippingPlanes.length||w.displacementMap&&0!==w.displacementScale||w.alphaMap&&w.alphaTest>0){const N=O.uuid,q=w.uuid;let L=c[N];void 0===L&&(L={},c[N]=L);let j=L[q];void 0===j&&(j=O.clone(),L[q]=j),O=j}return O.visible=w.visible,O.wireframe=w.wireframe,O.side=3===G?null!==w.shadowSide?w.shadowSide:w.side:null!==w.shadowSide?w.shadowSide:d[w.side],O.alphaMap=w.alphaMap,O.alphaTest=w.alphaTest,O.clipShadows=w.clipShadows,O.clippingPlanes=w.clippingPlanes,O.clipIntersection=w.clipIntersection,O.displacementMap=w.displacementMap,O.displacementScale=w.displacementScale,O.displacementBias=w.displacementBias,O.wireframeLinewidth=w.wireframeLinewidth,O.linewidth=w.linewidth,!0===D.isPointLight&&!0===O.isMeshDistanceMaterial&&(O.referencePosition.setFromMatrixPosition(D.matrixWorld),O.nearDistance=C,O.farDistance=T),O}function v(b,w,D,C,T){if(!1===b.visible)return;if(b.layers.test(w.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&3===T)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,b.matrixWorld);const x=e.update(b),N=b.material;if(Array.isArray(N)){const q=x.groups;for(let L=0,j=q.length;L<j;L++){const z=q[L],$=N[z.materialIndex];if($&&$.visible){const U=_(b,$,C,D.near,D.far,T);n.renderBufferDirect(D,null,x,U,b,z)}}}else if(N.visible){const q=_(b,N,C,D.near,D.far,T);n.renderBufferDirect(D,null,x,q,b,null)}}const O=b.children;for(let x=0,N=O.length;x<N;x++)v(O[x],w,D,C,T)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(b,w,D){if(!1===m.enabled||!1===m.autoUpdate&&!1===m.needsUpdate||0===b.length)return;const C=n.getRenderTarget(),T=n.getActiveCubeFace(),G=n.getActiveMipmapLevel(),O=n.state;O.setBlending(0),O.buffers.color.setClear(1,1,1,1),O.buffers.depth.setTest(!0),O.setScissorTest(!1);for(let x=0,N=b.length;x<N;x++){const q=b[x],L=q.shadow;if(void 0===L){console.warn("THREE.WebGLShadowMap:",q,"has no shadow.");continue}if(!1===L.autoUpdate&&!1===L.needsUpdate)continue;r.copy(L.mapSize);const j=L.getFrameExtents();r.multiply(j),o.copy(L.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/j.x),r.x=o.x*j.x,L.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/j.y),r.y=o.y*j.y,L.mapSize.y=o.y)),null===L.map&&!L.isPointLightShadow&&3===this.type&&(L.map=new Pr(r.x,r.y),L.map.texture.name=q.name+".shadowMap",L.mapPass=new Pr(r.x,r.y),L.camera.updateProjectionMatrix()),null===L.map&&(L.map=new Pr(r.x,r.y,{minFilter:gi,magFilter:gi,format:to}),L.map.texture.name=q.name+".shadowMap",L.camera.updateProjectionMatrix()),n.setRenderTarget(L.map),n.clear();const z=L.getViewportCount();for(let $=0;$<z;$++){const U=L.getViewport($);s.set(o.x*U.x,o.y*U.y,o.x*U.z,o.y*U.w),O.viewport(s),L.updateMatrices(q,$),i=L.getFrustum(),v(w,D,L.camera,q,this.type)}!L.isPointLightShadow&&3===this.type&&y(L,D),L.needsUpdate=!1}m.needsUpdate=!1,n.setRenderTarget(C,T,G)}}function vY(n,e,t){const i=t.isWebGL2,a=new function r(){let V=!1;const xe=new Zt;let be=null;const tt=new Zt(0,0,0,0);return{setMask:function(Pe){be!==Pe&&!V&&(n.colorMask(Pe,Pe,Pe,Pe),be=Pe)},setLocked:function(Pe){V=Pe},setClear:function(Pe,$e,Se,mt,En){!0===En&&(Pe*=mt,$e*=mt,Se*=mt),xe.set(Pe,$e,Se,mt),!1===tt.equals(xe)&&(n.clearColor(Pe,$e,Se,mt),tt.copy(xe))},reset:function(){V=!1,be=null,tt.set(-1,0,0,0)}}},l=new function o(){let V=!1,xe=null,be=null,tt=null;return{setTest:function(Pe){Pe?Ie(2929):te(2929)},setMask:function(Pe){xe!==Pe&&!V&&(n.depthMask(Pe),xe=Pe)},setFunc:function(Pe){if(be!==Pe){if(Pe)switch(Pe){case 0:n.depthFunc(512);break;case 1:n.depthFunc(519);break;case 2:n.depthFunc(513);break;case 3:default:n.depthFunc(515);break;case 4:n.depthFunc(514);break;case 5:n.depthFunc(518);break;case 6:n.depthFunc(516);break;case 7:n.depthFunc(517)}else n.depthFunc(515);be=Pe}},setLocked:function(Pe){V=Pe},setClear:function(Pe){tt!==Pe&&(n.clearDepth(Pe),tt=Pe)},reset:function(){V=!1,xe=null,be=null,tt=null}}},c=new function s(){let V=!1,xe=null,be=null,tt=null,Pe=null,$e=null,Se=null,mt=null,En=null;return{setTest:function(Wt){V||(Wt?Ie(2960):te(2960))},setMask:function(Wt){xe!==Wt&&!V&&(n.stencilMask(Wt),xe=Wt)},setFunc:function(Wt,ds,hs){(be!==Wt||tt!==ds||Pe!==hs)&&(n.stencilFunc(Wt,ds,hs),be=Wt,tt=ds,Pe=hs)},setOp:function(Wt,ds,hs){($e!==Wt||Se!==ds||mt!==hs)&&(n.stencilOp(Wt,ds,hs),$e=Wt,Se=ds,mt=hs)},setLocked:function(Wt){V=Wt},setClear:function(Wt){En!==Wt&&(n.clearStencil(Wt),En=Wt)},reset:function(){V=!1,xe=null,be=null,tt=null,Pe=null,$e=null,Se=null,mt=null,En=null}}};let u={},d={},h=new WeakMap,f=[],g=null,p=!1,m=null,y=null,_=null,v=null,b=null,w=null,D=null,C=!1,T=null,G=null,O=null,x=null,N=null;const q=n.getParameter(35661);let L=!1,j=0;const z=n.getParameter(7938);-1!==z.indexOf("WebGL")?(j=parseFloat(/^WebGL (\d)/.exec(z)[1]),L=j>=1):-1!==z.indexOf("OpenGL ES")&&(j=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),L=j>=2);let $=null,U={};const X=n.getParameter(3088),ee=n.getParameter(2978),se=(new Zt).fromArray(X),ie=(new Zt).fromArray(ee);function Ae(V,xe,be){const tt=new Uint8Array(4),Pe=n.createTexture();n.bindTexture(V,Pe),n.texParameteri(V,10241,9728),n.texParameteri(V,10240,9728);for(let $e=0;$e<be;$e++)n.texImage2D(xe+$e,0,6408,1,1,0,6408,5121,tt);return Pe}const Le={};function Ie(V){!0!==u[V]&&(n.enable(V),u[V]=!0)}function te(V){!1!==u[V]&&(n.disable(V),u[V]=!1)}Le[3553]=Ae(3553,3553,1),Le[34067]=Ae(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Ie(2929),l.setFunc(3),fe(!1),Be(1),Ie(2884),ne(0);const _e={100:32774,101:32778,102:32779};if(i)_e[103]=32775,_e[104]=32776;else{const V=e.get("EXT_blend_minmax");null!==V&&(_e[103]=V.MIN_EXT,_e[104]=V.MAX_EXT)}const it={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function ne(V,xe,be,tt,Pe,$e,Se,mt){if(0!==V){if(!1===p&&(Ie(3042),p=!0),5===V)Pe=Pe||xe,$e=$e||be,Se=Se||tt,(xe!==y||Pe!==b)&&(n.blendEquationSeparate(_e[xe],_e[Pe]),y=xe,b=Pe),(be!==_||tt!==v||$e!==w||Se!==D)&&(n.blendFuncSeparate(it[be],it[tt],it[$e],it[Se]),_=be,v=tt,w=$e,D=Se),m=V,C=null;else if(V!==m||mt!==C){if((100!==y||100!==b)&&(n.blendEquation(32774),y=100,b=100),mt)switch(V){case 1:n.blendFuncSeparate(1,771,1,771);break;case 2:n.blendFunc(1,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",V)}else switch(V){case 1:n.blendFuncSeparate(770,771,1,771);break;case 2:n.blendFunc(770,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",V)}_=null,v=null,w=null,D=null,m=V,C=mt}}else!0===p&&(te(3042),p=!1)}function fe(V){T!==V&&(n.frontFace(V?2304:2305),T=V)}function Be(V){0!==V?(Ie(2884),V!==G&&n.cullFace(1===V?1029:2===V?1028:1032)):te(2884),G=V}function rt(V,xe,be){V?(Ie(32823),(x!==xe||N!==be)&&(n.polygonOffset(xe,be),x=xe,N=be)):te(32823)}function qe(V){void 0===V&&(V=33984+q-1),$!==V&&(n.activeTexture(V),$=V)}return{buffers:{color:a,depth:l,stencil:c},enable:Ie,disable:te,bindFramebuffer:function pt(V,xe){return d[V]!==xe&&(n.bindFramebuffer(V,xe),d[V]=xe,i&&(36009===V&&(d[36160]=xe),36160===V&&(d[36009]=xe)),!0)},drawBuffers:function ze(V,xe){let be=f,tt=!1;if(V)if(be=h.get(xe),void 0===be&&(be=[],h.set(xe,be)),V.isWebGLMultipleRenderTargets){const Pe=V.texture;if(be.length!==Pe.length||36064!==be[0]){for(let $e=0,Se=Pe.length;$e<Se;$e++)be[$e]=36064+$e;be.length=Pe.length,tt=!0}}else 36064!==be[0]&&(be[0]=36064,tt=!0);else 1029!==be[0]&&(be[0]=1029,tt=!0);tt&&(t.isWebGL2?n.drawBuffers(be):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(be))},useProgram:function Qe(V){return g!==V&&(n.useProgram(V),g=V,!0)},setBlending:ne,setMaterial:function oe(V,xe){2===V.side?te(2884):Ie(2884);let be=1===V.side;xe&&(be=!be),fe(be),1===V.blending&&!1===V.transparent?ne(0):ne(V.blending,V.blendEquation,V.blendSrc,V.blendDst,V.blendEquationAlpha,V.blendSrcAlpha,V.blendDstAlpha,V.premultipliedAlpha),l.setFunc(V.depthFunc),l.setTest(V.depthTest),l.setMask(V.depthWrite),a.setMask(V.colorWrite);const tt=V.stencilWrite;c.setTest(tt),tt&&(c.setMask(V.stencilWriteMask),c.setFunc(V.stencilFunc,V.stencilRef,V.stencilFuncMask),c.setOp(V.stencilFail,V.stencilZFail,V.stencilZPass)),rt(V.polygonOffset,V.polygonOffsetFactor,V.polygonOffsetUnits),!0===V.alphaToCoverage?Ie(32926):te(32926)},setFlipSided:fe,setCullFace:Be,setLineWidth:function Ee(V){V!==O&&(L&&n.lineWidth(V),O=V)},setPolygonOffset:rt,setScissorTest:function Ke(V){V?Ie(3089):te(3089)},activeTexture:qe,bindTexture:function jt(V,xe){null===$&&qe();let be=U[$];void 0===be&&(be={type:void 0,texture:void 0},U[$]=be),(be.type!==V||be.texture!==xe)&&(n.bindTexture(V,xe||Le[V]),be.type=V,be.texture=xe)},unbindTexture:function Ht(){const V=U[$];void 0!==V&&void 0!==V.type&&(n.bindTexture(V.type,null),V.type=void 0,V.texture=void 0)},compressedTexImage2D:function P(){try{n.compressedTexImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texImage2D:function We(){try{n.texImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texImage3D:function I(){try{n.texImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texStorage2D:function Me(){try{n.texStorage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texStorage3D:function Oe(){try{n.texStorage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texSubImage2D:function E(){try{n.texSubImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},texSubImage3D:function J(){try{n.texSubImage3D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},compressedTexSubImage2D:function de(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(V){console.error("THREE.WebGLState:",V)}},scissor:function pe(V){!1===se.equals(V)&&(n.scissor(V.x,V.y,V.z,V.w),se.copy(V))},viewport:function Ge(V){!1===ie.equals(V)&&(n.viewport(V.x,V.y,V.z,V.w),ie.copy(V))},reset:function De(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},$=null,U={},d={},h=new WeakMap,f=[],g=null,p=!1,m=null,y=null,_=null,v=null,b=null,w=null,D=null,C=!1,T=null,G=null,O=null,x=null,N=null,se.set(0,0,n.canvas.width,n.canvas.height),ie.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}}}function bY(n,e,t,i,r,o,s){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let p;const m=new WeakMap;let y=!1;try{y="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(P){}function _(P,E){return y?new OffscreenCanvas(P,E):Lh("canvas")}function v(P,E,J,de){let Me=1;if((P.width>de||P.height>de)&&(Me=de/Math.max(P.width,P.height)),Me<1||!0===E){if("undefined"!=typeof HTMLImageElement&&P instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&P instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&P instanceof ImageBitmap){const Oe=E?Yg:Math.floor,We=Oe(Me*P.width),I=Oe(Me*P.height);void 0===p&&(p=_(We,I));const pe=J?_(We,I):p;return pe.width=We,pe.height=I,pe.getContext("2d").drawImage(P,0,0,We,I),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+P.width+"x"+P.height+") to ("+We+"x"+I+")."),pe}return"data"in P&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+P.width+"x"+P.height+")."),P}return P}function b(P){return u1(P.width)&&u1(P.height)}function D(P,E){return P.generateMipmaps&&E&&P.minFilter!==gi&&P.minFilter!==oi}function C(P){n.generateMipmap(P)}function T(P,E,J,de,Me=!1){if(!1===a)return E;if(null!==P){if(void 0!==n[P])return n[P];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+P+"'")}let Oe=E;return 6403===E&&(5126===J&&(Oe=33326),5131===J&&(Oe=33325),5121===J&&(Oe=33321)),33319===E&&(5126===J&&(Oe=33328),5131===J&&(Oe=33327),5121===J&&(Oe=33323)),6408===E&&(5126===J&&(Oe=34836),5131===J&&(Oe=34842),5121===J&&(Oe=de===hn&&!1===Me?35907:32856),32819===J&&(Oe=32854),32820===J&&(Oe=32855)),(33325===Oe||33326===Oe||33327===Oe||33328===Oe||34842===Oe||34836===Oe)&&e.get("EXT_color_buffer_float"),Oe}function G(P,E,J){return!0===D(P,J)||P.isFramebufferTexture&&P.minFilter!==gi&&P.minFilter!==oi?Math.log2(Math.max(E.width,E.height))+1:void 0!==P.mipmaps&&P.mipmaps.length>0?P.mipmaps.length:P.isCompressedTexture&&Array.isArray(P.image)?E.mipmaps.length:1}function O(P){return P===gi||1004===P||1005===P?9728:9729}function x(P){const E=P.target;E.removeEventListener("dispose",x),function q(P){const E=i.get(P);if(void 0===E.__webglInit)return;const J=P.source,de=m.get(J);if(de){const Me=de[E.__cacheKey];Me.usedTimes--,0===Me.usedTimes&&L(P),0===Object.keys(de).length&&m.delete(J)}i.remove(P)}(E),E.isVideoTexture&&g.delete(E)}function N(P){const E=P.target;E.removeEventListener("dispose",N),function j(P){const E=P.texture,J=i.get(P),de=i.get(E);if(void 0!==de.__webglTexture&&(n.deleteTexture(de.__webglTexture),s.memory.textures--),P.depthTexture&&P.depthTexture.dispose(),P.isWebGLCubeRenderTarget)for(let Me=0;Me<6;Me++)n.deleteFramebuffer(J.__webglFramebuffer[Me]),J.__webglDepthbuffer&&n.deleteRenderbuffer(J.__webglDepthbuffer[Me]);else n.deleteFramebuffer(J.__webglFramebuffer),J.__webglDepthbuffer&&n.deleteRenderbuffer(J.__webglDepthbuffer),J.__webglMultisampledFramebuffer&&n.deleteFramebuffer(J.__webglMultisampledFramebuffer),J.__webglColorRenderbuffer&&n.deleteRenderbuffer(J.__webglColorRenderbuffer),J.__webglDepthRenderbuffer&&n.deleteRenderbuffer(J.__webglDepthRenderbuffer);if(P.isWebGLMultipleRenderTargets)for(let Me=0,Oe=E.length;Me<Oe;Me++){const We=i.get(E[Me]);We.__webglTexture&&(n.deleteTexture(We.__webglTexture),s.memory.textures--),i.remove(E[Me])}i.remove(E),i.remove(P)}(E)}function L(P){const E=i.get(P);n.deleteTexture(E.__webglTexture),delete m.get(P.source)[E.__cacheKey],s.memory.textures--}let z=0;function ee(P,E){const J=i.get(P);if(P.isVideoTexture&&function jt(P){const E=s.render.frame;g.get(P)!==E&&(g.set(P,E),P.update())}(P),!1===P.isRenderTargetTexture&&P.version>0&&J.__version!==P.version){const de=P.image;if(null===de)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==de.complete)return void ze(J,P,E);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+E),t.bindTexture(3553,J.__webglTexture)}const Le={[tu]:10497,[ji]:33071,1002:33648},Ie={[gi]:9728,1004:9984,1005:9986,[oi]:9729,1007:9985,1008:9987};function te(P,E,J){if(J?(n.texParameteri(P,10242,Le[E.wrapS]),n.texParameteri(P,10243,Le[E.wrapT]),(32879===P||35866===P)&&n.texParameteri(P,32882,Le[E.wrapR]),n.texParameteri(P,10240,Ie[E.magFilter]),n.texParameteri(P,10241,Ie[E.minFilter])):(n.texParameteri(P,10242,33071),n.texParameteri(P,10243,33071),(32879===P||35866===P)&&n.texParameteri(P,32882,33071),(E.wrapS!==ji||E.wrapT!==ji)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(P,10240,O(E.magFilter)),n.texParameteri(P,10241,O(E.minFilter)),E.minFilter!==gi&&E.minFilter!==oi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const de=e.get("EXT_texture_filter_anisotropic");if(E.type===ma&&!1===e.has("OES_texture_float_linear")||!1===a&&E.type===iu&&!1===e.has("OES_texture_half_float_linear"))return;(E.anisotropy>1||i.get(E).__currentAnisotropy)&&(n.texParameterf(P,de.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(E.anisotropy,r.getMaxAnisotropy())),i.get(E).__currentAnisotropy=E.anisotropy)}}function pt(P,E){let J=!1;void 0===P.__webglInit&&(P.__webglInit=!0,E.addEventListener("dispose",x));const de=E.source;let Me=m.get(de);void 0===Me&&(Me={},m.set(de,Me));const Oe=function X(P){const E=[];return E.push(P.wrapS),E.push(P.wrapT),E.push(P.magFilter),E.push(P.minFilter),E.push(P.anisotropy),E.push(P.internalFormat),E.push(P.format),E.push(P.type),E.push(P.generateMipmaps),E.push(P.premultiplyAlpha),E.push(P.flipY),E.push(P.unpackAlignment),E.push(P.encoding),E.join()}(E);if(Oe!==P.__cacheKey){void 0===Me[Oe]&&(Me[Oe]={texture:n.createTexture(),usedTimes:0},s.memory.textures++,J=!0),Me[Oe].usedTimes++;const We=Me[P.__cacheKey];void 0!==We&&(Me[P.__cacheKey].usedTimes--,0===We.usedTimes&&L(E)),P.__cacheKey=Oe,P.__webglTexture=Me[Oe].texture}return J}function ze(P,E,J){let de=3553;E.isDataArrayTexture&&(de=35866),E.isData3DTexture&&(de=32879);const Me=pt(P,E),Oe=E.source;if(t.activeTexture(33984+J),t.bindTexture(de,P.__webglTexture),Oe.version!==Oe.__currentVersion||!0===Me){n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const We=function w(P){return!a&&(P.wrapS!==ji||P.wrapT!==ji||P.minFilter!==gi&&P.minFilter!==oi)}(E)&&!1===b(E.image);let I=v(E.image,We,!1,u);I=Ht(E,I);const pe=b(I)||a,Ge=o.convert(E.format,E.encoding);let xe,De=o.convert(E.type),V=T(E.internalFormat,Ge,De,E.encoding,E.isVideoTexture);te(de,E,pe);const be=E.mipmaps,tt=a&&!0!==E.isVideoTexture,Pe=void 0===P.__version,$e=G(E,I,pe);if(E.isDepthTexture)V=6402,a?V=E.type===ma?36012:1014===E.type?33190:E.type===ru?35056:33189:E.type===ma&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),E.format===wl&&6402===V&&E.type!==Nh&&1014!==E.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),E.type=Nh,De=o.convert(E.type)),E.format===ou&&6402===V&&(V=34041,E.type!==ru&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),E.type=ru,De=o.convert(E.type))),tt&&Pe?t.texStorage2D(3553,1,V,I.width,I.height):t.texImage2D(3553,0,V,I.width,I.height,0,Ge,De,null);else if(E.isDataTexture)if(be.length>0&&pe){tt&&Pe&&t.texStorage2D(3553,$e,V,be[0].width,be[0].height);for(let Se=0,mt=be.length;Se<mt;Se++)xe=be[Se],tt?t.texSubImage2D(3553,Se,0,0,xe.width,xe.height,Ge,De,xe.data):t.texImage2D(3553,Se,V,xe.width,xe.height,0,Ge,De,xe.data);E.generateMipmaps=!1}else tt?(Pe&&t.texStorage2D(3553,$e,V,I.width,I.height),t.texSubImage2D(3553,0,0,0,I.width,I.height,Ge,De,I.data)):t.texImage2D(3553,0,V,I.width,I.height,0,Ge,De,I.data);else if(E.isCompressedTexture){tt&&Pe&&t.texStorage2D(3553,$e,V,be[0].width,be[0].height);for(let Se=0,mt=be.length;Se<mt;Se++)xe=be[Se],E.format!==to?null!==Ge?tt?t.compressedTexSubImage2D(3553,Se,0,0,xe.width,xe.height,Ge,xe.data):t.compressedTexImage2D(3553,Se,V,xe.width,xe.height,0,xe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):tt?t.texSubImage2D(3553,Se,0,0,xe.width,xe.height,Ge,De,xe.data):t.texImage2D(3553,Se,V,xe.width,xe.height,0,Ge,De,xe.data)}else if(E.isDataArrayTexture)tt?(Pe&&t.texStorage3D(35866,$e,V,I.width,I.height,I.depth),t.texSubImage3D(35866,0,0,0,0,I.width,I.height,I.depth,Ge,De,I.data)):t.texImage3D(35866,0,V,I.width,I.height,I.depth,0,Ge,De,I.data);else if(E.isData3DTexture)tt?(Pe&&t.texStorage3D(32879,$e,V,I.width,I.height,I.depth),t.texSubImage3D(32879,0,0,0,0,I.width,I.height,I.depth,Ge,De,I.data)):t.texImage3D(32879,0,V,I.width,I.height,I.depth,0,Ge,De,I.data);else if(E.isFramebufferTexture)tt&&Pe?t.texStorage2D(3553,$e,V,I.width,I.height):t.texImage2D(3553,0,V,I.width,I.height,0,Ge,De,null);else if(be.length>0&&pe){tt&&Pe&&t.texStorage2D(3553,$e,V,be[0].width,be[0].height);for(let Se=0,mt=be.length;Se<mt;Se++)xe=be[Se],tt?t.texSubImage2D(3553,Se,0,0,Ge,De,xe):t.texImage2D(3553,Se,V,Ge,De,xe);E.generateMipmaps=!1}else tt?(Pe&&t.texStorage2D(3553,$e,V,I.width,I.height),t.texSubImage2D(3553,0,0,0,Ge,De,I)):t.texImage2D(3553,0,V,Ge,De,I);D(E,pe)&&C(de),Oe.__currentVersion=Oe.version,E.onUpdate&&E.onUpdate(E)}P.__version=E.version}function _e(P,E,J,de,Me){const Oe=o.convert(J.format,J.encoding),We=o.convert(J.type),I=T(J.internalFormat,Oe,We,J.encoding);i.get(E).__hasExternalTextures||(32879===Me||35866===Me?t.texImage3D(Me,0,I,E.width,E.height,E.depth,0,Oe,We,null):t.texImage2D(Me,0,I,E.width,E.height,0,Oe,We,null)),t.bindFramebuffer(36160,P),qe(E)?h.framebufferTexture2DMultisampleEXT(36160,de,Me,i.get(J).__webglTexture,0,Ke(E)):n.framebufferTexture2D(36160,de,Me,i.get(J).__webglTexture,0),t.bindFramebuffer(36160,null)}function it(P,E,J){if(n.bindRenderbuffer(36161,P),E.depthBuffer&&!E.stencilBuffer){let de=33189;if(J||qe(E)){const Me=E.depthTexture;Me&&Me.isDepthTexture&&(Me.type===ma?de=36012:1014===Me.type&&(de=33190));const Oe=Ke(E);qe(E)?h.renderbufferStorageMultisampleEXT(36161,Oe,de,E.width,E.height):n.renderbufferStorageMultisample(36161,Oe,de,E.width,E.height)}else n.renderbufferStorage(36161,de,E.width,E.height);n.framebufferRenderbuffer(36160,36096,36161,P)}else if(E.depthBuffer&&E.stencilBuffer){const de=Ke(E);J&&!1===qe(E)?n.renderbufferStorageMultisample(36161,de,35056,E.width,E.height):qe(E)?h.renderbufferStorageMultisampleEXT(36161,de,35056,E.width,E.height):n.renderbufferStorage(36161,34041,E.width,E.height),n.framebufferRenderbuffer(36160,33306,36161,P)}else{const de=!0===E.isWebGLMultipleRenderTargets?E.texture[0]:E.texture,Me=o.convert(de.format,de.encoding),Oe=o.convert(de.type),We=T(de.internalFormat,Me,Oe,de.encoding),I=Ke(E);J&&!1===qe(E)?n.renderbufferStorageMultisample(36161,I,We,E.width,E.height):qe(E)?h.renderbufferStorageMultisampleEXT(36161,I,We,E.width,E.height):n.renderbufferStorage(36161,We,E.width,E.height)}n.bindRenderbuffer(36161,null)}function oe(P){const E=i.get(P),J=!0===P.isWebGLCubeRenderTarget;if(P.depthTexture&&!E.__autoAllocateDepthBuffer){if(J)throw new Error("target.depthTexture not supported in Cube render targets");!function ne(P,E){if(E&&E.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,P),!E.depthTexture||!E.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(E.depthTexture).__webglTexture||E.depthTexture.image.width!==E.width||E.depthTexture.image.height!==E.height)&&(E.depthTexture.image.width=E.width,E.depthTexture.image.height=E.height,E.depthTexture.needsUpdate=!0),ee(E.depthTexture,0);const de=i.get(E.depthTexture).__webglTexture,Me=Ke(E);if(E.depthTexture.format===wl)qe(E)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,de,0,Me):n.framebufferTexture2D(36160,36096,3553,de,0);else{if(E.depthTexture.format!==ou)throw new Error("Unknown depthTexture format");qe(E)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,de,0,Me):n.framebufferTexture2D(36160,33306,3553,de,0)}}(E.__webglFramebuffer,P)}else if(J){E.__webglDepthbuffer=[];for(let de=0;de<6;de++)t.bindFramebuffer(36160,E.__webglFramebuffer[de]),E.__webglDepthbuffer[de]=n.createRenderbuffer(),it(E.__webglDepthbuffer[de],P,!1)}else t.bindFramebuffer(36160,E.__webglFramebuffer),E.__webglDepthbuffer=n.createRenderbuffer(),it(E.__webglDepthbuffer,P,!1);t.bindFramebuffer(36160,null)}function Ke(P){return Math.min(d,P.samples)}function qe(P){const E=i.get(P);return a&&P.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==E.__useRenderToTexture}function Ht(P,E){const J=P.encoding,de=P.format,Me=P.type;return!0===P.isCompressedTexture||!0===P.isVideoTexture||1035===P.format||J!==Ns&&(J===hn?!1===a?!0===e.has("EXT_sRGB")&&de===to?(P.format=1035,P.minFilter=oi,P.generateMipmaps=!1):E=Sl.sRGBToLinear(E):(de!==to||Me!==bl)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",J)),E}this.allocateTextureUnit=function U(){const P=z;return P>=l&&console.warn("THREE.WebGLTextures: Trying to use "+P+" texture units while this GPU supports only "+l),z+=1,P},this.resetTextureUnits=function $(){z=0},this.setTexture2D=ee,this.setTexture2DArray=function se(P,E){const J=i.get(P);P.version>0&&J.__version!==P.version?ze(J,P,E):(t.activeTexture(33984+E),t.bindTexture(35866,J.__webglTexture))},this.setTexture3D=function ie(P,E){const J=i.get(P);P.version>0&&J.__version!==P.version?ze(J,P,E):(t.activeTexture(33984+E),t.bindTexture(32879,J.__webglTexture))},this.setTextureCube=function Ae(P,E){const J=i.get(P);P.version>0&&J.__version!==P.version?function Qe(P,E,J){if(6!==E.image.length)return;const de=pt(P,E),Me=E.source;if(t.activeTexture(33984+J),t.bindTexture(34067,P.__webglTexture),Me.version!==Me.__currentVersion||!0===de){n.pixelStorei(37440,E.flipY),n.pixelStorei(37441,E.premultiplyAlpha),n.pixelStorei(3317,E.unpackAlignment),n.pixelStorei(37443,0);const Oe=E.isCompressedTexture||E.image[0].isCompressedTexture,We=E.image[0]&&E.image[0].isDataTexture,I=[];for(let Se=0;Se<6;Se++)I[Se]=Oe||We?We?E.image[Se].image:E.image[Se]:v(E.image[Se],!1,!0,c),I[Se]=Ht(E,I[Se]);const pe=I[0],Ge=b(pe)||a,De=o.convert(E.format,E.encoding),V=o.convert(E.type),xe=T(E.internalFormat,De,V,E.encoding),be=a&&!0!==E.isVideoTexture,tt=void 0===P.__version;let $e,Pe=G(E,pe,Ge);if(te(34067,E,Ge),Oe){be&&tt&&t.texStorage2D(34067,Pe,xe,pe.width,pe.height);for(let Se=0;Se<6;Se++){$e=I[Se].mipmaps;for(let mt=0;mt<$e.length;mt++){const En=$e[mt];E.format!==to?null!==De?be?t.compressedTexSubImage2D(34069+Se,mt,0,0,En.width,En.height,De,En.data):t.compressedTexImage2D(34069+Se,mt,xe,En.width,En.height,0,En.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):be?t.texSubImage2D(34069+Se,mt,0,0,En.width,En.height,De,V,En.data):t.texImage2D(34069+Se,mt,xe,En.width,En.height,0,De,V,En.data)}}}else{$e=E.mipmaps,be&&tt&&($e.length>0&&Pe++,t.texStorage2D(34067,Pe,xe,I[0].width,I[0].height));for(let Se=0;Se<6;Se++)if(We){be?t.texSubImage2D(34069+Se,0,0,0,I[Se].width,I[Se].height,De,V,I[Se].data):t.texImage2D(34069+Se,0,xe,I[Se].width,I[Se].height,0,De,V,I[Se].data);for(let mt=0;mt<$e.length;mt++){const Wt=$e[mt].image[Se].image;be?t.texSubImage2D(34069+Se,mt+1,0,0,Wt.width,Wt.height,De,V,Wt.data):t.texImage2D(34069+Se,mt+1,xe,Wt.width,Wt.height,0,De,V,Wt.data)}}else{be?t.texSubImage2D(34069+Se,0,0,0,De,V,I[Se]):t.texImage2D(34069+Se,0,xe,De,V,I[Se]);for(let mt=0;mt<$e.length;mt++){const En=$e[mt];be?t.texSubImage2D(34069+Se,mt+1,0,0,De,V,En.image[Se]):t.texImage2D(34069+Se,mt+1,xe,De,V,En.image[Se])}}}D(E,Ge)&&C(34067),Me.__currentVersion=Me.version,E.onUpdate&&E.onUpdate(E)}P.__version=E.version}(J,P,E):(t.activeTexture(33984+E),t.bindTexture(34067,J.__webglTexture))},this.rebindTextures=function fe(P,E,J){const de=i.get(P);void 0!==E&&_e(de.__webglFramebuffer,P,P.texture,36064,3553),void 0!==J&&oe(P)},this.setupRenderTarget=function Be(P){const E=P.texture,J=i.get(P),de=i.get(E);P.addEventListener("dispose",N),!0!==P.isWebGLMultipleRenderTargets&&(void 0===de.__webglTexture&&(de.__webglTexture=n.createTexture()),de.__version=E.version,s.memory.textures++);const Me=!0===P.isWebGLCubeRenderTarget,Oe=!0===P.isWebGLMultipleRenderTargets,We=b(P)||a;if(Me){J.__webglFramebuffer=[];for(let I=0;I<6;I++)J.__webglFramebuffer[I]=n.createFramebuffer()}else if(J.__webglFramebuffer=n.createFramebuffer(),Oe)if(r.drawBuffers){const I=P.texture;for(let pe=0,Ge=I.length;pe<Ge;pe++){const De=i.get(I[pe]);void 0===De.__webglTexture&&(De.__webglTexture=n.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(a&&P.samples>0&&!1===qe(P)){J.__webglMultisampledFramebuffer=n.createFramebuffer(),J.__webglColorRenderbuffer=n.createRenderbuffer(),n.bindRenderbuffer(36161,J.__webglColorRenderbuffer);const I=o.convert(E.format,E.encoding),pe=o.convert(E.type),Ge=T(E.internalFormat,I,pe,E.encoding),De=Ke(P);n.renderbufferStorageMultisample(36161,De,Ge,P.width,P.height),t.bindFramebuffer(36160,J.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064,36161,J.__webglColorRenderbuffer),n.bindRenderbuffer(36161,null),P.depthBuffer&&(J.__webglDepthRenderbuffer=n.createRenderbuffer(),it(J.__webglDepthRenderbuffer,P,!0)),t.bindFramebuffer(36160,null)}if(Me){t.bindTexture(34067,de.__webglTexture),te(34067,E,We);for(let I=0;I<6;I++)_e(J.__webglFramebuffer[I],P,E,36064,34069+I);D(E,We)&&C(34067),t.unbindTexture()}else if(Oe){const I=P.texture;for(let pe=0,Ge=I.length;pe<Ge;pe++){const De=I[pe],V=i.get(De);t.bindTexture(3553,V.__webglTexture),te(3553,De,We),_e(J.__webglFramebuffer,P,De,36064+pe,3553),D(De,We)&&C(3553)}t.unbindTexture()}else{let I=3553;(P.isWebGL3DRenderTarget||P.isWebGLArrayRenderTarget)&&(a?I=P.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(I,de.__webglTexture),te(I,E,We),_e(J.__webglFramebuffer,P,E,36064,I),D(E,We)&&C(I),t.unbindTexture()}P.depthBuffer&&oe(P)},this.updateRenderTargetMipmap=function Ee(P){const E=b(P)||a,J=!0===P.isWebGLMultipleRenderTargets?P.texture:[P.texture];for(let de=0,Me=J.length;de<Me;de++){const Oe=J[de];if(D(Oe,E)){const We=P.isWebGLCubeRenderTarget?34067:3553,I=i.get(Oe).__webglTexture;t.bindTexture(We,I),C(We),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function rt(P){if(a&&P.samples>0&&!1===qe(P)){const E=P.width,J=P.height;let de=16384;const Me=[36064],Oe=P.stencilBuffer?33306:36096;P.depthBuffer&&Me.push(Oe);const We=i.get(P),I=void 0!==We.__ignoreDepthValues&&We.__ignoreDepthValues;!1===I&&(P.depthBuffer&&(de|=256),P.stencilBuffer&&(de|=1024)),t.bindFramebuffer(36008,We.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,We.__webglFramebuffer),!0===I&&(n.invalidateFramebuffer(36008,[Oe]),n.invalidateFramebuffer(36009,[Oe])),n.blitFramebuffer(0,0,E,J,0,0,E,J,de,9728),f&&n.invalidateFramebuffer(36008,Me),t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,We.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=oe,this.setupFrameBufferTexture=_e,this.useMultisampledRTT=qe}function wY(n,e,t){const i=t.isWebGL2;return{convert:function r(o,s=null){let a;if(o===bl)return 5121;if(1017===o)return 32819;if(1018===o)return 32820;if(1010===o)return 5120;if(1011===o)return 5122;if(o===Nh)return 5123;if(1013===o)return 5124;if(1014===o)return 5125;if(o===ma)return 5126;if(o===iu)return i?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===o)return 6406;if(o===to)return 6408;if(1024===o)return 6409;if(1025===o)return 6410;if(o===wl)return 6402;if(o===ou)return 34041;if(1028===o)return 6403;if(1022===o)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===o)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1029===o)return 36244;if(1030===o)return 33319;if(1031===o)return 33320;if(1033===o)return 36249;if(33776===o||33777===o||33778===o||33779===o)if(s===hn){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===o)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===o)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===o)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===o)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===o)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===o)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===o)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===o)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===o||35841===o||35842===o||35843===o){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===o)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===o)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===o)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===o)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===o)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===o||37496===o){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===o)return s===hn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===o||37809===o||37810===o||37811===o||37812===o||37813===o||37814===o||37815===o||37816===o||37817===o||37818===o||37819===o||37820===o||37821===o){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===o)return s===hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===o){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===o)return s===hn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return o===ru?i?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}G1.prototype.isMeshDistanceMaterial=!0;class sN extends yi{constructor(e=[]){super(),this.cameras=e}}sN.prototype.isArrayCamera=!0;class Ea extends Dt{constructor(){super(),this.type="Group"}}Ea.prototype.isGroup=!0;const xY={type:"move"};class j1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Ea,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Ea,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new M,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new M),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Ea,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new M,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new M),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,o=null,s=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==a&&(r=t.getPose(e.targetRaySpace,i),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(xY))),c&&e.hand){s=!0;for(const p of e.hand.values()){const m=t.getJointPose(p,i);if(void 0===c.joints[p.jointName]){const _=new Ea;_.matrixAutoUpdate=!1,_.visible=!1,c.joints[p.jointName]=_,c.add(_)}const y=c.joints[p.jointName];null!==m&&(y.matrix.fromArray(m.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=m.radius),y.visible=null!==m}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,g=.005;c.inputState.pinching&&h>f+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),null!==o&&(l.matrix.fromArray(o.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),o.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(o.linearVelocity)):l.hasLinearVelocity=!1,o.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(o.angularVelocity)):l.hasAngularVelocity=!1));return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==o),null!==c&&(c.visible=null!==s),this}}class aN extends Di{constructor(e,t,i,r,o,s,a,l,c,u){if((u=void 0!==u?u:wl)!==wl&&u!==ou)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===wl&&(i=Nh),void 0===i&&u===ou&&(i=ru),super(null,r,o,s,a,l,u,i,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:gi,this.minFilter=void 0!==l?l:gi,this.flipY=!1,this.generateMipmaps=!1}}aN.prototype.isDepthTexture=!0;class MY extends _a{constructor(e,t){super();const i=this;let r=null,o=1,s=null,a="local-floor",l=null,c=null,u=null,d=null,h=null;const f=t.getContextAttributes();let g=null,p=null;const m=[],y=new Map,_=new yi;_.layers.enable(1),_.viewport=new Zt;const v=new yi;v.layers.enable(2),v.viewport=new Zt;const b=[_,v],w=new sN;w.layers.enable(1),w.layers.enable(2);let D=null,C=null;function T(U){const X=y.get(U.inputSource);X&&X.dispatchEvent({type:U.type,data:U.inputSource})}function G(){y.forEach(function(U,X){U.disconnect(X)}),y.clear(),D=null,C=null,e.setRenderTarget(g),d=null,u=null,c=null,r=null,p=null,$.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function O(U){const X=r.inputSources;for(let ee=0;ee<m.length;ee++)y.set(X[ee],m[ee]);for(let ee=0;ee<U.removed.length;ee++){const se=U.removed[ee],ie=y.get(se);ie&&(ie.dispatchEvent({type:"disconnected",data:se}),y.delete(se))}for(let ee=0;ee<U.added.length;ee++){const se=U.added[ee],ie=y.get(se);ie&&ie.dispatchEvent({type:"connected",data:se})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(U){let X=m[U];return void 0===X&&(X=new j1,m[U]=X),X.getTargetRaySpace()},this.getControllerGrip=function(U){let X=m[U];return void 0===X&&(X=new j1,m[U]=X),X.getGripSpace()},this.getHand=function(U){let X=m[U];return void 0===X&&(X=new j1,m[U]=X),X.getHandSpace()},this.setFramebufferScaleFactor=function(U){o=U,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(U){a=U,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return s},this.getBaseLayer=function(){return null!==u?u:d},this.getBinding=function(){return c},this.getFrame=function(){return h},this.getSession=function(){return r},this.setSession=function(){var U=Ch(function*(X){if(r=X,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",T),r.addEventListener("selectstart",T),r.addEventListener("selectend",T),r.addEventListener("squeeze",T),r.addEventListener("squeezestart",T),r.addEventListener("squeezeend",T),r.addEventListener("end",G),r.addEventListener("inputsourceschange",O),!0!==f.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)d=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:o}),r.updateRenderState({baseLayer:d}),p=new Pr(d.framebufferWidth,d.framebufferHeight,{format:to,type:bl,encoding:e.outputEncoding});else{let ee=null,se=null,ie=null;f.depth&&(ie=f.stencil?35056:33190,ee=f.stencil?ou:wl,se=f.stencil?ru:Nh);const Ae={colorFormat:e.outputEncoding===hn?35907:32856,depthFormat:ie,scaleFactor:o};c=new XRWebGLBinding(r,t),u=c.createProjectionLayer(Ae),r.updateRenderState({layers:[u]}),p=new Pr(u.textureWidth,u.textureHeight,{format:to,type:bl,depthTexture:new aN(u.textureWidth,u.textureHeight,se,void 0,void 0,void 0,void 0,void 0,void 0,ee),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0}),e.properties.get(p).__ignoreDepthValues=u.ignoreDepthValues}p.isXRRenderTarget=!0,this.setFoveation(1),s=yield r.requestReferenceSpace(a),$.setContext(r),$.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(X){return U.apply(this,arguments)}}();const x=new M,N=new M;function L(U,X){null===X?U.matrixWorld.copy(U.matrix):U.matrixWorld.multiplyMatrices(X.matrixWorld,U.matrix),U.matrixWorldInverse.copy(U.matrixWorld).invert()}this.updateCamera=function(U){if(null===r)return;w.near=v.near=_.near=U.near,w.far=v.far=_.far=U.far,(D!==w.near||C!==w.far)&&(r.updateRenderState({depthNear:w.near,depthFar:w.far}),D=w.near,C=w.far);const X=U.parent,ee=w.cameras;L(w,X);for(let ie=0;ie<ee.length;ie++)L(ee[ie],X);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),U.position.copy(w.position),U.quaternion.copy(w.quaternion),U.scale.copy(w.scale),U.matrix.copy(w.matrix),U.matrixWorld.copy(w.matrixWorld);const se=U.children;for(let ie=0,Ae=se.length;ie<Ae;ie++)se[ie].updateMatrixWorld(!0);2===ee.length?function q(U,X,ee){x.setFromMatrixPosition(X.matrixWorld),N.setFromMatrixPosition(ee.matrixWorld);const se=x.distanceTo(N),ie=X.projectionMatrix.elements,Ae=ee.projectionMatrix.elements,Le=ie[14]/(ie[10]-1),Ie=ie[14]/(ie[10]+1),te=(ie[9]+1)/ie[5],pt=(ie[9]-1)/ie[5],ze=(ie[8]-1)/ie[0],Qe=(Ae[8]+1)/Ae[0],_e=Le*ze,it=Le*Qe,ne=se/(-ze+Qe),oe=ne*-ze;X.matrixWorld.decompose(U.position,U.quaternion,U.scale),U.translateX(oe),U.translateZ(ne),U.matrixWorld.compose(U.position,U.quaternion,U.scale),U.matrixWorldInverse.copy(U.matrixWorld).invert();const fe=Le+ne,Be=Ie+ne;U.projectionMatrix.makePerspective(_e-oe,it+(se-oe),te*Ie/Be*fe,pt*Ie/Be*fe,fe,Be)}(w,_,v):w.projectionMatrix.copy(_.projectionMatrix)},this.getCamera=function(){return w},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(U){null!==u&&(u.fixedFoveation=U),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=U)};let j=null;const $=new AR;$.setAnimationLoop(function z(U,X){if(l=X.getViewerPose(s),h=X,null!==l){const se=l.views;null!==d&&(e.setRenderTargetFramebuffer(p,d.framebuffer),e.setRenderTarget(p));let ie=!1;se.length!==w.cameras.length&&(w.cameras.length=0,ie=!0);for(let Ae=0;Ae<se.length;Ae++){const Le=se[Ae];let Ie=null;if(null!==d)Ie=d.getViewport(Le);else{const pt=c.getViewSubImage(u,Le);Ie=pt.viewport,0===Ae&&(e.setRenderTargetTextures(p,pt.colorTexture,u.ignoreDepthValues?void 0:pt.depthStencilTexture),e.setRenderTarget(p))}const te=b[Ae];te.matrix.fromArray(Le.transform.matrix),te.projectionMatrix.fromArray(Le.projectionMatrix),te.viewport.set(Ie.x,Ie.y,Ie.width,Ie.height),0===Ae&&w.matrix.copy(te.matrix),!0===ie&&w.cameras.push(te)}}const ee=r.inputSources;for(let se=0;se<m.length;se++)m[se].update(ee[se],X,s);j&&j(U,X),h=null}),this.setAnimationLoop=function(U){j=U},this.dispose=function(){}}}function DY(n,e){function r(p,m){p.opacity.value=m.opacity,m.color&&p.diffuse.value.copy(m.color),m.emissive&&p.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(p.map.value=m.map),m.alphaMap&&(p.alphaMap.value=m.alphaMap),m.bumpMap&&(p.bumpMap.value=m.bumpMap,p.bumpScale.value=m.bumpScale,1===m.side&&(p.bumpScale.value*=-1)),m.displacementMap&&(p.displacementMap.value=m.displacementMap,p.displacementScale.value=m.displacementScale,p.displacementBias.value=m.displacementBias),m.emissiveMap&&(p.emissiveMap.value=m.emissiveMap),m.normalMap&&(p.normalMap.value=m.normalMap,p.normalScale.value.copy(m.normalScale),1===m.side&&p.normalScale.value.negate()),m.specularMap&&(p.specularMap.value=m.specularMap),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest);const y=e.get(m).envMap;if(y&&(p.envMap.value=y,p.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,p.reflectivity.value=m.reflectivity,p.ior.value=m.ior,p.refractionRatio.value=m.refractionRatio),m.lightMap){p.lightMap.value=m.lightMap;const b=!0!==n.physicallyCorrectLights?Math.PI:1;p.lightMapIntensity.value=m.lightMapIntensity*b}let _,v;m.aoMap&&(p.aoMap.value=m.aoMap,p.aoMapIntensity.value=m.aoMapIntensity),m.map?_=m.map:m.specularMap?_=m.specularMap:m.displacementMap?_=m.displacementMap:m.normalMap?_=m.normalMap:m.bumpMap?_=m.bumpMap:m.roughnessMap?_=m.roughnessMap:m.metalnessMap?_=m.metalnessMap:m.alphaMap?_=m.alphaMap:m.emissiveMap?_=m.emissiveMap:m.clearcoatMap?_=m.clearcoatMap:m.clearcoatNormalMap?_=m.clearcoatNormalMap:m.clearcoatRoughnessMap?_=m.clearcoatRoughnessMap:m.specularIntensityMap?_=m.specularIntensityMap:m.specularColorMap?_=m.specularColorMap:m.transmissionMap?_=m.transmissionMap:m.thicknessMap?_=m.thicknessMap:m.sheenColorMap?_=m.sheenColorMap:m.sheenRoughnessMap&&(_=m.sheenRoughnessMap),void 0!==_&&(_.isWebGLRenderTarget&&(_=_.texture),!0===_.matrixAutoUpdate&&_.updateMatrix(),p.uvTransform.value.copy(_.matrix)),m.aoMap?v=m.aoMap:m.lightMap&&(v=m.lightMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),p.uv2Transform.value.copy(v.matrix))}return{refreshFogUniforms:function t(p,m){p.fogColor.value.copy(m.color),m.isFog?(p.fogNear.value=m.near,p.fogFar.value=m.far):m.isFogExp2&&(p.fogDensity.value=m.density)},refreshMaterialUniforms:function i(p,m,y,_,v){m.isMeshBasicMaterial||m.isMeshLambertMaterial?r(p,m):m.isMeshToonMaterial?(r(p,m),function u(p,m){m.gradientMap&&(p.gradientMap.value=m.gradientMap)}(p,m)):m.isMeshPhongMaterial?(r(p,m),function c(p,m){p.specular.value.copy(m.specular),p.shininess.value=Math.max(m.shininess,1e-4)}(p,m)):m.isMeshStandardMaterial?(r(p,m),function d(p,m){p.roughness.value=m.roughness,p.metalness.value=m.metalness,m.roughnessMap&&(p.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(p.metalnessMap.value=m.metalnessMap),e.get(m).envMap&&(p.envMapIntensity.value=m.envMapIntensity)}(p,m),m.isMeshPhysicalMaterial&&function h(p,m,y){p.ior.value=m.ior,m.sheen>0&&(p.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),p.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(p.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(p.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(p.clearcoat.value=m.clearcoat,p.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(p.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(p.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),p.clearcoatNormalMap.value=m.clearcoatNormalMap,1===m.side&&p.clearcoatNormalScale.value.negate())),m.transmission>0&&(p.transmission.value=m.transmission,p.transmissionSamplerMap.value=y.texture,p.transmissionSamplerSize.value.set(y.width,y.height),m.transmissionMap&&(p.transmissionMap.value=m.transmissionMap),p.thickness.value=m.thickness,m.thicknessMap&&(p.thicknessMap.value=m.thicknessMap),p.attenuationDistance.value=m.attenuationDistance,p.attenuationColor.value.copy(m.attenuationColor)),p.specularIntensity.value=m.specularIntensity,p.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(p.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(p.specularColorMap.value=m.specularColorMap)}(p,m,v)):m.isMeshMatcapMaterial?(r(p,m),function f(p,m){m.matcap&&(p.matcap.value=m.matcap)}(p,m)):m.isMeshDepthMaterial?r(p,m):m.isMeshDistanceMaterial?(r(p,m),function g(p,m){p.referencePosition.value.copy(m.referencePosition),p.nearDistance.value=m.nearDistance,p.farDistance.value=m.farDistance}(p,m)):m.isMeshNormalMaterial?r(p,m):m.isLineBasicMaterial?(function o(p,m){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity}(p,m),m.isLineDashedMaterial&&function s(p,m){p.dashSize.value=m.dashSize,p.totalSize.value=m.dashSize+m.gapSize,p.scale.value=m.scale}(p,m)):m.isPointsMaterial?function a(p,m,y,_){let v;p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.size.value=m.size*y,p.scale.value=.5*_,m.map&&(p.map.value=m.map),m.alphaMap&&(p.alphaMap.value=m.alphaMap),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest),m.map?v=m.map:m.alphaMap&&(v=m.alphaMap),void 0!==v&&(!0===v.matrixAutoUpdate&&v.updateMatrix(),p.uvTransform.value.copy(v.matrix))}(p,m,y,_):m.isSpriteMaterial?function l(p,m){let y;p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.rotation.value=m.rotation,m.map&&(p.map.value=m.map),m.alphaMap&&(p.alphaMap.value=m.alphaMap),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest),m.map?y=m.map:m.alphaMap&&(y=m.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),p.uvTransform.value.copy(y.matrix))}(p,m):m.isShadowMaterial?(p.color.value.copy(m.color),p.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}}}function fn(n={}){const e=void 0!==n.canvas?n.canvas:function SY(){const n=Lh("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,o=void 0!==n.antialias&&n.antialias,s=void 0===n.premultipliedAlpha||n.premultipliedAlpha,a=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,l=void 0!==n.powerPreference?n.powerPreference:"default",c=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let u;u=void 0!==n.context?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let d=null,h=null;const f=[],g=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Ns,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const p=this;let m=!1,y=0,_=0,v=null,b=-1,w=null;const D=new Zt,C=new Zt;let T=null,G=e.width,O=e.height,x=1,N=null,q=null;const L=new Zt(0,0,G,O),j=new Zt(0,0,G,O);let z=!1;const $=new _m;let U=!1,X=!1,ee=null;const se=new ye,ie=new re,Ae=new M,Le={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ie(){return null===v?x:1}let ze,Qe,_e,it,ne,oe,fe,Be,Ee,rt,Ke,qe,jt,Ht,P,E,J,de,Me,Oe,We,I,pe,te=t;function pt(R,Z){for(let Q=0;Q<R.length;Q++){const ae=e.getContext(R[Q],Z);if(null!==ae)return ae}return null}try{const R={alpha:!0,depth:i,stencil:r,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r139"),e.addEventListener("webglcontextlost",V,!1),e.addEventListener("webglcontextrestored",xe,!1),null===te){const Z=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&Z.shift(),te=pt(Z,R),null===te)throw pt(Z)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===te.getShaderPrecisionFormat&&(te.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(R){throw console.error("THREE.WebGLRenderer: "+R.message),R}function Ge(){ze=new G9(te),Qe=new L9(te,ze,n),ze.init(Qe),I=new wY(te,ze,Qe),_e=new vY(te,ze,Qe),it=new $9(te),ne=new lY,oe=new bY(te,ze,_e,ne,Qe,I,it),fe=new V9(p),Be=new z9(p),Ee=new B$(te,Qe),pe=new F9(te,ze,Ee,Qe),rt=new j9(te,Ee,it,pe),Ke=new X9(te,rt,Ee,it),Me=new Z9(te,Qe,oe),E=new B9(ne),qe=new aY(p,fe,Be,ze,Qe,pe,E),jt=new DY(p,ne),Ht=new uY,P=new mY(ze,Qe),de=new O9(p,fe,_e,Ke,u,s),J=new oN(p,Ke,Qe),Oe=new k9(te,ze,it,Qe),We=new W9(te,ze,it,Qe),it.programs=qe.programs,p.capabilities=Qe,p.extensions=ze,p.properties=ne,p.renderLists=Ht,p.shadowMap=J,p.state=_e,p.info=it}Ge();const De=new MY(p,te);function V(R){R.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function xe(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;const R=it.autoReset,Z=J.enabled,Q=J.autoUpdate,K=J.needsUpdate,ae=J.type;Ge(),it.autoReset=R,J.enabled=Z,J.autoUpdate=Q,J.needsUpdate=K,J.type=ae}function be(R){const Z=R.target;Z.removeEventListener("dispose",be),function tt(R){(function Pe(R){const Z=ne.get(R).programs;void 0!==Z&&(Z.forEach(function(Q){qe.releaseProgram(Q)}),R.isShaderMaterial&&qe.releaseShaderCache(R))})(R),ne.remove(R)}(Z)}this.xr=De,this.getContext=function(){return te},this.getContextAttributes=function(){return te.getContextAttributes()},this.forceContextLoss=function(){const R=ze.get("WEBGL_lose_context");R&&R.loseContext()},this.forceContextRestore=function(){const R=ze.get("WEBGL_lose_context");R&&R.restoreContext()},this.getPixelRatio=function(){return x},this.setPixelRatio=function(R){void 0!==R&&(x=R,this.setSize(G,O,!1))},this.getSize=function(R){return R.set(G,O)},this.setSize=function(R,Z,Q){De.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(G=R,O=Z,e.width=Math.floor(R*x),e.height=Math.floor(Z*x),!1!==Q&&(e.style.width=R+"px",e.style.height=Z+"px"),this.setViewport(0,0,R,Z))},this.getDrawingBufferSize=function(R){return R.set(G*x,O*x).floor()},this.setDrawingBufferSize=function(R,Z,Q){G=R,O=Z,x=Q,e.width=Math.floor(R*Q),e.height=Math.floor(Z*Q),this.setViewport(0,0,R,Z)},this.getCurrentViewport=function(R){return R.copy(D)},this.getViewport=function(R){return R.copy(L)},this.setViewport=function(R,Z,Q,K){R.isVector4?L.set(R.x,R.y,R.z,R.w):L.set(R,Z,Q,K),_e.viewport(D.copy(L).multiplyScalar(x).floor())},this.getScissor=function(R){return R.copy(j)},this.setScissor=function(R,Z,Q,K){R.isVector4?j.set(R.x,R.y,R.z,R.w):j.set(R,Z,Q,K),_e.scissor(C.copy(j).multiplyScalar(x).floor())},this.getScissorTest=function(){return z},this.setScissorTest=function(R){_e.setScissorTest(z=R)},this.setOpaqueSort=function(R){N=R},this.setTransparentSort=function(R){q=R},this.getClearColor=function(R){return R.copy(de.getClearColor())},this.setClearColor=function(){de.setClearColor.apply(de,arguments)},this.getClearAlpha=function(){return de.getClearAlpha()},this.setClearAlpha=function(){de.setClearAlpha.apply(de,arguments)},this.clear=function(R=!0,Z=!0,Q=!0){let K=0;R&&(K|=16384),Z&&(K|=256),Q&&(K|=1024),te.clear(K)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",V,!1),e.removeEventListener("webglcontextrestored",xe,!1),Ht.dispose(),P.dispose(),ne.dispose(),fe.dispose(),Be.dispose(),Ke.dispose(),pe.dispose(),qe.dispose(),De.dispose(),De.removeEventListener("sessionstart",mt),De.removeEventListener("sessionend",En),ee&&(ee.dispose(),ee=null),Wt.stop()},this.renderBufferDirect=function(R,Z,Q,K,ae,ct){null===Z&&(Z=Le);const bt=ae.isMesh&&ae.matrixWorld.determinant()<0,Tt=function Goe(R,Z,Q,K,ae){!0!==Z.isScene&&(Z=Le),oe.resetTextureUnits();const ct=Z.fog,Tt=null===v?p.outputEncoding:!0===v.isXRRenderTarget?v.texture.encoding:Ns,St=(K.isMeshStandardMaterial?Be:fe).get(K.envMap||(K.isMeshStandardMaterial?Z.environment:null)),cn=!0===K.vertexColors&&!!Q.attributes.color&&4===Q.attributes.color.itemSize,Xt=!!K.normalMap&&!!Q.attributes.tangent,Qt=!!Q.morphAttributes.position,jn=!!Q.morphAttributes.normal,ec=!!Q.morphAttributes.color,gd=K.toneMapped?p.toneMapping:0,md=Q.morphAttributes.position||Q.morphAttributes.normal||Q.morphAttributes.color,fs=void 0!==md?md.length:0,rn=ne.get(K),_d=h.state.lights;!0!==U||!0!==X&&R===w||E.setState(K,R,R===w&&K.id===b);let ci=!1;K.version===rn.__version?(rn.needsLights&&rn.lightsStateVersion!==_d.state.version||rn.outputEncoding!==Tt||ae.isInstancedMesh&&!1===rn.instancing||!ae.isInstancedMesh&&!0===rn.instancing||ae.isSkinnedMesh&&!1===rn.skinning||!ae.isSkinnedMesh&&!0===rn.skinning||rn.envMap!==St||K.fog&&rn.fog!==ct||void 0!==rn.numClippingPlanes&&(rn.numClippingPlanes!==E.numPlanes||rn.numIntersection!==E.numIntersection)||rn.vertexAlphas!==cn||rn.vertexTangents!==Xt||rn.morphTargets!==Qt||rn.morphNormals!==jn||rn.morphColors!==ec||rn.toneMapping!==gd||!0===Qe.isWebGL2&&rn.morphTargetsCount!==fs)&&(ci=!0):(ci=!0,rn.__version=K.version);let ps=rn.currentProgram;!0===ci&&(ps=Yx(K,Z,ae));let Ya=!1,Xf=!1,Zx=!1;const Zi=ps.getUniforms(),Kf=rn.uniforms;if(_e.useProgram(ps.program)&&(Ya=!0,Xf=!0,Zx=!0),K.id!==b&&(b=K.id,Xf=!0),Ya||w!==R){if(Zi.setValue(te,"projectionMatrix",R.projectionMatrix),Qe.logarithmicDepthBuffer&&Zi.setValue(te,"logDepthBufFC",2/(Math.log(R.far+1)/Math.LN2)),w!==R&&(w=R,Xf=!0,Zx=!0),K.isShaderMaterial||K.isMeshPhongMaterial||K.isMeshToonMaterial||K.isMeshStandardMaterial||K.envMap){const Uo=Zi.map.cameraPosition;void 0!==Uo&&Uo.setValue(te,Ae.setFromMatrixPosition(R.matrixWorld))}(K.isMeshPhongMaterial||K.isMeshToonMaterial||K.isMeshLambertMaterial||K.isMeshBasicMaterial||K.isMeshStandardMaterial||K.isShaderMaterial)&&Zi.setValue(te,"isOrthographic",!0===R.isOrthographicCamera),(K.isMeshPhongMaterial||K.isMeshToonMaterial||K.isMeshLambertMaterial||K.isMeshBasicMaterial||K.isMeshStandardMaterial||K.isShaderMaterial||K.isShadowMaterial||ae.isSkinnedMesh)&&Zi.setValue(te,"viewMatrix",R.matrixWorldInverse)}if(ae.isSkinnedMesh){Zi.setOptional(te,ae,"bindMatrix"),Zi.setOptional(te,ae,"bindMatrixInverse");const Uo=ae.skeleton;Uo&&(Qe.floatVertexTextures?(null===Uo.boneTexture&&Uo.computeBoneTexture(),Zi.setValue(te,"boneTexture",Uo.boneTexture,oe),Zi.setValue(te,"boneTextureSize",Uo.boneTextureSize)):Zi.setOptional(te,Uo,"boneMatrices"))}const Xx=Q.morphAttributes;return(void 0!==Xx.position||void 0!==Xx.normal||void 0!==Xx.color&&!0===Qe.isWebGL2)&&Me.update(ae,Q,K,ps),(Xf||rn.receiveShadow!==ae.receiveShadow)&&(rn.receiveShadow=ae.receiveShadow,Zi.setValue(te,"receiveShadow",ae.receiveShadow)),Xf&&(Zi.setValue(te,"toneMappingExposure",p.toneMappingExposure),rn.needsLights&&function joe(R,Z){R.ambientLightColor.needsUpdate=Z,R.lightProbe.needsUpdate=Z,R.directionalLights.needsUpdate=Z,R.directionalLightShadows.needsUpdate=Z,R.pointLights.needsUpdate=Z,R.pointLightShadows.needsUpdate=Z,R.spotLights.needsUpdate=Z,R.spotLightShadows.needsUpdate=Z,R.rectAreaLights.needsUpdate=Z,R.hemisphereLights.needsUpdate=Z}(Kf,Zx),ct&&K.fog&&jt.refreshFogUniforms(Kf,ct),jt.refreshMaterialUniforms(Kf,K,x,O,ee),Sa.upload(te,rn.uniformsList,Kf,oe)),K.isShaderMaterial&&!0===K.uniformsNeedUpdate&&(Sa.upload(te,rn.uniformsList,Kf,oe),K.uniformsNeedUpdate=!1),K.isSpriteMaterial&&Zi.setValue(te,"center",ae.center),Zi.setValue(te,"modelViewMatrix",ae.modelViewMatrix),Zi.setValue(te,"normalMatrix",ae.normalMatrix),Zi.setValue(te,"modelMatrix",ae.matrixWorld),ps}(R,Z,Q,K,ae);_e.setMaterial(K,bt);let St=Q.index;const cn=Q.attributes.position;if(null===St){if(void 0===cn||0===cn.count)return}else if(0===St.count)return;let Xt=1;!0===K.wireframe&&(St=rt.getWireframeAttribute(Q),Xt=2),pe.setup(ae,K,Tt,Q,St);let Qt,jn=Oe;null!==St&&(Qt=Ee.get(St),jn=We,jn.setIndex(Qt));const ec=null!==St?St.count:cn.count,gd=Q.drawRange.start*Xt,md=Q.drawRange.count*Xt,fs=null!==ct?ct.start*Xt:0,rn=null!==ct?ct.count*Xt:1/0,_d=Math.max(gd,fs),ci=Math.min(ec,gd+md,fs+rn)-1,ps=Math.max(0,ci-_d+1);if(0!==ps){if(ae.isMesh)!0===K.wireframe?(_e.setLineWidth(K.wireframeLinewidth*Ie()),jn.setMode(1)):jn.setMode(4);else if(ae.isLine){let Ya=K.linewidth;void 0===Ya&&(Ya=1),_e.setLineWidth(Ya*Ie()),jn.setMode(ae.isLineSegments?1:ae.isLineLoop?2:3)}else ae.isPoints?jn.setMode(0):ae.isSprite&&jn.setMode(4);if(ae.isInstancedMesh)jn.renderInstances(_d,ps,ae.count);else if(Q.isInstancedBufferGeometry){const Ya=Math.min(Q.instanceCount,Q._maxInstanceCount);jn.renderInstances(_d,ps,Ya)}else jn.render(_d,ps)}},this.compile=function(R,Z){h=P.get(R),h.init(),g.push(h),R.traverseVisible(function(Q){Q.isLight&&Q.layers.test(Z.layers)&&(h.pushLight(Q),Q.castShadow&&h.pushShadow(Q))}),h.setupLights(p.physicallyCorrectLights),R.traverse(function(Q){const K=Q.material;if(K)if(Array.isArray(K))for(let ae=0;ae<K.length;ae++)Yx(K[ae],R,Q);else Yx(K,R,Q)}),g.pop(),h=null};let $e=null;function mt(){Wt.stop()}function En(){Wt.start()}const Wt=new AR;function ds(R,Z,Q,K){if(!1===R.visible)return;if(R.layers.test(Z.layers))if(R.isGroup)Q=R.renderOrder;else if(R.isLOD)!0===R.autoUpdate&&R.update(Z);else if(R.isLight)h.pushLight(R),R.castShadow&&h.pushShadow(R);else if(R.isSprite){if(!R.frustumCulled||$.intersectsSprite(R)){K&&Ae.setFromMatrixPosition(R.matrixWorld).applyMatrix4(se);const bt=Ke.update(R),Tt=R.material;Tt.visible&&d.push(R,bt,Tt,Q,Ae.z,null)}}else if((R.isMesh||R.isLine||R.isPoints)&&(R.isSkinnedMesh&&R.skeleton.frame!==it.render.frame&&(R.skeleton.update(),R.skeleton.frame=it.render.frame),!R.frustumCulled||$.intersectsObject(R))){K&&Ae.setFromMatrixPosition(R.matrixWorld).applyMatrix4(se);const bt=Ke.update(R),Tt=R.material;if(Array.isArray(Tt)){const St=bt.groups;for(let cn=0,Xt=St.length;cn<Xt;cn++){const Qt=St[cn],jn=Tt[Qt.materialIndex];jn&&jn.visible&&d.push(R,bt,jn,Q,Ae.z,Qt)}}else Tt.visible&&d.push(R,bt,Tt,Q,Ae.z,null)}const ct=R.children;for(let bt=0,Tt=ct.length;bt<Tt;bt++)ds(ct[bt],Z,Q,K)}function hs(R,Z,Q,K){const ae=R.opaque,ct=R.transmissive,bt=R.transparent;h.setupLightsView(Q),ct.length>0&&function Uoe(R,Z,Q){const K=Qe.isWebGL2;null===ee&&(ee=new Pr(1,1,{generateMipmaps:!0,type:null!==I.convert(iu)?iu:bl,minFilter:1008,samples:K&&!0===o?4:0})),p.getDrawingBufferSize(ie),K?ee.setSize(ie.x,ie.y):ee.setSize(Yg(ie.x),Yg(ie.y));const ae=p.getRenderTarget();p.setRenderTarget(ee),p.clear();const ct=p.toneMapping;p.toneMapping=0,f0(R,Z,Q),p.toneMapping=ct,oe.updateMultisampleRenderTarget(ee),oe.updateRenderTargetMipmap(ee),p.setRenderTarget(ae)}(ae,Z,Q),K&&_e.viewport(D.copy(K)),ae.length>0&&f0(ae,Z,Q),ct.length>0&&f0(ct,Z,Q),bt.length>0&&f0(bt,Z,Q),_e.buffers.depth.setTest(!0),_e.buffers.depth.setMask(!0),_e.buffers.color.setMask(!0),_e.setPolygonOffset(!1)}function f0(R,Z,Q){const K=!0===Z.isScene?Z.overrideMaterial:null;for(let ae=0,ct=R.length;ae<ct;ae++){const bt=R[ae],Tt=bt.object,St=bt.geometry,cn=null===K?bt.material:K,Xt=bt.group;Tt.layers.test(Q.layers)&&zoe(Tt,Z,Q,St,cn,Xt)}}function zoe(R,Z,Q,K,ae,ct){R.onBeforeRender(p,Z,Q,K,ae,ct),R.modelViewMatrix.multiplyMatrices(Q.matrixWorldInverse,R.matrixWorld),R.normalMatrix.getNormalMatrix(R.modelViewMatrix),ae.onBeforeRender(p,Z,Q,K,R,ct),!0===ae.transparent&&2===ae.side?(ae.side=1,ae.needsUpdate=!0,p.renderBufferDirect(Q,Z,K,ae,R,ct),ae.side=0,ae.needsUpdate=!0,p.renderBufferDirect(Q,Z,K,ae,R,ct),ae.side=2):p.renderBufferDirect(Q,Z,K,ae,R,ct),R.onAfterRender(p,Z,Q,K,ae,ct)}function Yx(R,Z,Q){!0!==Z.isScene&&(Z=Le);const K=ne.get(R),ae=h.state.lights,bt=ae.state.version,Tt=qe.getParameters(R,ae.state,h.state.shadowsArray,Z,Q),St=qe.getProgramCacheKey(Tt);let cn=K.programs;K.environment=R.isMeshStandardMaterial?Z.environment:null,K.fog=Z.fog,K.envMap=(R.isMeshStandardMaterial?Be:fe).get(R.envMap||K.environment),void 0===cn&&(R.addEventListener("dispose",be),cn=new Map,K.programs=cn);let Xt=cn.get(St);if(void 0!==Xt){if(K.currentProgram===Xt&&K.lightsStateVersion===bt)return Hk(R,Tt),Xt}else Tt.uniforms=qe.getUniforms(R),R.onBuild(Q,Tt,p),R.onBeforeCompile(Tt,p),Xt=qe.acquireProgram(Tt,St),cn.set(St,Xt),K.uniforms=Tt.uniforms;const Qt=K.uniforms;(!R.isShaderMaterial&&!R.isRawShaderMaterial||!0===R.clipping)&&(Qt.clippingPlanes=E.uniform),Hk(R,Tt),K.needsLights=function Woe(R){return R.isMeshLambertMaterial||R.isMeshToonMaterial||R.isMeshPhongMaterial||R.isMeshStandardMaterial||R.isShadowMaterial||R.isShaderMaterial&&!0===R.lights}(R),K.lightsStateVersion=bt,K.needsLights&&(Qt.ambientLightColor.value=ae.state.ambient,Qt.lightProbe.value=ae.state.probe,Qt.directionalLights.value=ae.state.directional,Qt.directionalLightShadows.value=ae.state.directionalShadow,Qt.spotLights.value=ae.state.spot,Qt.spotLightShadows.value=ae.state.spotShadow,Qt.rectAreaLights.value=ae.state.rectArea,Qt.ltc_1.value=ae.state.rectAreaLTC1,Qt.ltc_2.value=ae.state.rectAreaLTC2,Qt.pointLights.value=ae.state.point,Qt.pointLightShadows.value=ae.state.pointShadow,Qt.hemisphereLights.value=ae.state.hemi,Qt.directionalShadowMap.value=ae.state.directionalShadowMap,Qt.directionalShadowMatrix.value=ae.state.directionalShadowMatrix,Qt.spotShadowMap.value=ae.state.spotShadowMap,Qt.spotShadowMatrix.value=ae.state.spotShadowMatrix,Qt.pointShadowMap.value=ae.state.pointShadowMap,Qt.pointShadowMatrix.value=ae.state.pointShadowMatrix);const jn=Xt.getUniforms(),ec=Sa.seqWithValue(jn.seq,Qt);return K.currentProgram=Xt,K.uniformsList=ec,Xt}function Hk(R,Z){const Q=ne.get(R);Q.outputEncoding=Z.outputEncoding,Q.instancing=Z.instancing,Q.skinning=Z.skinning,Q.morphTargets=Z.morphTargets,Q.morphNormals=Z.morphNormals,Q.morphColors=Z.morphColors,Q.morphTargetsCount=Z.morphTargetsCount,Q.numClippingPlanes=Z.numClippingPlanes,Q.numIntersection=Z.numClipIntersection,Q.vertexAlphas=Z.vertexAlphas,Q.vertexTangents=Z.vertexTangents,Q.toneMapping=Z.toneMapping}Wt.setAnimationLoop(function Se(R){$e&&$e(R)}),"undefined"!=typeof self&&Wt.setContext(self),this.setAnimationLoop=function(R){$e=R,De.setAnimationLoop(R),null===R?Wt.stop():Wt.start()},De.addEventListener("sessionstart",mt),De.addEventListener("sessionend",En),this.render=function(R,Z){if(void 0===Z||!0===Z.isCamera){if(!0!==m){if(!0===R.autoUpdate&&R.updateMatrixWorld(),null===Z.parent&&Z.updateMatrixWorld(),!0===De.enabled&&!0===De.isPresenting&&(!0===De.cameraAutoUpdate&&De.updateCamera(Z),Z=De.getCamera()),!0===R.isScene&&R.onBeforeRender(p,R,Z,v),h=P.get(R,g.length),h.init(),g.push(h),se.multiplyMatrices(Z.projectionMatrix,Z.matrixWorldInverse),$.setFromProjectionMatrix(se),X=this.localClippingEnabled,U=E.init(this.clippingPlanes,X,Z),d=Ht.get(R,f.length),d.init(),f.push(d),ds(R,Z,0,p.sortObjects),d.finish(),!0===p.sortObjects&&d.sort(N,q),!0===U&&E.beginShadows(),J.render(h.state.shadowsArray,R,Z),!0===U&&E.endShadows(),!0===this.info.autoReset&&this.info.reset(),de.render(d,R),h.setupLights(p.physicallyCorrectLights),Z.isArrayCamera){const K=Z.cameras;for(let ae=0,ct=K.length;ae<ct;ae++){const bt=K[ae];hs(d,R,bt,bt.viewport)}}else hs(d,R,Z);null!==v&&(oe.updateMultisampleRenderTarget(v),oe.updateRenderTargetMipmap(v)),!0===R.isScene&&R.onAfterRender(p,R,Z),pe.resetDefaultState(),b=-1,w=null,g.pop(),h=g.length>0?g[g.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return v},this.setRenderTargetTextures=function(R,Z,Q){ne.get(R.texture).__webglTexture=Z,ne.get(R.depthTexture).__webglTexture=Q;const K=ne.get(R);K.__hasExternalTextures=!0,K.__hasExternalTextures&&(K.__autoAllocateDepthBuffer=void 0===Q,K.__autoAllocateDepthBuffer||!0===ze.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),K.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(R,Z){const Q=ne.get(R);Q.__webglFramebuffer=Z,Q.__useDefaultFramebuffer=void 0===Z},this.setRenderTarget=function(R,Z=0,Q=0){v=R,y=Z,_=Q;let K=!0;if(R){const St=ne.get(R);void 0!==St.__useDefaultFramebuffer?(_e.bindFramebuffer(36160,null),K=!1):void 0===St.__webglFramebuffer?oe.setupRenderTarget(R):St.__hasExternalTextures&&oe.rebindTextures(R,ne.get(R.texture).__webglTexture,ne.get(R.depthTexture).__webglTexture)}let ae=null,ct=!1,bt=!1;if(R){const St=R.texture;(St.isData3DTexture||St.isDataArrayTexture)&&(bt=!0);const cn=ne.get(R).__webglFramebuffer;R.isWebGLCubeRenderTarget?(ae=cn[Z],ct=!0):ae=Qe.isWebGL2&&R.samples>0&&!1===oe.useMultisampledRTT(R)?ne.get(R).__webglMultisampledFramebuffer:cn,D.copy(R.viewport),C.copy(R.scissor),T=R.scissorTest}else D.copy(L).multiplyScalar(x).floor(),C.copy(j).multiplyScalar(x).floor(),T=z;if(_e.bindFramebuffer(36160,ae)&&Qe.drawBuffers&&K&&_e.drawBuffers(R,ae),_e.viewport(D),_e.scissor(C),_e.setScissorTest(T),ct){const St=ne.get(R.texture);te.framebufferTexture2D(36160,36064,34069+Z,St.__webglTexture,Q)}else if(bt){const St=ne.get(R.texture);te.framebufferTextureLayer(36160,36064,St.__webglTexture,Q||0,Z||0)}b=-1},this.readRenderTargetPixels=function(R,Z,Q,K,ae,ct,bt){if(!R||!R.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Tt=ne.get(R).__webglFramebuffer;if(R.isWebGLCubeRenderTarget&&void 0!==bt&&(Tt=Tt[bt]),Tt){_e.bindFramebuffer(36160,Tt);try{const St=R.texture,cn=St.format,Xt=St.type;if(cn!==to&&I.convert(cn)!==te.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Qt=Xt===iu&&(ze.has("EXT_color_buffer_half_float")||Qe.isWebGL2&&ze.has("EXT_color_buffer_float"));if(!(Xt===bl||I.convert(Xt)===te.getParameter(35738)||Xt===ma&&(Qe.isWebGL2||ze.has("OES_texture_float")||ze.has("WEBGL_color_buffer_float"))||Qt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Z>=0&&Z<=R.width-K&&Q>=0&&Q<=R.height-ae&&te.readPixels(Z,Q,K,ae,I.convert(cn),I.convert(Xt),ct)}finally{const St=null!==v?ne.get(v).__webglFramebuffer:null;_e.bindFramebuffer(36160,St)}}},this.copyFramebufferToTexture=function(R,Z,Q=0){if(!0!==Z.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const K=Math.pow(2,-Q),ae=Math.floor(Z.image.width*K),ct=Math.floor(Z.image.height*K);oe.setTexture2D(Z,0),te.copyTexSubImage2D(3553,Q,0,0,R.x,R.y,ae,ct),_e.unbindTexture()},this.copyTextureToTexture=function(R,Z,Q,K=0){const ae=Z.image.width,ct=Z.image.height,bt=I.convert(Q.format),Tt=I.convert(Q.type);oe.setTexture2D(Q,0),te.pixelStorei(37440,Q.flipY),te.pixelStorei(37441,Q.premultiplyAlpha),te.pixelStorei(3317,Q.unpackAlignment),Z.isDataTexture?te.texSubImage2D(3553,K,R.x,R.y,ae,ct,bt,Tt,Z.image.data):Z.isCompressedTexture?te.compressedTexSubImage2D(3553,K,R.x,R.y,Z.mipmaps[0].width,Z.mipmaps[0].height,bt,Z.mipmaps[0].data):te.texSubImage2D(3553,K,R.x,R.y,bt,Tt,Z.image),0===K&&Q.generateMipmaps&&te.generateMipmap(3553),_e.unbindTexture()},this.copyTextureToTexture3D=function(R,Z,Q,K,ae=0){if(p.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const ct=R.max.x-R.min.x+1,bt=R.max.y-R.min.y+1,Tt=R.max.z-R.min.z+1,St=I.convert(K.format),cn=I.convert(K.type);let Xt;if(K.isData3DTexture)oe.setTexture3D(K,0),Xt=32879;else{if(!K.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");oe.setTexture2DArray(K,0),Xt=35866}te.pixelStorei(37440,K.flipY),te.pixelStorei(37441,K.premultiplyAlpha),te.pixelStorei(3317,K.unpackAlignment);const Qt=te.getParameter(3314),jn=te.getParameter(32878),ec=te.getParameter(3316),gd=te.getParameter(3315),md=te.getParameter(32877),fs=Q.isCompressedTexture?Q.mipmaps[0]:Q.image;te.pixelStorei(3314,fs.width),te.pixelStorei(32878,fs.height),te.pixelStorei(3316,R.min.x),te.pixelStorei(3315,R.min.y),te.pixelStorei(32877,R.min.z),Q.isDataTexture||Q.isData3DTexture?te.texSubImage3D(Xt,ae,Z.x,Z.y,Z.z,ct,bt,Tt,St,cn,fs.data):Q.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),te.compressedTexSubImage3D(Xt,ae,Z.x,Z.y,Z.z,ct,bt,Tt,St,fs.data)):te.texSubImage3D(Xt,ae,Z.x,Z.y,Z.z,ct,bt,Tt,St,cn,fs),te.pixelStorei(3314,Qt),te.pixelStorei(32878,jn),te.pixelStorei(3316,ec),te.pixelStorei(3315,gd),te.pixelStorei(32877,md),0===ae&&K.generateMipmaps&&te.generateMipmap(Xt),_e.unbindTexture()},this.initTexture=function(R){oe.setTexture2D(R,0),_e.unbindTexture()},this.resetState=function(){y=0,_=0,v=null,_e.reset(),pe.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}fn.prototype.isWebGLRenderer=!0;class lN extends fn{}lN.prototype.isWebGL1Renderer=!0;class bm{constructor(e,t=25e-5){this.name="",this.color=new ve(e),this.density=t}clone(){return new bm(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}bm.prototype.isFogExp2=!0;class Au{constructor(e,t=1,i=1e3){this.name="",this.color=new ve(e),this.near=t,this.far=i}clone(){return new Au(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Au.prototype.isFog=!0;class Pl extends Dt{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}Pl.prototype.isScene=!0;class Iu{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Ph,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Nr()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Nr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Nr()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Iu.prototype.isInterleavedBuffer=!0;const or=new M;class Ol{constructor(e,t,i,r=!1){this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)or.fromBufferAttribute(this,t),or.applyMatrix4(e),this.setXYZ(t,or.x,or.y,or.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)or.fromBufferAttribute(this,t),or.applyNormalMatrix(e),this.setXYZ(t,or.x,or.y,or.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)or.fromBufferAttribute(this,t),or.transformDirection(e),this.setXYZ(t,or.x,or.y,or.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,i){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,o){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return new xn(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ol(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Ol.prototype.isInterleavedBufferAttribute=!0;class W1 extends Ln{constructor(e){super(),this.type="SpriteMaterial",this.color=new ve(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let Ru;W1.prototype.isSpriteMaterial=!0;const jh=new M,Nu=new M,Pu=new M,Ou=new re,Wh=new re,cN=new ye,wm=new M,$h=new M,xm=new M,uN=new re,$1=new re,dN=new re;function Mm(n,e,t,i,r,o){Ou.subVectors(n,t).addScalar(.5).multiply(i),void 0!==r?(Wh.x=o*Ou.x-r*Ou.y,Wh.y=r*Ou.x+o*Ou.y):Wh.copy(Ou),n.copy(e),n.x+=Wh.x,n.y+=Wh.y,n.applyMatrix4(cN)}(class hN extends Dt{constructor(e){if(super(),this.type="Sprite",void 0===Ru){Ru=new je;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Iu(t,5);Ru.setIndex([0,1,2,0,2,3]),Ru.setAttribute("position",new Ol(i,3,0,!1)),Ru.setAttribute("uv",new Ol(i,2,3,!1))}this.geometry=Ru,this.material=void 0!==e?e:new W1,this.center=new re(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Nu.setFromMatrixScale(this.matrixWorld),cN.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Pu.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Nu.multiplyScalar(-Pu.z);const i=this.material.rotation;let r,o;0!==i&&(o=Math.cos(i),r=Math.sin(i));const s=this.center;Mm(wm.set(-.5,-.5,0),Pu,s,Nu,r,o),Mm($h.set(.5,-.5,0),Pu,s,Nu,r,o),Mm(xm.set(.5,.5,0),Pu,s,Nu,r,o),uN.set(0,0),$1.set(1,0),dN.set(1,1);let a=e.ray.intersectTriangle(wm,$h,xm,!1,jh);if(null===a&&(Mm($h.set(-.5,.5,0),Pu,s,Nu,r,o),$1.set(0,1),a=e.ray.intersectTriangle(wm,xm,$h,!1,jh),null===a))return;const l=e.ray.origin.distanceTo(jh);l<e.near||l>e.far||t.push({distance:l,point:jh.clone(),uv:si.getUV(jh,wm,$h,xm,uN,$1,dN,new re),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const pN=new M,gN=new Zt,mN=new Zt,CY=new M,_N=new ye;class Sm extends we{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ye,this.bindMatrixInverse=new ye}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Zt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;gN.fromBufferAttribute(r.attributes.skinIndex,e),mN.fromBufferAttribute(r.attributes.skinWeight,e),pN.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const s=mN.getComponent(o);if(0!==s){const a=gN.getComponent(o);_N.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(CY.copy(pN).applyMatrix4(_N),s)}}return t.applyMatrix4(this.bindMatrixInverse)}}Sm.prototype.isSkinnedMesh=!0;class qh extends Dt{constructor(){super(),this.type="Bone"}}qh.prototype.isBone=!0;class Fu extends Di{constructor(e=null,t=1,i=1,r,o,s,a,l,c=gi,u=gi,d,h){super(null,s,a,l,c,u,r,o,d,h),this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Fu.prototype.isDataTexture=!0;const yN=new ye,TY=new ye;class Em{constructor(e=[],t=[]){this.uuid=Nr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new ye)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new ye;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let o=0,s=e.length;o<s;o++)yN.multiplyMatrices(e[o]?e[o].matrixWorld:TY,t[o]),yN.toArray(i,16*o);null!==r&&(r.needsUpdate=!0)}clone(){return new Em(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=fR(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Fu(t,e,e,to,ma);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const o=e.bones[i];let s=t[o];void 0===s&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),s=new qh),this.bones.push(s),this.boneInverses.push((new ye).fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,o=t.length;r<o;r++)e.bones.push(t[r].uuid),e.boneInverses.push(i[r].toArray());return e}}class ku extends xn{constructor(e,t,i,r=1){"number"==typeof i&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,i),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}ku.prototype.isInstancedBufferAttribute=!0;const vN=new ye,bN=new ye,Cm=[],Yh=new we;(class wN extends we{constructor(e,t,i){super(e,t),this.instanceMatrix=new ku(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Yh.geometry=this.geometry,Yh.material=this.material,void 0!==Yh.material)for(let o=0;o<r;o++){this.getMatrixAt(o,vN),bN.multiplyMatrices(i,vN),Yh.matrixWorld=bN,Yh.raycast(e,Cm);for(let s=0,a=Cm.length;s<a;s++){const l=Cm[s];l.instanceId=o,l.object=this,t.push(l)}Cm.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new ku(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class vi extends Ln{constructor(e){super(),this.type="LineBasicMaterial",this.color=new ve(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}vi.prototype.isLineBasicMaterial=!0;const xN=new M,MN=new M,DN=new ye,q1=new Il,Tm=new Al;class qi extends Dt{constructor(e=new je,t=new vi){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,o=t.count;r<o;r++)xN.fromBufferAttribute(t,r-1),MN.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=xN.distanceTo(MN);e.setAttribute("lineDistance",new Fe(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,s=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Tm.copy(i.boundingSphere),Tm.applyMatrix4(r),Tm.radius+=o,!1===e.ray.intersectsSphere(Tm))return;DN.copy(r).invert(),q1.copy(e.ray).applyMatrix4(DN);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new M,u=new M,d=new M,h=new M,f=this.isLineSegments?2:1;if(i.isBufferGeometry){const g=i.index,m=i.attributes.position;if(null!==g)for(let v=Math.max(0,s.start),b=Math.min(g.count,s.start+s.count)-1;v<b;v+=f){const w=g.getX(v),D=g.getX(v+1);if(c.fromBufferAttribute(m,w),u.fromBufferAttribute(m,D),q1.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const T=e.ray.origin.distanceTo(h);T<e.near||T>e.far||t.push({distance:T,point:d.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}else for(let v=Math.max(0,s.start),b=Math.min(m.count,s.start+s.count)-1;v<b;v+=f){if(c.fromBufferAttribute(m,v),u.fromBufferAttribute(m,v+1),q1.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const D=e.ray.origin.distanceTo(h);D<e.near||D>e.far||t.push({distance:D,point:d.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else i.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}qi.prototype.isLine=!0;const SN=new M,EN=new M;class Lu extends qi{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,o=t.count;r<o;r+=2)SN.fromBufferAttribute(t,r),EN.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+SN.distanceTo(EN);e.setAttribute("lineDistance",new Fe(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Lu.prototype.isLineSegments=!0;(class CN extends qi{constructor(e,t){super(e,t),this.type="LineLoop"}}).prototype.isLineLoop=!0;class Y1 extends Ln{constructor(e){super(),this.type="PointsMaterial",this.color=new ve(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Y1.prototype.isPointsMaterial=!0;const TN=new ye,Z1=new Il,Am=new Al,Im=new M;function IN(n,e,t,i,r,o,s){const a=Z1.distanceSqToPoint(n);if(a<t){const l=new M;Z1.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;o.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:s})}}(class AN extends Dt{constructor(e=new je,t=new Y1){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,s=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),Am.copy(i.boundingSphere),Am.applyMatrix4(r),Am.radius+=o,!1===e.ray.intersectsSphere(Am))return;TN.copy(r).invert(),Z1.copy(e.ray).applyMatrix4(TN);const a=o/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a;if(i.isBufferGeometry){const c=i.index,d=i.attributes.position;if(null!==c)for(let g=Math.max(0,s.start),p=Math.min(c.count,s.start+s.count);g<p;g++){const m=c.getX(g);Im.fromBufferAttribute(d,m),IN(Im,m,l,r,e,t,this)}else for(let g=Math.max(0,s.start),p=Math.min(d.count,s.start+s.count);g<p;g++)Im.fromBufferAttribute(d,g),IN(Im,g,l,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){const a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class AY extends Di{constructor(e,t,i,r,o,s,a,l,c){super(e,t,i,r,o,s,a,l,c),this.minFilter=void 0!==s?s:oi,this.magFilter=void 0!==o?o:oi,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function d(){u.needsUpdate=!0,e.requestVideoFrameCallback(d)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class IY extends Di{constructor(e,t,i){super({width:e,height:t}),this.format=i,this.magFilter=gi,this.minFilter=gi,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class RN extends Di{constructor(e,t,i,r,o,s,a,l,c,u,d,h){super(null,s,a,l,c,u,r,o,d,h),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class RY extends Di{constructor(e,t,i,r,o,s,a,l,c){super(e,t,i,r,o,s,a,l,c),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0;class Br{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),o=0;t.push(0);for(let s=1;s<=e;s++)i=this.getPoint(s/e),o+=i.distanceTo(r),t.push(o),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const o=i.length;let s;s=t||e*i[o-1];let c,a=0,l=o-1;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-s,c<0)a=r+1;else{if(!(c>0)){l=r;break}l=r-1}if(r=l,i[r]===s)return r/(o-1);const u=i[r];return(r+(s-u)/(i[r+1]-u))/(o-1)}getTangent(e,t){let r=e-1e-4,o=e+1e-4;r<0&&(r=0),o>1&&(o=1);const s=this.getPoint(r),a=this.getPoint(o),l=t||(s.isVector2?new re:new M);return l.copy(a).sub(s).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new M,r=[],o=[],s=[],a=new M,l=new ye;for(let f=0;f<=e;f++)r[f]=this.getTangentAt(f/e,new M);o[0]=new M,s[0]=new M;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),d=Math.abs(r[0].y),h=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),d<=c&&(c=d,i.set(0,1,0)),h<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),o[0].crossVectors(r[0],a),s[0].crossVectors(r[0],o[0]);for(let f=1;f<=e;f++){if(o[f]=o[f-1].clone(),s[f]=s[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const g=Math.acos(Zn(r[f-1].dot(r[f]),-1,1));o[f].applyMatrix4(l.makeRotationAxis(a,g))}s[f].crossVectors(r[f],o[f])}if(!0===t){let f=Math.acos(Zn(o[0].dot(o[e]),-1,1));f/=e,r[0].dot(a.crossVectors(o[0],o[e]))>0&&(f=-f);for(let g=1;g<=e;g++)o[g].applyMatrix4(l.makeRotationAxis(r[g],f*g)),s[g].crossVectors(r[g],o[g])}return{tangents:r,normals:o,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Rm extends Br{constructor(e=0,t=0,i=1,r=1,o=0,s=2*Math.PI,a=!1,l=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=s,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new re,r=2*Math.PI;let o=this.aEndAngle-this.aStartAngle;const s=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(o=s?0:r),!0===this.aClockwise&&!s&&(o===r?o=-r:o-=r);const a=this.aStartAngle+e*o;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=l-this.aX,f=c-this.aY;l=h*u-f*d+this.aX,c=h*d+f*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Rm.prototype.isEllipseCurve=!0;class NN extends Rm{constructor(e,t,i,r,o,s){super(e,t,i,i,r,o,s),this.type="ArcCurve"}}function X1(){let n=0,e=0,t=0,i=0;function r(o,s,a,l){n=o,e=a,t=-3*o+3*s-2*a-l,i=2*o-2*s+a+l}return{initCatmullRom:function(o,s,a,l,c){r(s,a,c*(a-o),c*(l-s))},initNonuniformCatmullRom:function(o,s,a,l,c,u,d){let h=(s-o)/c-(a-o)/(c+u)+(a-s)/u,f=(a-s)/u-(l-s)/(u+d)+(l-a)/d;h*=u,f*=u,r(s,a,h,f)},calc:function(o){const s=o*o;return n+e*o+t*s+i*(s*o)}}}NN.prototype.isArcCurve=!0;const Nm=new M,K1=new X1,J1=new X1,Q1=new X1;class PN extends Br{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new M){const i=t,r=this.points,o=r.length,s=(o-(this.closed?0:1))*e;let c,u,a=Math.floor(s),l=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/o)+1)*o:0===l&&a===o-1&&(a=o-2,l=1),this.closed||a>0?c=r[(a-1)%o]:(Nm.subVectors(r[0],r[1]).add(r[0]),c=Nm);const d=r[a%o],h=r[(a+1)%o];if(this.closed||a+2<o?u=r[(a+2)%o]:(Nm.subVectors(r[o-1],r[o-2]).add(r[o-1]),u=Nm),"centripetal"===this.curveType||"chordal"===this.curveType){const f="chordal"===this.curveType?.5:.25;let g=Math.pow(c.distanceToSquared(d),f),p=Math.pow(d.distanceToSquared(h),f),m=Math.pow(h.distanceToSquared(u),f);p<1e-4&&(p=1),g<1e-4&&(g=p),m<1e-4&&(m=p),K1.initNonuniformCatmullRom(c.x,d.x,h.x,u.x,g,p,m),J1.initNonuniformCatmullRom(c.y,d.y,h.y,u.y,g,p,m),Q1.initNonuniformCatmullRom(c.z,d.z,h.z,u.z,g,p,m)}else"catmullrom"===this.curveType&&(K1.initCatmullRom(c.x,d.x,h.x,u.x,this.tension),J1.initCatmullRom(c.y,d.y,h.y,u.y,this.tension),Q1.initCatmullRom(c.z,d.z,h.z,u.z,this.tension));return i.set(K1.calc(l),J1.calc(l),Q1.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new M).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function ON(n,e,t,i,r){const o=.5*(i-e),s=.5*(r-t),a=n*n;return(2*t-2*i+o+s)*(n*a)+(-3*t+3*i-2*o-s)*a+o*n+t}function Zh(n,e,t,i){return function NY(n,e){const t=1-n;return t*t*e}(n,e)+function PY(n,e){return 2*(1-n)*n*e}(n,t)+function OY(n,e){return n*n*e}(n,i)}function Xh(n,e,t,i,r){return function FY(n,e){const t=1-n;return t*t*t*e}(n,e)+function kY(n,e){const t=1-n;return 3*t*t*n*e}(n,t)+function LY(n,e){return 3*(1-n)*n*n*e}(n,i)+function BY(n,e){return n*n*n*e}(n,r)}PN.prototype.isCatmullRomCurve3=!0;class ew extends Br{constructor(e=new re,t=new re,i=new re,r=new re){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new re){const i=t,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return i.set(Xh(e,r.x,o.x,s.x,a.x),Xh(e,r.y,o.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}ew.prototype.isCubicBezierCurve=!0;class FN extends Br{constructor(e=new M,t=new M,i=new M,r=new M){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new M){const i=t,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return i.set(Xh(e,r.x,o.x,s.x,a.x),Xh(e,r.y,o.y,s.y,a.y),Xh(e,r.z,o.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}FN.prototype.isCubicBezierCurve3=!0;class Pm extends Br{constructor(e=new re,t=new re){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new re){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const i=t||new re;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Pm.prototype.isLineCurve=!0;class tw extends Br{constructor(e=new re,t=new re,i=new re){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new re){const i=t,r=this.v0,o=this.v1,s=this.v2;return i.set(Zh(e,r.x,o.x,s.x),Zh(e,r.y,o.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}tw.prototype.isQuadraticBezierCurve=!0;class nw extends Br{constructor(e=new M,t=new M,i=new M){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new M){const i=t,r=this.v0,o=this.v1,s=this.v2;return i.set(Zh(e,r.x,o.x,s.x),Zh(e,r.y,o.y,s.y),Zh(e,r.z,o.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}nw.prototype.isQuadraticBezierCurve3=!0;class iw extends Br{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new re){const i=t,r=this.points,o=(r.length-1)*e,s=Math.floor(o),a=o-s,l=r[0===s?s:s-1],c=r[s],u=r[s>r.length-2?r.length-1:s+1],d=r[s>r.length-3?r.length-1:s+2];return i.set(ON(a,l.x,c.x,u.x,d.x),ON(a,l.y,c.y,u.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++)this.points.push(e.points[t].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++)e.points.push(this.points[t].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push((new re).fromArray(r))}return this}}iw.prototype.isSplineCurve=!0;var rw=Object.freeze({__proto__:null,ArcCurve:NN,CatmullRomCurve3:PN,CubicBezierCurve:ew,CubicBezierCurve3:FN,EllipseCurve:Rm,LineCurve:Pm,LineCurve3:class VY extends Br{constructor(e=new M,t=new M){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new M){const i=t;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:tw,QuadraticBezierCurve3:nw,SplineCurve:iw});class HY extends Br{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Pm(t,e))}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let o=0;for(;o<r.length;){if(r[o]>=i){const s=r[o]-i,a=this.curves[o],l=a.getLength();return a.getPointAt(0===l?0:1-s/l,t)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,o=this.curves;r<o.length;r++){const s=o[r],l=s.getPoints(s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++)this.curves.push(e.curves[t].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++)e.curves.push(this.curves[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push((new rw[r.type]).fromJSON(r))}return this}}class Kh extends HY{constructor(e){super(),this.type="Path",this.currentPoint=new re,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new Pm(this.currentPoint.clone(),new re(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const o=new tw(this.currentPoint.clone(),new re(e,t),new re(i,r));return this.curves.push(o),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,o,s){const a=new ew(this.currentPoint.clone(),new re(e,t),new re(i,r),new re(o,s));return this.curves.push(a),this.currentPoint.set(o,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new iw(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,o,s){return this.absarc(e+this.currentPoint.x,t+this.currentPoint.y,i,r,o,s),this}absarc(e,t,i,r,o,s){return this.absellipse(e,t,i,i,r,o,s),this}ellipse(e,t,i,r,o,s,a,l){return this.absellipse(e+this.currentPoint.x,t+this.currentPoint.y,i,r,o,s,a,l),this}absellipse(e,t,i,r,o,s,a,l){const c=new Rm(e,t,i,r,o,s,a,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class li extends je{constructor(e=1,t=1,i=1,r=8,o=1,s=!1,a=0,l=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:o,openEnded:s,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),o=Math.floor(o);const u=[],d=[],h=[],f=[];let g=0;const p=[],m=i/2;let y=0;function v(b){const w=g,D=new re,C=new M;let T=0;const G=!0===b?e:t,O=!0===b?1:-1;for(let N=1;N<=r;N++)d.push(0,m*O,0),h.push(0,O,0),f.push(.5,.5),g++;const x=g;for(let N=0;N<=r;N++){const L=N/r*l+a,j=Math.cos(L),z=Math.sin(L);C.x=G*z,C.y=m*O,C.z=G*j,d.push(C.x,C.y,C.z),h.push(0,O,0),D.x=.5*j+.5,D.y=.5*z*O+.5,f.push(D.x,D.y),g++}for(let N=0;N<r;N++){const q=w+N,L=x+N;!0===b?u.push(L,L+1,q):u.push(L+1,L,q),T+=3}c.addGroup(y,T,!0===b?1:2),y+=T}(function _(){const b=new M,w=new M;let D=0;const C=(t-e)/i;for(let T=0;T<=o;T++){const G=[],O=T/o,x=O*(t-e)+e;for(let N=0;N<=r;N++){const q=N/r,L=q*l+a,j=Math.sin(L),z=Math.cos(L);w.x=x*j,w.y=-O*i+m,w.z=x*z,d.push(w.x,w.y,w.z),b.set(j,C,z).normalize(),h.push(b.x,b.y,b.z),f.push(q,1-O),G.push(g++)}p.push(G)}for(let T=0;T<r;T++)for(let G=0;G<o;G++){const x=p[G+1][T],N=p[G+1][T+1],q=p[G][T+1];u.push(p[G][T],x,q),u.push(x,N,q),D+=6}c.addGroup(y,D,0),y+=D})(),!1===s&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new Fe(d,3)),this.setAttribute("normal",new Fe(h,3)),this.setAttribute("uv",new Fe(f,2))}static fromJSON(e){return new li(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ca extends je{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const o=[],s=[];function l(_,v,b,w){const D=w+1,C=[];for(let T=0;T<=D;T++){C[T]=[];const G=_.clone().lerp(b,T/D),O=v.clone().lerp(b,T/D),x=D-T;for(let N=0;N<=x;N++)C[T][N]=0===N&&T===D?G:G.clone().lerp(O,N/x)}for(let T=0;T<D;T++)for(let G=0;G<2*(D-T)-1;G++){const O=Math.floor(G/2);G%2==0?(h(C[T][O+1]),h(C[T+1][O]),h(C[T][O])):(h(C[T][O+1]),h(C[T+1][O+1]),h(C[T+1][O]))}}function h(_){o.push(_.x,_.y,_.z)}function f(_,v){const b=3*_;v.x=e[b+0],v.y=e[b+1],v.z=e[b+2]}function p(_,v,b,w){w<0&&1===_.x&&(s[v]=_.x-1),0===b.x&&0===b.z&&(s[v]=w/2/Math.PI+.5)}function m(_){return Math.atan2(_.z,-_.x)}function y(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}(function a(_){const v=new M,b=new M,w=new M;for(let D=0;D<t.length;D+=3)f(t[D+0],v),f(t[D+1],b),f(t[D+2],w),l(v,b,w,_)})(r),function c(_){const v=new M;for(let b=0;b<o.length;b+=3)v.x=o[b+0],v.y=o[b+1],v.z=o[b+2],v.normalize().multiplyScalar(_),o[b+0]=v.x,o[b+1]=v.y,o[b+2]=v.z}(i),function u(){const _=new M;for(let v=0;v<o.length;v+=3){_.x=o[v+0],_.y=o[v+1],_.z=o[v+2];const b=m(_)/2/Math.PI+.5,w=y(_)/Math.PI+.5;s.push(b,1-w)}(function g(){const _=new M,v=new M,b=new M,w=new M,D=new re,C=new re,T=new re;for(let G=0,O=0;G<o.length;G+=9,O+=6){_.set(o[G+0],o[G+1],o[G+2]),v.set(o[G+3],o[G+4],o[G+5]),b.set(o[G+6],o[G+7],o[G+8]),D.set(s[O+0],s[O+1]),C.set(s[O+2],s[O+3]),T.set(s[O+4],s[O+5]),w.copy(_).add(v).add(b).divideScalar(3);const x=m(w);p(D,O+0,_,x),p(C,O+2,v,x),p(T,O+4,b,x)}})(),function d(){for(let _=0;_<s.length;_+=6){const v=s[_+0],b=s[_+2],w=s[_+4],D=Math.max(v,b,w),C=Math.min(v,b,w);D>.9&&C<.1&&(v<.2&&(s[_+0]+=1),b<.2&&(s[_+2]+=1),w<.2&&(s[_+4]+=1))}}()}(),this.setAttribute("position",new Fe(o,3)),this.setAttribute("normal",new Fe(o.slice(),3)),this.setAttribute("uv",new Fe(s,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new Ca(e.vertices,e.indices,e.radius,e.details)}}new M,new M,new M,new si;class Hs extends Kh{constructor(e){super(e),this.uuid=Nr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++)this.holes.push(e.holes[t].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++)e.holes.push(this.holes[t].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push((new Kh).fromJSON(r))}return this}}function LN(n,e,t,i,r){let o,s;if(r===function iZ(n,e,t,i){let r=0;for(let o=e,s=t-i;o<t;o+=i)r+=(n[s]-n[o])*(n[o+1]+n[s+1]),s=o;return r}(n,e,t,i)>0)for(o=e;o<t;o+=i)s=HN(o,n[o],n[o+1],s);else for(o=t-i;o>=e;o-=i)s=HN(o,n[o],n[o+1],s);return s&&Um(s,s.next)&&(tf(s),s=s.next),s}function Ta(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!Um(t,t.next)&&0!==Bn(t.prev,t,t.next))t=t.next;else{if(tf(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function Qh(n,e,t,i,r,o,s){if(!n)return;!s&&o&&function KY(n,e,t,i){let r=n;do{null===r.z&&(r.z=sw(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function JY(n){let e,t,i,r,o,s,a,l,c=1;do{for(t=n,n=null,o=null,s=0;t;){for(s++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:n=r,r.prevZ=o,o=r;t=i}o.nextZ=null,c*=2}while(s>1)}(r)}(n,i,r,o);let l,c,a=n;for(;n.prev!==n.next;)if(l=n.prev,c=n.next,o?GY(n,i,r,o):zY(n))e.push(l.i/t),e.push(n.i/t),e.push(c.i/t),tf(n),n=c.next,a=c.next;else if((n=c)===a){s?1===s?Qh(n=jY(Ta(n),e,t),e,t,i,r,o,2):2===s&&WY(n,e,t,i,r,o):Qh(Ta(n),e,t,i,r,o,1);break}}function zY(n){const e=n.prev,t=n,i=n.next;if(Bn(e,t,i)>=0)return!1;let r=n.next.next;for(;r!==n.prev;){if(Bu(e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y)&&Bn(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function GY(n,e,t,i){const r=n.prev,o=n,s=n.next;if(Bn(r,o,s)>=0)return!1;const c=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,u=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,d=sw(r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,e,t,i),h=sw(c,u,e,t,i);let f=n.prevZ,g=n.nextZ;for(;f&&f.z>=d&&g&&g.z<=h;){if(f!==n.prev&&f!==n.next&&Bu(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Bn(f.prev,f,f.next)>=0||(f=f.prevZ,g!==n.prev&&g!==n.next&&Bu(r.x,r.y,o.x,o.y,s.x,s.y,g.x,g.y)&&Bn(g.prev,g,g.next)>=0))return!1;g=g.nextZ}for(;f&&f.z>=d;){if(f!==n.prev&&f!==n.next&&Bu(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Bn(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;g&&g.z<=h;){if(g!==n.prev&&g!==n.next&&Bu(r.x,r.y,o.x,o.y,s.x,s.y,g.x,g.y)&&Bn(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function jY(n,e,t){let i=n;do{const r=i.prev,o=i.next.next;!Um(r,o)&&BN(r,i,i.next,o)&&ef(r,o)&&ef(o,r)&&(e.push(r.i/t),e.push(i.i/t),e.push(o.i/t),tf(i),tf(i.next),i=n=o),i=i.next}while(i!==n);return Ta(i)}function WY(n,e,t,i,r,o){let s=n;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&eZ(s,a)){let l=VN(s,a);return s=Ta(s,s.next),l=Ta(l,l.next),Qh(s,e,t,i,r,o),void Qh(l,e,t,i,r,o)}a=a.next}s=s.next}while(s!==n)}function qY(n,e){return n.x-e.x}function YY(n,e){if(e=function ZY(n,e){let t=e;const i=n.x,r=n.y;let s,o=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const h=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=i&&h>o){if(o=h,h===i){if(r===t.y)return t;if(r===t.next.y)return t.next}s=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!s)return null;if(i===o)return s;const a=s,l=s.x,c=s.y;let d,u=1/0;t=s;do{i>=t.x&&t.x>=l&&i!==t.x&&Bu(r<c?i:o,r,l,c,r<c?o:i,r,t.x,t.y)&&(d=Math.abs(r-t.y)/(i-t.x),ef(t,n)&&(d<u||d===u&&(t.x>s.x||t.x===s.x&&XY(s,t)))&&(s=t,u=d)),t=t.next}while(t!==a);return s}(n,e),e){const t=VN(e,n);Ta(e,e.next),Ta(t,t.next)}}function XY(n,e){return Bn(n.prev,n,e.prev)<0&&Bn(e.next,n,n.next)<0}function sw(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-t)*r)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function QY(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function Bu(n,e,t,i,r,o,s,a){return(r-s)*(e-a)-(n-s)*(o-a)>=0&&(n-s)*(i-a)-(t-s)*(e-a)>=0&&(t-s)*(o-a)-(r-s)*(i-a)>=0}function eZ(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function tZ(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&BN(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(ef(n,e)&&ef(e,n)&&function nZ(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,o=(n.y+e.y)/2;do{t.y>o!=t.next.y>o&&t.next.y!==t.y&&r<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(Bn(n.prev,n,e.prev)||Bn(n,e.prev,e))||Um(n,e)&&Bn(n.prev,n,n.next)>0&&Bn(e.prev,e,e.next)>0)}function Bn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Um(n,e){return n.x===e.x&&n.y===e.y}function BN(n,e,t,i){const r=Gm(Bn(n,e,t)),o=Gm(Bn(n,e,i)),s=Gm(Bn(t,i,n)),a=Gm(Bn(t,i,e));return!!(r!==o&&s!==a||0===r&&zm(n,t,e)||0===o&&zm(n,i,e)||0===s&&zm(t,n,i)||0===a&&zm(t,e,i))}function zm(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Gm(n){return n>0?1:n<0?-1:0}function ef(n,e){return Bn(n.prev,n,n.next)<0?Bn(n,e,n.next)>=0&&Bn(n,n.prev,e)>=0:Bn(n,e,n.prev)<0||Bn(n,n.next,e)<0}function VN(n,e){const t=new aw(n.i,n.x,n.y),i=new aw(e.i,e.x,e.y),r=n.next,o=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,o.next=i,i.prev=o,i}function HN(n,e,t,i){const r=new aw(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function tf(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function aw(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Us{static area(e){const t=e.length;let i=0;for(let r=t-1,o=0;o<t;r=o++)i+=e[r].x*e[o].y-e[o].x*e[r].y;return.5*i}static isClockWise(e){return Us.area(e)<0}static triangulateShape(e,t){const i=[],r=[],o=[];UN(e),zN(i,e);let s=e.length;t.forEach(UN);for(let l=0;l<t.length;l++)r.push(s),s+=t[l].length,zN(i,t[l]);const a=function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let o=LN(n,0,r,t,!0);const s=[];if(!o||o.next===o.prev)return s;let a,l,c,u,d,h,f;if(i&&(o=function $Y(n,e,t,i){const r=[];let o,s,a,l,c;for(o=0,s=e.length;o<s;o++)a=e[o]*i,l=o<s-1?e[o+1]*i:n.length,c=LN(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(QY(c));for(r.sort(qY),o=0;o<r.length;o++)YY(r[o],t),t=Ta(t,t.next);return t}(n,e,o,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let g=t;g<r;g+=t)d=n[g],h=n[g+1],d<a&&(a=d),h<l&&(l=h),d>c&&(c=d),h>u&&(u=h);f=Math.max(c-a,u-l),f=0!==f?1/f:0}return Qh(o,s,t,a,l,f),s}(i,r);for(let l=0;l<a.length;l+=3)o.push(a.slice(l,l+3));return o}}function UN(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function zN(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class Aa extends je{constructor(e=new Hs([new re(.5,.5),new re(-.5,.5),new re(-.5,-.5),new re(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],o=[];for(let a=0,l=e.length;a<l;a++)s(e[a]);function s(a){const l=[],c=void 0!==t.curveSegments?t.curveSegments:12,u=void 0!==t.steps?t.steps:1;let d=void 0!==t.depth?t.depth:1,h=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,g=void 0!==t.bevelSize?t.bevelSize:f-.1,p=void 0!==t.bevelOffset?t.bevelOffset:0,m=void 0!==t.bevelSegments?t.bevelSegments:3;const y=t.extrudePath,_=void 0!==t.UVGenerator?t.UVGenerator:rZ;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=t.amount);let v,w,D,C,T,b=!1;y&&(v=y.getSpacedPoints(u),b=!0,h=!1,w=y.computeFrenetFrames(u,!1),D=new M,C=new M,T=new M),h||(m=0,f=0,g=0,p=0);const G=a.extractPoints(c);let O=G.shape;const x=G.holes;if(!Us.isClockWise(O)){O=O.reverse();for(let ne=0,oe=x.length;ne<oe;ne++){const fe=x[ne];Us.isClockWise(fe)&&(x[ne]=fe.reverse())}}const q=Us.triangulateShape(O,x),L=O;for(let ne=0,oe=x.length;ne<oe;ne++)O=O.concat(x[ne]);function j(ne,oe,fe){return oe||console.error("THREE.ExtrudeGeometry: vec does not exist"),oe.clone().multiplyScalar(fe).add(ne)}const z=O.length,$=q.length;function U(ne,oe,fe){let Be,Ee,rt;const Ke=ne.x-oe.x,qe=ne.y-oe.y,jt=fe.x-ne.x,Ht=fe.y-ne.y,P=Ke*Ke+qe*qe;if(Math.abs(Ke*Ht-qe*jt)>Number.EPSILON){const J=Math.sqrt(P),de=Math.sqrt(jt*jt+Ht*Ht),Me=oe.x-qe/J,Oe=oe.y+Ke/J,pe=((fe.x-Ht/de-Me)*Ht-(fe.y+jt/de-Oe)*jt)/(Ke*Ht-qe*jt);Be=Me+Ke*pe-ne.x,Ee=Oe+qe*pe-ne.y;const Ge=Be*Be+Ee*Ee;if(Ge<=2)return new re(Be,Ee);rt=Math.sqrt(Ge/2)}else{let J=!1;Ke>Number.EPSILON?jt>Number.EPSILON&&(J=!0):Ke<-Number.EPSILON?jt<-Number.EPSILON&&(J=!0):Math.sign(qe)===Math.sign(Ht)&&(J=!0),J?(Be=-qe,Ee=Ke,rt=Math.sqrt(P)):(Be=Ke,Ee=qe,rt=Math.sqrt(P/2))}return new re(Be/rt,Ee/rt)}const X=[];for(let ne=0,oe=L.length,fe=oe-1,Be=ne+1;ne<oe;ne++,fe++,Be++)fe===oe&&(fe=0),Be===oe&&(Be=0),X[ne]=U(L[ne],L[fe],L[Be]);const ee=[];let se,ie=X.concat();for(let ne=0,oe=x.length;ne<oe;ne++){const fe=x[ne];se=[];for(let Be=0,Ee=fe.length,rt=Ee-1,Ke=Be+1;Be<Ee;Be++,rt++,Ke++)rt===Ee&&(rt=0),Ke===Ee&&(Ke=0),se[Be]=U(fe[Be],fe[rt],fe[Ke]);ee.push(se),ie=ie.concat(se)}for(let ne=0;ne<m;ne++){const oe=ne/m,fe=f*Math.cos(oe*Math.PI/2),Be=g*Math.sin(oe*Math.PI/2)+p;for(let Ee=0,rt=L.length;Ee<rt;Ee++){const Ke=j(L[Ee],X[Ee],Be);pt(Ke.x,Ke.y,-fe)}for(let Ee=0,rt=x.length;Ee<rt;Ee++){const Ke=x[Ee];se=ee[Ee];for(let qe=0,jt=Ke.length;qe<jt;qe++){const Ht=j(Ke[qe],se[qe],Be);pt(Ht.x,Ht.y,-fe)}}}const Ae=g+p;for(let ne=0;ne<z;ne++){const oe=h?j(O[ne],ie[ne],Ae):O[ne];b?(C.copy(w.normals[0]).multiplyScalar(oe.x),D.copy(w.binormals[0]).multiplyScalar(oe.y),T.copy(v[0]).add(C).add(D),pt(T.x,T.y,T.z)):pt(oe.x,oe.y,0)}for(let ne=1;ne<=u;ne++)for(let oe=0;oe<z;oe++){const fe=h?j(O[oe],ie[oe],Ae):O[oe];b?(C.copy(w.normals[ne]).multiplyScalar(fe.x),D.copy(w.binormals[ne]).multiplyScalar(fe.y),T.copy(v[ne]).add(C).add(D),pt(T.x,T.y,T.z)):pt(fe.x,fe.y,d/u*ne)}for(let ne=m-1;ne>=0;ne--){const oe=ne/m,fe=f*Math.cos(oe*Math.PI/2),Be=g*Math.sin(oe*Math.PI/2)+p;for(let Ee=0,rt=L.length;Ee<rt;Ee++){const Ke=j(L[Ee],X[Ee],Be);pt(Ke.x,Ke.y,d+fe)}for(let Ee=0,rt=x.length;Ee<rt;Ee++){const Ke=x[Ee];se=ee[Ee];for(let qe=0,jt=Ke.length;qe<jt;qe++){const Ht=j(Ke[qe],se[qe],Be);b?pt(Ht.x,Ht.y+v[u-1].y,v[u-1].x+fe):pt(Ht.x,Ht.y,d+fe)}}}function te(ne,oe){let fe=ne.length;for(;--fe>=0;){const Be=fe;let Ee=fe-1;Ee<0&&(Ee=ne.length-1);for(let rt=0,Ke=u+2*m;rt<Ke;rt++){const qe=z*rt,jt=z*(rt+1);Qe(oe+Be+qe,oe+Ee+qe,oe+Ee+jt,oe+Be+jt)}}}function pt(ne,oe,fe){l.push(ne),l.push(oe),l.push(fe)}function ze(ne,oe,fe){_e(ne),_e(oe),_e(fe);const Be=r.length/3,Ee=_.generateTopUV(i,r,Be-3,Be-2,Be-1);it(Ee[0]),it(Ee[1]),it(Ee[2])}function Qe(ne,oe,fe,Be){_e(ne),_e(oe),_e(Be),_e(oe),_e(fe),_e(Be);const Ee=r.length/3,rt=_.generateSideWallUV(i,r,Ee-6,Ee-3,Ee-2,Ee-1);it(rt[0]),it(rt[1]),it(rt[3]),it(rt[1]),it(rt[2]),it(rt[3])}function _e(ne){r.push(l[3*ne+0]),r.push(l[3*ne+1]),r.push(l[3*ne+2])}function it(ne){o.push(ne.x),o.push(ne.y)}(function Le(){const ne=r.length/3;if(h){let oe=0,fe=z*oe;for(let Be=0;Be<$;Be++){const Ee=q[Be];ze(Ee[2]+fe,Ee[1]+fe,Ee[0]+fe)}oe=u+2*m,fe=z*oe;for(let Be=0;Be<$;Be++){const Ee=q[Be];ze(Ee[0]+fe,Ee[1]+fe,Ee[2]+fe)}}else{for(let oe=0;oe<$;oe++){const fe=q[oe];ze(fe[2],fe[1],fe[0])}for(let oe=0;oe<$;oe++){const fe=q[oe];ze(fe[0]+z*u,fe[1]+z*u,fe[2]+z*u)}}i.addGroup(ne,r.length/3-ne,0)})(),function Ie(){const ne=r.length/3;let oe=0;te(L,oe),oe+=L.length;for(let fe=0,Be=x.length;fe<Be;fe++){const Ee=x[fe];te(Ee,oe),oe+=Ee.length}i.addGroup(ne,r.length/3-ne,1)}()}this.setAttribute("position",new Fe(r,3)),this.setAttribute("uv",new Fe(o,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function oZ(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++)t.shapes.push(n[i].uuid);else t.shapes.push(n.uuid);return void 0!==e.extrudePath&&(t.options.extrudePath=e.extrudePath.toJSON()),t}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const i=[];for(let o=0,s=e.shapes.length;o<s;o++)i.push(t[e.shapes[o]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new rw[r.type]).fromJSON(r)),new Aa(i,e.options)}}const rZ={generateTopUV:function(n,e,t,i,r){const a=e[3*i],l=e[3*i+1],c=e[3*r],u=e[3*r+1];return[new re(e[3*t],e[3*t+1]),new re(a,l),new re(c,u)]},generateSideWallUV:function(n,e,t,i,r,o){const s=e[3*t],a=e[3*t+1],l=e[3*t+2],c=e[3*i],u=e[3*i+1],d=e[3*i+2],h=e[3*r],f=e[3*r+1],g=e[3*r+2],p=e[3*o],m=e[3*o+1],y=e[3*o+2];return Math.abs(a-u)<Math.abs(s-c)?[new re(s,1-l),new re(c,1-d),new re(h,1-g),new re(p,1-y)]:[new re(a,1-l),new re(u,1-d),new re(f,1-g),new re(m,1-y)]}};class zs extends Ca{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new zs(e.radius,e.detail)}}class nf extends je{constructor(e=new Hs([new re(0,.5),new re(-.5,-.5),new re(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],o=[],s=[];let a=0,l=0;if(!1===Array.isArray(e))c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;function c(u){const d=r.length/3,h=u.extractPoints(t);let f=h.shape;const g=h.holes;!1===Us.isClockWise(f)&&(f=f.reverse());for(let m=0,y=g.length;m<y;m++){const _=g[m];!0===Us.isClockWise(_)&&(g[m]=_.reverse())}const p=Us.triangulateShape(f,g);for(let m=0,y=g.length;m<y;m++)f=f.concat(g[m]);for(let m=0,y=f.length;m<y;m++){const _=f[m];r.push(_.x,_.y,0),o.push(0,0,1),s.push(_.x,_.y)}for(let m=0,y=p.length;m<y;m++){const _=p[m];i.push(_[0]+d,_[1]+d,_[2]+d),l+=3}}this.setIndex(i),this.setAttribute("position",new Fe(r,3)),this.setAttribute("normal",new Fe(o,3)),this.setAttribute("uv",new Fe(s,2))}toJSON(){const e=super.toJSON();return function sZ(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++)e.shapes.push(n[t].uuid);else e.shapes.push(n.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,t){const i=[];for(let r=0,o=e.shapes.length;r<o;r++)i.push(t[e.shapes[r]]);return new nf(i,e.curveSegments)}}class Vu extends je{constructor(e=1,t=32,i=16,r=0,o=2*Math.PI,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:o,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(s+a,Math.PI);let c=0;const u=[],d=new M,h=new M,f=[],g=[],p=[],m=[];for(let y=0;y<=i;y++){const _=[],v=y/i;let b=0;0==y&&0==s?b=.5/t:y==i&&l==Math.PI&&(b=-.5/t);for(let w=0;w<=t;w++){const D=w/t;d.x=-e*Math.cos(r+D*o)*Math.sin(s+v*a),d.y=e*Math.cos(s+v*a),d.z=e*Math.sin(r+D*o)*Math.sin(s+v*a),g.push(d.x,d.y,d.z),h.copy(d).normalize(),p.push(h.x,h.y,h.z),m.push(D+b,1-v),_.push(c++)}u.push(_)}for(let y=0;y<i;y++)for(let _=0;_<t;_++){const v=u[y][_+1],b=u[y][_],w=u[y+1][_],D=u[y+1][_+1];(0!==y||s>0)&&f.push(v,b,D),(y!==i-1||l<Math.PI)&&f.push(b,w,D)}this.setIndex(f),this.setAttribute("position",new Fe(g,3)),this.setAttribute("normal",new Fe(p,3)),this.setAttribute("uv",new Fe(m,2))}static fromJSON(e){return new Vu(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Gs extends je{constructor(e=1,t=.4,i=8,r=6,o=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:o},i=Math.floor(i),r=Math.floor(r);const s=[],a=[],l=[],c=[],u=new M,d=new M,h=new M;for(let f=0;f<=i;f++)for(let g=0;g<=r;g++){const p=g/r*o,m=f/i*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(p),d.y=(e+t*Math.cos(m))*Math.sin(p),d.z=t*Math.sin(m),a.push(d.x,d.y,d.z),u.x=e*Math.cos(p),u.y=e*Math.sin(p),h.subVectors(d,u).normalize(),l.push(h.x,h.y,h.z),c.push(g/r),c.push(f/i)}for(let f=1;f<=i;f++)for(let g=1;g<=r;g++){const m=(r+1)*(f-1)+g-1,y=(r+1)*(f-1)+g,_=(r+1)*f+g;s.push((r+1)*f+g-1,m,_),s.push(m,y,_)}this.setIndex(s),this.setAttribute("position",new Fe(a,3)),this.setAttribute("normal",new Fe(l,3)),this.setAttribute("uv",new Fe(c,2))}static fromJSON(e){return new Gs(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class $N extends Ln{constructor(e){super(),this.type="ShadowMaterial",this.color=new ve(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}$N.prototype.isShadowMaterial=!0;class qN extends Io{constructor(e){super(e),this.type="RawShaderMaterial"}}qN.prototype.isRawShaderMaterial=!0;class lw extends Ln{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ve(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ve(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}lw.prototype.isMeshStandardMaterial=!0;class YN extends lw{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new re(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Zn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new ve(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new ve(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ve(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}YN.prototype.isMeshPhysicalMaterial=!0;class rf extends Ln{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new ve(16777215),this.specular=new ve(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ve(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}rf.prototype.isMeshPhongMaterial=!0;class ZN extends Ln{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ve(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ve(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}ZN.prototype.isMeshToonMaterial=!0;class XN extends Ln{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}XN.prototype.isMeshNormalMaterial=!0;class cw extends Ln{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new ve(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ve(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}cw.prototype.isMeshLambertMaterial=!0;class KN extends Ln{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ve(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new re(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}KN.prototype.isMeshMatcapMaterial=!0;class JN extends vi{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}JN.prototype.isLineDashedMaterial=!0;const aZ={ShadowMaterial:$N,SpriteMaterial:W1,RawShaderMaterial:qN,ShaderMaterial:Io,PointsMaterial:Y1,MeshPhysicalMaterial:YN,MeshStandardMaterial:lw,MeshPhongMaterial:rf,MeshToonMaterial:ZN,MeshNormalMaterial:XN,MeshLambertMaterial:cw,MeshDepthMaterial:z1,MeshDistanceMaterial:G1,MeshBasicMaterial:io,MeshMatcapMaterial:KN,LineDashedMaterial:JN,LineBasicMaterial:vi,Material:Ln};Ln.fromType=function(n){return new aZ[n]};const Rn={arraySlice:function(n,e,t){return Rn.isTypedArray(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)},convertArray:function(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)},isTypedArray:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)},getKeyframeOrder:function(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,o){return n[r]-n[o]}),i},sortedArray:function(n,e,t){const i=n.length,r=new n.constructor(i);for(let o=0,s=0;s!==i;++o){const a=t[o]*e;for(let l=0;l!==e;++l)r[s++]=n[a+l]}return r},flattenJSON:function(n,e,t,i){let r=1,o=n[0];for(;void 0!==o&&void 0===o[i];)o=n[r++];if(void 0===o)return;let s=o[i];if(void 0!==s)if(Array.isArray(s))do{s=o[i],void 0!==s&&(e.push(o.time),t.push.apply(t,s)),o=n[r++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[i],void 0!==s&&(e.push(o.time),s.toArray(t,t.length)),o=n[r++]}while(void 0!==o);else do{s=o[i],void 0!==s&&(e.push(o.time),t.push(s)),o=n[r++]}while(void 0!==o)},subclip:function(n,e,t,i,r=30){const o=n.clone();o.name=e;const s=[];for(let l=0;l<o.tracks.length;++l){const c=o.tracks[l],u=c.getValueSize(),d=[],h=[];for(let f=0;f<c.times.length;++f){const g=c.times[f]*r;if(!(g<t||g>=i)){d.push(c.times[f]);for(let p=0;p<u;++p)h.push(c.values[f*u+p])}}0!==d.length&&(c.times=Rn.convertArray(d,c.times.constructor),c.values=Rn.convertArray(h,c.values.constructor),s.push(c))}o.tracks=s;let a=1/0;for(let l=0;l<o.tracks.length;++l)a>o.tracks[l].times[0]&&(a=o.tracks[l].times[0]);for(let l=0;l<o.tracks.length;++l)o.tracks[l].shift(-1*a);return o.resetDuration(),o},makeClipAdditive:function(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,o=e/i;for(let s=0;s<r;++s){const a=t.tracks[s],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=n.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(void 0===c)continue;let u=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let h=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const g=a.times.length-1;let p;if(o<=a.times[0])p=Rn.arraySlice(a.values,u,d-u);else if(o>=a.times[g]){const y=g*d+u;p=Rn.arraySlice(a.values,y,y+d-u)}else{const y=a.createInterpolant(),_=u,v=d-u;y.evaluate(o),p=Rn.arraySlice(y.resultBuffer,_,v)}"quaternion"===l&&(new Jt).fromArray(p).normalize().conjugate().toArray(p);const m=c.times.length;for(let y=0;y<m;++y){const _=y*f+h;if("quaternion"===l)Jt.multiplyQuaternionsFlat(c.values,_,p,0,c.values,_);else{const v=f-2*h;for(let b=0;b<v;++b)c.values[_+b]-=p[b]}}}return n.blendMode=2501,n}};class Ia{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],o=t[i-1];e:{t:{let s;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,o)}if(i===a)break;if(o=r,r=t[++i],e<r)break t}s=t.length;break n}if(e>=o)break e;{const a=t[1];e<a&&(i=2,o=a);for(let l=i-2;;){if(void 0===o)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(i===l)break;if(r=o,o=t[--i-1],e>=o)break t}s=i,i=0}}for(;i<s;){const a=i+s>>>1;e<t[a]?s=a:i=a+1}if(r=t[i],o=t[i-1],void 0===o)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,o,e)}this._cachedIndex=i,this.intervalChanged_(i,o,r)}return this.interpolate_(i,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r;for(let s=0;s!==r;++s)t[s]=i[o+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Ia.prototype.beforeStart_=Ia.prototype.copySampleValue_,Ia.prototype.afterEnd_=Ia.prototype.copySampleValue_;class lZ extends Ia{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:su,endingEnd:su}}intervalChanged_(e,t,i){const r=this.parameterPositions;let o=e-2,s=e+1,a=r[o],l=r[s];if(void 0===a)switch(this.getSettings_().endingStart){case au:o=e,a=2*t-i;break;case 2402:o=r.length-2,a=t+r[o]-r[o+1];break;default:o=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case au:s=e,l=2*i-t;break;case 2402:s=1,l=i+r[1]-r[0];break;default:s=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=o*u,this._offsetNext=s*u}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,g=(i-t)/(r-t),p=g*g,m=p*g,y=-h*m+2*h*p-h*g,_=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*g+1,v=(-1-f)*m+(1.5+f)*p+.5*g,b=f*m-f*p;for(let w=0;w!==a;++w)o[w]=y*s[u+w]+_*s[c+w]+v*s[l+w]+b*s[d+w];return o}}class QN extends Ia{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)o[h]=s[c+h]*d+s[l+h]*u;return o}}class cZ extends Ia{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class is{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Rn.convertArray(t,this.TimeBufferType),this.values=Rn.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Rn.convertArray(e.times,Array),values:Rn.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new cZ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new QN(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new lZ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let o=0,s=r-1;for(;o!==r&&i[o]<e;)++o;for(;-1!==s&&i[s]>t;)--s;if(++s,0!==o||s!==r){o>=s&&(s=Math.max(s,1),o=s-1);const a=this.getValueSize();this.times=Rn.arraySlice(i,o,s),this.values=Rn.arraySlice(this.values,o*a,s*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,o=i.length;0===o&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==o;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==s&&s>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,s),e=!1;break}s=l}if(void 0!==r&&Rn.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Rn.arraySlice(this.times),t=Rn.arraySlice(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),o=e.length-1;let s=1;for(let a=1;a<o;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let g=0;g!==i;++g){const p=t[d+g];if(p!==t[h+g]||p!==t[f+g]){l=!0;break}}}if(l){if(a!==s){e[s]=e[a];const d=a*i,h=s*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++s}}if(o>0){e[s]=e[o];for(let a=o*i,l=s*i,c=0;c!==i;++c)t[l+c]=t[a+c];++s}return s!==e.length?(this.times=Rn.arraySlice(e,0,s),this.values=Rn.arraySlice(t,0,s*i)):(this.times=e,this.values=t),this}clone(){const e=Rn.arraySlice(this.times,0),t=Rn.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}is.prototype.TimeBufferType=Float32Array,is.prototype.ValueBufferType=Float32Array,is.prototype.DefaultInterpolation=2301;class Hu extends is{}Hu.prototype.ValueTypeName="bool",Hu.prototype.ValueBufferType=Array,Hu.prototype.DefaultInterpolation=2300,Hu.prototype.InterpolantFactoryMethodLinear=void 0,Hu.prototype.InterpolantFactoryMethodSmooth=void 0;class eP extends is{}eP.prototype.ValueTypeName="color";class sf extends is{}sf.prototype.ValueTypeName="number";class uZ extends Ia{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)Jt.slerpFlat(o,0,s,c-a,s,c,l);return o}}class Uu extends is{InterpolantFactoryMethodLinear(e){return new uZ(this.times,this.values,this.getValueSize(),e)}}Uu.prototype.ValueTypeName="quaternion",Uu.prototype.DefaultInterpolation=2301,Uu.prototype.InterpolantFactoryMethodSmooth=void 0;class zu extends is{}zu.prototype.ValueTypeName="string",zu.prototype.ValueBufferType=Array,zu.prototype.DefaultInterpolation=2300,zu.prototype.InterpolantFactoryMethodLinear=void 0,zu.prototype.InterpolantFactoryMethodSmooth=void 0;class af extends is{}af.prototype.ValueTypeName="vector";class Ra{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Nr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let s=0,a=i.length;s!==a;++s)t.push(hZ(i[s]).scale(r));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,s=i.length;o!==s;++o)t.push(is.toJSON(i[o]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const o=t.length,s=[];for(let a=0;a<o;a++){let l=[],c=[];l.push((a+o-1)%o,a,(a+1)%o),c.push(0,1,0);const u=Rn.getKeyframeOrder(l);l=Rn.sortedArray(l,1,u),c=Rn.sortedArray(c,1,u),!r&&0===l[0]&&(l.push(o),c.push(c[0])),s.push(new sf(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,s)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(o);if(u&&u.length>1){const d=u[1];let h=r[d];h||(r[d]=h=[]),h.push(c)}}const s=[];for(const a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,h,f,g,p){if(0!==f.length){const m=[],y=[];Rn.flattenJSON(f,m,y,g),0!==m.length&&p.push(new d(h,m,y))}},r=[],o=e.name||"default",s=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(h&&0!==h.length)if(h[0].morphTargets){const f={};let g;for(g=0;g<h.length;g++)if(h[g].morphTargets)for(let p=0;p<h[g].morphTargets.length;p++)f[h[g].morphTargets[p]]=-1;for(const p in f){const m=[],y=[];for(let _=0;_!==h[g].morphTargets.length;++_){const v=h[g];m.push(v.time),y.push(v.morphTarget===p?1:0)}r.push(new sf(".morphTargetInfluence["+p+"]",m,y))}l=f.length*s}else{const f=".bones["+t[d].name+"]";i(af,f+".position",h,"pos",r),i(Uu,f+".quaternion",h,"rot",r),i(af,f+".scale",h,"scl",r)}}return 0===r.length?null:new this(o,l,r,a)}resetDuration(){let t=0;for(let i=0,r=this.tracks.length;i!==r;++i){const o=this.tracks[i];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function hZ(n){if(void 0===n.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function dZ(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return sf;case"vector":case"vector2":case"vector3":case"vector4":return af;case"color":return eP;case"quaternion":return Uu;case"bool":case"boolean":return Hu;case"string":return zu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}(n.type);if(void 0===n.times){const t=[],i=[];Rn.flattenJSON(n.keys,t,i,"value"),n.times=t,n.values=i}return void 0!==e.parse?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Gu={enabled:!1,files:{},add:function(n,e){!1!==this.enabled&&(this.files[n]=e)},get:function(n){if(!1!==this.enabled)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};const fZ=new class tP{constructor(e,t,i){const r=this;let l,o=!1,s=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,!1===o&&void 0!==r.onStart&&r.onStart(u,s,a),o=!0},this.itemEnd=function(u){s++,void 0!==r.onProgress&&r.onProgress(u,s,a),s===a&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return-1!==d&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],g=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return g}return null}}};class js{constructor(e){this.manager=void 0!==e?e:fZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,o){i.load(e,r,t,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Ws={};class $s extends js{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=Gu.get(e);if(void 0!==o)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(void 0!==Ws[e])return void Ws[e].push({onLoad:t,onProgress:i,onError:r});Ws[e]=[],Ws[e].push({onLoad:t,onProgress:i,onError:r});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(s).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===c.body||void 0===c.body.getReader)return c;const u=Ws[e],d=c.body.getReader(),h=c.headers.get("Content-Length"),f=h?parseInt(h):0,g=0!==f;let p=0;const m=new ReadableStream({start(y){!function _(){d.read().then(({done:v,value:b})=>{if(v)y.close();else{p+=b.byteLength;const w=new ProgressEvent("progress",{lengthComputable:g,loaded:p,total:f});for(let D=0,C=u.length;D<C;D++){const T=u[D];T.onProgress&&T.onProgress(w)}y.enqueue(b),_()}})}()}});return new Response(m)}throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(g=>f.decode(g))}}}).then(c=>{Gu.add(e,c);const u=Ws[e];delete Ws[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=Ws[e];if(void 0===u)throw this.manager.itemError(e),c;delete Ws[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Zm extends js{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=Gu.get(e);if(void 0!==s)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;const a=Lh("img");function l(){u(),Gu.add(e,this),t&&t(this),o.manager.itemEnd(e)}function c(d){u(),r&&r(d),o.manager.itemError(e),o.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(e),a.src=e,a}}class pZ extends js{constructor(e){super(e)}load(e,t,i,r){const o=new Uh,s=new Zm(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function l(c){s.load(e[c],function(u){o.images[c]=u,a++,6===a&&(o.needsUpdate=!0,t&&t(o))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return o}}class nP extends js{constructor(e){super(e)}load(e,t,i,r){const o=new Di,s=new Zm(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){o.image=a,o.needsUpdate=!0,void 0!==t&&t(o)},i,r),o}}class Ro extends Dt{constructor(e,t=1){super(),this.type="Light",this.color=new ve(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}Ro.prototype.isLight=!0;(class iP extends Ro{constructor(e,t,i){super(e,i),this.type="HemisphereLight",this.position.copy(Dt.DefaultUp),this.updateMatrix(),this.groundColor=new ve(t)}copy(e){return Ro.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const rP=new ye,oP=new M,sP=new M;class uw{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new re(512,512),this.map=null,this.mapPass=null,this.matrix=new ye,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new _m,this._frameExtents=new re(1,1),this._viewportCount=1,this._viewports=[new Zt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;oP.setFromMatrixPosition(e.matrixWorld),t.position.copy(oP),sP.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(sP),t.updateMatrixWorld(),rP.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(rP),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class aP extends uw{constructor(){super(new yi(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,i=2*Fh*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(i!==t.fov||r!==t.aspect||o!==t.far)&&(t.fov=i,t.aspect=r,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}aP.prototype.isSpotLightShadow=!0;class dw extends Ro{constructor(e,t,i=0,r=Math.PI/3,o=0,s=1){super(e,t),this.type="SpotLight",this.position.copy(Dt.DefaultUp),this.updateMatrix(),this.target=new Dt,this.distance=i,this.angle=r,this.penumbra=o,this.decay=s,this.shadow=new aP}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}dw.prototype.isSpotLight=!0;const lP=new ye,lf=new M,hw=new M;class cP extends uw{constructor(){super(new yi(90,1,.5,500)),this._frameExtents=new re(4,2),this._viewportCount=6,this._viewports=[new Zt(2,1,1,1),new Zt(0,1,1,1),new Zt(3,1,1,1),new Zt(1,1,1,1),new Zt(3,0,1,1),new Zt(1,0,1,1)],this._cubeDirections=[new M(1,0,0),new M(-1,0,0),new M(0,0,1),new M(0,0,-1),new M(0,1,0),new M(0,-1,0)],this._cubeUps=[new M(0,1,0),new M(0,1,0),new M(0,1,0),new M(0,1,0),new M(0,0,1),new M(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),lf.setFromMatrixPosition(e.matrixWorld),i.position.copy(lf),hw.copy(i.position),hw.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(hw),i.updateMatrixWorld(),r.makeTranslation(-lf.x,-lf.y,-lf.z),lP.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lP)}}cP.prototype.isPointLightShadow=!0;class Xm extends Ro{constructor(e,t,i=0,r=1){super(e,t),this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new cP}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}Xm.prototype.isPointLight=!0;class uP extends uw{constructor(){super(new zh(-5,5,5,-5,.5,500))}}uP.prototype.isDirectionalLightShadow=!0;class Km extends Ro{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Dt.DefaultUp),this.updateMatrix(),this.target=new Dt,this.shadow=new uP}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Km.prototype.isDirectionalLight=!0;class fw extends Ro{constructor(e,t){super(e,t),this.type="AmbientLight"}}fw.prototype.isAmbientLight=!0;(class dP extends Ro{constructor(e,t,i=10,r=10){super(e,t),this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}).prototype.isRectAreaLight=!0;class hP{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new M)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,o=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*r),t.addScaledVector(s[2],.488603*o),t.addScaledVector(s[3],.488603*i),t.addScaledVector(s[4],i*r*1.092548),t.addScaledVector(s[5],r*o*1.092548),t.addScaledVector(s[6],.315392*(3*o*o-1)),t.addScaledVector(s[7],i*o*1.092548),t.addScaledVector(s[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,o=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*r),t.addScaledVector(s[2],1.023328*o),t.addScaledVector(s[3],1.023328*i),t.addScaledVector(s[4],.858086*i*r),t.addScaledVector(s[5],.858086*r*o),t.addScaledVector(s[6],.743125*o*o-.247708),t.addScaledVector(s[7],.858086*i*o),t.addScaledVector(s[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,o=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*o,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*i*o,t[8]=.546274*(i*i-r*r)}}hP.prototype.isSphericalHarmonics3=!0;class Jm extends Ro{constructor(e=new hP,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}Jm.prototype.isLightProbe=!0;class ju{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch(i){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}let Qm;(class fP extends je{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0,class yZ extends js{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,s=Gu.get(e);if(void 0!==s)return o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(l){Gu.add(e,l),t&&t(l),o.manager.itemEnd(e)}).catch(function(l){r&&r(l),o.manager.itemError(e),o.manager.itemEnd(e)}),o.manager.itemStart(e)}}.prototype.isImageBitmapLoader=!0;class vZ extends js{constructor(e){super(e)}load(e,t,i,r){const o=this,s=new $s(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{const l=a.slice(0);(void 0===Qm&&(Qm=new(window.AudioContext||window.webkitAudioContext)),Qm).decodeAudioData(l,function(u){t(u)})}catch(l){r?r(l):console.error(l),o.manager.itemError(e)}},i,r)}}(class bZ extends Jm{constructor(e,t,i=1){super(void 0,i);const r=(new ve).set(e),o=(new ve).set(t),s=new M(r.r,r.g,r.b),a=new M(o.r,o.g,o.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(s).sub(a).multiplyScalar(c)}}).prototype.isHemisphereLightProbe=!0,class wZ extends Jm{constructor(e,t=1){super(void 0,t);const i=(new ve).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class vP{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=bP(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=bP();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function bP(){return("undefined"==typeof performance?Date:performance).now()}class EZ{constructor(e,t,i){let r,o,s;switch(this.binding=e,this.valueSize=i,t){case"quaternion":r=this._slerp,o=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,o=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,o=e*r+r;let s=this.cumulativeWeight;if(0===s){for(let a=0;a!==r;++a)i[o+a]=i[a];s=t}else s+=t,this._mixBufferRegion(i,o,0,t/s,r);this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1&&this._mixBufferRegion(i,r,t*this._origIndex,1-o,t),s>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const t=this.buffer,i=this.valueSize,r=i*this._origIndex;this.binding.getValue(t,r);for(let o=i,s=r;o!==s;++o)t[o]=t[r+o%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,o){if(r>=.5)for(let s=0;s!==o;++s)e[t+s]=e[i+s]}_slerp(e,t,i,r){Jt.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,o){const s=this._workIndex*o;Jt.multiplyQuaternionsFlat(e,s,e,t,e,i),Jt.slerpFlat(e,t,e,t,e,s,r)}_lerp(e,t,i,r,o){const s=1-r;for(let a=0;a!==o;++a){const l=t+a;e[l]=e[l]*s+e[i+a]*r}}_lerpAdditive(e,t,i,r,o){for(let s=0;s!==o;++s){const a=t+s;e[a]=e[a]+e[i+s]*r}}}const pw="\\[\\]\\.:\\/",CZ=new RegExp("["+pw+"]","g"),gw="[^"+pw+"]",TZ="[^"+pw.replace("\\.","")+"]",AZ=/((?:WC+[\/:])*)/.source.replace("WC",gw),IZ=/(WCOD+)?/.source.replace("WCOD",TZ),RZ=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gw),NZ=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gw),PZ=new RegExp("^"+AZ+IZ+RZ+NZ+"$"),OZ=["material","materials","bones"];class FZ{constructor(e,t,i){const r=i||ln.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=i.length;r!==o;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let ln=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(CZ,"")}static parseTrackName(t){const i=PZ.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==o&&-1!==o){const s=r.nodeName.substring(o+1);-1!==OZ.indexOf(s)&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=s)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(s){for(let a=0;a<s.length;a++){const l=s[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},o=r(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)t[i++]=r[o]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,o=i.propertyName;let s=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[o];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+o+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==s){if("morphTargetInfluences"===o){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[s]&&(s=t.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=o;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=FZ,n})();ln.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ln.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ln.prototype.GetterByBindingType=[ln.prototype._getValue_direct,ln.prototype._getValue_array,ln.prototype._getValue_arrayElement,ln.prototype._getValue_toArray],ln.prototype.SetterByBindingTypeAndVersioning=[[ln.prototype._setValue_direct,ln.prototype._setValue_direct_setNeedsUpdate,ln.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ln.prototype._setValue_array,ln.prototype._setValue_array_setNeedsUpdate,ln.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ln.prototype._setValue_arrayElement,ln.prototype._setValue_arrayElement_setNeedsUpdate,ln.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ln.prototype._setValue_fromArray,ln.prototype._setValue_fromArray_setNeedsUpdate,ln.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class LZ{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const o=t.tracks,s=o.length,a=new Array(s),l={endingStart:su,endingEnd:su};for(let c=0;c!==s;++c){const u=o[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,o=e._clip.duration,a=r/o;e.warp(1,o/r,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,o=r.time,s=this.timeScale;let a=this._timeScaleInterpolant;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=o,l[1]=o+i,c[0]=e/s,c[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled)return void this._updateWeight(e);const o=this._startTime;if(null!==o){const l=(e-o)*i;if(l<0||0===i)return;this._startTime=null,t=i*l}t*=this._updateTimeScale(e);const s=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;if(2501===this.blendMode)for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(s),c[u].accumulateAdditive(a);else for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(s),c[u].accumulate(r,a)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(null!==i){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;null!==i&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,o=this._loopCount;const s=2202===i;if(0===e)return-1===o?r:s&&1==(1&o)?t-r:r;if(2200===i){-1===o&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===o&&(e>=0?(o=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,o+=Math.abs(a);const l=this.repetitions-o;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===l){const c=e<0;this._setEndings(c,!c,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(s&&1==(1&o))return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=au,r.endingEnd=au):(r.endingStart=e?this.zeroSlopeAtStart?au:su:2402,r.endingEnd=t?this.zeroSlopeAtEnd?au:su:2402)}_scheduleFading(e,t,i){const r=this._mixer,o=r.time;let s=this._weightInterpolant;null===s&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);const a=s.parameterPositions,l=s.sampleValues;return a[0]=o,l[0]=t,a[1]=o+e,l[1]=i,this}}class MP extends _a{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,o=r.length,s=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];void 0===u&&(u={},c[l]=u);for(let d=0;d!==o;++d){const h=r[d],f=h.name;let g=u[f];if(void 0!==g)++g.referenceCount,s[d]=g;else{if(g=s[d],void 0!==g){null===g._cacheIndex&&(++g.referenceCount,this._addInactiveBinding(g,l,f));continue}g=new EZ(ln.create(i,f,t&&t._propertyBindings[d].binding.parsedPath),h.ValueTypeName,h.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,l,f),s[d]=g}a[d].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,o=this._actionsByClip[r];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const o=t[i];0==o.useCount++&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const o=t[i];0==--o.useCount&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,o=this._actionsByClip;let s=o[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=s;else{const a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),s.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const o=e._clip.uuid,s=this._actionsByClip,a=s[o],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===l.length&&delete s[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const o=t[i];0==--o.referenceCount&&this._removeInactiveBinding(o)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,o=this._bindings;let s=r[t];void 0===s&&(s={},r[t]=s),s[i]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,o=i.path,s=this._bindingsByRootAndName,a=s[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[o],0===Object.keys(a).length&&delete s[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return void 0===i&&(i=new QN(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,o=t[r];e.__cacheIndex=r,t[r]=e,o.__cacheIndex=i,t[i]=o}clipAction(e,t,i){const r=t||this._root,o=r.uuid;let s="string"==typeof e?Ra.findByName(r,e):e;const a=null!==s?s.uuid:e,l=this._actionsByClip[a];let c=null;if(void 0===i&&(i=null!==s?s.blendMode:2500),void 0!==l){const d=l.actionByRoot[o];if(void 0!==d&&d.blendMode===i)return d;c=l.knownActions[0],null===s&&(s=c._clip)}if(null===s)return null;const u=new LZ(this,s,t,i);return this._bindAction(u,c),this._addInactiveAction(u,a,o),u}existingAction(e,t){const i=t||this._root,r=i.uuid,o="string"==typeof e?Ra.findByName(i,e):e,a=this._actionsByClip[o?o.uuid:e];return void 0!==a&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)e[i].stop();return this}update(e){const t=this._actions,i=this._nActiveActions,r=this.time+=e*=this.timeScale,o=Math.sign(e),s=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,o,s);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,o=r[i];if(void 0!==o){const s=o.knownActions;for(let a=0,l=s.length;a!==l;++a){const c=s[a];this._deactivateAction(c);const u=c._cacheIndex,d=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const s in i){const l=i[s].actionByRoot[t];void 0!==l&&(this._deactivateAction(l),this._removeInactiveAction(l))}const o=this._bindingsByRootAndName[t];if(void 0!==o)for(const s in o){const a=o[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}MP.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class mw{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new mw(void 0===this.value.clone?this.value:this.value.clone())}}function DP(n,e){return n.distance-e.distance}function _w(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),!0===i){const r=n.children;for(let o=0,s=r.length;o<s;o++)_w(r[o],e,t,!0)}}(class BZ extends Iu{constructor(e,t,i=1){super(e,t),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}).prototype.isInstancedInterleavedBuffer=!0;class SP{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Zn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const EP=new re;class cf{constructor(e=new re(1/0,1/0),t=new re(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=EP.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return EP.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}cf.prototype.isBox2=!0;const Na=new M,t_=new ye,yw=new ye;function AP(n){const e=[];!0===n.isBone&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,AP(n.children[t]));return e}const FP=new ArrayBuffer(4),No=(new Float32Array(FP),new Uint32Array(FP),new Uint32Array(512)),Po=new Uint32Array(512);for(let n=0;n<256;++n){const e=n-127;e<-27?(No[n]=0,No[256|n]=32768,Po[n]=24,Po[256|n]=24):e<-14?(No[n]=1024>>-e-14,No[256|n]=1024>>-e-14|32768,Po[n]=-e-1,Po[256|n]=-e-1):e<=15?(No[n]=e+15<<10,No[256|n]=e+15<<10|32768,Po[n]=13,Po[256|n]=13):e<128?(No[n]=31744,No[256|n]=64512,Po[n]=24,Po[256|n]=24):(No[n]=31744,No[256|n]=64512,Po[n]=13,Po[256|n]=13)}const bw=new Uint32Array(2048),Wu=new Uint32Array(64),BP=new Uint32Array(64);for(let n=1;n<1024;++n){let e=n<<13,t=0;for(;0==(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,bw[n]=e|t}for(let n=1024;n<2048;++n)bw[n]=939524096+(n-1024<<13);for(let n=1;n<31;++n)Wu[n]=n<<23;Wu[31]=1199570944,Wu[32]=2147483648;for(let n=33;n<63;++n)Wu[n]=2147483648+(n-32<<23);Wu[63]=3347054592;for(let n=1;n<64;++n)32!==n&&(BP[n]=1024);Br.create=function(n,e){return console.log("THREE.Curve.create() has been deprecated"),n.prototype=Object.create(Br.prototype),n.prototype.constructor=n,n.prototype.getPoint=e,n},Kh.prototype.fromPoints=function(n){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(n)},class jZ extends Lu{constructor(e=10,t=10,i=4473924,r=8947848){i=new ve(i),r=new ve(r);const o=t/2,s=e/t,a=e/2,l=[],c=[];for(let h=0,f=0,g=-a;h<=t;h++,g+=s){l.push(-a,0,g,a,0,g),l.push(g,0,-a,g,0,a);const p=h===o?i:r;p.toArray(c,f),f+=3,p.toArray(c,f),f+=3,p.toArray(c,f),f+=3,p.toArray(c,f),f+=3}const u=new je;u.setAttribute("position",new Fe(l,3)),u.setAttribute("color",new Fe(c,3)),super(u,new vi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class zZ extends Lu{constructor(e){const t=AP(e),i=new je,r=[],o=[],s=new ve(0,0,1),a=new ve(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),o.push(s.r,s.g,s.b),o.push(a.r,a.g,a.b))}i.setAttribute("position",new Fe(r,3)),i.setAttribute("color",new Fe(o,3)),super(i,new vi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");yw.copy(this.root.matrixWorld).invert();for(let o=0,s=0;o<t.length;o++){const a=t[o];a.parent&&a.parent.isBone&&(t_.multiplyMatrices(yw,a.matrixWorld),Na.setFromMatrixPosition(t_),r.setXYZ(s,Na.x,Na.y,Na.z),t_.multiplyMatrices(yw,a.parent.matrixWorld),Na.setFromMatrixPosition(t_),r.setXYZ(s+1,Na.x,Na.y,Na.z),s+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},js.prototype.extractUrlBase=function(n){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ju.extractUrlBase(n)},js.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},cf.prototype.center=function(n){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(n)},cf.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},cf.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},cf.prototype.size=function(n){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(n)},Or.prototype.center=function(n){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(n)},Or.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Or.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Or.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},Or.prototype.size=function(n){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(n)},kr.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},Al.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},_m.prototype.setFromMatrix=function(n){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(n)},mi.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},mi.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},mi.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},mi.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},mi.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},mi.prototype.getInverse=function(n){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},ye.prototype.extractPosition=function(n){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(n)},ye.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},ye.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new M).setFromMatrixColumn(this,3)},ye.prototype.setRotationFromQuaternion=function(n){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(n)},ye.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},ye.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},ye.prototype.multiplyVector4=function(n){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},ye.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},ye.prototype.rotateAxis=function(n){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),n.transformDirection(this)},ye.prototype.crossVector=function(n){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},ye.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},ye.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},ye.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},ye.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},ye.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},ye.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},ye.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},ye.prototype.makeFrustum=function(n,e,t,i,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(n,e,i,t,r,o)},ye.prototype.getInverse=function(n){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},Vs.prototype.isIntersectionLine=function(n){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(n)},Jt.prototype.multiplyVector3=function(n){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),n.applyQuaternion(this)},Jt.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Il.prototype.isIntersectionBox=function(n){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Il.prototype.isIntersectionPlane=function(n){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(n)},Il.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},si.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},si.prototype.barycoordFromPoint=function(n,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(n,e)},si.prototype.midpoint=function(n){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(n)},si.prototypenormal=function(n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(n)},si.prototype.plane=function(n){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(n)},si.barycoordFromPoint=function(n,e,t,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),si.getBarycoord(n,e,t,i,r)},si.normal=function(n,e,t,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),si.getNormal(n,e,t,i)},Hs.prototype.extractAllPoints=function(n){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(n)},Hs.prototype.extrude=function(n){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Aa(this,n)},Hs.prototype.makeGeometry=function(n){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new nf(this,n)},re.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},re.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},re.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},M.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},M.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},M.prototype.getPositionFromMatrix=function(n){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(n)},M.prototype.getScaleFromMatrix=function(n){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(n)},M.prototype.getColumnFromMatrix=function(n,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,n)},M.prototype.applyProjection=function(n){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(n)},M.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},M.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},M.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Zt.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},Zt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Dt.prototype.getChildByName=function(n){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(n)},Dt.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Dt.prototype.translate=function(n,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,n)},Dt.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Dt.prototype.applyMatrix=function(n){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(Dt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(n){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=n}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),we.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(we.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Sm.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},yi.prototype.setLens=function(n,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(n)},Object.defineProperties(Ro.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(n){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=n}},shadowCameraLeft:{set:function(n){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=n}},shadowCameraRight:{set:function(n){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=n}},shadowCameraTop:{set:function(n){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=n}},shadowCameraBottom:{set:function(n){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=n}},shadowCameraNear:{set:function(n){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=n}},shadowCameraFar:{set:function(n){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=n}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(n){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=n}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(n){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=n}},shadowMapHeight:{set:function(n){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=n}}}),Object.defineProperties(xn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Oh},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Oh)}}}),xn.prototype.setDynamic=function(n){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===n?Oh:Ph),this},xn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},xn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},je.prototype.addIndex=function(n){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(n)},je.prototype.addAttribute=function(n,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===n?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(n,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(n,new xn(arguments[1],arguments[2])))},je.prototype.addDrawCall=function(n,e,t){void 0!==t&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(n,e)},je.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},je.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},je.prototype.removeAttribute=function(n){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(n)},je.prototype.applyMatrix=function(n){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(je.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Iu.prototype.setDynamic=function(n){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===n?Oh:Ph),this},Iu.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Aa.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Aa.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Aa.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Pl.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},mw.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Ln.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ve}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(n){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=n}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Io.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(n){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=n}}}),fn.prototype.clearTarget=function(n,e,t,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(n),this.clear(e,t,i)},fn.prototype.animate=function(n){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(n)},fn.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},fn.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},fn.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},fn.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},fn.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},fn.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},fn.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},fn.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},fn.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},fn.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},fn.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},fn.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},fn.prototype.enableScissorTest=function(n){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(n)},fn.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},fn.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},fn.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},fn.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},fn.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},fn.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},fn.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},fn.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},fn.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},fn.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(fn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=n}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=n}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(n){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===n?hn:Ns}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(oN.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Pr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=n}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=n}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=n}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=n}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(n){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=n}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(n){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=n}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(n){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=n}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(n){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=n}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(n){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=n}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(n){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=n}}}),class MZ extends Dt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(n){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new vZ).load(n,function(i){e.setBuffer(i)}),this},O1.prototype.updateCubeMap=function(n,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(n,e)},O1.prototype.clear=function(n,e,t,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(n,e,t,i)},Sl.crossOrigin=void 0,Sl.loadTexture=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new nP;r.setCrossOrigin(this.crossOrigin);const o=r.load(n,t,void 0,i);return e&&(o.mapping=e),o},Sl.loadTextureCube=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new pZ;r.setCrossOrigin(this.crossOrigin);const o=r.load(n,t,void 0,i);return e&&(o.mapping=e),o},Sl.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Sl.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"139"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="139");var s_=(()=>{return(n=s_||(s_={}))[n.MultiplyOperation=0]="MultiplyOperation",n[n.MixOperation=1]="MixOperation",n[n.AddOperation=2]="AddOperation",s_;var n})(),a_=(()=>{return(n=a_||(a_={}))[n.FrontSide=0]="FrontSide",n[n.BackSide=1]="BackSide",n[n.DoubleSide=2]="DoubleSide",a_;var n})();class Oo{static fitCameraToSelection(e,t,i,r=1.2){this.box.makeEmpty();for(const u of i)u instanceof Pl?this.box.setFromCenterAndSize(new M(0,0,0),new M(1,1,1)):this.box.expandByObject(u);if(this.box.isEmpty())return!1;this.box.getSize(this.size),this.box.getCenter(this.center);const s=Math.max(this.size.x,this.size.y,this.size.z)/(2*Math.atan(Math.PI*e.fov/360)),l=r*Math.max(s,s/e.aspect),c=t.target.clone().sub(e.position).normalize().multiplyScalar(l);return t.target.copy(this.center),e.position.copy(t.target).sub(c),t.update(),!0}static moveCameraToObject(e,t,i){i.getWorldPosition(this.center);const r=new M(0,0,-1).applyQuaternion(e.quaternion).negate(),o=t.target.distanceTo(e.position),s=this.center.clone().add(r.multiplyScalar(o));e.position.copy(s),t.target.copy(this.center),t.update()}static*traverseAll(e){yield e;for(const t of e.children)for(const i of this.traverseAll(t))yield i}static isAncestor(e,t){for(let i=e.parent;null!=i;i=i.parent)if(i===t)return!0;return!1}static deconstruct(e){console.log(e)}static getProperty(e,t,i){return Object.keys(e.userData).includes(t)?e.userData[t]:i}static setProperty(e,t,i){return e.userData[t]=i,e}}Oo.size=new M,Oo.center=new M,Oo.box=new Or;var Fo=Za(928),VP={},ww=function(n){return URL.createObjectURL(new Blob([n],{type:"text/javascript"}))},HP=function(n){return new Worker(n)};try{URL.revokeObjectURL(ww(""))}catch(n){ww=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)},HP=function(e){return new Worker(e,{type:"module"})}}var Lt=Uint8Array,Ei=Uint16Array,qs=Uint32Array,$u=new Lt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),qu=new Lt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uf=new Lt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),UP=function(n,e){for(var t=new Ei(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];var r=new qs(t[30]);for(i=1;i<30;++i)for(var o=t[i];o<t[i+1];++o)r[o]=o-t[i]<<5|i;return[t,r]},zP=UP($u,2),xw=zP[0],l_=zP[1];xw[28]=258,l_[258]=28;for(var GP=UP(qu,0),jP=GP[0],Mw=GP[1],df=new Ei(32768),Sn=0;Sn<32768;++Sn){var Pa=(43690&Sn)>>>1|(21845&Sn)<<1;df[Sn]=((65280&(Pa=(61680&(Pa=(52428&Pa)>>>2|(13107&Pa)<<2))>>>4|(3855&Pa)<<4))>>>8|(255&Pa)<<8)>>>1}var oo=function(n,e,t){for(var i=n.length,r=0,o=new Ei(e);r<i;++r)++o[n[r]-1];var a,s=new Ei(e);for(r=0;r<e;++r)s[r]=s[r-1]+o[r-1]<<1;if(t){a=new Ei(1<<e);var l=15-e;for(r=0;r<i;++r)if(n[r])for(var c=r<<4|n[r],u=e-n[r],d=s[n[r]-1]++<<u,h=d|(1<<u)-1;d<=h;++d)a[df[d]>>>l]=c}else for(a=new Ei(i),r=0;r<i;++r)n[r]&&(a[r]=df[s[n[r]-1]++]>>>15-n[r]);return a},Ys=new Lt(288);for(Sn=0;Sn<144;++Sn)Ys[Sn]=8;for(Sn=144;Sn<256;++Sn)Ys[Sn]=9;for(Sn=256;Sn<280;++Sn)Ys[Sn]=7;for(Sn=280;Sn<288;++Sn)Ys[Sn]=8;var Yu=new Lt(32);for(Sn=0;Sn<32;++Sn)Yu[Sn]=5;var WP=oo(Ys,9,0),$P=oo(Ys,9,1),qP=oo(Yu,5,0),YP=oo(Yu,5,1),c_=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},so=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(7&e)&t},u_=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(7&e)},hf=function(n){return(n/8|0)+(7&n&&1)},ao=function(n,e,t){(null==e||e<0)&&(e=0),(null==t||t>n.length)&&(t=n.length);var i=new(n instanceof Ei?Ei:n instanceof qs?qs:Lt)(t-e);return i.set(n.subarray(e,t)),i},ff=function(n,e,t){var i=n.length;if(!i||t&&!t.l&&i<5)return e||new Lt(0);var r=!e||t,o=!t||t.i;t||(t={}),e||(e=new Lt(3*i));var s=function(te){var pt=e.length;if(te>pt){var ze=new Lt(Math.max(2*pt,te));ze.set(e),e=ze}},a=t.f||0,l=t.p||0,c=t.b||0,u=t.l,d=t.d,h=t.m,f=t.n,g=8*i;do{if(!u){t.f=a=so(n,l,1);var p=so(n,l+1,3);if(l+=3,!p){var y=n[(m=hf(l)+4)-4]|n[m-3]<<8,_=m+y;if(_>i){if(o)throw"unexpected EOF";break}r&&s(c+y),e.set(n.subarray(m,_),c),t.b=c+=y,t.p=l=8*_;continue}if(1==p)u=$P,d=YP,h=9,f=5;else{if(2!=p)throw"invalid block type";var v=so(n,l,31)+257,b=so(n,l+10,15)+4,w=v+so(n,l+5,31)+1;l+=14;for(var D=new Lt(w),C=new Lt(19),T=0;T<b;++T)C[uf[T]]=so(n,l+3*T,7);l+=3*b;var G=c_(C),O=(1<<G)-1,x=oo(C,G,1);for(T=0;T<w;){var m,N=x[so(n,l,O)];if(l+=15&N,(m=N>>>4)<16)D[T++]=m;else{var q=0,L=0;for(16==m?(L=3+so(n,l,3),l+=2,q=D[T-1]):17==m?(L=3+so(n,l,7),l+=3):18==m&&(L=11+so(n,l,127),l+=7);L--;)D[T++]=q}}var j=D.subarray(0,v),z=D.subarray(v);h=c_(j),f=c_(z),u=oo(j,h,1),d=oo(z,f,1)}if(l>g){if(o)throw"unexpected EOF";break}}r&&s(c+131072);for(var $=(1<<h)-1,U=(1<<f)-1,X=l;;X=l){var ee=(q=u[u_(n,l)&$])>>>4;if((l+=15&q)>g){if(o)throw"unexpected EOF";break}if(!q)throw"invalid length/literal";if(ee<256)e[c++]=ee;else{if(256==ee){X=l,u=null;break}var se=ee-254;ee>264&&(se=so(n,l,(1<<(ie=$u[T=ee-257]))-1)+xw[T],l+=ie);var Ae=d[u_(n,l)&U],Le=Ae>>>4;if(!Ae)throw"invalid distance";if(l+=15&Ae,z=jP[Le],Le>3){var ie=qu[Le];z+=u_(n,l)&(1<<ie)-1,l+=ie}if(l>g){if(o)throw"unexpected EOF";break}r&&s(c+131072);for(var Ie=c+se;c<Ie;c+=4)e[c]=e[c-z],e[c+1]=e[c+1-z],e[c+2]=e[c+2-z],e[c+3]=e[c+3-z];c=Ie}}t.l=u,t.p=X,t.b=c,u&&(a=1,t.m=h,t.d=d,t.n=f)}while(!a);return c==e.length?e:ao(e,0,c)},rs=function(n,e,t){var i=e/8|0;n[i]|=t<<=7&e,n[i+1]|=t>>>8},Zu=function(n,e,t){var i=e/8|0;n[i]|=t<<=7&e,n[i+1]|=t>>>8,n[i+2]|=t>>>16},d_=function(n,e){for(var t=[],i=0;i<n.length;++i)n[i]&&t.push({s:i,f:n[i]});var r=t.length,o=t.slice();if(!r)return[Zs,0];if(1==r){var s=new Lt(t[0].s+1);return s[t[0].s]=1,[s,1]}t.sort(function(w,D){return w.f-D.f}),t.push({s:-1,f:25001});var a=t[0],l=t[1],c=0,u=1,d=2;for(t[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=r-1;)a=t[t[c].f<t[d].f?c++:d++],l=t[c!=u&&t[c].f<t[d].f?c++:d++],t[u++]={s:-1,f:a.f+l.f,l:a,r:l};var h=o[0].s;for(i=1;i<r;++i)o[i].s>h&&(h=o[i].s);var f=new Ei(h+1),g=h_(t[u-1],f,0);if(g>e){i=0;var p=0,m=g-e,y=1<<m;for(o.sort(function(D,C){return f[C.s]-f[D.s]||D.f-C.f});i<r;++i){var _=o[i].s;if(!(f[_]>e))break;p+=y-(1<<g-f[_]),f[_]=e}for(p>>>=m;p>0;){var v=o[i].s;f[v]<e?p-=1<<e-f[v]++-1:++i}for(;i>=0&&p;--i){var b=o[i].s;f[b]==e&&(--f[b],++p)}g=e}return[new Lt(f),g]},h_=function(n,e,t){return-1==n.s?Math.max(h_(n.l,e,t+1),h_(n.r,e,t+1)):e[n.s]=t},Dw=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new Ei(++e),i=0,r=n[0],o=1,s=function(l){t[i++]=l},a=1;a<=e;++a)if(n[a]==r&&a!=e)++o;else{if(!r&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(r),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(r);o=1,r=n[a]}return[t.subarray(0,i),e]},Xu=function(n,e){for(var t=0,i=0;i<e.length;++i)t+=n[i]*e[i];return t},pf=function(n,e,t){var i=t.length,r=hf(e+2);n[r]=255&i,n[r+1]=i>>>8,n[r+2]=255^n[r],n[r+3]=255^n[r+1];for(var o=0;o<i;++o)n[r+o+4]=t[o];return 8*(r+4+i)},Sw=function(n,e,t,i,r,o,s,a,l,c,u){rs(e,u++,t),++r[256];for(var d=d_(r,15),h=d[0],f=d[1],g=d_(o,15),p=g[0],m=g[1],y=Dw(h),_=y[0],v=y[1],b=Dw(p),w=b[0],D=b[1],C=new Ei(19),T=0;T<_.length;++T)C[31&_[T]]++;for(T=0;T<w.length;++T)C[31&w[T]]++;for(var G=d_(C,7),O=G[0],x=G[1],N=19;N>4&&!O[uf[N-1]];--N);var z,$,U,X,q=c+5<<3,L=Xu(r,Ys)+Xu(o,Yu)+s,j=Xu(r,h)+Xu(o,p)+s+14+3*N+Xu(C,O)+(2*C[16]+3*C[17]+7*C[18]);if(q<=L&&q<=j)return pf(e,u,n.subarray(l,l+c));if(rs(e,u,1+(j<L)),u+=2,j<L){z=oo(h,f,0),$=h,U=oo(p,m,0),X=p;var ee=oo(O,x,0);for(rs(e,u,v-257),rs(e,u+5,D-1),rs(e,u+10,N-4),u+=14,T=0;T<N;++T)rs(e,u+3*T,O[uf[T]]);u+=3*N;for(var se=[_,w],ie=0;ie<2;++ie){var Ae=se[ie];for(T=0;T<Ae.length;++T)rs(e,u,ee[Le=31&Ae[T]]),u+=O[Le],Le>15&&(rs(e,u,Ae[T]>>>5&127),u+=Ae[T]>>>12)}}else z=WP,$=Ys,U=qP,X=Yu;for(T=0;T<a;++T)if(i[T]>255){var Le;Zu(e,u,z[257+(Le=i[T]>>>18&31)]),u+=$[Le+257],Le>7&&(rs(e,u,i[T]>>>23&31),u+=$u[Le]);var Ie=31&i[T];Zu(e,u,U[Ie]),u+=X[Ie],Ie>3&&(Zu(e,u,i[T]>>>5&8191),u+=qu[Ie])}else Zu(e,u,z[i[T]]),u+=$[i[T]];return Zu(e,u,z[256]),u+$[256]},ZP=new qs([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Zs=new Lt(0),XP=function(n,e,t,i,r,o){var s=n.length,a=new Lt(i+s+5*(1+Math.ceil(s/7e3))+r),l=a.subarray(i,a.length-r),c=0;if(!e||s<8)for(var u=0;u<=s;u+=65535){var d=u+65535;d<s?c=pf(l,c,n.subarray(u,d)):(l[u]=o,c=pf(l,c,n.subarray(u,s)))}else{for(var h=ZP[e-1],f=h>>>13,g=8191&h,p=(1<<t)-1,m=new Ei(32768),y=new Ei(p+1),_=Math.ceil(t/3),v=2*_,b=function(fe){return(n[fe]^n[fe+1]<<_^n[fe+2]<<v)&p},w=new qs(25e3),D=new Ei(288),C=new Ei(32),T=0,G=0,O=(u=0,0),x=0,N=0;u<s;++u){var q=b(u),L=32767&u,j=y[q];if(m[L]=j,y[q]=L,x<=u){var z=s-u;if((T>7e3||O>24576)&&z>423){c=Sw(n,l,0,w,D,C,G,O,N,u-N,c),O=T=G=0,N=u;for(var $=0;$<286;++$)D[$]=0;for($=0;$<30;++$)C[$]=0}var U=2,X=0,ee=g,se=L-j&32767;if(z>2&&q==b(u-se))for(var ie=Math.min(f,z)-1,Ae=Math.min(32767,u),Le=Math.min(258,z);se<=Ae&&--ee&&L!=j;){if(n[u+U]==n[u+U-se]){for(var Ie=0;Ie<Le&&n[u+Ie]==n[u+Ie-se];++Ie);if(Ie>U){if(U=Ie,X=se,Ie>ie)break;var te=Math.min(se,Ie-2),pt=0;for($=0;$<te;++$){var ze=u-se+$+32768&32767,_e=ze-m[ze]+32768&32767;_e>pt&&(pt=_e,j=ze)}}}se+=(L=j)-(j=m[L])+32768&32767}if(X){w[O++]=268435456|l_[U]<<18|Mw[X];var it=31&l_[U],ne=31&Mw[X];G+=$u[it]+qu[ne],++D[257+it],++C[ne],x=u+U,++T}else w[O++]=n[u],++D[n[u]]}}c=Sw(n,l,o,w,D,C,G,O,N,u-N,c),!o&&7&c&&(c=pf(l,c+1,Zs))}return ao(a,0,i+hf(c)+r)},KP=function(){for(var n=new qs(256),e=0;e<256;++e){for(var t=e,i=9;--i;)t=(1&t&&3988292384)^t>>>1;n[e]=t}return n}(),Ku=function(){var n=-1;return{p:function(e){for(var t=n,i=0;i<e.length;++i)t=KP[255&t^e[i]]^t>>>8;n=t},d:function(){return~n}}},Ew=function(){var n=1,e=0;return{p:function(t){for(var i=n,r=e,o=t.length,s=0;s!=o;){for(var a=Math.min(s+2655,o);s<a;++s)r+=i+=t[s];i=(65535&i)+15*(i>>16),r=(65535&r)+15*(r>>16)}n=i,e=r},d:function(){return(255&(n%=65521))<<24|n>>>8<<16|(255&(e%=65521))<<8|e>>>8}}},Hl=function(n,e,t,i,r){return XP(n,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(n.length)))):12+e.mem,t,i,!r)},gf=function(n,e){var t={};for(var i in n)t[i]=n[i];for(var i in e)t[i]=e[i];return t},JP=function(n,e,t){for(var i=n(),r=n.toString(),o=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/ /g,"").split(","),s=0;s<i.length;++s){var a=i[s],l=o[s];if("function"==typeof a){e+=";"+l+"=";var c=a.toString();if(a.prototype)if(-1!=c.indexOf("[native code]")){var u=c.indexOf(" ",8)+1;e+=c.slice(u,c.indexOf("(",u))}else for(var d in e+=c,a.prototype)e+=";"+l+".prototype."+d+"="+a.prototype[d].toString();else e+=c}else t[l]=a}return[e,t]},f_=[],QP=function(n,e,t,i){var r;if(!f_[t]){for(var o="",s={},a=n.length-1,l=0;l<a;++l)o=(r=JP(n[l],o,s))[0],s=r[1];f_[t]=JP(n[a],o,s)}var c=gf({},f_[t][1]);return function(n,e,t,i,r){var o=HP(VP[e]||(VP[e]=ww(n)));return o.onerror=function(s){return r(s.error,null)},o.onmessage=function(s){return r(null,s.data)},o.postMessage(t,i),o}(f_[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,c,function(n){var e=[];for(var t in n)(n[t]instanceof Lt||n[t]instanceof Ei||n[t]instanceof qs)&&e.push((n[t]=new n[t].constructor(n[t])).buffer);return e}(c),i)},Ju=function(){return[Lt,Ei,qs,$u,qu,uf,xw,jP,$P,YP,df,oo,c_,so,u_,hf,ao,ff,nd,Oa,Cw]},Qu=function(){return[Lt,Ei,qs,$u,qu,uf,l_,Mw,WP,Ys,qP,Yu,df,ZP,Zs,oo,rs,Zu,d_,h_,Dw,Xu,pf,Sw,hf,ao,XP,Hl,mf,Oa]},eO=function(){return[Aw,Rw,nn,Ku,KP]},tO=function(){return[Iw,rO]},nO=function(){return[Nw,nn,Ew]},iO=function(){return[oO]},Oa=function(n){return postMessage(n,[n.buffer])},Cw=function(n){return n&&n.size&&new Lt(n.size)},ed=function(n,e,t,i,r,o){var s=QP(t,i,r,function(a,l){s.terminate(),o(a,l)});return s.postMessage([n,e],e.consume?[n.buffer]:[]),function(){s.terminate()}},lo=function(n){return n.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(e){return n.push(e.data[0],e.data[1])}},td=function(n,e,t,i,r){var o,s=QP(n,i,r,function(a,l){a?(s.terminate(),e.ondata.call(e,a)):(l[1]&&s.terminate(),e.ondata.call(e,a,l[0],l[1]))});s.postMessage(t),e.push=function(a,l){if(o)throw"stream finished";if(!e.ondata)throw"no stream handler";s.postMessage([a,o=l],[a.buffer])},e.terminate=function(){s.terminate()}},sr=function(n,e){return n[e]|n[e+1]<<8},Kn=function(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24)>>>0},Tw=function(n,e){return Kn(n,e)+4294967296*Kn(n,e+4)},nn=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},Aw=function(n,e){var t=e.filename;if(n[0]=31,n[1]=139,n[2]=8,n[8]=e.level<2?4:9==e.level?2:0,n[9]=3,0!=e.mtime&&nn(n,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){n[3]=8;for(var i=0;i<=t.length;++i)n[i+10]=t.charCodeAt(i)}},Iw=function(n){if(31!=n[0]||139!=n[1]||8!=n[2])throw"invalid gzip data";var e=n[3],t=10;4&e&&(t+=n[10]|2+(n[11]<<8));for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!n[t++]);return t+(2&e)},rO=function(n){var e=n.length;return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0},Rw=function(n){return 10+(n.filename&&n.filename.length+1||0)},Nw=function(n,e){var t=e.level,i=0==t?0:t<6?1:9==t?3:2;n[0]=120,n[1]=i<<6|(i?32-2*i:1)},oO=function(n){if(8!=(15&n[0])||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(32&n[1])throw"invalid zlib data: preset dictionaries not supported"};function Pw(n,e){return!e&&"function"==typeof n&&(e=n,n={}),this.ondata=e,n}var os=function(){function n(e,t){!t&&"function"==typeof e&&(t=e,e={}),this.ondata=t,this.o=e||{}}return n.prototype.p=function(e,t){this.ondata(Hl(e,this.o,0,0,!t),t)},n.prototype.push=function(e,t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=t,this.p(e,t||!1)},n}(),sO=function(){return function n(e,t){td([Qu,function(){return[lo,os]}],this,Pw.call(this,e,t),function(i){var r=new os(i.data);onmessage=lo(r)},6)}}();function aO(n,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return ed(n,e,[Qu],function(i){return Oa(mf(i.data[0],i.data[1]))},0,t)}function mf(n,e){return Hl(n,e||{},0,0)}var mr=function(){function n(e){this.s={},this.p=new Lt(0),this.ondata=e}return n.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var t=this.p.length,i=new Lt(t+e.length);i.set(this.p),i.set(e,t),this.p=i},n.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,i=ff(this.p,this.o,this.s);this.ondata(ao(i,t,this.s.b),this.d),this.o=ao(i,this.s.b-32768),this.s.b=this.o.length,this.p=ao(this.p,this.s.p/8|0),this.s.p&=7},n.prototype.push=function(e,t){this.e(e),this.c(t)},n}(),Ow=function(){return function n(e){this.ondata=e,td([Ju,function(){return[lo,mr]}],this,0,function(){var t=new mr;onmessage=lo(t)},7)}}();function Fw(n,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return ed(n,e,[Ju],function(i){return Oa(nd(i.data[0],Cw(i.data[1])))},1,t)}function nd(n,e){return ff(n,e)}var p_=function(){function n(e,t){this.c=Ku(),this.l=0,this.v=1,os.call(this,e,t)}return n.prototype.push=function(e,t){os.prototype.push.call(this,e,t)},n.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var i=Hl(e,this.o,this.v&&Rw(this.o),t&&8,!t);this.v&&(Aw(i,this.o),this.v=0),t&&(nn(i,i.length-8,this.c.d()),nn(i,i.length-4,this.l)),this.ondata(i,t)},n}(),lO=function(){return function n(e,t){td([Qu,eO,function(){return[lo,os,p_]}],this,Pw.call(this,e,t),function(i){var r=new p_(i.data);onmessage=lo(r)},8)}}();function cO(n,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return ed(n,e,[Qu,eO,function(){return[g_]}],function(i){return Oa(g_(i.data[0],i.data[1]))},2,t)}function g_(n,e){e||(e={});var t=Ku(),i=n.length;t.p(n);var r=Hl(n,e,Rw(e),8),o=r.length;return Aw(r,e),nn(r,o-8,t.d()),nn(r,o-4,i),r}var m_=function(){function n(e){this.v=1,mr.call(this,e)}return n.prototype.push=function(e,t){if(mr.prototype.e.call(this,e),this.v){var i=this.p.length>3?Iw(this.p):4;if(i>=this.p.length&&!t)return;this.p=this.p.subarray(i),this.v=0}if(t){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}mr.prototype.c.call(this,t)},n}(),uO=function(){return function n(e){this.ondata=e,td([Ju,tO,function(){return[lo,mr,m_]}],this,0,function(){var t=new m_;onmessage=lo(t)},9)}}();function dO(n,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return ed(n,e,[Ju,tO,function(){return[__]}],function(i){return Oa(__(i.data[0]))},3,t)}function __(n,e){return ff(n.subarray(Iw(n),-8),e||new Lt(rO(n)))}var kw=function(){function n(e,t){this.c=Ew(),this.v=1,os.call(this,e,t)}return n.prototype.push=function(e,t){os.prototype.push.call(this,e,t)},n.prototype.p=function(e,t){this.c.p(e);var i=Hl(e,this.o,this.v&&2,t&&4,!t);this.v&&(Nw(i,this.o),this.v=0),t&&nn(i,i.length-4,this.c.d()),this.ondata(i,t)},n}(),qZ=function(){return function n(e,t){td([Qu,nO,function(){return[lo,os,kw]}],this,Pw.call(this,e,t),function(i){var r=new kw(i.data);onmessage=lo(r)},10)}}();function YZ(n,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return ed(n,e,[Qu,nO,function(){return[Lw]}],function(i){return Oa(Lw(i.data[0],i.data[1]))},4,t)}function Lw(n,e){e||(e={});var t=Ew();t.p(n);var i=Hl(n,e,2,4);return Nw(i,e),nn(i,i.length-4,t.d()),i}var y_=function(){function n(e){this.v=1,mr.call(this,e)}return n.prototype.push=function(e,t){if(mr.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}if(t){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}mr.prototype.c.call(this,t)},n}(),hO=function(){return function n(e){this.ondata=e,td([Ju,iO,function(){return[lo,mr,y_]}],this,0,function(){var t=new y_;onmessage=lo(t)},11)}}();function fO(n,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return ed(n,e,[Ju,iO,function(){return[_f]}],function(i){return Oa(_f(i.data[0],Cw(i.data[1])))},5,t)}function _f(n,e){return ff((oO(n),n.subarray(2,-4)),e)}var pO=function(){function n(e){this.G=m_,this.I=mr,this.Z=y_,this.ondata=e}return n.prototype.push=function(e,t){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var i=new Lt(this.p.length+e.length);i.set(this.p),i.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var r=this,o=function(){r.ondata.apply(r,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(o):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(o):new this.Z(o),this.s.push(this.p,t),this.p=null}}},n}(),ZZ=function(){function n(e){this.G=uO,this.I=Ow,this.Z=hO,this.ondata=e}return n.prototype.push=function(e,t){pO.prototype.push.call(this,e,t)},n}();function XZ(n,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return 31==n[0]&&139==n[1]&&8==n[2]?dO(n,e,t):8!=(15&n[0])||n[0]>>4>7||(n[0]<<8|n[1])%31?Fw(n,e,t):fO(n,e,t)}function KZ(n,e){return 31==n[0]&&139==n[1]&&8==n[2]?__(n,e):8!=(15&n[0])||n[0]>>4>7||(n[0]<<8|n[1])%31?nd(n,e):_f(n,e)}var Bw=function(n,e,t,i){for(var r in n){var o=n[r],s=e+r;o instanceof Lt?t[s]=[o,i]:Array.isArray(o)?t[s]=[o[0],gf(i,o[1])]:Bw(o,s+"/",t,i)}},gO="undefined"!=typeof TextEncoder&&new TextEncoder,Vw="undefined"!=typeof TextDecoder&&new TextDecoder,mO=0;try{Vw.decode(Zs,{stream:!0}),mO=1}catch(n){}var _O=function(n){for(var e="",t=0;;){var i=n[t++],r=(i>127)+(i>223)+(i>239);if(t+r>n.length)return[e,ao(n,t-1)];r?3==r?(i=((15&i)<<18|(63&n[t++])<<12|(63&n[t++])<<6|63&n[t++])-65536,e+=String.fromCharCode(55296|i>>10,56320|1023&i)):e+=String.fromCharCode(1&r?(31&i)<<6|63&n[t++]:(15&i)<<12|(63&n[t++])<<6|63&n[t++]):e+=String.fromCharCode(i)}},JZ=function(){function n(e){this.ondata=e,mO?this.t=new TextDecoder:this.p=Zs}return n.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(t=!!t,this.t){if(this.ondata(this.t.decode(e,{stream:!0}),t),t){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var i=new Lt(this.p.length+e.length);i.set(this.p),i.set(e,this.p.length);var r=_O(i),o=r[0],s=r[1];if(t){if(s.length)throw"invalid utf-8 data";this.p=null}else this.p=s;this.ondata(o,t)}},n}(),QZ=function(){function n(e){this.ondata=e}return n.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(Fa(e),this.d=t||!1)},n}();function Fa(n,e){if(e){for(var t=new Lt(n.length),i=0;i<n.length;++i)t[i]=n.charCodeAt(i);return t}if(gO)return gO.encode(n);var r=n.length,o=new Lt(n.length+(n.length>>1)),s=0,a=function(u){o[s++]=u};for(i=0;i<r;++i){if(s+5>o.length){var l=new Lt(s+8+(r-i<<1));l.set(o),o=l}var c=n.charCodeAt(i);c<128||e?a(c):c<2048?(a(192|c>>6),a(128|63&c)):c>55295&&c<57344?(a(240|(c=65536+(1047552&c)|1023&n.charCodeAt(++i))>>18),a(128|c>>12&63),a(128|c>>6&63),a(128|63&c)):(a(224|c>>12),a(128|c>>6&63),a(128|63&c))}return ao(o,0,s)}function Hw(n,e){if(e){for(var t="",i=0;i<n.length;i+=16384)t+=String.fromCharCode.apply(null,n.subarray(i,i+16384));return t}if(Vw)return Vw.decode(n);var r=_O(n);if(r[1].length)throw"invalid utf-8 data";return r[0]}var yO=function(n){return 1==n?3:n<6?2:9==n?1:0},vO=function(n,e){return e+30+sr(n,e+26)+sr(n,e+28)},bO=function(n,e,t){var i=sr(n,e+28),r=Hw(n.subarray(e+46,e+46+i),!(2048&sr(n,e+8))),o=e+46+i,s=Kn(n,e+20),a=t&&4294967295==s?wO(n,o):[s,Kn(n,e+24),Kn(n,e+42)],l=a[0],c=a[1],u=a[2];return[sr(n,e+10),l,c,r,o+sr(n,e+30)+sr(n,e+32),u]},wO=function(n,e){for(;1!=sr(n,e);e+=4+sr(n,e+2));return[Tw(n,e+12),Tw(n,e+4),Tw(n,e+20)]},ka=function(n){var e=0;if(n)for(var t in n){var i=n[t].length;if(i>65535)throw"extra field too long";e+=i+4}return e},id=function(n,e,t,i,r,o,s,a){var l=i.length,c=t.extra,u=a&&a.length,d=ka(c);nn(n,e,null!=s?33639248:67324752),e+=4,null!=s&&(n[e++]=20,n[e++]=t.os),n[e]=20,e+=2,n[e++]=t.flag<<1|(null==o&&8),n[e++]=r&&8,n[e++]=255&t.compression,n[e++]=t.compression>>8;var h=new Date(null==t.mtime?Date.now():t.mtime),f=h.getFullYear()-1980;if(f<0||f>119)throw"date not in range 1980-2099";if(nn(n,e,f<<25|h.getMonth()+1<<21|h.getDate()<<16|h.getHours()<<11|h.getMinutes()<<5|h.getSeconds()>>>1),e+=4,null!=o&&(nn(n,e,t.crc),nn(n,e+4,o),nn(n,e+8,t.size)),nn(n,e+12,l),nn(n,e+14,d),e+=16,null!=s&&(nn(n,e,u),nn(n,e+6,t.attrs),nn(n,e+10,s),e+=14),n.set(i,e),e+=l,d)for(var g in c){var p=c[g],m=p.length;nn(n,e,+g),nn(n,e+2,m),n.set(p,e+4),e+=4+m}return u&&(n.set(a,e),e+=u),e},Uw=function(n,e,t,i,r){nn(n,e,101010256),nn(n,e+8,t),nn(n,e+10,t),nn(n,e+12,i),nn(n,e+16,r)},yf=function(){function n(e){this.filename=e,this.c=Ku(),this.size=0,this.compression=0}return n.prototype.process=function(e,t){this.ondata(null,e,t)},n.prototype.push=function(e,t){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},n}(),eX=function(){function n(e,t){var i=this;t||(t={}),yf.call(this,e),this.d=new os(t,function(r,o){i.ondata(null,r,o)}),this.compression=8,this.flag=yO(t.level)}return n.prototype.process=function(e,t){try{this.d.push(e,t)}catch(i){this.ondata(i,null,t)}},n.prototype.push=function(e,t){yf.prototype.push.call(this,e,t)},n}(),tX=function(){function n(e,t){var i=this;t||(t={}),yf.call(this,e),this.d=new sO(t,function(r,o,s){i.ondata(r,o,s)}),this.compression=8,this.flag=yO(t.level),this.terminate=this.d.terminate}return n.prototype.process=function(e,t){this.d.push(e,t)},n.prototype.push=function(e,t){yf.prototype.push.call(this,e,t)},n}(),nX=function(){function n(e){this.ondata=e,this.u=[],this.d=1}return n.prototype.add=function(e){var t=this;if(2&this.d)throw"stream finished";var i=Fa(e.filename),r=i.length,o=e.comment,s=o&&Fa(o),a=r!=e.filename.length||s&&o.length!=s.length,l=r+ka(e.extra)+30;if(r>65535)throw"filename too long";var c=new Lt(l);id(c,0,e,i,a);var u=[c],d=function(){for(var m=0,y=u;m<y.length;m++)t.ondata(null,y[m],!1);u=[]},h=this.d;this.d=0;var f=this.u.length,g=gf(e,{f:i,u:a,o:s,t:function(){e.terminate&&e.terminate()},r:function(){if(d(),h){var m=t.u[f+1];m?m.r():t.d=1}h=1}}),p=0;e.ondata=function(m,y,_){if(m)t.ondata(m,y,_),t.terminate();else if(p+=y.length,u.push(y),_){var v=new Lt(16);nn(v,0,134695760),nn(v,4,e.crc),nn(v,8,p),nn(v,12,e.size),u.push(v),g.c=p,g.b=l+p+16,g.crc=e.crc,g.size=e.size,h&&g.r(),h=1}else h&&d()},this.u.push(g)},n.prototype.end=function(){var e=this;if(2&this.d)throw 1&this.d?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){!(1&e.d)||(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},n.prototype.e=function(){for(var e=0,t=0,i=0,r=0,o=this.u;r<o.length;r++)i+=46+(s=o[r]).f.length+ka(s.extra)+(s.o?s.o.length:0);for(var a=new Lt(i+22),l=0,c=this.u;l<c.length;l++){var s;id(a,e,s=c[l],s.f,s.u,s.c,t,s.o),e+=46+s.f.length+ka(s.extra)+(s.o?s.o.length:0),t+=s.b}Uw(a,e,this.u.length,i,t),this.ondata(null,a,!0),this.d=2},n.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++)t[e].t();this.d=2},n}();function iX(n,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";var i={};Bw(n,"",i,e);var r=Object.keys(i),o=r.length,s=0,a=0,l=o,c=new Array(o),u=[],d=function(){for(var p=0;p<u.length;++p)u[p]()},h=function(){var p=new Lt(a+22),m=s,y=a-s;a=0;for(var _=0;_<l;++_){var v=c[_];try{var b=v.c.length;id(p,a,v,v.f,v.u,b);var w=30+v.f.length+ka(v.extra),D=a+w;p.set(v.c,D),id(p,s,v,v.f,v.u,b,a,v.m),s+=16+w+(v.m?v.m.length:0),a=D+b}catch(C){return t(C,null)}}Uw(p,s,c.length,y,m),t(null,p)};o||h();for(var f=function(p){var m=r[p],y=i[m],_=y[0],v=y[1],b=Ku(),w=_.length;b.p(_);var D=Fa(m),C=D.length,T=v.comment,G=T&&Fa(T),O=G&&G.length,x=ka(v.extra),N=0==v.level?0:8,q=function(L,j){if(L)d(),t(L,null);else{var z=j.length;c[p]=gf(v,{size:w,crc:b.d(),c:j,f:D,m:G,u:C!=m.length||G&&T.length!=O,compression:N}),s+=30+C+x+z,a+=76+2*(C+x)+(O||0)+z,--o||h()}};if(C>65535&&q("filename too long",null),N)if(w<16e4)try{q(null,mf(_,v))}catch(L){q(L,null)}else u.push(aO(_,v,q));else q(null,_)},g=0;g<l;++g)f(g);return d}function rX(n,e){e||(e={});var t={},i=[];Bw(n,"",t,e);var r=0,o=0;for(var s in t){var a=t[s],l=a[0],c=a[1],u=0==c.level?0:8,h=(d=Fa(s)).length,f=c.comment,g=f&&Fa(f),p=g&&g.length,m=ka(c.extra);if(h>65535)throw"filename too long";var y=u?mf(l,c):l,_=y.length,v=Ku();v.p(l),i.push(gf(c,{size:l.length,crc:v.d(),c:y,f:d,m:g,u:h!=s.length||g&&f.length!=p,o:r,compression:u})),r+=30+h+m+_,o+=76+2*(h+m)+(p||0)+_}for(var b=new Lt(o+22),w=r,D=o-r,C=0;C<i.length;++C){var d;id(b,(d=i[C]).o,d,d.f,d.u,d.c.length);var T=30+d.f.length+ka(d.extra);b.set(d.c,d.o+T),id(b,r,d,d.f,d.u,d.c.length,d.o,d.m),r+=16+T+(d.m?d.m.length:0)}return Uw(b,r,i.length,D,w),b}var xO=function(){function n(){}return n.prototype.push=function(e,t){this.ondata(null,e,t)},n.compression=0,n}(),oX=function(){function n(){var e=this;this.i=new mr(function(t,i){e.ondata(null,t,i)})}return n.prototype.push=function(e,t){try{this.i.push(e,t)}catch(i){this.ondata(i,e,t)}},n.compression=8,n}(),sX=function(){function n(e,t){var i=this;t<32e4?this.i=new mr(function(r,o){i.ondata(null,r,o)}):(this.i=new Ow(function(r,o,s){i.ondata(r,o,s)}),this.terminate=this.i.terminate)}return n.prototype.push=function(e,t){this.i.terminate&&(e=ao(e,0)),this.i.push(e,t)},n.compression=8,n}(),aX=function(){function n(e){this.onfile=e,this.k=[],this.o={0:xO},this.p=Zs}return n.prototype.push=function(e,t){var i=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var r=Math.min(this.c,e.length),o=e.subarray(0,r);if(this.c-=r,this.d?this.d.push(o,!this.c):this.k[0].push(o),(e=e.subarray(r)).length)return this.push(e,t)}else{var s=0,a=0,l=void 0,c=void 0;this.p.length?e.length?((c=new Lt(this.p.length+e.length)).set(this.p),c.set(e,this.p.length)):c=this.p:c=e;for(var u=c.length,d=this.c,h=d&&this.d,f=function(){var y,_=Kn(c,a);if(67324752==_){s=1,l=a,g.d=null,g.c=0;var v=sr(c,a+6),b=sr(c,a+8),w=2048&v,D=8&v,C=sr(c,a+26),T=sr(c,a+28);if(u>a+30+C+T){var G=[];g.k.unshift(G),s=2;var O=Kn(c,a+18),x=Kn(c,a+22),N=Hw(c.subarray(a+30,a+=30+C),!w);4294967295==O?(y=D?[-2]:wO(c,a),O=y[0],x=y[1]):D&&(O=-1),a+=T,g.c=O;var q,L={name:N,compression:b,start:function(){if(!L.ondata)throw"no callback";if(O){var j=i.o[b];if(!j)throw"unknown compression type "+b;(q=O<0?new j(N):new j(N,O,x)).ondata=function(X,ee,se){L.ondata(X,ee,se)};for(var z=0,$=G;z<$.length;z++)q.push($[z],!1);i.k[0]==G&&i.c?i.d=q:q.push(Zs,!0)}else L.ondata(null,Zs,!0)},terminate:function(){q&&q.terminate&&q.terminate()}};O>=0&&(L.size=O,L.originalSize=x),g.onfile(L)}return"break"}if(d){if(134695760==_)return l=a+=12+(-2==d&&8),s=3,g.c=0,"break";if(33639248==_)return l=a-=4,s=3,g.c=0,"break"}},g=this;a<u-4&&"break"!==f();++a);if(this.p=Zs,d<0){var m=c.subarray(0,s?l-12-(-2==d&&8)-(134695760==Kn(c,l-16)&&4):a);h?h.push(m,!!s):this.k[+(2==s)].push(m)}if(2&s)return this.push(c.subarray(a),t);this.p=c.subarray(a)}if(t){if(this.c)throw"invalid zip file";this.p=null}},n.prototype.register=function(e){this.o[e.compression]=e},n}();function lX(n,e){if("function"!=typeof e)throw"no callback";for(var t=[],i=function(){for(var h=0;h<t.length;++h)t[h]()},r={},o=n.length-22;101010256!=Kn(n,o);--o)if(!o||n.length-o>65558)return void e("invalid zip file",null);var s=sr(n,o+8);s||e(null,{});var a=s,l=Kn(n,o+16),c=4294967295==l;if(c){if(o=Kn(n,o-12),101075792!=Kn(n,o))return void e("invalid zip file",null);a=s=Kn(n,o+32),l=Kn(n,o+48)}for(var u=function(h){var f=bO(n,l,c),g=f[0],p=f[1],m=f[2],y=f[3],_=f[4],b=vO(n,f[5]);l=_;var w=function(C,T){C?(i(),e(C,null)):(r[y]=T,--s||e(null,r))};if(g)if(8==g){var D=n.subarray(b,b+p);if(p<32e4)try{w(null,nd(D,new Lt(m)))}catch(C){w(C,null)}else t.push(Fw(D,{size:m},w))}else w("unknown compression type "+g,null);else w(null,ao(n,b,b+p))},d=0;d<a;++d)u();return i}function cX(n){for(var e={},t=n.length-22;101010256!=Kn(n,t);--t)if(!t||n.length-t>65558)throw"invalid zip file";var i=sr(n,t+8);if(!i)return{};var r=Kn(n,t+16),o=4294967295==r;if(o){if(t=Kn(n,t-12),101075792!=Kn(n,t))throw"invalid zip file";i=Kn(n,t+32),r=Kn(n,t+48)}for(var s=0;s<i;++s){var a=bO(n,r,o),l=a[0],c=a[1],u=a[2],d=a[3],h=a[4],g=vO(n,a[5]);if(r=h,l){if(8!=l)throw"unknown compression type "+l;e[d]=nd(n.subarray(g,g+c),new Lt(u))}else e[d]=ao(n,g,g+c)}return e}function v_(n,e,t){const i=t.length-n-1;if(e>=t[i])return i-1;if(e<=t[n])return n;let r=n,o=i,s=Math.floor((r+o)/2);for(;e<t[s]||e>=t[s+1];)e<t[s]?o=s:r=s,s=Math.floor((r+o)/2);return s}function fX(n,e){let t=1;for(let r=2;r<=n;++r)t*=r;let i=1;for(let r=2;r<=e;++r)i*=r;for(let r=2;r<=n-e;++r)i*=r;return t/i}class MO extends Br{constructor(e,t,i,r,o){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=o||this.knots.length-1;for(let s=0;s<i.length;++s){const a=i[s];this.controlPoints[s]=new Zt(a.x,a.y,a.z,a.w)}}getPoint(e,t=new M){const i=t,o=function uX(n,e,t,i){const r=v_(n,i,e),o=function zw(n,e,t,i){const r=[],o=[],s=[];r[0]=1;for(let a=1;a<=t;++a){o[a]=e-i[n+1-a],s[a]=i[n+a]-e;let l=0;for(let c=0;c<a;++c){const u=s[c+1],d=o[a-c],h=r[c]/(u+d);r[c]=l+u*h,l=d*h}r[a]=l}return r}(r,i,n,e),s=new Zt(0,0,0,0);for(let a=0;a<=n;++a){const l=t[r-n+a],c=o[a],u=l.w*c;s.x+=l.x*u,s.y+=l.y*u,s.z+=l.z*u,s.w+=l.w*c}return s}(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!==o.w&&o.divideScalar(o.w),i.set(o.x,o.y,o.z)}getTangent(e,t=new M){const i=t,o=function gX(n,e,t,i,r){const o=function hX(n,e,t,i,r){const o=r<n?r:n,s=[],a=v_(n,i,e),l=function dX(n,e,t,i,r){const o=[];for(let d=0;d<=t;++d)o[d]=0;const s=[];for(let d=0;d<=i;++d)s[d]=o.slice(0);const a=[];for(let d=0;d<=t;++d)a[d]=o.slice(0);a[0][0]=1;const l=o.slice(0),c=o.slice(0);for(let d=1;d<=t;++d){l[d]=e-r[n+1-d],c[d]=r[n+d]-e;let h=0;for(let f=0;f<d;++f){const g=c[f+1],p=l[d-f];a[d][f]=g+p;const m=a[f][d-1]/a[d][f];a[f][d]=h+g*m,h=p*m}a[d][d]=h}for(let d=0;d<=t;++d)s[0][d]=a[d][t];for(let d=0;d<=t;++d){let h=0,f=1;const g=[];for(let p=0;p<=t;++p)g[p]=o.slice(0);g[0][0]=1;for(let p=1;p<=i;++p){let m=0;const y=d-p,_=t-p;d>=p&&(g[f][0]=g[h][0]/a[_+1][y],m=g[f][0]*a[y][_]);const b=d-1<=_?p-1:t-d;for(let D=y>=-1?1:-y;D<=b;++D)g[f][D]=(g[h][D]-g[h][D-1])/a[_+1][y+D],m+=g[f][D]*a[y+D][_];d<=_&&(g[f][p]=-g[h][p-1]/a[_+1][d],m+=g[f][p]*a[d][_]),s[p][d]=m;const w=h;h=f,f=w}}let u=t;for(let d=1;d<=i;++d){for(let h=0;h<=t;++h)s[d][h]*=u;u*=t-d}return s}(a,i,n,o,e),c=[];for(let u=0;u<t.length;++u){const d=t[u].clone(),h=d.w;d.x*=h,d.y*=h,d.z*=h,c[u]=d}for(let u=0;u<=o;++u){const d=c[a-n].clone().multiplyScalar(l[u][0]);for(let h=1;h<=n;++h)d.add(c[a-n+h].clone().multiplyScalar(l[u][h]));s[u]=d}for(let u=o+1;u<=r+1;++u)s[u]=new Zt(0,0,0);return s}(n,e,t,i,r);return function pX(n){const e=n.length,t=[],i=[];for(let o=0;o<e;++o){const s=n[o];t[o]=new M(s.x,s.y,s.z),i[o]=s.w}const r=[];for(let o=0;o<e;++o){const s=t[o].clone();for(let a=1;a<=o;++a)s.sub(r[o-a].clone().multiplyScalar(fX(o,a)*i[a]));r[o]=s.divideScalar(i[0])}return r}(o)}(this.degree,this.knots,this.controlPoints,this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),1);return i.copy(o[1]).normalize(),i}}let Ot,Jn,_r;class DO extends js{constructor(e){super(e)}load(e,t,i,r){const o=this,s=""===o.path?ju.extractUrlBase(e):o.path,a=new $s(this.manager);a.setPath(o.path),a.setResponseType("arraybuffer"),a.setRequestHeader(o.requestHeader),a.setWithCredentials(o.withCredentials),a.load(e,function(l){try{t(o.parse(l,s))}catch(c){r?r(c):console.error(c),o.manager.itemError(e)}},i,r)}parse(e,t){if(function wX(n){const e="Kaydara FBX Binary  \0";return n.byteLength>=e.length&&e===IO(n,0,e.length)}(e))Ot=(new bX).parse(e);else{const r=IO(e);if(!function xX(n){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function i(r){const o=n[r-1];return n=n.slice(t+r),t++,o}for(let r=0;r<e.length;++r)if(i(1)===e[r])return!1;return!0}(r))throw new Error("THREE.FBXLoader: Unknown format.");if(CO(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+CO(r));Ot=(new vX).parse(r)}const i=new nP(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new mX(i,this.manager).parse(Ot)}}class mX{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){Jn=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),i=this.parseMaterials(t),r=this.parseDeformers(),o=(new _X).parse(r);return this.parseScene(r,o,i),_r}parseConnections(){const e=new Map;return"Connections"in Ot&&Ot.Connections.connections.forEach(function(i){const r=i[0],o=i[1],s=i[2];e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:o,relationship:s};e.get(r).parents.push(a),e.has(o)||e.set(o,{parents:[],children:[]});const l={ID:r,relationship:s};e.get(o).children.push(l)}),e}parseImages(){const e={},t={};if("Video"in Ot.Objects){const i=Ot.Objects.Video;for(const r in i){const o=i[r];if(e[parseInt(r)]=o.RelativeFilename||o.Filename,"Content"in o){const a=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,l="string"==typeof o.Content&&""!==o.Content;if(a||l){const c=this.parseImage(i[r]);t[o.RelativeFilename||o.Filename]=c}}}}for(const i in e){const r=e[i];e[i]=void 0!==t[r]?t[r]:e[i].split("\\").pop()}return e}parseImage(e){const t=e.Content,i=e.RelativeFilename||e.Filename,r=i.slice(i.lastIndexOf(".")+1).toLowerCase();let o;switch(r){case"bmp":o="image/bmp";break;case"jpg":case"jpeg":o="image/jpeg";break;case"png":o="image/png";break;case"tif":o="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",i),o="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof t)return"data:"+o+";base64,"+t;{const s=new Uint8Array(t);return window.URL.createObjectURL(new Blob([s],{type:o}))}}parseTextures(e){const t=new Map;if("Texture"in Ot.Objects){const i=Ot.Objects.Texture;for(const r in i){const o=this.parseTexture(i[r],e);t.set(parseInt(r),o)}}return t}parseTexture(e,t){const i=this.loadTexture(e,t);i.ID=e.id,i.name=e.attrName;const r=e.WrapModeU,o=e.WrapModeV,a=void 0!==o?o.value:0;if(i.wrapS=0===(void 0!==r?r.value:0)?tu:ji,i.wrapT=0===a?tu:ji,"Scaling"in e){const l=e.Scaling.value;i.repeat.x=l[0],i.repeat.y=l[1]}return i}loadTexture(e,t){let i;const r=this.textureLoader.path,o=Jn.get(e.id).children;let s;void 0!==o&&o.length>0&&void 0!==t[o[0].ID]&&(i=t[o[0].ID],(0===i.indexOf("blob:")||0===i.indexOf("data:"))&&this.textureLoader.setPath(void 0));const a=e.FileName.slice(-3).toLowerCase();if("tga"===a){const l=this.manager.getHandler(".tga");null===l?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),s=new Di):(l.setPath(this.textureLoader.path),s=l.load(i))}else"psd"===a?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),s=new Di):s=this.textureLoader.load(i);return this.textureLoader.setPath(r),s}parseMaterials(e){const t=new Map;if("Material"in Ot.Objects){const i=Ot.Objects.Material;for(const r in i){const o=this.parseMaterial(i[r],e);null!==o&&t.set(parseInt(r),o)}}return t}parseMaterial(e,t){const i=e.id,r=e.attrName;let o=e.ShadingModel;if("object"==typeof o&&(o=o.value),!Jn.has(i))return null;const s=this.parseParameters(e,t,i);let a;switch(o.toLowerCase()){case"phong":a=new rf;break;case"lambert":a=new cw;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),a=new rf}return a.setValues(s),a.name=r,a}parseParameters(e,t,i){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=(new ve).fromArray(e.Diffuse.value):e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(r.color=(new ve).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=(new ve).fromArray(e.Emissive.value):e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(r.emissive=(new ve).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=(new ve).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=(new ve).fromArray(e.SpecularColor.value));const o=this;return Jn.get(i).children.forEach(function(s){const a=s.relationship;switch(a){case"Bump":r.bumpMap=o.getTexture(t,s.ID);break;case"Maya|TEX_ao_map":r.aoMap=o.getTexture(t,s.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=o.getTexture(t,s.ID),void 0!==r.map&&(r.map.encoding=hn);break;case"DisplacementColor":r.displacementMap=o.getTexture(t,s.ID);break;case"EmissiveColor":r.emissiveMap=o.getTexture(t,s.ID),void 0!==r.emissiveMap&&(r.emissiveMap.encoding=hn);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=o.getTexture(t,s.ID);break;case"ReflectionColor":r.envMap=o.getTexture(t,s.ID),void 0!==r.envMap&&(r.envMap.mapping=303,r.envMap.encoding=hn);break;case"SpecularColor":r.specularMap=o.getTexture(t,s.ID),void 0!==r.specularMap&&(r.specularMap.encoding=hn);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=o.getTexture(t,s.ID),r.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a)}}),r}getTexture(e,t){return"LayeredTexture"in Ot.Objects&&t in Ot.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=Jn.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in Ot.Objects){const i=Ot.Objects.Deformer;for(const r in i){const o=i[r],s=Jn.get(parseInt(r));if("Skin"===o.attrType){const a=this.parseSkeleton(s,i);a.ID=r,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=s.parents[0].ID,e[r]=a}else if("BlendShape"===o.attrType){const a={id:r};a.rawTargets=this.parseMorphTargets(s,i),a.id=r,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=a}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const i=[];return e.children.forEach(function(r){const o=t[r.ID];if("Cluster"!==o.attrType)return;const s={ID:r.ID,indices:[],weights:[],transformLink:(new ye).fromArray(o.TransformLink.a)};"Indexes"in o&&(s.indices=o.Indexes.a,s.weights=o.Weights.a),i.push(s)}),{rawBones:i,bones:[]}}parseMorphTargets(e,t){const i=[];for(let r=0;r<e.children.length;r++){const o=e.children[r],s=t[o.ID],a={name:s.attrName,initialWeight:s.DeformPercent,id:s.id,fullWeights:s.FullWeights.a};if("BlendShapeChannel"!==s.attrType)return;a.geoID=Jn.get(parseInt(o.ID)).children.filter(function(l){return void 0===l.relationship})[0].ID,i.push(a)}return i}parseScene(e,t,i){_r=new Ea;const r=this.parseModels(e.skeletons,t,i),o=Ot.Objects.Model,s=this;r.forEach(function(l){s.setLookAtProperties(l,o[l.ID]),Jn.get(l.ID).parents.forEach(function(d){const h=r.get(d.ID);void 0!==h&&h.add(l)}),null===l.parent&&_r.add(l)}),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),_r.traverse(function(l){if(l.userData.transformData){l.parent&&(l.userData.transformData.parentMatrix=l.parent.matrix,l.userData.transformData.parentMatrixWorld=l.parent.matrixWorld);const c=TO(l.userData.transformData);l.applyMatrix4(c),l.updateWorldMatrix()}});const a=(new yX).parse();1===_r.children.length&&_r.children[0].isGroup&&(_r.children[0].animations=a,_r=_r.children[0]),_r.animations=a}parseModels(e,t,i){const r=new Map,o=Ot.Objects.Model;for(const s in o){const a=parseInt(s),l=o[s],c=Jn.get(a);let u=this.buildSkeleton(c,e,a,l.attrName);if(!u){switch(l.attrType){case"Camera":u=this.createCamera(c);break;case"Light":u=this.createLight(c);break;case"Mesh":u=this.createMesh(c,t,i);break;case"NurbsCurve":u=this.createCurve(c,t);break;case"LimbNode":case"Root":u=new qh;break;default:u=new Ea}u.name=l.attrName?ln.sanitizeNodeName(l.attrName):"",u.ID=a}this.getTransformData(u,l),r.set(a,u)}return r}buildSkeleton(e,t,i,r){let o=null;return e.parents.forEach(function(s){for(const a in t){const l=t[a];l.rawBones.forEach(function(c,u){if(c.ID===s.ID){const d=o;o=new qh,o.matrixWorld.copy(c.transformLink),o.name=r?ln.sanitizeNodeName(r):"",o.ID=i,l.bones[u]=o,null!==d&&o.add(d)}})}}),o}createCamera(e){let t,i;if(e.children.forEach(function(r){const o=Ot.Objects.NodeAttribute[r.ID];void 0!==o&&(i=o)}),void 0===i)t=new Dt;else{let r=0;void 0!==i.CameraProjectionType&&1===i.CameraProjectionType.value&&(r=1);let o=1;void 0!==i.NearPlane&&(o=i.NearPlane.value/1e3);let s=1e3;void 0!==i.FarPlane&&(s=i.FarPlane.value/1e3);let a=window.innerWidth,l=window.innerHeight;void 0!==i.AspectWidth&&void 0!==i.AspectHeight&&(a=i.AspectWidth.value,l=i.AspectHeight.value);const c=a/l;let u=45;void 0!==i.FieldOfView&&(u=i.FieldOfView.value);const d=i.FocalLength?i.FocalLength.value:null;switch(r){case 0:t=new yi(u,c,o,s),null!==d&&t.setFocalLength(d);break;case 1:t=new zh(-a/2,a/2,l/2,-l/2,o,s);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new Dt}}return t}createLight(e){let t,i;if(e.children.forEach(function(r){const o=Ot.Objects.NodeAttribute[r.ID];void 0!==o&&(i=o)}),void 0===i)t=new Dt;else{let r;r=void 0===i.LightType?0:i.LightType.value;let o=16777215;void 0!==i.Color&&(o=(new ve).fromArray(i.Color.value));let s=void 0===i.Intensity?1:i.Intensity.value/100;void 0!==i.CastLightOnObject&&0===i.CastLightOnObject.value&&(s=0);let a=0;void 0!==i.FarAttenuationEnd&&(a=void 0!==i.EnableFarAttenuation&&0===i.EnableFarAttenuation.value?0:i.FarAttenuationEnd.value);const l=1;switch(r){case 0:t=new Xm(o,s,a,l);break;case 1:t=new Km(o,s);break;case 2:let c=Math.PI/3;void 0!==i.InnerAngle&&(c=no.degToRad(i.InnerAngle.value));let u=0;void 0!==i.OuterAngle&&(u=no.degToRad(i.OuterAngle.value),u=Math.max(u,1)),t=new dw(o,s,a,c,u,l);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),t=new Xm(o,s)}void 0!==i.CastShadows&&1===i.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,i){let r,o=null,s=null;const a=[];return e.children.forEach(function(l){t.has(l.ID)&&(o=t.get(l.ID)),i.has(l.ID)&&a.push(i.get(l.ID))}),a.length>1?s=a:a.length>0?s=a[0]:(s=new rf({color:13421772}),a.push(s)),"color"in o.attributes&&a.forEach(function(l){l.vertexColors=!0}),o.FBX_Deformer?(r=new Sm(o,s),r.normalizeSkinWeights()):r=new we(o,s),r}createCurve(e,t){const i=e.children.reduce(function(o,s){return t.has(s.ID)&&(o=t.get(s.ID)),o},null),r=new vi({color:3342591,linewidth:1});return new qi(i,r)}getTransformData(e,t){const i={};"InheritType"in t&&(i.inheritType=parseInt(t.InheritType.value)),i.eulerOrder="RotationOrder"in t?AO(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(i.translation=t.Lcl_Translation.value),"PreRotation"in t&&(i.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(i.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(i.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(i.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(i.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(i.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(i.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(i.rotationPivot=t.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,t){"LookAtProperty"in t&&Jn.get(e.ID).children.forEach(function(r){if("LookAtProperty"===r.relationship){const o=Ot.Objects.Model[r.ID];if("Lcl_Translation"in o){const s=o.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(s),_r.add(e.target)):e.lookAt((new M).fromArray(s))}}})}bindSkeleton(e,t,i){const r=this.parsePoseNodes();for(const o in e){const s=e[o];Jn.get(parseInt(s.ID)).parents.forEach(function(l){t.has(l.ID)&&Jn.get(l.ID).parents.forEach(function(d){i.has(d.ID)&&i.get(d.ID).bind(new Em(s.bones),r[d.ID])})})}}parsePoseNodes(){const e={};if("Pose"in Ot.Objects){const t=Ot.Objects.Pose;for(const i in t)if("BindPose"===t[i].attrType&&t[i].NbPoseNodes>0){const r=t[i].PoseNode;Array.isArray(r)?r.forEach(function(o){e[o.Node]=(new ye).fromArray(o.Matrix.a)}):e[r.Node]=(new ye).fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in Ot&&"AmbientColor"in Ot.GlobalSettings){const e=Ot.GlobalSettings.AmbientColor.value,t=e[0],i=e[1],r=e[2];if(0!==t||0!==i||0!==r){const o=new ve(t,i,r);_r.add(new fw(o,1))}}}}class _X{parse(e){const t=new Map;if("Geometry"in Ot.Objects){const i=Ot.Objects.Geometry;for(const r in i){const o=Jn.get(parseInt(r)),s=this.parseGeometry(o,i[r],e);t.set(parseInt(r),s)}}return t}parseGeometry(e,t,i){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,i);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,i){const r=i.skeletons,o=[],s=e.parents.map(function(d){return Ot.Objects.Model[d.ID]});if(0===s.length)return;const a=e.children.reduce(function(d,h){return void 0!==r[h.ID]&&(d=r[h.ID]),d},null);e.children.forEach(function(d){void 0!==i.morphTargets[d.ID]&&o.push(i.morphTargets[d.ID])});const l=s[0],c={};"RotationOrder"in l&&(c.eulerOrder=AO(l.RotationOrder.value)),"InheritType"in l&&(c.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(c.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(c.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(c.scale=l.GeometricScaling.value);const u=TO(c);return this.genGeometry(t,a,o,u)}genGeometry(e,t,i,r){const o=new je;e.attrName&&(o.name=e.attrName);const s=this.parseGeoNode(e,t),a=this.genBuffers(s),l=new Fe(a.vertex,3);if(l.applyMatrix4(r),o.setAttribute("position",l),a.colors.length>0&&o.setAttribute("color",new Fe(a.colors,3)),t&&(o.setAttribute("skinIndex",new C1(a.weightsIndices,4)),o.setAttribute("skinWeight",new Fe(a.vertexWeights,4)),o.FBX_Deformer=t),a.normal.length>0){const c=(new mi).getNormalMatrix(r),u=new Fe(a.normal,3);u.applyNormalMatrix(c),o.setAttribute("normal",u)}if(a.uvs.forEach(function(c,u){let d="uv"+(u+1).toString();0===u&&(d="uv"),o.setAttribute(d,new Fe(a.uvs[u],2))}),s.material&&"AllSame"!==s.material.mappingType){let c=a.materialIndex[0],u=0;if(a.materialIndex.forEach(function(d,h){d!==c&&(o.addGroup(u,h-u,c),c=d,u=h)}),o.groups.length>0){const d=o.groups[o.groups.length-1],h=d.start+d.count;h!==a.materialIndex.length&&o.addGroup(h,a.materialIndex.length-h,c)}0===o.groups.length&&o.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(o,e,i,r),o}parseGeoNode(e,t){const i={};if(i.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],i.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return i.weightTable={},null!==t&&(i.skeleton=t,t.rawBones.forEach(function(r,o){r.indices.forEach(function(s,a){void 0===i.weightTable[s]&&(i.weightTable[s]=[]),i.weightTable[s].push({id:o,weight:r.weights[a]})})})),i}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,r=0,o=!1,s=[],a=[],l=[],c=[],u=[],d=[];const h=this;return e.vertexIndices.forEach(function(f,g){let p,m=!1;f<0&&(f^=-1,m=!0);let y=[],_=[];if(s.push(3*f,3*f+1,3*f+2),e.color){const v=b_(g,i,f,e.color);l.push(v[0],v[1],v[2])}if(e.skeleton){if(void 0!==e.weightTable[f]&&e.weightTable[f].forEach(function(v){_.push(v.weight),y.push(v.id)}),_.length>4){o||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),o=!0);const v=[0,0,0,0],b=[0,0,0,0];_.forEach(function(w,D){let C=w,T=y[D];b.forEach(function(G,O,x){if(C>G){x[O]=C,C=G;const N=v[O];v[O]=T,T=N}})}),y=v,_=b}for(;_.length<4;)_.push(0),y.push(0);for(let v=0;v<4;++v)u.push(_[v]),d.push(y[v])}if(e.normal){const v=b_(g,i,f,e.normal);a.push(v[0],v[1],v[2])}e.material&&"AllSame"!==e.material.mappingType&&(p=b_(g,i,f,e.material)[0]),e.uv&&e.uv.forEach(function(v,b){const w=b_(g,i,f,v);void 0===c[b]&&(c[b]=[]),c[b].push(w[0]),c[b].push(w[1])}),r++,m&&(h.genFace(t,e,s,p,a,l,c,u,d,r),i++,r=0,s=[],a=[],l=[],c=[],u=[],d=[])}),t}genFace(e,t,i,r,o,s,a,l,c,u){for(let d=2;d<u;d++)e.vertex.push(t.vertexPositions[i[0]]),e.vertex.push(t.vertexPositions[i[1]]),e.vertex.push(t.vertexPositions[i[2]]),e.vertex.push(t.vertexPositions[i[3*(d-1)]]),e.vertex.push(t.vertexPositions[i[3*(d-1)+1]]),e.vertex.push(t.vertexPositions[i[3*(d-1)+2]]),e.vertex.push(t.vertexPositions[i[3*d]]),e.vertex.push(t.vertexPositions[i[3*d+1]]),e.vertex.push(t.vertexPositions[i[3*d+2]]),t.skeleton&&(e.vertexWeights.push(l[0]),e.vertexWeights.push(l[1]),e.vertexWeights.push(l[2]),e.vertexWeights.push(l[3]),e.vertexWeights.push(l[4*(d-1)]),e.vertexWeights.push(l[4*(d-1)+1]),e.vertexWeights.push(l[4*(d-1)+2]),e.vertexWeights.push(l[4*(d-1)+3]),e.vertexWeights.push(l[4*d]),e.vertexWeights.push(l[4*d+1]),e.vertexWeights.push(l[4*d+2]),e.vertexWeights.push(l[4*d+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(d-1)]),e.weightsIndices.push(c[4*(d-1)+1]),e.weightsIndices.push(c[4*(d-1)+2]),e.weightsIndices.push(c[4*(d-1)+3]),e.weightsIndices.push(c[4*d]),e.weightsIndices.push(c[4*d+1]),e.weightsIndices.push(c[4*d+2]),e.weightsIndices.push(c[4*d+3])),t.color&&(e.colors.push(s[0]),e.colors.push(s[1]),e.colors.push(s[2]),e.colors.push(s[3*(d-1)]),e.colors.push(s[3*(d-1)+1]),e.colors.push(s[3*(d-1)+2]),e.colors.push(s[3*d]),e.colors.push(s[3*d+1]),e.colors.push(s[3*d+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(o[0]),e.normal.push(o[1]),e.normal.push(o[2]),e.normal.push(o[3*(d-1)]),e.normal.push(o[3*(d-1)+1]),e.normal.push(o[3*(d-1)+2]),e.normal.push(o[3*d]),e.normal.push(o[3*d+1]),e.normal.push(o[3*d+2])),t.uv&&t.uv.forEach(function(h,f){void 0===e.uvs[f]&&(e.uvs[f]=[]),e.uvs[f].push(a[f][0]),e.uvs[f].push(a[f][1]),e.uvs[f].push(a[f][2*(d-1)]),e.uvs[f].push(a[f][2*(d-1)+1]),e.uvs[f].push(a[f][2*d]),e.uvs[f].push(a[f][2*d+1])})}addMorphTargets(e,t,i,r){if(0===i.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const o=this;i.forEach(function(s){s.rawTargets.forEach(function(a){const l=Ot.Objects.Geometry[a.geoID];void 0!==l&&o.genMorphGeometry(e,t,l,r,a.name)})})}genMorphGeometry(e,t,i,r,o){const s=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],a=void 0!==i.Vertices?i.Vertices.a:[],l=void 0!==i.Indexes?i.Indexes.a:[],u=new Float32Array(3*e.attributes.position.count);for(let g=0;g<l.length;g++){const p=3*l[g];u[p]=a[3*g],u[p+1]=a[3*g+1],u[p+2]=a[3*g+2]}const h=this.genBuffers({vertexIndices:s,vertexPositions:u}),f=new Fe(h.vertex,3);f.name=o||i.attrName,f.applyMatrix4(r),e.morphAttributes.position.push(f)}parseNormals(e){const i=e.ReferenceInformationType;let o=[];return"IndexToDirect"===i&&("NormalIndex"in e?o=e.NormalIndex.a:"NormalsIndex"in e&&(o=e.NormalsIndex.a)),{dataSize:3,buffer:e.Normals.a,indices:o,mappingType:e.MappingInformationType,referenceType:i}}parseUVs(e){const i=e.ReferenceInformationType;let o=[];return"IndexToDirect"===i&&(o=e.UVIndex.a),{dataSize:2,buffer:e.UV.a,indices:o,mappingType:e.MappingInformationType,referenceType:i}}parseVertexColors(e){const i=e.ReferenceInformationType;let o=[];return"IndexToDirect"===i&&(o=e.ColorIndex.a),{dataSize:4,buffer:e.Colors.a,indices:o,mappingType:e.MappingInformationType,referenceType:i}}parseMaterialIndices(e){const t=e.MappingInformationType,i=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const r=e.Materials.a,o=[];for(let s=0;s<r.length;++s)o.push(s);return{dataSize:1,buffer:r,indices:o,mappingType:t,referenceType:i}}parseNurbsGeometry(e){if(void 0===MO)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new je;const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new je;const i=t-1,r=e.KnotVector.a,o=[],s=e.Points.a;for(let d=0,h=s.length;d<h;d+=4)o.push((new Zt).fromArray(s,d));let a,l;if("Closed"===e.Form)o.push(o[0]);else if("Periodic"===e.Form){a=i,l=r.length-1-a;for(let d=0;d<i;++d)o.push(o[d])}const u=new MO(i,r,o,a,l).getPoints(12*o.length);return(new je).setFromPoints(u)}}class yX{parse(){const e=[],t=this.parseClips();if(void 0!==t)for(const i in t){const o=this.addClip(t[i]);e.push(o)}return e}parseClips(){if(void 0===Ot.Objects.AnimationCurve)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=Ot.Objects.AnimationCurveNode,t=new Map;for(const i in e){const r=e[i];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const o={id:r.id,attr:r.attrName,curves:{}};t.set(o.id,o)}}return t}parseAnimationCurves(e){const t=Ot.Objects.AnimationCurve;for(const i in t){const r={id:t[i].id,times:t[i].KeyTime.a.map(MX),values:t[i].KeyValueFloat.a},o=Jn.get(r.id);if(void 0!==o){const s=o.parents[0].ID,a=o.parents[0].relationship;a.match(/X/)?e.get(s).curves.x=r:a.match(/Y/)?e.get(s).curves.y=r:a.match(/Z/)?e.get(s).curves.z=r:a.match(/d|DeformPercent/)&&e.has(s)&&(e.get(s).curves.morph=r)}}}parseAnimationLayers(e){const t=Ot.Objects.AnimationLayer,i=new Map;for(const r in t){const o=[],s=Jn.get(parseInt(r));void 0!==s&&(s.children.forEach(function(l,c){if(e.has(l.ID)){const u=e.get(l.ID);if(void 0!==u.curves.x||void 0!==u.curves.y||void 0!==u.curves.z){if(void 0===o[c]){const d=Jn.get(l.ID).parents.filter(function(h){return void 0!==h.relationship})[0].ID;if(void 0!==d){const h=Ot.Objects.Model[d.toString()];if(void 0===h)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",l);const f={modelName:h.attrName?ln.sanitizeNodeName(h.attrName):"",ID:h.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};_r.traverse(function(g){g.ID===h.id&&(f.transform=g.matrix,g.userData.transformData&&(f.eulerOrder=g.userData.transformData.eulerOrder))}),f.transform||(f.transform=new ye),"PreRotation"in h&&(f.preRotation=h.PreRotation.value),"PostRotation"in h&&(f.postRotation=h.PostRotation.value),o[c]=f}}o[c]&&(o[c][u.attr]=u)}else if(void 0!==u.curves.morph){if(void 0===o[c]){const d=Jn.get(l.ID).parents.filter(function(y){return void 0!==y.relationship})[0].ID,h=Jn.get(d).parents[0].ID,f=Jn.get(h).parents[0].ID,g=Jn.get(f).parents[0].ID,p=Ot.Objects.Model[g],m={modelName:p.attrName?ln.sanitizeNodeName(p.attrName):"",morphName:Ot.Objects.Deformer[d].attrName};o[c]=m}o[c][u.attr]=u}}}),i.set(parseInt(r),o))}return i}parseAnimStacks(e){const t=Ot.Objects.AnimationStack,i={};for(const r in t){const o=Jn.get(parseInt(r)).children;o.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const s=e.get(o[0].ID);i[r]={name:t[r].attrName,layer:s}}return i}addClip(e){let t=[];const i=this;return e.layer.forEach(function(r){t=t.concat(i.generateTracks(r))}),new Ra(e.name,-1,t)}generateTracks(e){const t=[];let i=new M,r=new Jt,o=new M;if(e.transform&&e.transform.decompose(i,r,o),i=i.toArray(),r=(new kr).setFromQuaternion(r,e.eulerOrder).toArray(),o=o.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){const s=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");void 0!==s&&t.push(s)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){const s=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);void 0!==s&&t.push(s)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){const s=this.generateVectorTrack(e.modelName,e.S.curves,o,"scale");void 0!==s&&t.push(s)}if(void 0!==e.DeformPercent){const s=this.generateMorphTrack(e);void 0!==s&&t.push(s)}return t}generateVectorTrack(e,t,i,r){const o=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(o,t,i);return new af(e+"."+r,o,s)}generateRotationTrack(e,t,i,r,o,s){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(no.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(no.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(no.degToRad));const a=this.getTimesForAllAxes(t),l=this.getKeyframeTrackValues(a,t,i);void 0!==r&&((r=r.map(no.degToRad)).push(s),r=(new kr).fromArray(r),r=(new Jt).setFromEuler(r)),void 0!==o&&((o=o.map(no.degToRad)).push(s),o=(new kr).fromArray(o),o=(new Jt).setFromEuler(o).invert());const c=new Jt,u=new kr,d=[];for(let h=0;h<l.length;h+=3)u.set(l[h],l[h+1],l[h+2],s),c.setFromEuler(u),void 0!==r&&c.premultiply(r),void 0!==o&&c.multiply(o),c.toArray(d,h/3*4);return new Uu(e+".quaternion",a,d)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,i=t.values.map(function(o){return o/100}),r=_r.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new sf(e.modelName+".morphTargetInfluences["+r+"]",t.times,i)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(i,r){return i-r}),t.length>1){let i=1,r=t[0];for(let o=1;o<t.length;o++){const s=t[o];s!==r&&(t[i]=s,r=s,i++)}t=t.slice(0,i)}return t}getKeyframeTrackValues(e,t,i){const r=i,o=[];let s=-1,a=-1,l=-1;return e.forEach(function(c){if(t.x&&(s=t.x.times.indexOf(c)),t.y&&(a=t.y.times.indexOf(c)),t.z&&(l=t.z.times.indexOf(c)),-1!==s){const u=t.x.values[s];o.push(u),r[0]=u}else o.push(r[0]);if(-1!==a){const u=t.y.values[a];o.push(u),r[1]=u}else o.push(r[1]);if(-1!==l){const u=t.z.values[l];o.push(u),r[2]=u}else o.push(r[2])}),o}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const i=e.values[t-1],r=e.values[t]-i,o=Math.abs(r);if(o>=180){const s=o/180,a=r/s;let l=i+a;const c=e.times[t-1],d=(e.times[t]-c)/s;let h=c+d;const f=[],g=[];for(;h<e.times[t];)f.push(h),h+=d,g.push(l),l+=a;e.times=RO(e.times,t,f),e.values=RO(e.values,t,g)}}}}class vX{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new EO,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,i=e.split(/[\r\n]+/);return i.forEach(function(r,o){const s=r.match(/^[\s\t]*;/),a=r.match(/^[\s\t]*$/);if(s||a)return;const l=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),c=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),u=r.match("^\\t{"+(t.currentIndent-1)+"}}");l?t.parseNodeBegin(r,l):c?t.parseNodeProperty(r,c,i[++o]):u?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const i=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(l){return l.trim().replace(/^"/,"").replace(/"$/,"")}),o={name:i},s=this.parseNodeAttr(r),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(i,o):i in a?("PoseNode"===i?a.PoseNode.push(o):void 0!==a[i].id&&(a[i]={},a[i][a[i].id]=a[i]),""!==s.id&&(a[i][s.id]=o)):"number"==typeof s.id?(a[i]={},a[i][s.id]=o):"Properties70"!==i&&(a[i]="PoseNode"===i?[o]:o),"number"==typeof s.id&&(o.id=s.id),""!==s.name&&(o.attrName=s.name),""!==s.type&&(o.attrType=s.type),this.pushStack(o)}parseNodeAttr(e){let t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let i="",r="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:i,type:r}}parseNodeProperty(e,t,i){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),o=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===o&&(o=i.replace(/"/g,"").replace(/,$/,"").trim());const s=this.getCurrentNode();if("Properties70"!==s.name){if("C"===r){const l=o.split(",").slice(1),c=parseInt(l[0]),u=parseInt(l[1]);let d=o.split(",").slice(3);d=d.map(function(h){return h.trim().replace(/^"/,"")}),r="connections",o=[c,u],function SX(n,e){for(let t=0,i=n.length,r=e.length;t<r;t++,i++)n[i]=e[t]}(o,d),void 0===s[r]&&(s[r]=[])}"Node"===r&&(s.id=o),r in s&&Array.isArray(s[r])?s[r].push(o):"a"!==r?s[r]=o:s.a=o,this.setCurrentProp(s,r),"a"===r&&","!==o.slice(-1)&&(s.a=jw(o))}else this.parseNodeSpecialProperty(e,r,o)}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=jw(t.a))}parseNodeSpecialProperty(e,t,i){const r=i.split('",').map(function(u){return u.trim().replace(/^\"/,"").replace(/\s/,"_")}),o=r[0],s=r[1],a=r[2],l=r[3];let c=r[4];switch(s){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=jw(c)}this.getPrevNode()[o]={type:s,type2:a,flag:l,value:c},this.setCurrentProp(this.getPrevNode(),o)}}class bX{parse(e){const t=new SO(e);t.skip(23);const i=t.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const r=new EO;for(;!this.endOfContent(t);){const o=this.parseNode(t,i);null!==o&&r.add(o.name,o)}return r}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const i={},r=t>=7500?e.getUint64():e.getUint32(),o=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const s=e.getUint8(),a=e.getString(s);if(0===r)return null;const l=[];for(let h=0;h<o;h++)l.push(this.parseProperty(e));const c=l.length>0?l[0]:"",u=l.length>1?l[1]:"",d=l.length>2?l[2]:"";for(i.singleProperty=1===o&&e.getOffset()===r;r>e.getOffset();){const h=this.parseNode(e,t);null!==h&&this.parseSubNode(a,i,h)}return i.propertyList=l,"number"==typeof c&&(i.id=c),""!==u&&(i.attrName=u),""!==d&&(i.attrType=d),""!==a&&(i.name=a),i}parseSubNode(e,t,i){if(!0===i.singleProperty){const r=i.propertyList[0];Array.isArray(r)?(t[i.name]=i,i.a=r):t[i.name]=r}else if("Connections"===e&&"C"===i.name){const r=[];i.propertyList.forEach(function(o,s){0!==s&&r.push(o)}),void 0===t.connections&&(t.connections=[]),t.connections.push(r)}else if("Properties70"===i.name)Object.keys(i).forEach(function(o){t[o]=i[o]});else if("Properties70"===e&&"P"===i.name){let r=i.propertyList[0],o=i.propertyList[1];const s=i.propertyList[2],a=i.propertyList[3];let l;0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),0===o.indexOf("Lcl ")&&(o=o.replace("Lcl ","Lcl_")),l="Color"===o||"ColorRGB"===o||"Vector"===o||"Vector3D"===o||0===o.indexOf("Lcl_")?[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:i.propertyList[4],t[r]={type:o,type2:s,flag:a,value:l}}else void 0===t[i.name]?"number"==typeof i.id?(t[i.name]={},t[i.name][i.id]=i):t[i.name]=i:"PoseNode"===i.name?(Array.isArray(t[i.name])||(t[i.name]=[t[i.name]]),t[i.name].push(i)):void 0===t[i.name][i.id]&&(t[i.name][i.id]=i)}parseProperty(e){const t=e.getString(1);let i;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),o=e.getUint32(),s=e.getUint32();if(0===o)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}void 0===Xa&&console.error("THREE.FBXLoader: External library fflate.min.js required.");const a=_f(new Uint8Array(e.getArrayBuffer(s))),l=new SO(a.buffer);switch(t){case"b":case"c":return l.getBooleanArray(r);case"d":return l.getFloat64Array(r);case"f":return l.getFloat32Array(r);case"i":return l.getInt32Array(r);case"l":return l.getInt64Array(r)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class SO{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return 1==(1&this.getUint8())}getBooleanArray(e){const t=[];for(let i=0;i<e;i++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,e=4294967295&~e,4294967295===e&&(t=t+1&4294967295),e=e+1&4294967295,-(4294967296*t+e)):4294967296*t+e}getInt64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();const i=t.indexOf(0);return i>=0&&(t=t.slice(0,i)),ju.decodeText(new Uint8Array(t))}}class EO{add(e,t){this[e]=t}}function CO(n){const t=n.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function MX(n){return n/46186158e3}const DX=[];function b_(n,e,t,i){let r;switch(i.mappingType){case"ByPolygonVertex":r=n;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}"IndexToDirect"===i.referenceType&&(r=i.indices[r]);const o=r*i.dataSize;return function EX(n,e,t,i){for(let r=t,o=0;r<i;r++,o++)n[o]=e[r];return n}(DX,i.buffer,o,o+i.dataSize)}const Gw=new kr,rd=new M;function TO(n){const e=new ye,t=new ye,i=new ye,r=new ye,o=new ye,s=new ye,a=new ye,l=new ye,c=new ye,u=new ye,d=new ye,h=new ye,f=n.inheritType?n.inheritType:0;if(n.translation&&e.setPosition(rd.fromArray(n.translation)),n.preRotation){const O=n.preRotation.map(no.degToRad);O.push(n.eulerOrder),t.makeRotationFromEuler(Gw.fromArray(O))}if(n.rotation){const O=n.rotation.map(no.degToRad);O.push(n.eulerOrder),i.makeRotationFromEuler(Gw.fromArray(O))}if(n.postRotation){const O=n.postRotation.map(no.degToRad);O.push(n.eulerOrder),r.makeRotationFromEuler(Gw.fromArray(O)),r.invert()}n.scale&&o.scale(rd.fromArray(n.scale)),n.scalingOffset&&a.setPosition(rd.fromArray(n.scalingOffset)),n.scalingPivot&&s.setPosition(rd.fromArray(n.scalingPivot)),n.rotationOffset&&l.setPosition(rd.fromArray(n.rotationOffset)),n.rotationPivot&&c.setPosition(rd.fromArray(n.rotationPivot)),n.parentMatrixWorld&&(d.copy(n.parentMatrix),u.copy(n.parentMatrixWorld));const g=t.clone().multiply(i).multiply(r),p=new ye;p.extractRotation(u);const m=new ye;m.copyPosition(u);const y=m.clone().invert().multiply(u),_=p.clone().invert().multiply(y),v=o,b=new ye;if(0===f)b.copy(p).multiply(g).multiply(_).multiply(v);else if(1===f)b.copy(p).multiply(_).multiply(g).multiply(v);else{const x=(new ye).scale((new M).setFromMatrixScale(d)).clone().invert(),N=_.clone().multiply(x);b.copy(p).multiply(g).multiply(N).multiply(v)}const w=c.clone().invert(),D=s.clone().invert();let C=e.clone().multiply(l).multiply(c).multiply(t).multiply(i).multiply(r).multiply(w).multiply(a).multiply(s).multiply(o).multiply(D);const T=(new ye).copyPosition(C),G=u.clone().multiply(T);return h.copyPosition(G),C=h.clone().multiply(b),C.premultiply(u.invert()),C}function AO(n){const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(n=n||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[n]}function jw(n){return n.split(",").map(function(t){return parseFloat(t)})}function IO(n,e,t){return void 0===e&&(e=0),void 0===t&&(t=n.byteLength),ju.decodeText(new Uint8Array(n,e,t))}function RO(n,e,t){return n.slice(0,e).concat(t).concat(n.slice(e))}let NO=(()=>{class n{loadFileAsync(t){var i=this;return Ch(function*(){const r=yield i.useFileLoaderAsync(t);return r.name=(0,Fo.basename)(t),r})()}useFileLoaderAsync(t){return Ch(function*(){if(t.toLowerCase().endsWith(".fbx"))return yield(new DO).loadAsync(t,i=>console.log(i));throw new Error(`could not find file loader for: '${t}'`)})()}loadBuffer(t,i){const r=this.useBufferLoader(t,i);return r.name=(0,Fo.basename)(t),r}useBufferLoader(t,i){if(t.toLowerCase().endsWith(".fbx"))return(new DO).parse(i,"");throw new Error(`could not find buffer loader for: '${t}' `)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();class PO extends Map{}class OO extends Map{}class FO extends Map{}let vf=(()=>{class n{constructor(){this.geometriesSource$=new Yb,this.materialsSource$=new Yb,this.geometries=new PO,this.materials=new OO,this.textures=new FO,this.defaultMaterial=new io({name:"Default Material",color:14869477}),this.geometries$=this.geometriesSource$.asObservable(),this.materials$=this.materialsSource$.asObservable(),this.materials.set(this.defaultMaterial,new Map)}findGeometry(t){return Zb.find(this.geometries.keys(),i=>i.uuid===t)}findMaterial(t){return Zb.find(this.materials.keys(),i=>i.uuid===t)}refreshGeometries(){this.geometriesSource$.next(Array.from(n.getResourceInfo(this.geometries)))}refreshMaterials(){this.materialsSource$.next(Array.from(n.getResourceInfo(this.materials)))}refresh(){this.refreshGeometries(),this.refreshMaterials()}collect(t){const[i,r,o]=n.findAllResources(t);return n.merge(this.geometries,i),n.merge(this.materials,r),n.merge(this.textures,o),this.refresh(),t}replaceGeometry(t,i){n.replace(this.geometries,t,i),this.refreshGeometries()}static replace(t,i,r){if(i===r)return;if(!t.has(i))throw Error(`attempt to replace missing resource ${i}`);t.has(r)||t.set(r,new Map);const o=t.get(i),s=t.get(r);for(const[a,l]of o){s.has(a)||s.set(a,new Set);const c=s.get(a);for(const u of l)n.setProperty(a,u.split("."),i,r),c.add(u)}t.delete(i),i.dispose()}setGeometry(t,i,r,o){n.set(this.geometries,t,i,r,o),this.refreshGeometries()}static set(t,i,r,o,s){if(console.log(`replacing ${o} with ${s} in ${i}`),o!==s){if(null!=o){if(!t.has(o))throw Error(`attempt to set missing resource ${o}`);const a=t.get(o);if(!a.has(i))throw Error(`attempt to set missing object ${o} ${i}`);const l=a.get(i);if(!l.has(r))throw Error(`path ${r} missing for object ${o} ${i}`);l.delete(r),0===l.size&&a.delete(i),null==s&&n.setProperty(i,r.split("."),o,null)}if(null!=s){t.has(s)||t.set(s,new Map);const a=t.get(s);a.has(i)||a.set(i,new Set);const l=a.get(i);l.has(r)&&console.warn(`path ${r} already existed for object ${s} ${i}`),l.add(r),n.setProperty(i,r.split("."),o,s)}}}static findAllResources(t){const i=new PO,r=new OO;for(const s of Oo.traverseAll(t))this.flatten(s,i,this.findGeometries(s)),this.flatten(s,r,this.findMaterials(s));const o=new FO;for(const s of r.keys())this.flatten(s,o,this.findTextures(s));return[i,r,o]}static flatten(t,i,r){for(const[o,s]of r){i.has(o)||i.set(o,new Map);const a=i.get(o);a.has(t)||a.set(t,new Set);const l=a.get(t);l.has(s)&&console.warn(`path ${s} already existed for resource ${o}`),l.add(s)}}static merge(t,i){for(const[r,o]of i){t.has(r)||t.set(r,new Map);const s=t.get(r);for(const[a,l]of o){s.has(a)||s.set(a,new Set);const c=s.get(a);for(const u of l)c.add(u)}}}static*findGeometries(t){for(const[i,r]of Object.entries(t))r instanceof je&&(yield[r,i])}static*findMaterials(t){for(const[i,r]of Object.entries(t))for(const o of this.findProperties(r,i,Ln))yield o}static*findTextures(t){for(const[i,r]of Object.entries(t))for(const o of this.findProperties(r,i,Di))yield o;if(t.uniforms)for(const[i,r]of Object.entries(t.uniforms))if(r.value)for(const o of this.findProperties(r.value,`uniforms.${i}.value`,Di))yield o}static*findProperties(t,i,r){if(t instanceof r&&(yield[t,i]),t instanceof Array)for(const o of t)o instanceof r&&(yield[o,i])}static*getResourceInfo(t){for(const[i,r]of t)yield{resource:i,count:r.size}}static setProperty(t,i,r,o){for(let a=0;a<i.length-1;a++)t=t[i[a]];const s=t[i[i.length-1]];if(s instanceof Array){let a=!1;for(let l=0;l<s.length;l++)s[l]===r&&(s[l]=o,a=!0);a||console.error(`did not find source ${r} in object ${t}`)}else t[i[i.length-1]]=o}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})(),ar=(()=>{class n{constructor(t,i){this.loader=t,this.resources=i,this.sceneSource$=new Yb,this.importSource$=new Ft,this.selectionSource$=new kn([]),this.layoutUpdatedSource$=new Ft,this.focusSource$=new Ft,this.showTabDropZonesSource$=new Ft,this.scene$=this.sceneSource$.asObservable(),this.import$=this.importSource$.asObservable(),this.selection$=this.selectionSource$.asObservable(),this.layoutUpdated$=this.layoutUpdatedSource$.asObservable(),this.focus$=this.focusSource$.asObservable(),this.showTabDropZones$=this.showTabDropZonesSource$.asObservable()}setScene(t){this.resources.collect(Oo.setProperty(t,"autoExpand",!0)),this.sceneSource$.next(t)}import(t,i){t.children.length>0&&Oo.setProperty(t,"autoExpand",!0),this.resources.collect(t),this.importSource$.next({node:t,parent:i}),console.log(t,this.resources)}setSelection(t){return!Zb.arrayEqual(t,this.selectionSource$.getValue())&&(this.selectionSource$.next(t),!0)}updateLayout(){this.layoutUpdatedSource$.next(null)}focus(t){this.focusSource$.next(t)}replaceGeometry(t,i){this.resources.replaceGeometry(t,i),this.replaceInSelection(t,i)}setGeometry(t,i,r,o){this.resources.setGeometry(t,i,r,o)}replaceInSelection(t,i){const r=this.selectionSource$.getValue();for(let o=0;o<r.length;o++)r[o]===t&&(r[o]=i);return this.setSelection(r)}importFileAsync(t){var i=this;return Ch(function*(){i.import(yield i.loader.loadFileAsync(t))})()}tryImportDroppedAsync(t){var i=this;return Ch(function*(){if(t.isExternal&&t.event.dataTransfer&&t.event.dataTransfer.files&&t.event.dataTransfer.files.length>0){const r=[];for(let o=0;o<t.event.dataTransfer.files.length;o++){const s=t.event.dataTransfer.files[o].name,a=yield t.event.dataTransfer.files[o].arrayBuffer();try{const l=i.loader.loadBuffer(s,a);r.push(l)}catch(l){console.error(`Could not import ${s}!`)}}if(r.length>0)for(const o of r)i.import(o)}})()}showTabDropZones(t){this.showTabDropZonesSource$.next(t)}}return n.\u0275fac=function(t){return new(t||n)(ke(NO),ke(vf))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();const kO=["move","copy","link"],w_="application/x-dnd",Ww="application/json",x_="Text";function LO(n){return n.substr(0,w_.length)===w_}function BO(n){if(n.dataTransfer){const e=n.dataTransfer.types;if(!e)return x_;for(let t=0;t<e.length;t++)if(e[t]===x_||e[t]===Ww||LO(e[t]))return e[t]}return null}function M_(n,e){return"all"===e||"uninitialized"===e?n:n.filter(function(t){return-1!==e.toLowerCase().indexOf(t)})}function RX(n,e){const t=window.getComputedStyle(e),i=parseFloat(t.paddingTop)||0,r=parseFloat(t.paddingLeft)||0,o=parseFloat(t.borderTopWidth)||0,s=parseFloat(t.borderLeftWidth)||0;return{x:n.offsetX+r+s,y:n.offsetY+i+o}}const Yi={isDragging:!1,dropEffect:"none",effectAllowed:"all",type:void 0};function VO(){Yi.isDragging=!1,Yi.dropEffect=void 0,Yi.effectAllowed=void 0,Yi.type=void 0}function $w(n,e){!0===Yi.isDragging&&(Yi.dropEffect=e),n.dataTransfer&&(n.dataTransfer.dropEffect=e)}function HO(n,e){let i=M_(kO,n.dataTransfer?n.dataTransfer.effectAllowed:"uninitialized");return!0===Yi.isDragging&&(i=M_(i,Yi.effectAllowed)),e&&(i=M_(i,e)),0===i.length?"none":n.ctrlKey&&-1!==i.indexOf("copy")?"copy":n.altKey&&-1!==i.indexOf("link")?"link":i[0]}function qw(n){if(!0===Yi.isDragging)return Yi.type;const e=BO(n);return null!==e&&e!==x_&&e!==Ww&&e.substr(w_.length+1)||void 0}function Yw(){return!1===Yi.isDragging}const UO=Yi;let D_=(()=>{class n{constructor(t,i,r){this.elementRef=t,this.renderer=i,this.ngZone=r,this.dndEffectAllowed="copy",this.dndDraggingClass="dndDragging",this.dndDraggingSourceClass="dndDraggingSource",this.dndDraggableDisabledClass="dndDraggableDisabled",this.dndDragImageOffsetFunction=RX,this.dndStart=new Ne,this.dndDrag=new Ne,this.dndEnd=new Ne,this.dndMoved=new Ne,this.dndCopied=new Ne,this.dndLinked=new Ne,this.dndCanceled=new Ne,this.draggable=!0,this.isDragStarted=!1,this.dragEventHandler=o=>this.onDrag(o)}set dndDisableIf(t){this.draggable=!t,this.draggable?this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass):this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggableDisabledClass)}set dndDisableDragIf(t){this.dndDisableIf=t}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("drag",this.dragEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("drag",this.dragEventHandler),!0===this.isDragStarted&&VO()}onDragStart(t){if(!1===this.draggable||void 0!==this.dndHandle&&void 0===t._dndUsingHandle)return!1;(function PX(n,e,t){Yi.isDragging=!0,Yi.dropEffect="none",Yi.effectAllowed=e,Yi.type=t,n.dataTransfer&&(n.dataTransfer.effectAllowed=e)})(t,this.dndEffectAllowed,this.dndType),this.isDragStarted=!0,function CX(n,e,t){var i,r,o;const s=w_+(e.type?"-"+e.type:""),a=JSON.stringify(e);try{null===(i=n.dataTransfer)||void 0===i||i.setData(s,a)}catch(l){try{null===(r=n.dataTransfer)||void 0===r||r.setData(Ww,a)}catch(c){const u=M_(kO,t);n.dataTransfer&&(n.dataTransfer.effectAllowed=u[0]),null===(o=n.dataTransfer)||void 0===o||o.setData(x_,a)}}}(t,{data:this.dndDraggable,type:this.dndType},UO.effectAllowed),this.dragImage=this.determineDragImage(),this.renderer.addClass(this.dragImage,this.dndDraggingClass),(void 0!==this.dndDragImageElementRef||void 0!==t._dndUsingHandle)&&function NX(n,e,t){const i=t(n,e)||{x:0,y:0};n.dataTransfer.setDragImage(e,i.x,i.y)}(t,this.dragImage,this.dndDragImageOffsetFunction);const i=this.renderer.listen(this.elementRef.nativeElement,"drag",()=>{this.renderer.addClass(this.elementRef.nativeElement,this.dndDraggingSourceClass),i()});return this.dndStart.emit(t),t.stopPropagation(),!0}onDrag(t){this.dndDrag.emit(t)}onDragEnd(t){let r;switch(UO.dropEffect){case"copy":r=this.dndCopied;break;case"link":r=this.dndLinked;break;case"move":r=this.dndMoved;break;default:r=this.dndCanceled}r.emit(t),this.dndEnd.emit(t),VO(),this.isDragStarted=!1,this.renderer.removeClass(this.dragImage,this.dndDraggingClass),window.setTimeout(()=>{this.renderer.removeClass(this.elementRef.nativeElement,this.dndDraggingSourceClass)},0),t.stopPropagation()}registerDragHandle(t){this.dndHandle=t}registerDragImage(t){this.dndDragImageElementRef=t}determineDragImage(){return void 0!==this.dndDragImageElementRef?this.dndDragImageElementRef.nativeElement:this.elementRef.nativeElement}}return n.\u0275fac=function(t){return new(t||n)(k(Kt),k(zi),k(an))},n.\u0275dir=me({type:n,selectors:[["","dndDraggable",""]],hostVars:1,hostBindings:function(t,i){1&t&&Y("dragstart",function(o){return i.onDragStart(o)})("dragend",function(o){return i.onDragEnd(o)}),2&t&&sn("draggable",i.draggable)},inputs:{dndDraggable:"dndDraggable",dndEffectAllowed:"dndEffectAllowed",dndType:"dndType",dndDraggingClass:"dndDraggingClass",dndDraggingSourceClass:"dndDraggingSourceClass",dndDraggableDisabledClass:"dndDraggableDisabledClass",dndDragImageOffsetFunction:"dndDragImageOffsetFunction",dndDisableIf:"dndDisableIf",dndDisableDragIf:"dndDisableDragIf"},outputs:{dndStart:"dndStart",dndDrag:"dndDrag",dndEnd:"dndEnd",dndMoved:"dndMoved",dndCopied:"dndCopied",dndLinked:"dndLinked",dndCanceled:"dndCanceled"}}),n})(),OX=(()=>{class n{constructor(t){this.elementRef=t}}return n.\u0275fac=function(t){return new(t||n)(k(Kt))},n.\u0275dir=me({type:n,selectors:[["","dndPlaceholderRef",""]]}),n})(),La=(()=>{class n{constructor(t,i,r){this.ngZone=t,this.elementRef=i,this.renderer=r,this.dndDropzone="",this.dndEffectAllowed="uninitialized",this.dndAllowExternal=!1,this.dndHorizontal=!1,this.dndDragoverClass="dndDragover",this.dndDropzoneDisabledClass="dndDropzoneDisabled",this.dndDragover=new Ne,this.dndDrop=new Ne,this.placeholder=null,this.disabled=!1,this.dragEnterEventHandler=o=>this.onDragEnter(o),this.dragOverEventHandler=o=>this.onDragOver(o),this.dragLeaveEventHandler=o=>this.onDragLeave(o)}set dndDisableIf(t){this.disabled=!!t,this.disabled?this.renderer.addClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass):this.renderer.removeClass(this.elementRef.nativeElement,this.dndDropzoneDisabledClass)}set dndDisableDropIf(t){this.dndDisableIf=t}ngAfterViewInit(){this.placeholder=this.tryGetPlaceholder(),this.removePlaceholderFromDOM(),this.ngZone.runOutsideAngular(()=>{this.elementRef.nativeElement.addEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.addEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.addEventListener("dragleave",this.dragLeaveEventHandler)})}ngOnDestroy(){this.elementRef.nativeElement.removeEventListener("dragenter",this.dragEnterEventHandler),this.elementRef.nativeElement.removeEventListener("dragover",this.dragOverEventHandler),this.elementRef.nativeElement.removeEventListener("dragleave",this.dragLeaveEventHandler)}onDragEnter(t){if(!0===t._dndDropzoneActive)return void this.cleanupDragoverState();if(void 0===t._dndDropzoneActive){const r=document.elementFromPoint(t.clientX,t.clientY);this.elementRef.nativeElement.contains(r)&&(t._dndDropzoneActive=!0)}const i=qw(t);!1!==this.isDropAllowed(i)&&t.preventDefault()}onDragOver(t){if(t.defaultPrevented)return;const i=qw(t);if(!1===this.isDropAllowed(i))return;this.checkAndUpdatePlaceholderPosition(t);const r=HO(t,this.dndEffectAllowed);"none"!==r?(t.preventDefault(),$w(t,r),this.dndDragover.emit(t),this.renderer.addClass(this.elementRef.nativeElement,this.dndDragoverClass)):this.cleanupDragoverState()}onDrop(t){try{const i=qw(t);if(!1===this.isDropAllowed(i))return;const r=function TX(n,e){var t,i,r,o;const s=BO(n);return!0===e?null!==s&&LO(s)?JSON.parse(null!==(i=null===(t=n.dataTransfer)||void 0===t?void 0:t.getData(s))&&void 0!==i?i:"{}"):{}:null!==s?JSON.parse(null!==(o=null===(r=n.dataTransfer)||void 0===r?void 0:r.getData(s))&&void 0!==o?o:"{}"):{}}(t,Yw());if(!1===this.isDropAllowed(r.type))return;t.preventDefault();const o=HO(t);if($w(t,o),"none"===o)return;const s=this.getPlaceholderIndex();if(-1===s)return;this.dndDrop.emit({event:t,dropEffect:o,isExternal:Yw(),data:r.data,index:s,type:i}),t.stopPropagation()}finally{this.cleanupDragoverState()}}onDragLeave(t){if(void 0===t._dndDropzoneActive){const i=document.elementFromPoint(t.clientX,t.clientY);if(this.elementRef.nativeElement.contains(i))return void(t._dndDropzoneActive=!0)}this.cleanupDragoverState(),$w(t,"none")}isDropAllowed(t){if(!0===this.disabled||!0===Yw()&&!1===this.dndAllowExternal)return!1;if(!this.dndDropzone||!t)return!0;if(!1===Array.isArray(this.dndDropzone))throw new Error("dndDropzone: bound value to [dndDropzone] must be an array!");return-1!==this.dndDropzone.indexOf(t)}tryGetPlaceholder(){return void 0!==this.dndPlaceholderRef?this.dndPlaceholderRef.elementRef.nativeElement:this.elementRef.nativeElement.querySelector("[dndPlaceholderRef]")}removePlaceholderFromDOM(){null!==this.placeholder&&null!==this.placeholder.parentNode&&this.placeholder.parentNode.removeChild(this.placeholder)}checkAndUpdatePlaceholderPosition(t){if(null===this.placeholder)return;this.placeholder.parentNode!==this.elementRef.nativeElement&&this.renderer.appendChild(this.elementRef.nativeElement,this.placeholder);const i=function AX(n,e){let t=e;for(;t.parentNode!==n;){if(!t.parentNode)return null;t=t.parentNode}return t}(this.elementRef.nativeElement,t.target);null!==i&&i!==this.placeholder&&(function IX(n,e,t){const i=e.getBoundingClientRect();return t?n.clientX<i.left+i.width/2:n.clientY<i.top+i.height/2}(t,i,this.dndHorizontal)?i.previousSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,i):i.nextSibling!==this.placeholder&&this.renderer.insertBefore(this.elementRef.nativeElement,this.placeholder,i.nextSibling))}getPlaceholderIndex(){if(null!==this.placeholder)return Array.prototype.indexOf.call(this.elementRef.nativeElement.children,this.placeholder)}cleanupDragoverState(){this.renderer.removeClass(this.elementRef.nativeElement,this.dndDragoverClass),this.removePlaceholderFromDOM()}}return n.\u0275fac=function(t){return new(t||n)(k(an),k(Kt),k(zi))},n.\u0275dir=me({type:n,selectors:[["","dndDropzone",""]],contentQueries:function(t,i,r){if(1&t&&An(r,OX,5),2&t){let o;xt(o=Mt())&&(i.dndPlaceholderRef=o.first)}},hostBindings:function(t,i){1&t&&Y("drop",function(o){return i.onDrop(o)})},inputs:{dndDropzone:"dndDropzone",dndEffectAllowed:"dndEffectAllowed",dndAllowExternal:"dndAllowExternal",dndHorizontal:"dndHorizontal",dndDragoverClass:"dndDragoverClass",dndDropzoneDisabledClass:"dndDropzoneDisabledClass",dndDisableIf:"dndDisableIf",dndDisableDropIf:"dndDisableDropIf"},outputs:{dndDragover:"dndDragover",dndDrop:"dndDrop"}}),n})(),FX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})();const kX=["addListener","removeListener"],LX=["addEventListener","removeEventListener"],BX=["on","off"];function lr(n,e,t,i){if(At(t)&&(i=t,t=void 0),i)return lr(n,e,t).pipe(xb(i));const[r,o]=function UX(n){return At(n.addEventListener)&&At(n.removeEventListener)}(n)?LX.map(s=>a=>n[s](e,a,t)):function VX(n){return At(n.addListener)&&At(n.removeListener)}(n)?kX.map(zO(n,e)):function HX(n){return At(n.on)&&At(n.off)}(n)?BX.map(zO(n,e)):[];if(!r&&b0(n))return ei(s=>lr(s,e,t))(Fi(n));if(!r)throw new TypeError("Invalid event target");return new pn(s=>{const a=(...l)=>s.next(1<l.length?l:l[0]);return r(a),()=>o(a)})}function zO(n,e){return t=>i=>n[t](e,i)}class zX extends Ve{constructor(e,t){super()}schedule(e,t=0){return this}}const S_={setInterval(n,e,...t){const{delegate:i}=S_;return(null==i?void 0:i.setInterval)?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=S_;return((null==e?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0};class bf{constructor(e,t=bf.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}bf.now=qb.now;const Zw=new class jX extends bf{constructor(e,t=bf.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}(class GX extends zX{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return S_.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;S_.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ue(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),WX=Zw;function Xw(n=0,e,t=WX){let i=-1;return null!=e&&(fM(e)?t=e:i=e),new pn(r=>{let o=function $X(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;o<0&&(o=0);let s=0;return t.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}const{isArray:qX}=Array;function GO(n){return 1===n.length&&qX(n[0])?n[0]:n}function jO(...n){return 1===(n=GO(n)).length?Fi(n[0]):new pn(function YX(n){return e=>{let t=[];for(let i=0;t&&!e.closed&&i<n.length;i++)t.push(Fi(n[i]).subscribe(vn(e,r=>{if(t){for(let o=0;o<t.length;o++)o!==i&&t[o].unsubscribe();t=null}e.next(r)})))}}(n))}function E_(...n){const e=np(n),t=GO(n);return t.length?new pn(i=>{let r=t.map(()=>[]),o=t.map(()=>!1);i.add(()=>{r=o=null});for(let s=0;!i.closed&&s<t.length;s++)Fi(t[s]).subscribe(vn(i,a=>{if(r[s].push(a),r.every(l=>l.length)){const l=r.map(c=>c.shift());i.next(e?e(...l):l),r.some((c,u)=>!c.length&&o[u])&&i.complete()}},()=>{o[s]=!0,!r[s].length&&i.complete()}));return()=>{r=o=null}}):fo}function bi(n){return Vn((e,t)=>{Fi(n).subscribe(vn(t,()=>t.complete(),Qn)),!t.closed&&e.subscribe(t)})}function XX(n,e){return n===e}function Jw(...n){const e=np(n);return Vn((t,i)=>{const r=n.length,o=new Array(r);let s=n.map(()=>!1),a=!1;for(let l=0;l<r;l++)Fi(n[l]).subscribe(vn(i,c=>{o[l]=c,!a&&!s[l]&&(s[l]=!0,(a=s.every(ms))&&(s=null))},Qn));t.subscribe(vn(i,l=>{if(a){const c=[l,...o];i.next(e?e(...c):c)}}))})}function $O(n,e){return e?t=>ph(e.pipe(ui(1),function KX(){return Vn((n,e)=>{n.subscribe(vn(e,Qn))})}()),t.pipe($O(n))):ei((t,i)=>n(t,i).pipe(ui(1),function JX(n){return Bt(()=>n)}(t)))}new pn(Qn);let qO=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(k(zi),k(Kt))},n.\u0275dir=me({type:n}),n})(),Ul=(()=>{class n extends qO{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275dir=me({type:n,features:[lt]}),n})();const Vr=new wt("NgValueAccessor"),nK={provide:Vr,useExisting:Vt(()=>C_),multi:!0};let C_=(()=>{class n extends Ul{writeValue(t){this.setProperty("checked",t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275dir=me({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,i){1&t&&Y("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[dn([nK]),lt]}),n})();const iK={provide:Vr,useExisting:Vt(()=>ss),multi:!0},oK=new wt("CompositionEventMode");let ss=(()=>{class n extends qO{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function rK(){const n=Qo()?Qo().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(k(zi),k(Kt),k(oK,8))},n.\u0275dir=me({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&Y("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[dn([iK]),lt]}),n})();const Oi=new wt("NgValidators"),Va=new wt("NgAsyncValidators");function r2(n){return null!=n}function o2(n){const e=Xd(n)?xi(n):n;return hv(e),e}function s2(n){let e={};return n.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function a2(n,e){return e.map(t=>t(n))}function l2(n){return n.map(e=>function aK(n){return!n.validate}(e)?e:t=>e.validate(t))}function Qw(n){return null!=n?function c2(n){if(!n)return null;const e=n.filter(r2);return 0==e.length?null:function(t){return s2(a2(t,e))}}(l2(n)):null}function ex(n){return null!=n?function u2(n){if(!n)return null;const e=n.filter(r2);return 0==e.length?null:function(t){return function tK(...n){const e=np(n),{args:t,keys:i}=bA(n),r=new pn(o=>{const{length:s}=t;if(!s)return void o.complete();const a=new Array(s);let l=s,c=s;for(let u=0;u<s;u++){let d=!1;Fi(t[u]).subscribe(vn(o,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||o.next(i?wA(i,a):a),o.complete())}))}});return e?r.pipe(xb(e)):r}(a2(t,e).map(o2)).pipe(Bt(s2))}}(l2(n)):null}function d2(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function tx(n){return n?Array.isArray(n)?n:[n]:[]}function A_(n,e){return Array.isArray(n)?n.includes(e):n===e}function p2(n,e){const t=tx(e);return tx(n).forEach(r=>{A_(t,r)||t.push(r)}),t}function g2(n,e){return tx(e).filter(t=>!A_(n,t))}class m2{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Qw(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=ex(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Ha extends m2{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class cr extends m2{get formDirective(){return null}get path(){return null}}let ko=(()=>{class n extends class _2{constructor(e){this._cd=e}is(e){var t,i,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[e])}}{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(k(Ha,2))},n.\u0275dir=me({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&Ze("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[lt]}),n})();function wf(n,e){(function rx(n,e){const t=function h2(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(d2(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function f2(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(d2(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();P_(e._rawValidators,r),P_(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),function mK(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&v2(n,e)})}(n,e),function yK(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function _K(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&v2(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function gK(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function P_(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function v2(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function ax(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const xf="VALID",F_="INVALID",od="PENDING",Mf="DISABLED";function cx(n){return(k_(n)?n.validators:n)||null}function M2(n){return Array.isArray(n)?Qw(n):n||null}function ux(n,e){return(k_(e)?e.asyncValidators:n)||null}function D2(n){return Array.isArray(n)?ex(n):n||null}function k_(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const dx=n=>n instanceof fx;function E2(n){return(n=>n instanceof A2)(n)?n.value:n.getRawValue()}function C2(n,e){const t=dx(n),i=n.controls;if(!(t?Object.keys(i):i).length)throw new Ut(1e3,"");if(!i[e])throw new Ut(1001,"")}function T2(n,e){dx(n),n._forEachChild((i,r)=>{if(void 0===e[r])throw new Ut(1002,"")})}class hx{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=M2(this._rawValidators),this._composedAsyncValidatorFn=D2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===xf}get invalid(){return this.status===F_}get pending(){return this.status==od}get disabled(){return this.status===Mf}get enabled(){return this.status!==Mf}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=M2(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=D2(e)}addValidators(e){this.setValidators(p2(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(p2(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(g2(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(g2(e,this._rawAsyncValidators))}hasValidator(e){return A_(this._rawValidators,e)}hasAsyncValidator(e){return A_(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=od,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Mf,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=xf,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===xf||this.status===od)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Mf:xf}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=od,this._hasOwnPendingAsyncValidator=!0;const t=o2(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function xK(n,e,t){if(null==e||(Array.isArray(e)||(e=e.split(t)),Array.isArray(e)&&0===e.length))return null;let i=n;return e.forEach(r=>{i=dx(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(n=>n instanceof DK)(i)&&i.at(r)||null}),i}(this,e,".")}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ne,this.statusChanges=new Ne}_calculateStatus(){return this._allControlsDisabled()?Mf:this.errors?F_:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(od)?od:this._anyControlsHaveStatus(F_)?F_:xf}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){k_(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class A2 extends hx{constructor(e=null,t,i){super(cx(t),ux(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),k_(t)&&t.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){ax(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){ax(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class fx extends hx{constructor(e,t,i){super(cx(t),ux(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){T2(this,e),Object.keys(e).forEach(i=>{C2(this,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=E2(t),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const i=this.controls[t];if(this.contains(t)&&e(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,i)=>((t.enabled||this.disabled)&&(e[i]=t.value),e))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,o)=>{i=t(i,r,o)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class DK extends hx{constructor(e,t,i){super(cx(t),ux(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,i={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){T2(this,e),e.forEach((i,r)=>{C2(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>E2(e))}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((t,i)=>!!i._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,i)=>{e(t,i)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const CK={provide:Ha,useExisting:Vt(()=>co)},N2=(()=>Promise.resolve(null))();let co=(()=>{class n extends Ha{constructor(t,i,r,o,s){super(),this._changeDetectorRef=s,this.control=new A2,this._registered=!1,this.update=new Ne,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function sx(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(o=>{o.constructor===ss?t=o:function wK(n){return Object.getPrototypeOf(n.constructor)===Ul}(o)?i=o:r=o}),r||i||t||null}(0,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function ox(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){wf(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){N2.then(()=>{var i;this.control.setValue(t,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=""===i||i&&"false"!==i;N2.then(()=>{var o;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(o=this._changeDetectorRef)||void 0===o||o.markForCheck()})}_getPath(t){return this._parent?function R_(n,e){return[...e.path,n]}(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)(k(cr,9),k(Oi,10),k(Va,10),k(Vr,10),k(Kr,8))},n.\u0275dir=me({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[dn([CK]),lt,Bi]}),n})();const AK={provide:Vr,useExisting:Vt(()=>Sf),multi:!0};let Sf=(()=>{class n extends Ul{writeValue(t){this.setProperty("value",null==t?"":t)}registerOnChange(t){this.onChange=i=>{t(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275dir=me({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,i){1&t&&Y("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[dn([AK]),lt]}),n})(),P2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({}),n})();const NK={provide:Vr,useExisting:Vt(()=>gx),multi:!0};let gx=(()=>{class n extends Ul{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=i=>{t(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275dir=me({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,i){1&t&&Y("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[dn([NK]),lt]}),n})();const BK={provide:Vr,useExisting:Vt(()=>L_),multi:!0};function V2(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let L_=(()=>{class n extends Ul{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=V2(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){const i=function VK(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i):t}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275dir=me({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,i){1&t&&Y("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[dn([BK]),lt]}),n})(),H2=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(V2(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(k(Kt),k(zi),k(L_,9))},n.\u0275dir=me({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const HK={provide:Vr,useExisting:Vt(()=>vx),multi:!0};function U2(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let vx=(()=>{class n extends Ul{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let i;if(this.value=t,Array.isArray(t)){const r=t.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const c=this._getOptionValue(s[a].value);r.push(c)}}else{const s=i.options;for(let a=0;a<s.length;a++){const l=s[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,t(r)}}_registerOption(t){const i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){const i=function UK(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275dir=me({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,i){1&t&&Y("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[dn([HK]),lt]}),n})(),z2=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(U2(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(U2(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(k(Kt),k(zi),k(vx,9))},n.\u0275dir=me({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})(),KK=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[P2]]}),n})(),J2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[KK]}),n})();var JK={left:"right",right:"left",bottom:"top",top:"bottom"};function B_(n){return n.replace(/left|right|bottom|top/g,function(e){return JK[e]})}function as(n){return n.split("-")[0]}var QK={start:"end",end:"start"};function Q2(n){return n.replace(/start|end/g,function(e){return QK[e]})}var Hr="top",Lo="bottom",Bo="right",Ur="left",wx="auto",Ef=[Hr,Lo,Bo,Ur],sd="start",Cf="end",eF="viewport",Tf="popper",tF=Ef.reduce(function(n,e){return n.concat([e+"-"+sd,e+"-"+Cf])},[]),nF=[].concat(Ef,[wx]).reduce(function(n,e){return n.concat([e,e+"-"+sd,e+"-"+Cf])},[]),dJ=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Vo(n){if(null==n)return window;if("[object Window]"!==n.toString()){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ad(n){return n instanceof Vo(n).Element||n instanceof Element}function uo(n){return n instanceof Vo(n).HTMLElement||n instanceof HTMLElement}function xx(n){return"undefined"!=typeof ShadowRoot&&(n instanceof Vo(n).ShadowRoot||n instanceof ShadowRoot)}function Ua(n){return((ad(n)?n.ownerDocument:n.document)||window.document).documentElement}var Gl=Math.max,V_=Math.min,ld=Math.round;function cd(n,e){void 0===e&&(e=!1);var t=n.getBoundingClientRect(),i=1,r=1;if(uo(n)&&e){var o=n.offsetHeight,s=n.offsetWidth;s>0&&(i=ld(t.width)/s||1),o>0&&(r=ld(t.height)/o||1)}return{width:t.width/i,height:t.height/r,top:t.top/r,right:t.right/i,bottom:t.bottom/r,left:t.left/i,x:t.left/i,y:t.top/r}}function Mx(n){var e=Vo(n);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Dx(n){return cd(Ua(n)).left+Mx(n).scrollLeft}function Xs(n){return Vo(n).getComputedStyle(n)}function ls(n){return n?(n.nodeName||"").toLowerCase():null}function H_(n){return"html"===ls(n)?n:n.assignedSlot||n.parentNode||(xx(n)?n.host:null)||Ua(n)}function Sx(n){var e=Xs(n);return/auto|scroll|overlay|hidden/.test(e.overflow+e.overflowY+e.overflowX)}function iF(n){return["html","body","#document"].indexOf(ls(n))>=0?n.ownerDocument.body:uo(n)&&Sx(n)?n:iF(H_(n))}function Af(n,e){var t;void 0===e&&(e=[]);var i=iF(n),r=i===(null==(t=n.ownerDocument)?void 0:t.body),o=Vo(i),s=r?[o].concat(o.visualViewport||[],Sx(i)?i:[]):i,a=e.concat(s);return r?a:a.concat(Af(H_(s)))}function pJ(n){return["table","td","th"].indexOf(ls(n))>=0}function rF(n){return uo(n)&&"fixed"!==Xs(n).position?n.offsetParent:null}function If(n){for(var e=Vo(n),t=rF(n);t&&pJ(t)&&"static"===Xs(t).position;)t=rF(t);return t&&("html"===ls(t)||"body"===ls(t)&&"static"===Xs(t).position)?e:t||function gJ(n){var e=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&uo(n)&&"fixed"===Xs(n).position)return null;var r=H_(n);for(xx(r)&&(r=r.host);uo(r)&&["html","body"].indexOf(ls(r))<0;){var o=Xs(r);if("none"!==o.transform||"none"!==o.perspective||"paint"===o.contain||-1!==["transform","perspective"].indexOf(o.willChange)||e&&"filter"===o.willChange||e&&o.filter&&"none"!==o.filter)return r;r=r.parentNode}return null}(n)||e}function oF(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&xx(t)){var i=e;do{if(i&&n.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Ex(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function sF(n,e){return e===eF?Ex(function hJ(n){var e=Vo(n),t=Ua(n),i=e.visualViewport,r=t.clientWidth,o=t.clientHeight,s=0,a=0;return i&&(r=i.width,o=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(s=i.offsetLeft,a=i.offsetTop)),{width:r,height:o,x:s+Dx(n),y:a}}(n)):ad(e)?function mJ(n){var e=cd(n);return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}(e):Ex(function fJ(n){var e,t=Ua(n),i=Mx(n),r=null==(e=n.ownerDocument)?void 0:e.body,o=Gl(t.scrollWidth,t.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),s=Gl(t.scrollHeight,t.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+Dx(n),l=-i.scrollTop;return"rtl"===Xs(r||t).direction&&(a+=Gl(t.clientWidth,r?r.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}(Ua(n)))}function ud(n){return n.split("-")[1]}function Cx(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function aF(n){var l,e=n.reference,t=n.element,i=n.placement,r=i?as(i):null,o=i?ud(i):null,s=e.x+e.width/2-t.width/2,a=e.y+e.height/2-t.height/2;switch(r){case Hr:l={x:s,y:e.y-t.height};break;case Lo:l={x:s,y:e.y+e.height};break;case Bo:l={x:e.x+e.width,y:a};break;case Ur:l={x:e.x-t.width,y:a};break;default:l={x:e.x,y:e.y}}var c=r?Cx(r):null;if(null!=c){var u="y"===c?"height":"width";switch(o){case sd:l[c]=l[c]-(e[u]/2-t[u]/2);break;case Cf:l[c]=l[c]+(e[u]/2-t[u]/2)}}return l}function cF(n){return Object.assign({},{top:0,right:0,bottom:0,left:0},n)}function uF(n,e){return e.reduce(function(t,i){return t[i]=n,t},{})}function Tx(n,e){void 0===e&&(e={});var i=e.placement,r=void 0===i?n.placement:i,o=e.boundary,s=void 0===o?"clippingParents":o,a=e.rootBoundary,l=void 0===a?eF:a,c=e.elementContext,u=void 0===c?Tf:c,d=e.altBoundary,h=void 0!==d&&d,f=e.padding,g=void 0===f?0:f,p=cF("number"!=typeof g?g:uF(g,Ef)),y=n.rects.popper,_=n.elements[h?u===Tf?"reference":Tf:u],v=function yJ(n,e,t){var i="clippingParents"===e?function _J(n){var e=Af(H_(n)),i=["absolute","fixed"].indexOf(Xs(n).position)>=0&&uo(n)?If(n):n;return ad(i)?e.filter(function(r){return ad(r)&&oF(r,i)&&"body"!==ls(r)}):[]}(n):[].concat(e),r=[].concat(i,[t]),s=r.reduce(function(a,l){var c=sF(n,l);return a.top=Gl(c.top,a.top),a.right=V_(c.right,a.right),a.bottom=V_(c.bottom,a.bottom),a.left=Gl(c.left,a.left),a},sF(n,r[0]));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}(ad(_)?_:_.contextElement||Ua(n.elements.popper),s,l),b=cd(n.elements.reference),w=aF({reference:b,element:y,strategy:"absolute",placement:r}),D=Ex(Object.assign({},y,w)),C=u===Tf?D:b,T={top:v.top-C.top+p.top,bottom:C.bottom-v.bottom+p.bottom,left:v.left-C.left+p.left,right:C.right-v.right+p.right},G=n.modifiersData.offset;if(u===Tf&&G){var O=G[r];Object.keys(T).forEach(function(x){var N=[Bo,Lo].indexOf(x)>=0?1:-1,q=[Hr,Lo].indexOf(x)>=0?"y":"x";T[x]+=O[q]*N})}return T}const xJ={name:"flip",enabled:!0,phase:"main",fn:function wJ(n){var e=n.state,t=n.options,i=n.name;if(!e.modifiersData[i]._skip){for(var r=t.mainAxis,o=void 0===r||r,s=t.altAxis,a=void 0===s||s,l=t.fallbackPlacements,c=t.padding,u=t.boundary,d=t.rootBoundary,h=t.altBoundary,f=t.flipVariations,g=void 0===f||f,p=t.allowedAutoPlacements,m=e.options.placement,y=as(m),v=l||(y!==m&&g?function bJ(n){if(as(n)===wx)return[];var e=B_(n);return[Q2(n),e,Q2(e)]}(m):[B_(m)]),b=[m].concat(v).reduce(function(Le,Ie){return Le.concat(as(Ie)===wx?function vJ(n,e){void 0===e&&(e={});var r=e.boundary,o=e.rootBoundary,s=e.padding,a=e.flipVariations,l=e.allowedAutoPlacements,c=void 0===l?nF:l,u=ud(e.placement),d=u?a?tF:tF.filter(function(g){return ud(g)===u}):Ef,h=d.filter(function(g){return c.indexOf(g)>=0});0===h.length&&(h=d);var f=h.reduce(function(g,p){return g[p]=Tx(n,{placement:p,boundary:r,rootBoundary:o,padding:s})[as(p)],g},{});return Object.keys(f).sort(function(g,p){return f[g]-f[p]})}(e,{placement:Ie,boundary:u,rootBoundary:d,padding:c,flipVariations:g,allowedAutoPlacements:p}):Ie)},[]),w=e.rects.reference,D=e.rects.popper,C=new Map,T=!0,G=b[0],O=0;O<b.length;O++){var x=b[O],N=as(x),q=ud(x)===sd,L=[Hr,Lo].indexOf(N)>=0,j=L?"width":"height",z=Tx(e,{placement:x,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),$=L?q?Bo:Ur:q?Lo:Hr;w[j]>D[j]&&($=B_($));var U=B_($),X=[];if(o&&X.push(z[N]<=0),a&&X.push(z[$]<=0,z[U]<=0),X.every(function(Le){return Le})){G=x,T=!1;break}C.set(x,X)}if(T)for(var se=function(Ie){var te=b.find(function(pt){var ze=C.get(pt);if(ze)return ze.slice(0,Ie).every(function(Qe){return Qe})});if(te)return G=te,"break"},ie=g?3:1;ie>0&&"break"!==se(ie);ie--);e.placement!==G&&(e.modifiersData[i]._skip=!0,e.placement=G,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Rf(n,e,t){return Gl(n,V_(e,t))}function Ax(n){var e=cd(n),t=n.offsetWidth,i=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:i}}const EJ={name:"preventOverflow",enabled:!0,phase:"main",fn:function SJ(n){var e=n.state,t=n.options,i=n.name,r=t.mainAxis,o=void 0===r||r,s=t.altAxis,a=void 0!==s&&s,h=t.tether,f=void 0===h||h,g=t.tetherOffset,p=void 0===g?0:g,m=Tx(e,{boundary:t.boundary,rootBoundary:t.rootBoundary,padding:t.padding,altBoundary:t.altBoundary}),y=as(e.placement),_=ud(e.placement),v=!_,b=Cx(y),w=function MJ(n){return"x"===n?"y":"x"}(b),D=e.modifiersData.popperOffsets,C=e.rects.reference,T=e.rects.popper,G="function"==typeof p?p(Object.assign({},e.rects,{placement:e.placement})):p,O="number"==typeof G?{mainAxis:G,altAxis:G}:Object.assign({mainAxis:0,altAxis:0},G),x=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,N={x:0,y:0};if(D){if(o){var q,L="y"===b?Hr:Ur,j="y"===b?Lo:Bo,z="y"===b?"height":"width",$=D[b],U=$+m[L],X=$-m[j],ee=f?-T[z]/2:0,se=_===sd?C[z]:T[z],ie=_===sd?-T[z]:-C[z],Ae=e.elements.arrow,Le=f&&Ae?Ax(Ae):{width:0,height:0},Ie=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},te=Ie[L],pt=Ie[j],ze=Rf(0,C[z],Le[z]),Qe=v?C[z]/2-ee-ze-te-O.mainAxis:se-ze-te-O.mainAxis,_e=v?-C[z]/2+ee+ze+pt+O.mainAxis:ie+ze+pt+O.mainAxis,it=e.elements.arrow&&If(e.elements.arrow),oe=null!=(q=null==x?void 0:x[b])?q:0,Be=$+_e-oe,Ee=Rf(f?V_(U,$+Qe-oe-(it?"y"===b?it.clientTop||0:it.clientLeft||0:0)):U,$,f?Gl(X,Be):X);D[b]=Ee,N[b]=Ee-$}if(a){var rt,jt=D[w],Ht="y"===w?"height":"width",P=jt+m["x"===b?Hr:Ur],E=jt-m["x"===b?Lo:Bo],J=-1!==[Hr,Ur].indexOf(y),de=null!=(rt=null==x?void 0:x[w])?rt:0,Me=J?P:jt-C[Ht]-T[Ht]-de+O.altAxis,Oe=J?jt+C[Ht]+T[Ht]-de-O.altAxis:E,We=f&&J?function DJ(n,e,t){var i=Rf(n,e,t);return i>t?t:i}(Me,jt,Oe):Rf(f?Me:P,jt,f?Oe:E);D[w]=We,N[w]=We-jt}e.modifiersData[i]=N}},requiresIfExists:["offset"]},IJ={name:"arrow",enabled:!0,phase:"main",fn:function TJ(n){var e,t=n.state,i=n.name,r=n.options,o=t.elements.arrow,s=t.modifiersData.popperOffsets,a=as(t.placement),l=Cx(a),u=[Ur,Bo].indexOf(a)>=0?"height":"width";if(o&&s){var d=function(e,t){return cF("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:uF(e,Ef))}(r.padding,t),h=Ax(o),f="y"===l?Hr:Ur,g="y"===l?Lo:Bo,p=t.rects.reference[u]+t.rects.reference[l]-s[l]-t.rects.popper[u],m=s[l]-t.rects.reference[l],y=If(o),_=y?"y"===l?y.clientHeight||0:y.clientWidth||0:0,D=_/2-h[u]/2+(p/2-m/2),C=Rf(d[f],D,_-h[u]-d[g]);t.modifiersData[i]=((e={})[l]=C,e.centerOffset=C-D,e)}},effect:function AJ(n){var e=n.state,i=n.options.element,r=void 0===i?"[data-popper-arrow]":i;null!=r&&("string"==typeof r&&!(r=e.elements.popper.querySelector(r))||!oF(e.elements.popper,r)||(e.elements.arrow=r))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function OJ(n,e,t){void 0===t&&(t=!1);var i=uo(e),r=uo(e)&&function PJ(n){var e=n.getBoundingClientRect(),t=ld(e.width)/n.offsetWidth||1,i=ld(e.height)/n.offsetHeight||1;return 1!==t||1!==i}(e),o=Ua(e),s=cd(n,r),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!t)&&(("body"!==ls(e)||Sx(o))&&(a=function NJ(n){return n!==Vo(n)&&uo(n)?function RJ(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}(n):Mx(n)}(e)),uo(e)?((l=cd(e,!0)).x+=e.clientLeft,l.y+=e.clientTop):o&&(l.x=Dx(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function FJ(n){var e=new Map,t=new Set,i=[];function r(o){t.add(o.name),[].concat(o.requires||[],o.requiresIfExists||[]).forEach(function(a){if(!t.has(a)){var l=e.get(a);l&&r(l)}}),i.push(o)}return n.forEach(function(o){e.set(o.name,o)}),n.forEach(function(o){t.has(o.name)||r(o)}),i}function LJ(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}var dF={placement:"bottom",modifiers:[],strategy:"absolute"};function hF(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(i){return!(i&&"function"==typeof i.getBoundingClientRect)})}function VJ(n){void 0===n&&(n={});var t=n.defaultModifiers,i=void 0===t?[]:t,r=n.defaultOptions,o=void 0===r?dF:r;return function(a,l,c){void 0===c&&(c=o);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},dF,o),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],h=!1,f={state:u,setOptions:function(y){var _="function"==typeof y?y(u.options):y;p(),u.options=Object.assign({},o,u.options,_),u.scrollParents={reference:ad(a)?Af(a):a.contextElement?Af(a.contextElement):[],popper:Af(l)};var v=function kJ(n){var e=FJ(n);return dJ.reduce(function(t,i){return t.concat(e.filter(function(r){return r.phase===i}))},[])}(function BJ(n){var e=n.reduce(function(t,i){var r=t[i.name];return t[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,t},{});return Object.keys(e).map(function(t){return e[t]})}([].concat(i,u.options.modifiers)));return u.orderedModifiers=v.filter(function(x){return x.enabled}),function g(){u.orderedModifiers.forEach(function(m){var _=m.options,b=m.effect;if("function"==typeof b){var w=b({state:u,name:m.name,instance:f,options:void 0===_?{}:_});d.push(w||function(){})}})}(),f.update()},forceUpdate:function(){if(!h){var y=u.elements,_=y.reference,v=y.popper;if(hF(_,v)){u.rects={reference:OJ(_,If(v),"fixed"===u.options.strategy),popper:Ax(v)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(x){return u.modifiersData[x.name]=Object.assign({},x.data)});for(var w=0;w<u.orderedModifiers.length;w++)if(!0!==u.reset){var D=u.orderedModifiers[w],C=D.fn,T=D.options;"function"==typeof C&&(u=C({state:u,options:void 0===T?{}:T,name:D.name,instance:f})||u)}else u.reset=!1,w=-1}}},update:LJ(function(){return new Promise(function(m){f.forceUpdate(),m(u)})}),destroy:function(){p(),h=!0}};if(!hF(a,l))return f;function p(){d.forEach(function(m){return m()}),d=[]}return f.setOptions(c).then(function(m){!h&&c.onFirstUpdate&&c.onFirstUpdate(m)}),f}}var U_={passive:!0},jJ={top:"auto",right:"auto",bottom:"auto",left:"auto"};function fF(n){var e,t=n.popper,i=n.popperRect,r=n.placement,o=n.variation,s=n.offsets,a=n.position,l=n.gpuAcceleration,c=n.adaptive,u=n.roundOffsets,d=n.isFixed,h=s.x,f=void 0===h?0:h,g=s.y,p=void 0===g?0:g,m="function"==typeof u?u({x:f,y:p}):{x:f,y:p};f=m.x,p=m.y;var y=s.hasOwnProperty("x"),_=s.hasOwnProperty("y"),v=Ur,b=Hr,w=window;if(c){var D=If(t),C="clientHeight",T="clientWidth";D===Vo(t)&&"static"!==Xs(D=Ua(t)).position&&"absolute"===a&&(C="scrollHeight",T="scrollWidth"),D=D,(r===Hr||(r===Ur||r===Bo)&&o===Cf)&&(b=Lo,p-=(d&&D===w&&w.visualViewport?w.visualViewport.height:D[C])-i.height,p*=l?1:-1),r!==Ur&&(r!==Hr&&r!==Lo||o!==Cf)||(v=Bo,f-=(d&&D===w&&w.visualViewport?w.visualViewport.width:D[T])-i.width,f*=l?1:-1)}var q,x=Object.assign({position:a},c&&jJ),N=!0===u?function WJ(n){var t=n.y,r=window.devicePixelRatio||1;return{x:ld(n.x*r)/r||0,y:ld(t*r)/r||0}}({x:f,y:p}):{x:f,y:p};return f=N.x,p=N.y,Object.assign({},x,l?((q={})[b]=_?"0":"",q[v]=y?"0":"",q.transform=(w.devicePixelRatio||1)<=1?"translate("+f+"px, "+p+"px)":"translate3d("+f+"px, "+p+"px, 0)",q):((e={})[b]=_?p+"px":"",e[v]=y?f+"px":"",e.transform="",e))}var KJ=VJ({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function HJ(n){var e=n.state,t=n.instance,i=n.options,r=i.scroll,o=void 0===r||r,s=i.resize,a=void 0===s||s,l=Vo(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(u){u.addEventListener("scroll",t.update,U_)}),a&&l.addEventListener("resize",t.update,U_),function(){o&&c.forEach(function(u){u.removeEventListener("scroll",t.update,U_)}),a&&l.removeEventListener("resize",t.update,U_)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function zJ(n){var e=n.state;e.modifiersData[n.name]=aF({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function $J(n){var e=n.state,t=n.options,i=t.gpuAcceleration,r=void 0===i||i,o=t.adaptive,s=void 0===o||o,a=t.roundOffsets,l=void 0===a||a,u={placement:as(e.placement),variation:ud(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,fF(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,fF(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function YJ(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var i=e.styles[t]||{},r=e.attributes[t]||{},o=e.elements[t];!uo(o)||!ls(o)||(Object.assign(o.style,i),Object.keys(r).forEach(function(s){var a=r[s];!1===a?o.removeAttribute(s):o.setAttribute(s,!0===a?"":a)}))})},effect:function ZJ(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(i){var r=e.elements[i],o=e.attributes[i]||{},a=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:t[i]).reduce(function(l,c){return l[c]="",l},{});!uo(r)||!ls(r)||(Object.assign(r.style,a),Object.keys(o).forEach(function(l){r.removeAttribute(l)}))})}},requires:["computeStyles"]}]});const eQ={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function QJ(n){var e=n.state,i=n.name,r=n.options.offset,o=void 0===r?[0,0]:r,s=nF.reduce(function(u,d){return u[d]=function JJ(n,e,t){var i=as(n),r=[Ur,Hr].indexOf(i)>=0?-1:1,o="function"==typeof t?t(Object.assign({},e,{placement:n})):t,s=o[0],a=o[1];return s=s||0,a=(a||0)*r,[Ur,Bo].indexOf(i)>=0?{x:a,y:s}:{x:s,y:a}}(d,e.rects,o),u},{}),a=s[e.placement],c=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=a.x,e.modifiersData.popperOffsets.y+=c),e.modifiersData[i]=s}},lQ=["*"],EQ=["dialog"],CQ=["ngbNavOutlet",""];function TQ(n,e){}const AQ=function(n){return{$implicit:n}};function IQ(n,e){if(1&n&&(F(0,"div",2),W(1,TQ,0,0,"ng-template",3),B()),2&n){const t=H().$implicit,i=H();S("item",t)("nav",i.nav)("role",i.paneRole),A(1),S("ngTemplateOutlet",(null==t.contentTpl?null:t.contentTpl.templateRef)||null)("ngTemplateOutletContext",Ai(5,AQ,t.active||i.isPanelTransitioning(t)))}}function RQ(n,e){if(1&n&&W(0,IQ,2,7,"div",1),2&n){const t=e.$implicit,i=H();S("ngIf",t.isPanelInDom()||i.isPanelTransitioning(t))}}function Rx(n){return"string"==typeof n}function jl(n){return null!=n}function dd(n){return(n||document.body).getBoundingClientRect()}const gF={animation:!0,transitionTimerDelayMs:5},bee=()=>{},{transitionTimerDelayMs:wee}=gF,Nf=new Map,ur=(n,e,t,i)=>{let r=i.context||{};const o=Nf.get(e);if(o)switch(i.runningTransition){case"continue":return fo;case"stop":n.run(()=>o.transition$.complete()),r=Object.assign(o.context,r),Nf.delete(e)}const s=t(e,i.animation,r)||bee;if(!i.animation||"none"===window.getComputedStyle(e).transitionProperty)return n.run(()=>s()),ft(void 0).pipe(function yee(n){return e=>new pn(t=>e.subscribe({next:s=>n.run(()=>t.next(s)),error:s=>n.run(()=>t.error(s)),complete:()=>n.run(()=>t.complete())}))}(n));const a=new Ft,l=new Ft,c=a.pipe(function ZX(...n){return e=>ph(e,ft(...n))}(!0));Nf.set(e,{transition$:a,complete:()=>{l.next(),l.complete()},context:r});const u=function vee(n){const{transitionDelay:e,transitionDuration:t}=window.getComputedStyle(n);return 1e3*(parseFloat(e)+parseFloat(t))}(e);return n.runOutsideAngular(()=>{const d=lr(e,"transitionend").pipe(bi(c),nr(({target:f})=>f===e));jO(Xw(u+wee).pipe(bi(c)),d,l).pipe(bi(c)).subscribe(()=>{Nf.delete(e),n.run(()=>{s(),a.next(),a.complete()})})}),a.asObservable()};let G_=(()=>{class n{constructor(){this.animation=gF.animation}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),wF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),xF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),DF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({}),n})(),CF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),TF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({}),n})();var wi=(()=>{return(n=wi||(wi={}))[n.Tab=9]="Tab",n[n.Enter=13]="Enter",n[n.Escape=27]="Escape",n[n.Space=32]="Space",n[n.PageUp=33]="PageUp",n[n.PageDown=34]="PageDown",n[n.End=35]="End",n[n.Home=36]="Home",n[n.ArrowLeft=37]="ArrowLeft",n[n.ArrowUp=38]="ArrowUp",n[n.ArrowRight=39]="ArrowRight",n[n.ArrowDown=40]="ArrowDown",wi;var n})();const W_=(n,e)=>!!e&&e.some(t=>t.contains(n)),AF=(n,e)=>!e||null!=function _ee(n,e){return e&&void 0!==n.closest?n.closest(e):null}(n,e),Hee="undefined"!=typeof navigator&&!!navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));function zee(n,e,t,i,r,o,s,a){t&&n.runOutsideAngular((n=>Hee?()=>setTimeout(()=>n(),100):n)(()=>{const c=lr(e,"keydown").pipe(bi(r),nr(h=>h.which===wi.Escape),ir(h=>h.preventDefault())),u=lr(e,"mousedown").pipe(Bt(h=>{const f=h.target;return 2!==h.button&&!W_(f,s)&&("inside"===t?W_(f,o)&&AF(f,a):"outside"===t?!W_(f,o):AF(f,a)||!W_(f,o))}),bi(r)),d=lr(e,"mouseup").pipe(Jw(u),nr(([h,f])=>f),function QX(n,e=Zw){const t=Xw(n,e);return $O(()=>t)}(0),bi(r));jO([c.pipe(Bt(h=>0)),d.pipe(Bt(h=>1))]).subscribe(h=>n.run(()=>i(h)))}))}const IF=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function RF(n){const e=Array.from(n.querySelectorAll(IF)).filter(t=>-1!==t.tabIndex);return[e[0],e[e.length-1]]}const jee=/\s+/,Wee=/  +/gi,$ee=/^start/,qee=/^end/,Yee=/-(top|left)$/,Zee=/-(bottom|right)$/,Kee=/^left/,Jee=/^right/,Qee=/^start/,ete=/^end/;function NF({placement:n,baseClass:e}){let t=Array.isArray(n)?n:n.split(jee),r=t.findIndex(l=>"auto"===l);r>=0&&["top","bottom","start","end","top-start","top-end","bottom-start","bottom-end","start-top","start-bottom","end-top","end-bottom"].forEach(function(l){null==t.find(c=>-1!==c.search("^"+l))&&t.splice(r++,1,l)});const o=t.map(l=>function Xee(n){return n.replace($ee,"left").replace(qee,"right").replace(Yee,"-start").replace(Zee,"-end")}(l));return{placement:o.shift(),modifiers:[{name:"bootstrapClasses",enabled:!!e,phase:"write",fn({state:l}){const c=new RegExp(e+"-[a-z]+","gi"),u=l.elements.popper,d=l.placement;let h=u.className;h=h.replace(c,""),h+=` ${function tte(n,e){let[t,i]=e.split("-");const r=t.replace(Kee,"start").replace(Jee,"end");let o=[r];if(i){let s=i;("left"===t||"right"===t)&&(s=s.replace(Qee,"top").replace(ete,"bottom")),o.push(`${r}-${s}`)}return n&&(o=o.map(s=>`${n}-${s}`)),o.join(" ")}(e,d)}`,h=h.trim().replace(Wee," "),u.className=h}},xJ,EJ,IJ,{enabled:!0,name:"flip",options:{fallbackPlacements:o}},{enabled:!0,name:"preventOverflow",phase:"main",fn:function(){}}]}}function PF(n){return n}function ite(n){return e=>(e.modifiers.push(eQ,{name:"offset",options:{offset:()=>n}}),e)}new Date(1882,10,12),new Date(2174,10,25);let VF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr,J2]]}),n})(),hte=(()=>{class n{constructor(){this.autoClose=!0,this.placement=["bottom-start","bottom-end","top-start","top-end"]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),HF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=me({type:n,selectors:[["",8,"navbar"]]}),n})(),Z_=(()=>{class n{constructor(t,i){this.elementRef=t,this._renderer=i,this._disabled=!1}set disabled(t){this._disabled=""===t||!0===t,this._renderer.setProperty(this.elementRef.nativeElement,"disabled",this._disabled)}get disabled(){return this._disabled}}return n.\u0275fac=function(t){return new(t||n)(k(Kt),k(zi))},n.\u0275dir=me({type:n,selectors:[["","ngbDropdownItem",""]],hostAttrs:[1,"dropdown-item"],hostVars:3,hostBindings:function(t,i){2&t&&(la("tabIndex",i.disabled?-1:0),Ze("disabled",i.disabled))},inputs:{disabled:"disabled"}}),n})(),X_=(()=>{class n{constructor(t,i){this.dropdown=t,this.placement="bottom",this.isOpen=!1,this.nativeElement=i.nativeElement}}return n.\u0275fac=function(t){return new(t||n)(k(Vt(()=>Yl)),k(Kt))},n.\u0275dir=me({type:n,selectors:[["","ngbDropdownMenu",""]],contentQueries:function(t,i,r){if(1&t&&An(r,Z_,4),2&t){let o;xt(o=Mt())&&(i.menuItems=o)}},hostVars:4,hostBindings:function(t,i){1&t&&Y("keydown.ArrowUp",function(o){return i.dropdown.onKeyDown(o)})("keydown.ArrowDown",function(o){return i.dropdown.onKeyDown(o)})("keydown.Home",function(o){return i.dropdown.onKeyDown(o)})("keydown.End",function(o){return i.dropdown.onKeyDown(o)})("keydown.Enter",function(o){return i.dropdown.onKeyDown(o)})("keydown.Space",function(o){return i.dropdown.onKeyDown(o)})("keydown.Tab",function(o){return i.dropdown.onKeyDown(o)})("keydown.Shift.Tab",function(o){return i.dropdown.onKeyDown(o)}),2&t&&Ze("dropdown-menu",!0)("show",i.dropdown.isOpen())}}),n})(),K_=(()=>{class n{constructor(t,i){this.dropdown=t,this.nativeElement=i.nativeElement}}return n.\u0275fac=function(t){return new(t||n)(k(Vt(()=>Yl)),k(Kt))},n.\u0275dir=me({type:n,selectors:[["","ngbDropdownAnchor",""]],hostAttrs:[1,"dropdown-toggle"],hostVars:1,hostBindings:function(t,i){2&t&&sn("aria-expanded",i.dropdown.isOpen())}}),n})(),Vx=(()=>{class n extends K_{constructor(t,i){super(t,i)}}return n.\u0275fac=function(t){return new(t||n)(k(Vt(()=>Yl)),k(Kt))},n.\u0275dir=me({type:n,selectors:[["","ngbDropdownToggle",""]],hostAttrs:[1,"dropdown-toggle"],hostVars:1,hostBindings:function(t,i){1&t&&Y("click",function(){return i.dropdown.toggle()})("keydown.ArrowUp",function(o){return i.dropdown.onKeyDown(o)})("keydown.ArrowDown",function(o){return i.dropdown.onKeyDown(o)})("keydown.Home",function(o){return i.dropdown.onKeyDown(o)})("keydown.End",function(o){return i.dropdown.onKeyDown(o)})("keydown.Tab",function(o){return i.dropdown.onKeyDown(o)})("keydown.Shift.Tab",function(o){return i.dropdown.onKeyDown(o)}),2&t&&sn("aria-expanded",i.dropdown.isOpen())},features:[dn([{provide:K_,useExisting:Vt(()=>n)}]),lt]}),n})(),Yl=(()=>{class n{constructor(t,i,r,o,s,a,l){this._changeDetector=t,this._document=r,this._ngZone=o,this._elementRef=s,this._renderer=a,this._destroyCloseHandlers$=new Ft,this._bodyContainer=null,this._positioning=function nte(){let n=null;return{createPopper(e){if(!n){let i=(e.updatePopperOptions||PF)(NF(e));n=KJ(e.hostElement,e.targetElement,i)}},update(){n&&n.update()},setOptions(e){if(n){let i=(e.updatePopperOptions||PF)(NF(e));n.setOptions(i)}},destroy(){n&&(n.destroy(),n=null)}}}(),this._open=!1,this.openChange=new Ne,this.placement=i.placement,this.container=i.container,this.autoClose=i.autoClose,this.display=l?"static":"dynamic",this._zoneSubscription=o.onStable.subscribe(()=>{this._positionMenu()})}ngAfterContentInit(){this._ngZone.onStable.pipe(ui(1)).subscribe(()=>{this._applyPlacementClasses(),this._open&&this._setCloseHandlers()})}ngOnChanges(t){if(t.container&&this._open&&this._applyContainer(this.container),t.placement&&!t.placement.firstChange&&(this._positioning.setOptions({hostElement:this._anchor.nativeElement,targetElement:this._bodyContainer||this._menu.nativeElement,placement:this.placement,appendToBody:"body"===this.container}),this._applyPlacementClasses()),t.dropdownClass){const{currentValue:i,previousValue:r}=t.dropdownClass;this._applyCustomDropdownClass(i,r)}t.autoClose&&this._open&&(this.autoClose=t.autoClose.currentValue,this._setCloseHandlers())}isOpen(){return this._open}open(){this._open||(this._open=!0,this._applyContainer(this.container),this.openChange.emit(!0),this._setCloseHandlers(),this._anchor&&(this._anchor.nativeElement.focus(),"dynamic"===this.display&&this._ngZone.onStable.pipe(ui(1)).subscribe(()=>{this._positioning.createPopper({hostElement:this._anchor.nativeElement,targetElement:this._bodyContainer||this._menu.nativeElement,placement:this.placement,appendToBody:"body"===this.container,updatePopperOptions:ite([0,2])}),this._applyPlacementClasses()})))}_setCloseHandlers(){this._destroyCloseHandlers$.next(),zee(this._ngZone,this._document,this.autoClose,t=>{this.close(),0===t&&this._anchor.nativeElement.focus()},this._destroyCloseHandlers$,this._menu?[this._menu.nativeElement]:[],this._anchor?[this._anchor.nativeElement]:[],".dropdown-item,.dropdown-divider")}close(){this._open&&(this._open=!1,this._positioning.destroy(),this._resetContainer(),this._destroyCloseHandlers$.next(),this.openChange.emit(!1),this._changeDetector.markForCheck())}toggle(){this.isOpen()?this.close():this.open()}ngOnDestroy(){this._resetContainer(),this._destroyCloseHandlers$.next(),this._zoneSubscription.unsubscribe()}onKeyDown(t){const i=t.which,r=this._getMenuElements();let o=-1,s=null;const a=this._isEventFromToggle(t);if(!a&&r.length&&r.forEach((l,c)=>{l.contains(t.target)&&(s=l),l===this._document.activeElement&&(o=c)}),i!==wi.Space&&i!==wi.Enter){if(i!==wi.Tab){if(a||s){if(this.open(),r.length){switch(i){case wi.ArrowDown:o=Math.min(o+1,r.length-1);break;case wi.ArrowUp:if(this._isDropup()&&-1===o){o=r.length-1;break}o=Math.max(o-1,0);break;case wi.Home:o=0;break;case wi.End:o=r.length-1}r[o].focus()}t.preventDefault()}}else if(t.target&&this.isOpen()&&this.autoClose){if(this._anchor.nativeElement===t.target)return void("body"!==this.container||t.shiftKey?t.shiftKey&&this.close():(this._renderer.setAttribute(this._menu.nativeElement,"tabindex","0"),this._menu.nativeElement.focus(),this._renderer.removeAttribute(this._menu.nativeElement,"tabindex")));if("body"===this.container){const l=this._menu.nativeElement.querySelectorAll(IF);t.shiftKey&&t.target===l[0]?(this._anchor.nativeElement.focus(),t.preventDefault()):!t.shiftKey&&t.target===l[l.length-1]&&(this._anchor.nativeElement.focus(),this.close())}else lr(t.target,"focusout").pipe(ui(1)).subscribe(({relatedTarget:l})=>{this._elementRef.nativeElement.contains(l)||this.close()})}}else s&&(!0===this.autoClose||"inside"===this.autoClose)&&lr(s,"click").pipe(ui(1)).subscribe(()=>this.close())}_isDropup(){return this._elementRef.nativeElement.classList.contains("dropup")}_isEventFromToggle(t){return this._anchor.nativeElement.contains(t.target)}_getMenuElements(){const t=this._menu;return null==t?[]:t.menuItems.filter(i=>!i.disabled).map(i=>i.elementRef.nativeElement)}_positionMenu(){const t=this._menu;this.isOpen()&&t&&("dynamic"===this.display?(this._positioning.update(),this._applyPlacementClasses()):this._applyPlacementClasses(this._getFirstPlacement(this.placement)))}_getFirstPlacement(t){return Array.isArray(t)?t[0]:t.split(" ")[0]}_resetContainer(){const t=this._renderer;this._menu&&t.appendChild(this._elementRef.nativeElement,this._menu.nativeElement),this._bodyContainer&&(t.removeChild(this._document.body,this._bodyContainer),this._bodyContainer=null)}_applyContainer(t=null){if(this._resetContainer(),"body"===t){const i=this._renderer,r=this._menu.nativeElement,o=this._bodyContainer=this._bodyContainer||i.createElement("div");i.setStyle(o,"position","absolute"),i.setStyle(r,"position","static"),i.setStyle(o,"z-index","1055"),i.appendChild(o,r),i.appendChild(this._document.body,o)}this._applyCustomDropdownClass(this.dropdownClass)}_applyCustomDropdownClass(t,i){const r="body"===this.container?this._bodyContainer:this._elementRef.nativeElement;r&&(i&&this._renderer.removeClass(r,i),t&&this._renderer.addClass(r,t))}_applyPlacementClasses(t){const i=this._menu;if(i){t||(t=this._getFirstPlacement(this.placement));const r=this._renderer,o=this._elementRef.nativeElement;r.removeClass(o,"dropup"),r.removeClass(o,"dropdown");const{nativeElement:s}=i;"static"===this.display?(i.placement=null,r.setAttribute(s,"data-bs-popper","static")):(i.placement=t,r.removeAttribute(s,"data-bs-popper"));const a=-1!==t.search("^top")?"dropup":"dropdown";r.addClass(o,a);const l=this._bodyContainer;l&&(r.removeClass(l,"dropup"),r.removeClass(l,"dropdown"),r.addClass(l,a))}}}return n.\u0275fac=function(t){return new(t||n)(k(Kr),k(hte),k(Ii),k(an),k(Kt),k(zi),k(HF,8))},n.\u0275dir=me({type:n,selectors:[["","ngbDropdown",""]],contentQueries:function(t,i,r){if(1&t&&(An(r,X_,5),An(r,K_,5)),2&t){let o;xt(o=Mt())&&(i._menu=o.first),xt(o=Mt())&&(i._anchor=o.first)}},hostVars:2,hostBindings:function(t,i){2&t&&Ze("show",i.isOpen())},inputs:{autoClose:"autoClose",dropdownClass:"dropdownClass",_open:["open","_open"],placement:"placement",container:"container",display:"display"},outputs:{openChange:"openChange"},exportAs:["ngbDropdown"],features:[Bi]}),n})(),UF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({}),n})();class Zl{constructor(e,t,i){this.nodes=e,this.viewRef=t,this.componentRef=i}}let fte=(()=>{class n{constructor(t,i){this._el=t,this._zone=i}ngOnInit(){this._zone.onStable.asObservable().pipe(ui(1)).subscribe(()=>{ur(this._zone,this._el.nativeElement,(t,i)=>{i&&dd(t),t.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return ur(this._zone,this._el.nativeElement,({classList:t})=>t.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return n.\u0275fac=function(t){return new(t||n)(k(Kt),k(an))},n.\u0275cmp=He({type:n,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(t,i){2&t&&(Ds("modal-backdrop"+(i.backdropClass?" "+i.backdropClass:"")),Ze("show",!i.animation)("fade",i.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})();class zF{close(e){}dismiss(e){}}class pte{constructor(e,t,i,r){this._windowCmptRef=e,this._contentRef=t,this._backdropCmptRef=i,this._beforeDismiss=r,this._closed=new Ft,this._dismissed=new Ft,this._hidden=new Ft,e.instance.dismissEvent.subscribe(o=>{this.dismiss(o)}),this.result=new Promise((o,s)=>{this._resolve=o,this._reject=s}),this.result.then(null,()=>{})}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(bi(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(bi(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}close(e){this._windowCmptRef&&(this._closed.next(e),this._resolve(e),this._removeModalElements())}_dismiss(e){this._dismissed.next(e),this._reject(e),this._removeModalElements()}dismiss(e){if(this._windowCmptRef)if(this._beforeDismiss){const t=this._beforeDismiss();!function pF(n){return n&&n.then}(t)?!1!==t&&this._dismiss(e):t.then(i=>{!1!==i&&this._dismiss(e)},()=>{})}else this._dismiss(e)}_removeModalElements(){const e=this._windowCmptRef.instance.hide(),t=this._backdropCmptRef?this._backdropCmptRef.instance.hide():ft(void 0);e.subscribe(()=>{const{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),t.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),E_(e,t).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var kf=(()=>{return(n=kf||(kf={}))[n.BACKDROP_CLICK=0]="BACKDROP_CLICK",n[n.ESC=1]="ESC",kf;var n})();let gte=(()=>{class n{constructor(t,i,r){this._document=t,this._elRef=i,this._zone=r,this._closed$=new Ft,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new Ne,this.shown=new Ft,this.hidden=new Ft}get fullscreenClass(){return!0===this.fullscreen?" modal-fullscreen":Rx(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(t){this.dismissEvent.emit(t)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(ui(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:t}=this._elRef,i={animation:this.animation,runningTransition:"stop"},s=E_(ur(this._zone,t,()=>t.classList.remove("show"),i),ur(this._zone,this._dialogEl.nativeElement,()=>{},i));return s.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),s}_show(){const t={animation:this.animation,runningTransition:"continue"};E_(ur(this._zone,this._elRef.nativeElement,(o,s)=>{s&&dd(o),o.classList.add("show")},t),ur(this._zone,this._dialogEl.nativeElement,()=>{},t)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:t}=this._elRef;this._zone.runOutsideAngular(()=>{lr(t,"keydown").pipe(bi(this._closed$),nr(r=>r.which===wi.Escape)).subscribe(r=>{this.keyboard?requestAnimationFrame(()=>{r.defaultPrevented||this._zone.run(()=>this.dismiss(kf.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let i=!1;lr(this._dialogEl.nativeElement,"mousedown").pipe(bi(this._closed$),ir(()=>i=!1),Ts(()=>lr(t,"mouseup").pipe(bi(this._closed$),ui(1))),nr(({target:r})=>t===r)).subscribe(()=>{i=!0}),lr(t,"click").pipe(bi(this._closed$)).subscribe(({target:r})=>{t===r&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!i&&this._zone.run(()=>this.dismiss(kf.BACKDROP_CLICK))),i=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:t}=this._elRef;if(!t.contains(document.activeElement)){const i=t.querySelector("[ngbAutofocus]"),r=RF(t)[0];(i||r||t).focus()}}_restoreFocus(){const t=this._document.body,i=this._elWithFocus;let r;r=i&&i.focus&&t.contains(i)?i:t,this._zone.runOutsideAngular(()=>{setTimeout(()=>r.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&ur(this._zone,this._elRef.nativeElement,({classList:t})=>(t.add("modal-static"),()=>t.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return n.\u0275fac=function(t){return new(t||n)(k(Ii),k(Kt),k(an))},n.\u0275cmp=He({type:n,selectors:[["ngb-modal-window"]],viewQuery:function(t,i){if(1&t&&Gi(EQ,7),2&t){let r;xt(r=Mt())&&(i._dialogEl=r.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(t,i){2&t&&(sn("aria-modal",!0)("aria-labelledby",i.ariaLabelledBy)("aria-describedby",i.ariaDescribedBy),Ds("modal d-block"+(i.windowClass?" "+i.windowClass:"")),Ze("fade",i.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:lQ,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(t,i){1&t&&(kc(),F(0,"div",0,1)(2,"div",2),Lc(3),B()()),2&t&&Ds("modal-dialog"+(i.size?" modal-"+i.size:"")+(i.centered?" modal-dialog-centered":"")+i.fullscreenClass+(i.scrollable?" modal-dialog-scrollable":"")+(i.modalDialogClass?" "+i.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2}),n})(),mte=(()=>{class n{constructor(t){this._document=t}hide(){const t=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),i=this._document.body,r=i.style,{overflow:o,paddingRight:s}=r;if(t>0){const a=parseFloat(window.getComputedStyle(i).paddingRight);r.paddingRight=`${a+t}px`}return r.overflow="hidden",()=>{t>0&&(r.paddingRight=s),r.overflow=o}}}return n.\u0275fac=function(t){return new(t||n)(ke(Ii))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),_te=(()=>{class n{constructor(t,i,r,o,s,a){this._applicationRef=t,this._injector=i,this._document=r,this._scrollBar=o,this._rendererFactory=s,this._ngZone=a,this._activeWindowCmptHasChanged=new Ft,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._backdropAttributes=["animation","backdropClass"],this._modalRefs=[],this._windowAttributes=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","scrollable","size","windowClass","modalDialogClass"],this._windowCmpts=[],this._activeInstances=new Ne,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const l=this._windowCmpts[this._windowCmpts.length-1];((n,e,t,i=!1)=>{this._ngZone.runOutsideAngular(()=>{const r=lr(e,"focusin").pipe(bi(t),Bt(o=>o.target));lr(e,"keydown").pipe(bi(t),nr(o=>o.which===wi.Tab),Jw(r)).subscribe(([o,s])=>{const[a,l]=RF(e);(s===a||s===e)&&o.shiftKey&&(l.focus(),o.preventDefault()),s===l&&!o.shiftKey&&(a.focus(),o.preventDefault())}),i&&lr(e,"click").pipe(bi(t),Jw(r),Bt(o=>o[1])).subscribe(o=>o.focus())})})(0,l.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(l.location.nativeElement)}})}_restoreScrollBar(){const t=this._scrollBarRestoreFn;t&&(this._scrollBarRestoreFn=null,t())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(t,i,r,o){const s=o.container instanceof HTMLElement?o.container:jl(o.container)?this._document.querySelector(o.container):this._document.body,a=this._rendererFactory.createRenderer(null,null);if(!s)throw new Error(`The specified modal container "${o.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const l=new zF,c=this._getContentRef(t,o.injector||i,r,l,o);let u=!1!==o.backdrop?this._attachBackdrop(t,s):void 0,d=this._attachWindowComponent(t,s,c),h=new pte(d,c,u,o.beforeDismiss);return this._registerModalRef(h),this._registerWindowCmpt(d),h.hidden.pipe(ui(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(a.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),l.close=f=>{h.close(f)},l.dismiss=f=>{h.dismiss(f)},this._applyWindowOptions(d.instance,o),1===this._modalRefs.length&&a.addClass(this._document.body,"modal-open"),u&&u.instance&&(this._applyBackdropOptions(u.instance,o),u.changeDetectorRef.detectChanges()),d.changeDetectorRef.detectChanges(),h}get activeInstances(){return this._activeInstances}dismissAll(t){this._modalRefs.forEach(i=>i.dismiss(t))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(t,i){let o=t.resolveComponentFactory(fte).create(this._injector);return this._applicationRef.attachView(o.hostView),i.appendChild(o.location.nativeElement),o}_attachWindowComponent(t,i,r){let s=t.resolveComponentFactory(gte).create(this._injector,r.nodes);return this._applicationRef.attachView(s.hostView),i.appendChild(s.location.nativeElement),s}_applyWindowOptions(t,i){this._windowAttributes.forEach(r=>{jl(i[r])&&(t[r]=i[r])})}_applyBackdropOptions(t,i){this._backdropAttributes.forEach(r=>{jl(i[r])&&(t[r]=i[r])})}_getContentRef(t,i,r,o,s){return r?r instanceof Tn?this._createFromTemplateRef(r,o):Rx(r)?this._createFromString(r):this._createFromComponent(t,i,r,o,s):new Zl([])}_createFromTemplateRef(t,i){const o=t.createEmbeddedView({$implicit:i,close(s){i.close(s)},dismiss(s){i.dismiss(s)}});return this._applicationRef.attachView(o),new Zl([o.rootNodes],o)}_createFromString(t){const i=this._document.createTextNode(`${t}`);return new Zl([[i]])}_createFromComponent(t,i,r,o,s){const a=t.resolveComponentFactory(r),l=Ti.create({providers:[{provide:zF,useValue:o}],parent:i}),c=a.create(l),u=c.location.nativeElement;return s.scrollable&&u.classList.add("component-host-scrollable"),this._applicationRef.attachView(c.hostView),new Zl([[u]],c.hostView,c)}_setAriaHidden(t){const i=t.parentElement;i&&t!==this._document.body&&(Array.from(i.children).forEach(r=>{r!==t&&"SCRIPT"!==r.nodeName&&(this._ariaHiddenValues.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}),this._setAriaHidden(i))}_revertAriaHidden(){this._ariaHiddenValues.forEach((t,i)=>{t?i.setAttribute("aria-hidden",t):i.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(t){const i=()=>{const r=this._modalRefs.indexOf(t);r>-1&&(this._modalRefs.splice(r,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(t),this._activeInstances.emit(this._modalRefs),t.result.then(i,i)}_registerWindowCmpt(t){this._windowCmpts.push(t),this._activeWindowCmptHasChanged.next(),t.onDestroy(()=>{const i=this._windowCmpts.indexOf(t);i>-1&&(this._windowCmpts.splice(i,1),this._activeWindowCmptHasChanged.next())})}}return n.\u0275fac=function(t){return new(t||n)(ke(og),ke(Ti),ke(Ii),ke(mte),ke(xv),ke(an))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),yte=(()=>{class n{constructor(t){this._ngbConfig=t,this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(t){this._animation=t}}return n.\u0275fac=function(t){return new(t||n)(ke(G_))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),vte=(()=>{class n{constructor(t,i,r,o){this._moduleCFR=t,this._injector=i,this._modalStack=r,this._config=o}open(t,i={}){const r=Object.assign(Object.assign(Object.assign({},this._config),{animation:this._config.animation}),i);return this._modalStack.open(this._moduleCFR,this._injector,t,r)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(t){this._modalStack.dismissAll(t)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return n.\u0275fac=function(t){return new(t||n)(ke(Uc),ke(Ti),ke(_te),ke(yte))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),GF=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({providers:[vte]}),n})(),bte=(()=>{class n{constructor(t){this._ngbConfig=t,this.destroyOnHide=!0,this.orientation="horizontal",this.roles="tablist",this.keyboard=!1}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(t){this._animation=t}}return n.\u0275fac=function(t){return new(t||n)(ke(G_))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const jF=n=>jl(n)&&""!==n;let wte=0,Hx=(()=>{class n{constructor(t){this.templateRef=t}}return n.\u0275fac=function(t){return new(t||n)(k(Tn))},n.\u0275dir=me({type:n,selectors:[["ng-template","ngbNavContent",""]]}),n})(),J_=(()=>{class n{constructor(t,i){this.elementRef=i,this.disabled=!1,this.shown=new Ne,this.hidden=new Ne,this._nav=t}ngAfterContentChecked(){this.contentTpl=this.contentTpls.first}ngOnInit(){jl(this.domId)||(this.domId="ngb-nav-"+wte++)}get active(){return this._nav.activeId===this.id}get id(){return jF(this._id)?this._id:this.domId}get panelDomId(){return`${this.domId}-panel`}isPanelInDom(){return(jl(this.destroyOnHide)?!this.destroyOnHide:!this._nav.destroyOnHide)||this.active}}return n.\u0275fac=function(t){return new(t||n)(k(Vt(()=>Lf)),k(Kt))},n.\u0275dir=me({type:n,selectors:[["","ngbNavItem",""]],contentQueries:function(t,i,r){if(1&t&&An(r,Hx,4),2&t){let o;xt(o=Mt())&&(i.contentTpls=o)}},hostVars:2,hostBindings:function(t,i){2&t&&Ze("nav-item",!0)},inputs:{destroyOnHide:"destroyOnHide",disabled:"disabled",domId:"domId",_id:["ngbNavItem","_id"]},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbNavItem"]}),n})(),Lf=(()=>{class n{constructor(t,i,r,o){this.role=t,this._cd=r,this._document=o,this.activeIdChange=new Ne,this.shown=new Ne,this.hidden=new Ne,this.destroy$=new Ft,this.navItemChange$=new Ft,this.navChange=new Ne,this.animation=i.animation,this.destroyOnHide=i.destroyOnHide,this.orientation=i.orientation,this.roles=i.roles,this.keyboard=i.keyboard}click(t){t.disabled||this._updateActiveId(t.id)}onKeyDown(t){if("tablist"!==this.roles||!this.keyboard)return;const i=t.which,r=this.links.filter(a=>!a.navItem.disabled),{length:o}=r;let s=-1;if(r.forEach((a,l)=>{a.elRef.nativeElement===this._document.activeElement&&(s=l)}),o){switch(i){case wi.ArrowLeft:if("vertical"===this.orientation)return;s=(s-1+o)%o;break;case wi.ArrowRight:if("vertical"===this.orientation)return;s=(s+1)%o;break;case wi.ArrowDown:if("horizontal"===this.orientation)return;s=(s+1)%o;break;case wi.ArrowUp:if("horizontal"===this.orientation)return;s=(s-1+o)%o;break;case wi.Home:s=0;break;case wi.End:s=o-1}"changeWithArrows"===this.keyboard&&this.select(r[s].navItem.id),r[s].elRef.nativeElement.focus(),t.preventDefault()}}select(t){this._updateActiveId(t,!1)}ngAfterContentInit(){if(!jl(this.activeId)){const t=this.items.first?this.items.first.id:null;jF(t)&&(this._updateActiveId(t,!1),this._cd.detectChanges())}this.items.changes.pipe(bi(this.destroy$)).subscribe(()=>this._notifyItemChanged(this.activeId))}ngOnChanges({activeId:t}){t&&!t.firstChange&&this._notifyItemChanged(t.currentValue)}ngOnDestroy(){this.destroy$.next()}_updateActiveId(t,i=!0){if(this.activeId!==t){let r=!1;i&&this.navChange.emit({activeId:this.activeId,nextId:t,preventDefault:()=>{r=!0}}),r||(this.activeId=t,this.activeIdChange.emit(t),this._notifyItemChanged(t))}}_notifyItemChanged(t){this.navItemChange$.next(this._getItemById(t))}_getItemById(t){return this.items&&this.items.find(i=>i.id===t)||null}}return n.\u0275fac=function(t){return new(t||n)(rl("role"),k(bte),k(Kr),k(Ii))},n.\u0275dir=me({type:n,selectors:[["","ngbNav",""]],contentQueries:function(t,i,r){if(1&t&&(An(r,J_,4),An(r,Ux,5)),2&t){let o;xt(o=Mt())&&(i.items=o),xt(o=Mt())&&(i.links=o)}},hostVars:6,hostBindings:function(t,i){1&t&&Y("keydown.arrowLeft",function(o){return i.onKeyDown(o)})("keydown.arrowRight",function(o){return i.onKeyDown(o)})("keydown.arrowDown",function(o){return i.onKeyDown(o)})("keydown.arrowUp",function(o){return i.onKeyDown(o)})("keydown.Home",function(o){return i.onKeyDown(o)})("keydown.End",function(o){return i.onKeyDown(o)}),2&t&&(sn("aria-orientation","vertical"===i.orientation&&"tablist"===i.roles?"vertical":void 0)("role",i.role?i.role:i.roles?"tablist":void 0),Ze("nav",!0)("flex-column","vertical"===i.orientation))},inputs:{activeId:"activeId",animation:"animation",destroyOnHide:"destroyOnHide",orientation:"orientation",roles:"roles",keyboard:"keyboard"},outputs:{activeIdChange:"activeIdChange",shown:"shown",hidden:"hidden",navChange:"navChange"},exportAs:["ngbNav"],features:[Bi]}),n})(),Ux=(()=>{class n{constructor(t,i,r,o){this.role=t,this.navItem=i,this.nav=r,this.elRef=o}hasNavItemClass(){return this.navItem.elementRef.nativeElement.nodeType===Node.COMMENT_NODE}}return n.\u0275fac=function(t){return new(t||n)(rl("role"),k(J_),k(Lf),k(Kt))},n.\u0275dir=me({type:n,selectors:[["a","ngbNavLink",""]],hostAttrs:["href",""],hostVars:14,hostBindings:function(t,i){1&t&&Y("click",function(o){return i.nav.click(i.navItem),o.preventDefault()}),2&t&&(la("id",i.navItem.domId),sn("role",i.role?i.role:i.nav.roles?"tab":void 0)("tabindex",i.navItem.disabled?-1:void 0)("aria-controls",i.navItem.isPanelInDom()?i.navItem.panelDomId:null)("aria-selected",i.navItem.active)("aria-disabled",i.navItem.disabled),Ze("nav-link",!0)("nav-item",i.hasNavItemClass())("active",i.navItem.active)("disabled",i.navItem.disabled))}}),n})();const xte=({classList:n})=>(n.remove("show"),()=>n.remove("active")),Mte=(n,e)=>{e&&dd(n),n.classList.add("show")};let zx=(()=>{class n{constructor(t){this.elRef=t}}return n.\u0275fac=function(t){return new(t||n)(k(Kt))},n.\u0275dir=me({type:n,selectors:[["","ngbNavPane",""]],hostAttrs:[1,"tab-pane"],hostVars:5,hostBindings:function(t,i){2&t&&(la("id",i.item.panelDomId),sn("role",i.role?i.role:i.nav.roles?"tabpanel":void 0)("aria-labelledby",i.item.domId),Ze("fade",i.nav.animation))},inputs:{item:"item",nav:"nav",role:"role"}}),n})(),WF=(()=>{class n{constructor(t,i){this._cd=t,this._ngZone=i,this._activePane=null}isPanelTransitioning(t){var i;return(null===(i=this._activePane)||void 0===i?void 0:i.item)===t}ngAfterViewInit(){var t;this._updateActivePane(),this.nav.navItemChange$.pipe(bi(this.nav.destroy$),Cg((null===(t=this._activePane)||void 0===t?void 0:t.item)||null),function Kw(n,e=ms){return n=null!=n?n:XX,Vn((t,i)=>{let r,o=!0;t.subscribe(vn(i,s=>{const a=e(s);(o||!n(r,a))&&(o=!1,r=a,i.next(s))}))})}(),function eK(n){return nr((e,t)=>n<=t)}(1)).subscribe(i=>{const r={animation:this.nav.animation,runningTransition:"stop"};this._cd.detectChanges(),this._activePane?ur(this._ngZone,this._activePane.elRef.nativeElement,xte,r).subscribe(()=>{var o;const s=null===(o=this._activePane)||void 0===o?void 0:o.item;this._activePane=this._getPaneForItem(i),this._cd.markForCheck(),this._activePane&&(this._activePane.elRef.nativeElement.classList.add("active"),ur(this._ngZone,this._activePane.elRef.nativeElement,Mte,r).subscribe(()=>{i&&(i.shown.emit(),this.nav.shown.emit(i.id))})),s&&(s.hidden.emit(),this.nav.hidden.emit(s.id))}):this._updateActivePane()})}_updateActivePane(){var t,i;this._activePane=this._getActivePane(),null===(t=this._activePane)||void 0===t||t.elRef.nativeElement.classList.add("show"),null===(i=this._activePane)||void 0===i||i.elRef.nativeElement.classList.add("active")}_getPaneForItem(t){return this._panes&&this._panes.find(i=>i.item===t)||null}_getActivePane(){return this._panes&&this._panes.find(t=>t.item.active)||null}}return n.\u0275fac=function(t){return new(t||n)(k(Kr),k(an))},n.\u0275cmp=He({type:n,selectors:[["","ngbNavOutlet",""]],viewQuery:function(t,i){if(1&t&&Gi(zx,5),2&t){let r;xt(r=Mt())&&(i._panes=r)}},hostVars:2,hostBindings:function(t,i){2&t&&Ze("tab-content",!0)},inputs:{paneRole:"paneRole",nav:["ngbNavOutlet","nav"]},attrs:CQ,decls:1,vars:1,consts:[["ngFor","",3,"ngForOf"],["ngbNavPane","",3,"item","nav","role",4,"ngIf"],["ngbNavPane","",3,"item","nav","role"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){1&t&&W(0,RQ,1,1,"ng-template",0),2&t&&S("ngForOf",i.nav.items)},directives:[Ri,Yn,zx,gr],encapsulation:2,changeDetection:0}),n})(),$F=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),ek=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),nk=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),ik=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),rk=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),ok=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),sk=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),ak=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({}),n})();new wt("live announcer delay",{providedIn:"root",factory:function Nte(){return 100}});let lk=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})(),ck=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({}),n})();const Pte=[wF,xF,DF,CF,TF,VF,UF,GF,$F,ck,ek,nk,ik,rk,ok,sk,ak,lk];let Ote=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[Pte,wF,xF,DF,CF,TF,VF,UF,GF,$F,ck,ek,nk,ik,rk,ok,sk,ak,lk]}),n})(),Q_=(()=>{class n{constructor(){this.margin=!0}ngOnInit(){this.icon=n.findIcon(this.type,this.name)}static findIcon(t,i){switch(t){case"tab":return n.findTabIcon(i);case"component":return n.findComponentIcon(i);default:return n.defaultIcon}}static findTabIcon(t){switch(t){case"Hierarchy":return"fa-list";case"Scene":return n.findComponentIcon(t);case"Inspector":return"fa-circle-info";case"Resources":return"fa-folder";default:return n.defaultIcon}}static findComponentIcon(t){switch(t){case"Object3D":return"fa-chart-line";case"Light":case"DirectionalLight":return"fa-lightbulb";case"PerspectiveCamera":return"fa-camera";case"SkinnedMesh":return"fa-person-walking";case"Mesh":case"BoxGeometry":return"fa-cube";case"Group":return"fa-cubes";case"Scene":return"fa-image";case"Fog":return"fa-cloud";case"Bone":return"fa-bone";case"PlaneGeometry":return"fa-square";case"OctahedronGeometry":return"fa-diamond";case"CylinderGeometry":return"fa-database";case"TorusGeometry":return"fa-ring";case"SphereGeometry":return"fa-globe";default:return t.endsWith("Geometry")?"fa-shapes":t.endsWith("Material")?"fa-brush":(console.warn(`missing component icon for ${t}`),n.defaultIcon)}}}return n.defaultIcon="fa-question",n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["icon"]],inputs:{type:"type",name:"name",margin:"margin"},decls:1,vars:4,consts:[[1,"fa-solid","fa-fw",3,"ngClass","title"]],template:function(t,i){1&t&&he(0,"i",0),2&t&&(Ze("me-1",i.margin),Zr("title",i.name),S("ngClass",i.icon))},directives:[vg],encapsulation:2}),n})();function Fte(n,e){1&n&&tn(0,17),2&n&&S("componentType",H().$implicit.componentType)}function kte(n,e){if(1&n){const t=nt();F(0,"li",13),Y("dndStart",function(){return ge(t),H().onDragStart()})("dndEnd",function(){return ge(t),H().onDragEnd()}),F(1,"a",14),he(2,"icon",15),Rt(3),B(),W(4,Fte,1,1,"ng-template",16),B()}if(2&n){const t=e.$implicit;Zr("ngbNavItem",t.name),S("destroyOnHide",t.destroyOnHide)("dndDraggable",t.uuid)("dndType","tab")("dndEffectAllowed","move"),A(2),S("type","tab")("name",t.name),A(1),Jo("",t.name," ")}}const Xl=function(){return["tab"]};function Lte(n,e){if(1&n){const t=nt();F(0,"div",18),Y("dndDragover",function(){return ge(t),H().onZoneDragover("")}),he(1,"div",19),F(2,"div",20)(3,"div",21)(4,"i",22),Y("dndDragover",function(){return ge(t),H().onZoneDragover("left")})("dndDrop",function(r){return ge(t),H().onZoneDrop(r,"left")}),B(),he(5,"div",23),B(),F(6,"div",24)(7,"i",25),Y("dndDragover",function(){return ge(t),H().onZoneDragover("up")})("dndDrop",function(r){return ge(t),H().onZoneDrop(r,"up")}),B(),he(8,"div",26),F(9,"i",27),Y("dndDragover",function(){return ge(t),H().onZoneDragover("center")})("dndDrop",function(r){return ge(t),H().onZoneDrop(r,"center")}),B(),he(10,"div",28),F(11,"i",29),Y("dndDragover",function(){return ge(t),H().onZoneDragover("down")})("dndDrop",function(r){return ge(t),H().onZoneDrop(r,"down")}),B(),he(12,"div",30),B(),F(13,"div",21)(14,"i",31),Y("dndDragover",function(){return ge(t),H().onZoneDragover("right")})("dndDrop",function(r){return ge(t),H().onZoneDrop(r,"right")}),B(),he(15,"div",32),B()()()}if(2&n){const t=H();S("dndDropzone",Xr(21,Xl)),A(4),S("dndDropzone",Xr(22,Xl))("dndEffectAllowed","move"),A(1),Ze("d-none",!t.isLeftZone),A(2),S("dndDropzone",Xr(23,Xl))("dndEffectAllowed","move"),A(1),Ze("d-none",!t.isUpZone),A(1),S("dndDropzone",Xr(24,Xl))("dndEffectAllowed","move"),A(1),Ze("d-none",!t.isCenterZone),A(1),S("dndDropzone",Xr(25,Xl))("dndEffectAllowed","move"),A(1),Ze("d-none",!t.isDownZone),A(2),S("dndDropzone",Xr(26,Xl))("dndEffectAllowed","move"),A(1),Ze("d-none",!t.isRightZone)}}class Bf{constructor(e,t,i=!0){this.name=e,this.componentType=t,this.destroyOnHide=i,this.uuid=no.generateUUID()}}class Ga{constructor(e){this.tabs=e,this.type="tabs",this.uuid=no.generateUUID()}}let Bte=(()=>{class n{constructor(t){this.viewContainerRef=t}ngOnInit(){this.viewContainerRef.createComponent(this.componentType)}}return n.\u0275fac=function(t){return new(t||n)(k($n))},n.\u0275dir=me({type:n,selectors:[["","tab-content",""]],inputs:{componentType:"componentType"}}),n})(),uk=(()=>{class n{constructor(t){this.engine=t,this.root=!1,this.zoneDrop=new Ne,this.closed=new Ne,this.showTabDropZones=!1,this.direction=""}get isUpZone(){return"up"===this.direction}get isLeftZone(){return"left"===this.direction}get isRightZone(){return"right"===this.direction}get isCenterZone(){return"center"===this.direction}get isDownZone(){return"down"===this.direction}ngOnInit(){this.showTabDropZonesSub=this.engine.showTabDropZones$.subscribe(t=>this.onShowTabDropZonesUpdated(t))}ngOnDestroy(){this.showTabDropZonesSub.unsubscribe()}onShowTabDropZonesUpdated(t){this.showTabDropZones=t,this.direction=""}onDragStart(){this.engine.showTabDropZones(!0),this.direction=""}onDragEnd(){this.engine.showTabDropZones(!1),this.direction=""}onDrop(){this.engine.showTabDropZones(!1),this.direction=""}onZoneDragover(t){this.direction=t}onZoneDrop(t,i){this.zoneDrop.emit({info:this.info,uuid:t.data,direction:i}),this.engine.showTabDropZones(!1),this.direction=""}close(){this.closed.emit(this.info)}}return n.\u0275fac=function(t){return new(t||n)(k(ar))},n.\u0275cmp=He({type:n,selectors:[["tab-set"]],viewQuery:function(t,i){if(1&t&&Gi(Lf,7),2&t){let r;xt(r=Mt())&&(i.ngbNav=r.first)}},inputs:{root:"root",info:"info"},outputs:{zoneDrop:"zoneDrop",closed:"closed"},decls:14,vars:7,consts:[[1,"d-flex","flex-column","h-100","w-100"],[1,"flex-shrink-1","bg-light"],["ngbNav","",1,"nav-tabs","xs","fs-xs","text-nowrap",3,"dndDropzone","dndEffectAllowed","dndDrop"],["nav","ngbNav"],["class","text-nowrap",3,"ngbNavItem","destroyOnHide","dndDraggable","dndType","dndEffectAllowed","dndStart","dndEnd",4,"ngFor","ngForOf"],[1,"ms-auto"],["ngbDropdown","","container","body",1,"h-100","d-inline-block"],["ngbDropdownToggle","","title","Actions",1,"fa-solid","fa-ellipsis-vertical","fa-fw","align-middle","selectable"],["ngbDropdownMenu","",1,"xs","fs-xs"],["ngbDropdownItem","",1,"py-1","px-2",3,"disabled","click"],[1,"h-100","w-100","overflow-hidden","position-relative"],["class","d-flex justify-content-center align-items-center position-absolute top-0 bottom-0 start-0 end-0 dropzones",3,"dndDropzone","dndDragover",4,"ngIf"],[1,"h-100","w-100","overflow-hidden",3,"ngbNavOutlet"],[1,"text-nowrap",3,"ngbNavItem","destroyOnHide","dndDraggable","dndType","dndEffectAllowed","dndStart","dndEnd"],["ngbNavLink","","draggable","false",1,"px-2","py-1"],[3,"type","name"],["ngbNavContent",""],["tab-content","",3,"componentType"],[1,"d-flex","justify-content-center","align-items-center","position-absolute","top-0","bottom-0","start-0","end-0","dropzones",3,"dndDropzone","dndDragover"],[1,"position-absolute","top-0","bottom-0","start-0","end-0","bg-light","opacity-50"],[1,"d-flex"],[1,"d-flex","align-items-center"],[1,"fa-regular","fa-square-caret-left","fa-2xl","tab-drop-zone",3,"dndDropzone","dndEffectAllowed","dndDragover","dndDrop"],[1,"position-absolute","top-0","bottom-0","start-0","end-50","dropzone-highlight","bg-info","opacity-50"],[1,"d-flex","flex-column"],[1,"fa-regular","fa-square-caret-up","fa-2xl","tab-drop-zone",3,"dndDropzone","dndEffectAllowed","dndDragover","dndDrop"],[1,"d-none","position-absolute","top-0","bottom-50","start-0","end-0","dropzone-highlight","bg-info","opacity-50"],[1,"fa-regular","fa-square","fa-2xl","tab-drop-zone",3,"dndDropzone","dndEffectAllowed","dndDragover","dndDrop"],[1,"d-none","position-absolute","top-0","bottom-0","start-0","end-0","dropzone-highlight","bg-info","opacity-50"],[1,"fa-regular","fa-square-caret-down","fa-2xl","tab-drop-zone",3,"dndDropzone","dndEffectAllowed","dndDragover","dndDrop"],[1,"d-none","position-absolute","top-50","bottom-0","start-0","end-0","dropzone-highlight","bg-info","opacity-50"],[1,"fa-regular","fa-square-caret-right","fa-2xl","tab-drop-zone",3,"dndDropzone","dndEffectAllowed","dndDragover","dndDrop"],[1,"d-none","position-absolute","top-0","bottom-0","start-50","end-0","dropzone-highlight","bg-info","opacity-50"]],template:function(t,i){if(1&t&&(F(0,"div",0)(1,"div",1)(2,"ul",2,3),Y("dndDrop",function(){return i.onDrop()}),W(4,kte,5,8,"li",4),F(5,"li",5)(6,"div",6),he(7,"i",7),F(8,"div",8)(9,"button",9),Y("click",function(){return i.close()}),Rt(10,"Close"),B()()()()()(),F(11,"div",10),W(12,Lte,16,27,"div",11),he(13,"div",12),B()()),2&t){const r=gt(3);A(2),S("dndDropzone",Xr(6,Xl))("dndEffectAllowed","move"),A(2),S("ngForOf",i.info.tabs),A(5),S("disabled",i.root),A(3),S("ngIf",i.showTabDropZones),A(1),S("ngbNavOutlet",r)}},directives:[Lf,La,Ri,J_,D_,Ux,Q_,Hx,Bte,Yl,Vx,X_,Z_,Yn,WF],encapsulation:2}),n})();const Hte=["gutterEls"];function Ute(n,e){if(1&n){const t=nt();F(0,"div",2,3),Y("keydown",function(r){ge(t);const o=H().index;return H().startKeyboardDrag(r,2*o+1,o+1)})("mousedown",function(r){ge(t);const o=H().index;return H().startMouseDrag(r,2*o+1,o+1)})("touchstart",function(r){ge(t);const o=H().index;return H().startMouseDrag(r,2*o+1,o+1)})("mouseup",function(r){ge(t);const o=H().index;return H().clickGutter(r,o+1)})("touchend",function(r){ge(t);const o=H().index;return H().clickGutter(r,o+1)}),he(2,"div",4),B()}if(2&n){const t=H(),i=t.index,r=t.$implicit,o=H();al("flex-basis",o.gutterSize,"px")("order",2*i+1),sn("aria-label",o.gutterAriaLabel)("aria-orientation",o.direction)("aria-valuemin",r.minSize)("aria-valuemax",r.maxSize)("aria-valuenow",r.size)("aria-valuetext",o.getAriaAreaSizeText(r.size))}}function zte(n,e){1&n&&W(0,Ute,3,10,"div",1),2&n&&S("ngIf",!1===e.last)}const Gte=["*"];function Vf(n){if(void 0!==n.changedTouches&&n.changedTouches.length>0)return{x:n.changedTouches[0].clientX,y:n.changedTouches[0].clientY};if(void 0!==n.clientX&&void 0!==n.clientY)return{x:n.clientX,y:n.clientY};if(void 0!==n.currentTarget){const e=n.currentTarget;return{x:e.offsetLeft,y:e.offsetTop}}return null}function dk(n,e,t){return Math.abs(n.x-e.x)<=t&&Math.abs(n.y-e.y)<=t}function hk(n,e){const t=n.nativeElement.getBoundingClientRect();return"horizontal"===e?t.width:t.height}function Hf(n){return"boolean"==typeof n?n:"false"!==n}function ja(n,e){return null==n?e:(n=Number(n),!isNaN(n)&&n>=0?n:e)}function fk(n,e){if("percent"===n){const t=e.reduce((i,r)=>null!==r?i+r:i,0);return e.every(i=>null!==i)&&t>99.9&&t<100.1}if("pixel"===n)return 1===e.filter(t=>null===t).length}function e0(n){return null===n.size?null:!0===n.component.lockSize?n.size:null===n.component.minSize?null:n.component.minSize>n.size?n.size:n.component.minSize}function t0(n){return null===n.size?null:!0===n.component.lockSize?n.size:null===n.component.maxSize?null:n.component.maxSize<n.size?n.size:n.component.maxSize}function fd(n,e,t,i){return e.reduce((r,o)=>{const s=function Wte(n,e,t,i){return 0===t?{areaSnapshot:e,pixelAbsorb:0,percentAfterAbsorption:e.sizePercentAtStart,pixelRemain:0}:0===e.sizePixelAtStart&&t<0?{areaSnapshot:e,pixelAbsorb:0,percentAfterAbsorption:0,pixelRemain:t}:"percent"===n?function $te(n,e,t){const r=(n.sizePixelAtStart+e)/t*100;if(e>0){if(null!==n.area.maxSize&&r>n.area.maxSize){const o=n.area.maxSize/100*t;return{areaSnapshot:n,pixelAbsorb:o,percentAfterAbsorption:n.area.maxSize,pixelRemain:n.sizePixelAtStart+e-o}}return{areaSnapshot:n,pixelAbsorb:e,percentAfterAbsorption:r>100?100:r,pixelRemain:0}}if(e<0){if(null!==n.area.minSize&&r<n.area.minSize){const o=n.area.minSize/100*t;return{areaSnapshot:n,pixelAbsorb:o,percentAfterAbsorption:n.area.minSize,pixelRemain:n.sizePixelAtStart+e-o}}return r<0?{areaSnapshot:n,pixelAbsorb:-n.sizePixelAtStart,percentAfterAbsorption:0,pixelRemain:e+n.sizePixelAtStart}:{areaSnapshot:n,pixelAbsorb:e,percentAfterAbsorption:r,pixelRemain:0}}}(e,t,i):"pixel"===n?function qte(n,e,t){const i=n.sizePixelAtStart+e;return e>0?null!==n.area.maxSize&&i>n.area.maxSize?{areaSnapshot:n,pixelAbsorb:n.area.maxSize-n.sizePixelAtStart,percentAfterAbsorption:-1,pixelRemain:i-n.area.maxSize}:{areaSnapshot:n,pixelAbsorb:e,percentAfterAbsorption:-1,pixelRemain:0}:e<0?null!==n.area.minSize&&i<n.area.minSize?{areaSnapshot:n,pixelAbsorb:n.area.minSize+e-i,percentAfterAbsorption:-1,pixelRemain:i-n.area.minSize}:i<0?{areaSnapshot:n,pixelAbsorb:-n.sizePixelAtStart,percentAfterAbsorption:-1,pixelRemain:e+n.sizePixelAtStart}:{areaSnapshot:n,pixelAbsorb:e,percentAfterAbsorption:-1,pixelRemain:0}:void 0}(e,t):void 0}(n,o,r.remain,i);return r.list.push(s),r.remain=s.pixelRemain,r},{remain:t,list:[]})}function pk(n,e){"percent"===n?e.areaSnapshot.area.size=e.percentAfterAbsorption:"pixel"===n&&null!==e.areaSnapshot.area.size&&(e.areaSnapshot.area.size=e.areaSnapshot.sizePixelAtStart+e.pixelAbsorb)}const Yte=new wt("angular-split-global-config");let n0=(()=>{class n{constructor(t,i,r,o,s){this.ngZone=t,this.elRef=i,this.cdRef=r,this.renderer=o,this.gutterClickDeltaPx=2,this._config={direction:"horizontal",unit:"percent",gutterSize:11,gutterStep:1,restrictMove:!1,useTransition:!1,disabled:!1,dir:"ltr",gutterDblClickDuration:0},this.dragStart=new Ne(!1),this.dragEnd=new Ne(!1),this.gutterClick=new Ne(!1),this.gutterDblClick=new Ne(!1),this.dragProgressSubject=new Ft,this.dragProgress$=this.dragProgressSubject.asObservable(),this.isDragging=!1,this.isWaitingClear=!1,this.isWaitingInitialMove=!1,this.dragListeners=[],this.snapshot=null,this.startPoint=null,this.endPoint=null,this.displayedAreas=[],this.hiddenAreas=[],this._clickTimeout=null,this.direction=this._direction,this._config=s?Object.assign(this._config,s):this._config,Object.keys(this._config).forEach(a=>{this[a]=this._config[a]})}set direction(t){this._direction="vertical"===t?"vertical":"horizontal",this.renderer.addClass(this.elRef.nativeElement,`as-${this._direction}`),this.renderer.removeClass(this.elRef.nativeElement,"as-"+("vertical"===this._direction?"horizontal":"vertical")),this.build(!1,!1)}get direction(){return this._direction}set unit(t){this._unit="pixel"===t?"pixel":"percent",this.renderer.addClass(this.elRef.nativeElement,`as-${this._unit}`),this.renderer.removeClass(this.elRef.nativeElement,"as-"+("pixel"===this._unit?"percent":"pixel")),this.build(!1,!0)}get unit(){return this._unit}set gutterSize(t){this._gutterSize=ja(t,11),this.build(!1,!1)}get gutterSize(){return this._gutterSize}set gutterStep(t){this._gutterStep=ja(t,1)}get gutterStep(){return this._gutterStep}set restrictMove(t){this._restrictMove=Hf(t)}get restrictMove(){return this._restrictMove}set useTransition(t){this._useTransition=Hf(t),this._useTransition?this.renderer.addClass(this.elRef.nativeElement,"as-transition"):this.renderer.removeClass(this.elRef.nativeElement,"as-transition")}get useTransition(){return this._useTransition}set disabled(t){this._disabled=Hf(t),this._disabled?this.renderer.addClass(this.elRef.nativeElement,"as-disabled"):this.renderer.removeClass(this.elRef.nativeElement,"as-disabled")}get disabled(){return this._disabled}set dir(t){this._dir="rtl"===t?"rtl":"ltr",this.renderer.setAttribute(this.elRef.nativeElement,"dir",this._dir)}get dir(){return this._dir}set gutterDblClickDuration(t){this._gutterDblClickDuration=ja(t,0)}get gutterDblClickDuration(){return this._gutterDblClickDuration}get transitionEnd(){return new pn(t=>this.transitionEndSubscriber=t).pipe(function Vte(n,e=Zw){return Vn((t,i)=>{let r=null,o=null,s=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=o;o=null,i.next(c)}};function l(){const c=s+n,u=e.now();if(u<c)return r=this.schedule(void 0,c-u),void i.add(r);a()}t.subscribe(vn(i,c=>{o=c,s=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}(20))}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{setTimeout(()=>this.renderer.addClass(this.elRef.nativeElement,"as-init"))})}getNbGutters(){return 0===this.displayedAreas.length?0:this.displayedAreas.length-1}addArea(t){const i={component:t,order:0,size:0,minSize:null,maxSize:null,sizeBeforeCollapse:null,gutterBeforeCollapse:0};!0===t.visible?(this.displayedAreas.push(i),this.build(!0,!0)):this.hiddenAreas.push(i)}removeArea(t){if(this.displayedAreas.some(i=>i.component===t)){const i=this.displayedAreas.find(r=>r.component===t);this.displayedAreas.splice(this.displayedAreas.indexOf(i),1),this.build(!0,!0)}else if(this.hiddenAreas.some(i=>i.component===t)){const i=this.hiddenAreas.find(r=>r.component===t);this.hiddenAreas.splice(this.hiddenAreas.indexOf(i),1)}}updateArea(t,i,r){!0===t.visible&&this.build(i,r)}showArea(t){const i=this.hiddenAreas.find(o=>o.component===t);if(void 0===i)return;const r=this.hiddenAreas.splice(this.hiddenAreas.indexOf(i),1);this.displayedAreas.push(...r),this.build(!0,!0)}hideArea(t){const i=this.displayedAreas.find(o=>o.component===t);if(void 0===i)return;const r=this.displayedAreas.splice(this.displayedAreas.indexOf(i),1);r.forEach(o=>{o.order=0,o.size=0}),this.hiddenAreas.push(...r),this.build(!0,!0)}getVisibleAreaSizes(){return this.displayedAreas.map(t=>null===t.size?"*":t.size)}setVisibleAreaSizes(t){if(t.length!==this.displayedAreas.length)return!1;const i=t.map(o=>ja(o,null));return!1!==fk(this.unit,i)&&(this.displayedAreas.forEach((o,s)=>o.component._size=i[s]),this.build(!1,!0),!0)}build(t,i){if(this.stopDragging(),!0===t&&(this.displayedAreas.every(r=>null!==r.component.order)&&this.displayedAreas.sort((r,o)=>r.component.order-o.component.order),this.displayedAreas.forEach((r,o)=>{r.order=2*o,r.component.setStyleOrder(r.order)})),!0===i){const r=fk(this.unit,this.displayedAreas.map(o=>o.component.size));switch(this.unit){case"percent":{const o=100/this.displayedAreas.length;this.displayedAreas.forEach(s=>{s.size=r?s.component.size:o,s.minSize=e0(s),s.maxSize=t0(s)});break}case"pixel":if(r)this.displayedAreas.forEach(o=>{o.size=o.component.size,o.minSize=e0(o),o.maxSize=t0(o)});else{const o=this.displayedAreas.filter(s=>null===s.component.size);if(0===o.length&&this.displayedAreas.length>0)this.displayedAreas.forEach((s,a)=>{s.size=0===a?null:s.component.size,s.minSize=0===a?null:e0(s),s.maxSize=0===a?null:t0(s)});else if(o.length>1){let s=!1;this.displayedAreas.forEach(a=>{null===a.component.size?!1===s?(a.size=null,a.minSize=null,a.maxSize=null,s=!0):(a.size=100,a.minSize=null,a.maxSize=null):(a.size=a.component.size,a.minSize=e0(a),a.maxSize=t0(a))})}}}}this.refreshStyleSizes(),this.cdRef.markForCheck()}refreshStyleSizes(){if("percent"===this.unit)if(1===this.displayedAreas.length)this.displayedAreas[0].component.setStyleFlex(0,0,"100%",!1,!1);else{const t=this.getNbGutters()*this.gutterSize;this.displayedAreas.forEach(i=>{i.component.setStyleFlex(0,0,`calc( ${i.size}% - ${i.size/100*t}px )`,null!==i.minSize&&i.minSize===i.size,null!==i.maxSize&&i.maxSize===i.size)})}else"pixel"===this.unit&&this.displayedAreas.forEach(t=>{null===t.size?t.component.setStyleFlex(1,1,1===this.displayedAreas.length?"100%":"auto",!1,!1):1===this.displayedAreas.length?t.component.setStyleFlex(0,0,"100%",!1,!1):t.component.setStyleFlex(0,0,`${t.size}px`,null!==t.minSize&&t.minSize===t.size,null!==t.maxSize&&t.maxSize===t.size)})}clickGutter(t,i){const r=Vf(t);this.startPoint&&dk(this.startPoint,r,this.gutterClickDeltaPx)&&(!this.isDragging||this.isWaitingInitialMove)&&(null!==this._clickTimeout?(window.clearTimeout(this._clickTimeout),this._clickTimeout=null,this.notify("dblclick",i),this.stopDragging()):this._clickTimeout=window.setTimeout(()=>{this._clickTimeout=null,this.notify("click",i),this.stopDragging()},this.gutterDblClickDuration))}startKeyboardDrag(t,i,r){if(!0===this.disabled||!0===this.isWaitingClear)return;const o=function jte(n,e){if("horizontal"===e)switch(n.key){case"ArrowLeft":case"ArrowRight":case"PageUp":case"PageDown":break;default:return null}if("vertical"===e)switch(n.key){case"ArrowUp":case"ArrowDown":case"PageUp":case"PageDown":break;default:return null}const t=n.currentTarget,i="PageUp"===n.key||"PageDown"===n.key?500:50;let r=t.offsetLeft,o=t.offsetTop;switch(n.key){case"ArrowLeft":r-=i;break;case"ArrowRight":r+=i;break;case"ArrowUp":o-=i;break;case"ArrowDown":o+=i;break;case"PageUp":"vertical"===e?o-=i:r+=i;break;case"PageDown":"vertical"===e?o+=i:r-=i;break;default:return null}return{x:r,y:o}}(t,this.direction);null!==o&&(this.endPoint=o,this.startPoint=Vf(t),t.preventDefault(),t.stopPropagation(),this.setupForDragEvent(i,r),this.startDragging(),this.drag(),this.stopDragging())}startMouseDrag(t,i,r){t.preventDefault(),t.stopPropagation(),this.startPoint=Vf(t),null!==this.startPoint&&!0!==this.disabled&&!0!==this.isWaitingClear&&(this.setupForDragEvent(i,r),this.dragListeners.push(this.renderer.listen("document","mouseup",this.stopDragging.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchend",this.stopDragging.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchcancel",this.stopDragging.bind(this))),this.ngZone.runOutsideAngular(()=>{this.dragListeners.push(this.renderer.listen("document","mousemove",this.mouseDragEvent.bind(this))),this.dragListeners.push(this.renderer.listen("document","touchmove",this.mouseDragEvent.bind(this)))}),this.startDragging())}setupForDragEvent(t,i){this.snapshot={gutterNum:i,lastSteppedOffset:0,allAreasSizePixel:hk(this.elRef,this.direction)-this.getNbGutters()*this.gutterSize,allInvolvedAreasSizePercent:100,areasBeforeGutter:[],areasAfterGutter:[]},this.displayedAreas.forEach(r=>{const o={area:r,sizePixelAtStart:hk(r.component.elRef,this.direction),sizePercentAtStart:"percent"===this.unit?r.size:-1};r.order<t?!0===this.restrictMove?this.snapshot.areasBeforeGutter=[o]:this.snapshot.areasBeforeGutter.unshift(o):r.order>t&&(!0===this.restrictMove?0===this.snapshot.areasAfterGutter.length&&(this.snapshot.areasAfterGutter=[o]):this.snapshot.areasAfterGutter.push(o))}),this.snapshot.allInvolvedAreasSizePercent=[...this.snapshot.areasBeforeGutter,...this.snapshot.areasAfterGutter].reduce((r,o)=>r+o.sizePercentAtStart,0)}startDragging(){this.displayedAreas.forEach(t=>t.component.lockEvents()),this.isDragging=!0,this.isWaitingInitialMove=!0}mouseDragEvent(t){t.preventDefault(),t.stopPropagation();const i=Vf(t);null!==this._clickTimeout&&!dk(this.startPoint,i,this.gutterClickDeltaPx)&&(window.clearTimeout(this._clickTimeout),this._clickTimeout=null),!1!==this.isDragging&&(this.endPoint=Vf(t),null!==this.endPoint&&this.drag())}drag(){if(this.isWaitingInitialMove){if(this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y)return;this.ngZone.run(()=>{this.isWaitingInitialMove=!1,this.renderer.addClass(this.elRef.nativeElement,"as-dragging"),this.renderer.addClass(this.gutterEls.toArray()[this.snapshot.gutterNum-1].nativeElement,"as-dragged"),this.notify("start",this.snapshot.gutterNum)})}let t="horizontal"===this.direction?this.startPoint.x-this.endPoint.x:this.startPoint.y-this.endPoint.y;"rtl"===this.dir&&(t=-t);const i=Math.round(t/this.gutterStep)*this.gutterStep;if(i===this.snapshot.lastSteppedOffset)return;this.snapshot.lastSteppedOffset=i;let r=fd(this.unit,this.snapshot.areasBeforeGutter,-i,this.snapshot.allAreasSizePixel),o=fd(this.unit,this.snapshot.areasAfterGutter,i,this.snapshot.allAreasSizePixel);if(0!==r.remain&&0!==o.remain?Math.abs(r.remain)===Math.abs(o.remain)||(Math.abs(r.remain)>Math.abs(o.remain)?o=fd(this.unit,this.snapshot.areasAfterGutter,i+r.remain,this.snapshot.allAreasSizePixel):r=fd(this.unit,this.snapshot.areasBeforeGutter,-(i-o.remain),this.snapshot.allAreasSizePixel)):0!==r.remain?o=fd(this.unit,this.snapshot.areasAfterGutter,i+r.remain,this.snapshot.allAreasSizePixel):0!==o.remain&&(r=fd(this.unit,this.snapshot.areasBeforeGutter,-(i-o.remain),this.snapshot.allAreasSizePixel)),"percent"===this.unit){const s=[...r.list,...o.list],a=s.find(l=>0!==l.percentAfterAbsorption&&l.percentAfterAbsorption!==l.areaSnapshot.area.minSize&&l.percentAfterAbsorption!==l.areaSnapshot.area.maxSize);a&&(a.percentAfterAbsorption=this.snapshot.allInvolvedAreasSizePercent-s.filter(l=>l!==a).reduce((l,c)=>l+c.percentAfterAbsorption,0))}r.list.forEach(s=>pk(this.unit,s)),o.list.forEach(s=>pk(this.unit,s)),this.refreshStyleSizes(),this.notify("progress",this.snapshot.gutterNum)}stopDragging(t){if(t&&(t.preventDefault(),t.stopPropagation()),!1!==this.isDragging){for(this.displayedAreas.forEach(i=>i.component.unlockEvents());this.dragListeners.length>0;){const i=this.dragListeners.pop();i&&i()}this.isDragging=!1,!1===this.isWaitingInitialMove&&this.notify("end",this.snapshot.gutterNum),this.renderer.removeClass(this.elRef.nativeElement,"as-dragging"),this.renderer.removeClass(this.gutterEls.toArray()[this.snapshot.gutterNum-1].nativeElement,"as-dragged"),this.snapshot=null,this.isWaitingClear=!0,this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.startPoint=null,this.endPoint=null,this.isWaitingClear=!1})})}}notify(t,i){const r=this.getVisibleAreaSizes();"start"===t?this.dragStart.emit({gutterNum:i,sizes:r}):"end"===t?this.dragEnd.emit({gutterNum:i,sizes:r}):"click"===t?this.gutterClick.emit({gutterNum:i,sizes:r}):"dblclick"===t?this.gutterDblClick.emit({gutterNum:i,sizes:r}):"transitionEnd"===t?this.transitionEndSubscriber&&this.ngZone.run(()=>this.transitionEndSubscriber.next(r)):"progress"===t&&this.dragProgressSubject.next({gutterNum:i,sizes:r})}ngOnDestroy(){this.stopDragging()}collapseArea(t,i,r){const o=this.displayedAreas.find(l=>l.component===t);if(void 0===o)return;const s="right"===r?1:-1;o.sizeBeforeCollapse||(o.sizeBeforeCollapse=o.size,o.gutterBeforeCollapse=s),o.size=i;const a=this.gutterEls.find(l=>l.nativeElement.style.order===`${o.order+s}`);a&&this.renderer.addClass(a.nativeElement,"as-split-gutter-collapsed"),this.updateArea(t,!1,!1)}expandArea(t){const i=this.displayedAreas.find(o=>o.component===t);if(void 0===i||!i.sizeBeforeCollapse)return;i.size=i.sizeBeforeCollapse,i.sizeBeforeCollapse=null;const r=this.gutterEls.find(o=>o.nativeElement.style.order===`${i.order+i.gutterBeforeCollapse}`);r&&this.renderer.removeClass(r.nativeElement,"as-split-gutter-collapsed"),this.updateArea(t,!1,!1)}getAriaAreaSizeText(t){return null===t?null:t.toFixed(0)+" "+this.unit}}return n.\u0275fac=function(t){return new(t||n)(k(an),k(Kt),k(Kr),k(zi),k(Yte,8))},n.\u0275cmp=He({type:n,selectors:[["as-split"]],viewQuery:function(t,i){if(1&t&&Gi(Hte,5),2&t){let r;xt(r=Mt())&&(i.gutterEls=r)}},inputs:{direction:"direction",unit:"unit",gutterSize:"gutterSize",gutterStep:"gutterStep",restrictMove:"restrictMove",useTransition:"useTransition",disabled:"disabled",dir:"dir",gutterDblClickDuration:"gutterDblClickDuration",gutterClickDeltaPx:"gutterClickDeltaPx",gutterAriaLabel:"gutterAriaLabel"},outputs:{transitionEnd:"transitionEnd",dragStart:"dragStart",dragEnd:"dragEnd",gutterClick:"gutterClick",gutterDblClick:"gutterDblClick"},exportAs:["asSplit"],ngContentSelectors:Gte,decls:2,vars:1,consts:[["ngFor","",3,"ngForOf"],["role","slider","tabindex","0","class","as-split-gutter",3,"flex-basis","order","keydown","mousedown","touchstart","mouseup","touchend",4,"ngIf"],["role","slider","tabindex","0",1,"as-split-gutter",3,"keydown","mousedown","touchstart","mouseup","touchend"],["gutterEls",""],[1,"as-split-gutter-icon"]],template:function(t,i){1&t&&(kc(),Lc(0),W(1,zte,1,1,"ng-template",0)),2&t&&(A(1),S("ngForOf",i.displayedAreas))},directives:[Ri,Yn],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:nowrap;justify-content:flex-start;align-items:stretch;overflow:hidden;width:100%;height:100%}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{border:none;flex-grow:0;flex-shrink:0;background-color:#eee;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%] > .as-split-gutter.as-split-gutter-collapsed[_ngcontent-%COMP%]{flex-basis:1px!important;pointer-events:none}[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{width:100%;height:100%;background-position:center center;background-repeat:no-repeat}[_nghost-%COMP%]    >.as-split-area{flex-grow:0;flex-shrink:0;overflow-x:hidden;overflow-y:auto}[_nghost-%COMP%]    >.as-split-area.as-hidden{flex:0 1 0px!important;overflow-x:hidden;overflow-y:hidden}.as-horizontal[_nghost-%COMP%]{flex-direction:row}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:row;cursor:col-resize;height:100%}.as-horizontal[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%] > .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==)}.as-horizontal[_nghost-%COMP%]    >.as-split-area{height:100%}.as-vertical[_nghost-%COMP%]{flex-direction:column}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{flex-direction:column;cursor:row-resize;width:100%}.as-vertical[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFCAMAAABl/6zIAAAABlBMVEUAAADMzMzIT8AyAAAAAXRSTlMAQObYZgAAABRJREFUeAFjYGRkwIMJSeMHlBkOABP7AEGzSuPKAAAAAElFTkSuQmCC)}.as-vertical[_nghost-%COMP%]    >.as-split-area{width:100%}.as-vertical[_nghost-%COMP%]    >.as-split-area.as-hidden{max-width:0}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]{cursor:default}.as-disabled[_nghost-%COMP%] > .as-split-gutter[_ngcontent-%COMP%]   .as-split-gutter-icon[_ngcontent-%COMP%]{background-image:url()}.as-transition.as-init[_nghost-%COMP%]:not(.as-dragging) > .as-split-gutter[_ngcontent-%COMP%], .as-transition.as-init[_nghost-%COMP%]:not(.as-dragging)    >.as-split-area{transition:flex-basis .3s}"],changeDetection:0}),n})(),Gx=(()=>{class n{constructor(t,i,r,o){this.ngZone=t,this.elRef=i,this.renderer=r,this.split=o,this._order=null,this._size=null,this._minSize=null,this._maxSize=null,this._lockSize=!1,this._visible=!0,this.lockListeners=[],this.renderer.addClass(this.elRef.nativeElement,"as-split-area")}set order(t){this._order=ja(t,null),this.split.updateArea(this,!0,!1)}get order(){return this._order}set size(t){this._size=ja(t,null),this.split.updateArea(this,!1,!0)}get size(){return this._size}set minSize(t){this._minSize=ja(t,null),this.split.updateArea(this,!1,!0)}get minSize(){return this._minSize}set maxSize(t){this._maxSize=ja(t,null),this.split.updateArea(this,!1,!0)}get maxSize(){return this._maxSize}set lockSize(t){this._lockSize=Hf(t),this.split.updateArea(this,!1,!0)}get lockSize(){return this._lockSize}set visible(t){this._visible=Hf(t),this._visible?(this.split.showArea(this),this.renderer.removeClass(this.elRef.nativeElement,"as-hidden")):(this.split.hideArea(this),this.renderer.addClass(this.elRef.nativeElement,"as-hidden"))}get visible(){return this._visible}ngOnInit(){this.split.addArea(this),this.ngZone.runOutsideAngular(()=>{this.transitionListener=this.renderer.listen(this.elRef.nativeElement,"transitionend",t=>{"flex-basis"===t.propertyName&&this.split.notify("transitionEnd",-1)})})}setStyleOrder(t){this.renderer.setStyle(this.elRef.nativeElement,"order",t)}setStyleFlex(t,i,r,o,s){this.renderer.setStyle(this.elRef.nativeElement,"flex-grow",t),this.renderer.setStyle(this.elRef.nativeElement,"flex-shrink",i),this.renderer.setStyle(this.elRef.nativeElement,"flex-basis",r),!0===o?this.renderer.addClass(this.elRef.nativeElement,"as-min"):this.renderer.removeClass(this.elRef.nativeElement,"as-min"),!0===s?this.renderer.addClass(this.elRef.nativeElement,"as-max"):this.renderer.removeClass(this.elRef.nativeElement,"as-max")}lockEvents(){this.ngZone.runOutsideAngular(()=>{this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement,"selectstart",()=>!1)),this.lockListeners.push(this.renderer.listen(this.elRef.nativeElement,"dragstart",()=>!1))})}unlockEvents(){for(;this.lockListeners.length>0;){const t=this.lockListeners.pop();t&&t()}}ngOnDestroy(){this.unlockEvents(),this.transitionListener&&this.transitionListener(),this.split.removeArea(this)}collapse(t=0,i="right"){this.split.collapseArea(this,t,i)}expand(){this.split.expandArea(this)}}return n.\u0275fac=function(t){return new(t||n)(k(an),k(Kt),k(zi),k(n0))},n.\u0275dir=me({type:n,selectors:[["as-split-area"],["","as-split-area",""]],inputs:{order:"order",size:"size",minSize:"minSize",maxSize:"maxSize",lockSize:"lockSize",visible:"visible"},exportAs:["asSplitArea"]}),n})(),Zte=(()=>{class n{static forRoot(){return console.warn("AngularSplitModule.forRoot() is deprecated and will be removed in v6"),{ngModule:n,providers:[]}}static forChild(){return console.warn("AngularSplitModule.forChild() is deprecated and will be removed in v6"),{ngModule:n,providers:[]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[tr]]}),n})();function Xte(n,e){1&n&&tn(0)}function Kte(n,e){1&n&&tn(0)}const Kl=function(n){return{$implicit:n}};function Jte(n,e){if(1&n){const t=nt();F(0,"as-split",4),Y("dragEnd",function(){return ge(t),H().onSplitDragEnd()}),F(1,"as-split-area",5),W(2,Xte,1,0,"ng-container",3),B(),F(3,"as-split-area",5),W(4,Kte,1,0,"ng-container",3),B()()}if(2&n){const t=e.$implicit;H();const i=gt(5);A(1),S("size",t.one),A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ai(6,Kl,t.t)),A(1),S("size",t.two),A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ai(8,Kl,t.b))}}function Qte(n,e){1&n&&tn(0)}function ene(n,e){1&n&&tn(0)}function tne(n,e){if(1&n){const t=nt();F(0,"as-split",6),Y("dragEnd",function(){return ge(t),H().onSplitDragEnd()}),F(1,"as-split-area",5),W(2,Qte,1,0,"ng-container",3),B(),F(3,"as-split-area",5),W(4,ene,1,0,"ng-container",3),B()()}if(2&n){const t=e.$implicit;H();const i=gt(5);A(1),S("size",t.one),A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ai(6,Kl,t.l)),A(1),S("size",t.two),A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ai(8,Kl,t.r))}}function nne(n,e){if(1&n){const t=nt();qt(0),F(1,"tab-set",9),Y("zoneDrop",function(r){return ge(t),H(2).onZoneDrop(r)})("closed",function(r){return ge(t),H(2).onClosed(r)}),B(),Yt()}if(2&n){const t=H().$implicit,i=H();A(1),S("info",t)("root",t===i.root)}}function ine(n,e){1&n&&tn(0)}function rne(n,e){if(1&n&&(qt(0),W(1,ine,1,0,"ng-container",3),Yt()),2&n){const t=H().$implicit;H();const i=gt(3);A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ai(2,Kl,t))}}function one(n,e){1&n&&tn(0)}function sne(n,e){if(1&n&&(qt(0),W(1,one,1,0,"ng-container",3),Yt()),2&n){const t=H().$implicit;H();const i=gt(1);A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ai(2,Kl,t))}}function ane(n,e){1&n&&(qt(0,7),W(1,nne,2,2,"ng-container",8),W(2,rne,2,4,"ng-container",8),W(3,sne,2,4,"ng-container",8),Yt()),2&n&&(S("ngSwitch",e.$implicit.type),A(1),S("ngSwitchCase","tabs"),A(1),S("ngSwitchCase","horizontal"),A(1),S("ngSwitchCase","vertical"))}function lne(n,e){1&n&&tn(0)}class gk{constructor(e,t){this.one=e,this.two=t}}class r0 extends gk{constructor(e,t,i,r){super(t,r),this.l=e,this.r=i,this.type="horizontal"}}class jx extends gk{constructor(e,t,i,r){super(t,r),this.t=e,this.b=i,this.type="vertical"}}let cne=(()=>{class n{constructor(t){this.engine=t}onSplitDragEnd(){this.engine.updateLayout()}onClosed(t){const i=this.findTabSet(this.root,t.uuid);if(i)if(i.parent&&i.parent.content&&i.parent.parent&&i.parent.parent.content){const r=this.findPropertyInParent(i.parent.parent.content,i.parent.content);if("horizontal"===i.parent.content.type){const o=i.parent.content;o.l===i.tabSet?this.replace(r,o.r):o.r===i.tabSet?this.replace(r,o.l):console.error("could not find child property")}else if("vertical"===i.parent.content.type){const o=i.parent.content;o.t===i.tabSet?this.replace(r,o.b):o.b===i.tabSet?this.replace(r,o.t):console.error("could not find child property")}}else if("horizontal"===this.root.type){const r=this.root;r.l===i.tabSet?this.root=r.r:r.r===i.tabSet?this.root=r.l:console.error("could not find child property")}else if("vertical"===this.root.type){const r=this.root;r.t===i.tabSet?this.root=r.b:r.b===i.tabSet?this.root=r.t:console.error("could not find child property")}}findPropertyInParent(t,i){if("horizontal"===t.type){const r=t;if(r.l===i)return new ho("l",t);if(r.r===i)return new ho("r",t)}else if("vertical"===t.type){const r=t;if(r.t===i)return new ho("t",t);if(r.b===i)return new ho("b",t)}throw Error("could not find property")}onZoneDrop({info:t,uuid:i,direction:r}){if(t.tabs.some(s=>s.uuid===i)&&(1===t.tabs.length||"center"===r))return;const o=this.findTab(this.root,i);if(o){switch(o.tabSet.tabs.splice(o.tabSet.tabs.indexOf(o.tab),1),r){case"center":t.tabs.push(o.tab),this.activateTab(t.uuid,o.tab.name);break;case"up":this.replaceTabSet(t.uuid,new jx(new Ga([o.tab]),50,t,50));break;case"down":this.replaceTabSet(t.uuid,new jx(t,50,new Ga([o.tab]),50));break;case"left":this.replaceTabSet(t.uuid,new r0(new Ga([o.tab]),50,t,50));break;case"right":this.replaceTabSet(t.uuid,new r0(t,50,new Ga([o.tab]),50))}this.activateRemainingTab(o.tabSet.uuid,i)}}activateTab(t,i){const r=this.findTabSetComponent(t);r&&setTimeout(()=>r.ngbNav.select(i),0)}activateRemainingTab(t,i){const r=this.findTabSetComponent(t);if(r){let o;for(const s of r.info.tabs)if(s.uuid!==i){o=s;break}o&&r.ngbNav.select(o.name)}}findTabSetComponent(t){for(const i of this.tabSets)if(i.info.uuid===t)return i}findTab(t,i,r){if("tabs"===t.type){const o=t,s=o.tabs.find(a=>a.uuid===i);if(s)return new une(o,s,r)}else if("horizontal"===t.type){const o=t,s=this.findTab(o.l,i,new ho("l",t,r));if(s)return s;const a=this.findTab(o.r,i,new ho("r",t,r));if(a)return a}else if("vertical"===t.type){const o=t,s=this.findTab(o.t,i,new ho("t",t,r));if(s)return s;const a=this.findTab(o.b,i,new ho("b",t,r));if(a)return a}}findTabSet(t,i,r){if("tabs"===t.type){const o=t;if(o.uuid===i)return new dne(o,r)}else if("horizontal"===t.type){const o=t,s=this.findTabSet(o.l,i,new ho("l",t,r));if(s)return s;const a=this.findTabSet(o.r,i,new ho("r",t,r));if(a)return a}else if("vertical"===t.type){const o=t,s=this.findTabSet(o.t,i,new ho("t",t,r));if(s)return s;const a=this.findTabSet(o.b,i,new ho("b",t,r));if(a)return a}}replaceTabSet(t,i){const r=this.findTabSet(this.root,t);r&&r.parent&&this.replace(r.parent,i)}replace(t,i){t.prop&&t.content?t.content[t.prop]=i:this.root=i}}return n.\u0275fac=function(t){return new(t||n)(k(ar))},n.\u0275cmp=He({type:n,selectors:[["split-content"]],viewQuery:function(t,i){if(1&t&&Gi(uk,5),2&t){let r;xt(r=Mt())&&(i.tabSets=r)}},inputs:{root:"root"},decls:7,vars:4,consts:[["vertical",""],["horizontal",""],["content",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["direction","vertical",3,"dragEnd"],[3,"size"],["direction","horizontal",3,"dragEnd"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"info","root","zoneDrop","closed"]],template:function(t,i){if(1&t&&(W(0,Jte,5,10,"ng-template",null,0,st),W(2,tne,5,10,"ng-template",null,1,st),W(4,ane,4,4,"ng-template",null,2,st),W(6,lne,1,0,"ng-container",3)),2&t){const r=gt(5);A(6),S("ngTemplateOutlet",r)("ngTemplateOutletContext",Ai(2,Kl,i.root))}},directives:[n0,Gx,gr,hl,dh,uk],encapsulation:2}),n})();class ho{constructor(e,t,i){this.prop=e,this.content=t,this.parent=i}}class une{constructor(e,t,i){this.tabSet=e,this.tab=t,this.parent=i}}class dne{constructor(e,t){this.tabSet=e,this.parent=t}}function hne(n,e){1&n&&(F(0,"div",3)(1,"div",4),Rt(2,"no animation selected"),B()())}function fne(n,e){if(1&n&&(F(0,"div"),Rt(1),B()),2&n){const t=e.$implicit;A(1),Ui(t.name)}}function pne(n,e){if(1&n&&(F(0,"div",5),W(1,fne,2,1,"div",6),B()),2&n){const t=e.$implicit;A(1),S("ngForOf",t.tracks)}}function gne(n,e){1&n&&tn(0)}const mne=function(n){return{$implicit:n}};function _ne(n,e){if(1&n&&(qt(0),W(1,gne,1,0,"ng-container",7),Yt()),2&n){const t=H(),i=gt(3);A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ai(2,mne,t.clip))}}let yne=(()=>{class n{constructor(t){this.engine=t}ngOnInit(){this.selectionSub=this.engine.selection$.subscribe(t=>this.onSelectionUpdated(t))}ngOnDestroy(){this.selectionSub.unsubscribe()}onSelectionUpdated(t){this.clip=this.findFirstAnimationClip(t),console.log("showing clip",this.clip)}findFirstAnimationClip(t){for(const i of t){if(i instanceof Ra)return i;if(i instanceof Dt&&i.animations&&i.animations.length>0)return i.animations[0]}}}return n.\u0275fac=function(t){return new(t||n)(k(ar))},n.\u0275cmp=He({type:n,selectors:[["animation-view"]],decls:5,vars:2,consts:[["empty",""],["exists",""],[4,"ngIf","ngIfElse"],[1,"d-flex","h-100","text-muted","fst-italic","bg-white"],[1,"w-100","text-center","align-self-center"],[1,"w-100","h-100","fs-xs","overflow-y-only","bg-light"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){if(1&t&&(W(0,hne,3,0,"ng-template",null,0,st),W(2,pne,2,1,"ng-template",null,1,st),W(4,_ne,2,4,"ng-container",2)),2&t){const r=gt(1);A(4),S("ngIf",i.clip)("ngIfElse",r)}},directives:[Ri,Yn,gr],encapsulation:2}),n})();const vne=["*"];let Uf=(()=>{class n{constructor(){this.border=!0,this.sub=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["inspector-table"]],inputs:{border:"border",sub:"sub"},ngContentSelectors:vne,decls:2,vars:4,consts:[[1,"inspector","table","table-borderless","table-sm","bg-white","xs","m-0"]],template:function(t,i){1&t&&(kc(),F(0,"table",0),Lc(1),B()),2&t&&Ze("border-bottom",i.border)("border-start",i.border&&i.sub)},encapsulation:2}),n})();const bne=["*"];let zr=(()=>{class n{constructor(){this.cols=5,this.sub=!1,this.expanded=!0}toggleExpanded(){this.expanded=!this.expanded}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["component-editor"]],inputs:{name:"name",cols:"cols",sub:"sub"},ngContentSelectors:bne,decls:12,vars:10,consts:[[3,"sub"],[1,"table-secondary"],[1,"selectable","align-middle",3,"click"],[1,"fa-solid","fa-caret-down","fa-fw"],[1,"fa-solid","fa-caret-right","fa-fw"],[1,"selectable",3,"colSpan","click"],[3,"type","name"],[3,"hidden"]],template:function(t,i){1&t&&(kc(),F(0,"inspector-table",0)(1,"thead")(2,"tr",1)(3,"th",2),Y("click",function(){return i.toggleExpanded()}),F(4,"span"),he(5,"i",3)(6,"i",4),B()(),F(7,"th",5),Y("click",function(){return i.toggleExpanded()}),he(8,"icon",6),Rt(9),B()()(),F(10,"tbody",7),Lc(11),B()()),2&t&&(S("sub",i.sub),A(5),Ze("d-none",!i.expanded),A(1),Ze("d-none",i.expanded),A(1),Zr("colSpan",i.cols),A(1),S("type","component")("name",i.name),A(1),Ui(i.name),A(1),S("hidden",!i.expanded))},directives:[Uf,Q_],encapsulation:2}),n})();const wne=["template"];function xne(n,e){1&n&&he(0,"i",6)}function Mne(n,e){if(1&n&&(F(0,"span"),he(1,"i",7)(2,"i",8),B()),2&n){const t=H(2);A(1),Ze("d-none",!t.expanded),A(1),Ze("d-none",t.expanded)}}function Dne(n,e){1&n&&tn(0)}function Sne(n,e){if(1&n&&(F(0,"tr",9)(1,"th"),he(2,"i",6),B(),F(3,"td",10),W(4,Dne,1,0,"ng-container",11),B()()),2&n){const t=H(2);S("hidden",!t.expanded),A(3),Ze("py-1",t.content.editor),A(1),S("ngTemplateOutlet",t.content.template)}}function Ene(n,e){if(1&n){const t=nt();F(0,"tr")(1,"th",1),Y("click",function(){ge(t);const r=H();return r.canExpand&&r.toggleExpanded()}),W(2,xne,1,0,"i",2),W(3,Mne,3,4,"span",3),B(),F(4,"th",4),Y("click",function(){ge(t);const r=H();return r.canExpand&&r.toggleExpanded()}),Rt(5),B(),Lc(6),B(),W(7,Sne,5,4,"tr",5)}if(2&n){const t=H();A(1),Ze("selectable",t.canExpand),A(1),S("ngIf",!t.canExpand),A(1),S("ngIf",t.canExpand),A(1),Ze("selectable",t.canExpand),Zr("colSpan",t.cols),A(1),Ui(t.name),A(2),S("ngIf",t.content&&t.content.show)}}const Cne=["*"];let pd=(()=>{class n{constructor(t){this.template=t,this.editor=!1,this.show=!0}}return n.\u0275fac=function(t){return new(t||n)(k(Tn))},n.\u0275dir=me({type:n,selectors:[["","nested-content",""]],inputs:{editor:"editor",show:"show"}}),n})(),dr=(()=>{class n{constructor(t){this.viewContainerRef=t}ngOnInit(){this.viewContainerRef.createEmbeddedView(this.template)}}return n.\u0275fac=function(t){return new(t||n)(k($n))},n.\u0275cmp=He({type:n,selectors:[["ng-component"]],viewQuery:function(t,i){if(1&t&&Gi(wne,7),2&t){let r;xt(r=Mt())&&(i.template=r.first)}},inputs:{name:"name"},decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})(),yr=(()=>{class n extends dr{constructor(t){super(t),this.cols=2,this.canExpand=!1,this.expanded=!1,this.expandedChange=new Ne}toggleExpanded(){this.expanded=!this.expanded,this.expandedChange.emit(this.expanded)}}return n.\u0275fac=function(t){return new(t||n)(k($n))},n.\u0275cmp=He({type:n,selectors:[["property"]],contentQueries:function(t,i,r){if(1&t&&An(r,pd,7),2&t){let o;xt(o=Mt())&&(i.content=o.first)}},inputs:{cols:"cols",canExpand:"canExpand",expanded:"expanded"},outputs:{expandedChange:"expandedChange"},features:[lt],ngContentSelectors:Cne,decls:2,vars:0,consts:[["template",""],[1,"align-middle",3,"click"],["class","fa-solid fa-question fa-fw invisible",4,"ngIf"],[4,"ngIf"],[1,"align-middle",3,"colSpan","click"],[3,"hidden",4,"ngIf"],[1,"fa-solid","fa-question","fa-fw","invisible"],[1,"fa-solid","fa-caret-down","fa-fw"],[1,"fa-solid","fa-caret-right","fa-fw"],[3,"hidden"],["colSpan","5",1,"p-0"],[4,"ngTemplateOutlet"]],template:function(t,i){1&t&&(kc(),W(0,Ene,8,9,"ng-template",null,0,st))},directives:[Yn,gr],encapsulation:2}),n})();function Tne(n,e){if(1&n){const t=nt();F(0,"property",1)(1,"td",2)(2,"div",3)(3,"input",4),Y("ngModelChange",function(r){return ge(t),H().model=r})("ngModelChange",function(){return ge(t),H().onValueChange()}),B()()()()}if(2&n){const t=H();S("name",t.name),A(3),S("ngModel",t.model)("readonly",t.readonly)}}let zf=(()=>{class n extends dr{constructor(){super(...arguments),this.readonly=!1,this.modelChange=new Ne}onValueChange(){this.modelChange.emit(this.model)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275cmp=He({type:n,selectors:[["string-property"]],inputs:{readonly:"readonly",model:"model"},outputs:{modelChange:"modelChange"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name"],["colSpan","3"],[1,"input-group","input-group-sm","xs"],["type","text",1,"form-control",3,"ngModel","readonly","ngModelChange"]],template:function(t,i){1&t&&W(0,Tne,4,3,"ng-template",null,0,st)},directives:[yr,ss,ko,co],encapsulation:2}),n})();function Ane(n,e){if(1&n){const t=nt();F(0,"property",1)(1,"td",2)(2,"div")(3,"input",3),Y("ngModelChange",function(r){return ge(t),H().model=r})("ngModelChange",function(){return ge(t),H().onValueChange()}),B()()()()}if(2&n){const t=H();S("name",t.name),A(3),S("ngModel",t.model)}}let o0=(()=>{class n extends dr{constructor(t){super(t),this.modelChange=new Ne}onValueChange(){this.modelChange.emit(this.model)}}return n.\u0275fac=function(t){return new(t||n)(k($n))},n.\u0275cmp=He({type:n,selectors:[["boolean-property"]],inputs:{model:"model"},outputs:{modelChange:"modelChange"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name"],["colSpan","3",1,"align-middle"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&W(0,Ane,4,2,"ng-template",null,0,st)},directives:[yr,C_,ko,co],encapsulation:2}),n})();function Ine(n,e){if(1&n){const t=nt();F(0,"property",1)(1,"td")(2,"div",2)(3,"span",3),Rt(4,"X"),B(),F(5,"input",4),Y("ngModelChange",function(r){return ge(t),H().model.x=r}),B()()(),F(6,"td")(7,"div",2)(8,"span",3),Rt(9,"Y"),B(),F(10,"input",4),Y("ngModelChange",function(r){return ge(t),H().model.y=r}),B()()(),F(11,"td")(12,"div",2)(13,"span",3),Rt(14,"Z"),B(),F(15,"input",4),Y("ngModelChange",function(r){return ge(t),H().model.z=r}),B()()()()}if(2&n){const t=H();S("name",t.name),A(5),S("ngModel",t.model.x),A(5),S("ngModel",t.model.y),A(5),S("ngModel",t.model.z)}}let Rne=(()=>{class n extends dr{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275cmp=He({type:n,selectors:[["vector3-property"]],inputs:{model:"model"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name"],[1,"input-group","input-group-sm","xs"],[1,"input-group-text"],["type","number","step","any",1,"form-control",3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&W(0,Ine,16,4,"ng-template",null,0,st)},directives:[yr,Sf,ss,ko,co],encapsulation:2}),n})();function Nne(n,e){if(1&n){const t=nt();F(0,"property",1)(1,"td",2)(2,"div",3)(3,"input",4),Y("ngModelChange",function(r){return ge(t),H().value=r})("ngModelChange",function(){return ge(t),H().onValueChange()}),B()()()()}if(2&n){const t=H();S("name",t.name),A(3),S("ngModel",t.value)}}let Gf=(()=>{class n extends dr{constructor(){super(...arguments),this.modelChange=new Ne}get value(){return`#${this.model.getHexString()}`}set value(t){this.model=new ve(t)}onValueChange(){this.modelChange.emit(this.model)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275cmp=He({type:n,selectors:[["color-property"]],inputs:{model:"model"},outputs:{modelChange:"modelChange"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name"],["colSpan","3"],[1,"input-group","input-group-sm","xs"],["type","color",1,"form-control",3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&W(0,Nne,4,2,"ng-template",null,0,st)},directives:[yr,ss,ko,co],encapsulation:2}),n})(),Pne=(()=>{class n{constructor(){this.sub=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["fog-editor"]],inputs:{model:"model",sub:"sub"},decls:3,vars:6,consts:[[3,"name","sub"],[3,"name","model","modelChange"]],template:function(t,i){1&t&&(F(0,"component-editor",0)(1,"string-property",1),Y("modelChange",function(o){return i.model.name=o}),B(),F(2,"color-property",1),Y("modelChange",function(o){return i.model.color=o}),B()()),2&t&&(S("name","Fog")("sub",i.sub),A(1),S("name","Name")("model",i.model.name),A(1),S("name","Color")("model",i.model.color))},directives:[zr,zf,Gf],encapsulation:2}),n})();function One(n,e){1&n&&he(0,"fog-editor",6),2&n&&S("model",H(3).asFog)("sub",!0)}function Fne(n,e){1&n&&W(0,One,1,2,"fog-editor",5),2&n&&S("ngIf",H(2).isFog)}function kne(n,e){if(1&n){const t=nt();F(0,"property",1)(1,"td",2)(2,"div")(3,"input",3),Y("ngModelChange",function(r){return ge(t),H().value=r})("ngModelChange",function(){return ge(t),H().onValueChange()}),B()()(),W(4,Fne,1,1,"ng-template",4),B()}if(2&n){const t=H();S("name",t.name)("expanded",t.isFog),A(3),S("ngModel",t.value),A(1),S("editor",!0)}}let Lne=(()=>{class n extends dr{constructor(t){super(t),this.modelChange=new Ne}get isFog(){return this.model instanceof Au}get asFog(){return this.model}get value(){return this.isFog}set value(t){this.model=t?new Au(10066329):null}onValueChange(){this.modelChange.emit(this.model)}}return n.\u0275fac=function(t){return new(t||n)(k($n))},n.\u0275cmp=He({type:n,selectors:[["fog-property"]],inputs:{model:"model"},outputs:{modelChange:"modelChange"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name","expanded"],["colSpan","3",1,"align-middle"],["type","checkbox",1,"form-check-input",3,"ngModel","ngModelChange"],["nested-content","",3,"editor"],[3,"model","sub",4,"ngIf"],[3,"model","sub"]],template:function(t,i){1&t&&W(0,kne,5,4,"ng-template",null,0,st)},directives:[yr,C_,ko,co,pd,Yn,Pne],encapsulation:2}),n})();function Bne(n,e){if(1&n){const t=nt();qt(0),F(1,"color-property",2),Y("modelChange",function(r){return ge(t),H().backgroundColor=r}),B(),Yt()}if(2&n){const t=H();A(1),S("name","Background")("model",t.backgroundColor)}}let Vne=(()=>{class n{get backgroundIsColor(){return this.model.background instanceof ve}get backgroundColor(){return this.model.background}set backgroundColor(t){this.model.background=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["scene-editor"]],inputs:{model:"model"},decls:3,vars:4,consts:[[3,"name"],[4,"ngIf"],[3,"name","model","modelChange"]],template:function(t,i){1&t&&(F(0,"component-editor",0),W(1,Bne,2,2,"ng-container",1),F(2,"fog-property",2),Y("modelChange",function(o){return i.model.fog=o}),B()()),2&t&&(S("name",i.model.type),A(1),S("ngIf",i.backgroundIsColor),A(1),S("name","Fog")("model",i.model.fog))},directives:[zr,Yn,Gf,Lne],encapsulation:2}),n})();function Hne(n,e){if(1&n){const t=nt();F(0,"property",1)(1,"td",2)(2,"div",3)(3,"input",4),Y("ngModelChange",function(r){return ge(t),H().model=r})("ngModelChange",function(){return ge(t),H().onValueChange()}),B()()()()}if(2&n){const t=H();S("name",t.name),A(3),S("ngModel",t.model)}}let Une=(()=>{class n extends dr{constructor(){super(...arguments),this.modelChange=new Ne}onValueChange(){this.modelChange.emit(this.model)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275cmp=He({type:n,selectors:[["float-property"]],inputs:{model:"model"},outputs:{modelChange:"modelChange"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name"],["colSpan","3"],[1,"input-group","input-group-sm","xs"],["type","number","step","1",1,"form-control",3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&W(0,Hne,4,2,"ng-template",null,0,st)},directives:[yr,Sf,ss,ko,co],encapsulation:2}),n})();function zne(n,e){if(1&n){const t=nt();F(0,"property",1)(1,"td",2)(2,"div",3)(3,"input",4),Y("ngModelChange",function(r){return ge(t),H().model=r})("ngModelChange",function(){return ge(t),H().onValueChange()}),B()()()()}if(2&n){const t=H();S("name",t.name),A(3),S("ngModel",t.model)}}let Gne=(()=>{class n extends dr{constructor(){super(...arguments),this.modelChange=new Ne}onValueChange(){this.modelChange.emit(this.model)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275cmp=He({type:n,selectors:[["integer-property"]],inputs:{model:"model"},outputs:{modelChange:"modelChange"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name"],["colSpan","3"],[1,"input-group","input-group-sm","xs"],["type","number","step","1",1,"form-control",3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&W(0,zne,4,2,"ng-template",null,0,st)},directives:[yr,Sf,ss,ko,co],encapsulation:2}),n})(),jne=(()=>{class n{constructor(t){this.engine=t,this.sub=!1}apply(){const t=new In(...Object.values(this.model.parameters));t.name=this.model.name,this.engine.replaceGeometry(this.model,t)}}return n.\u0275fac=function(t){return new(t||n)(k(ar))},n.\u0275cmp=He({type:n,selectors:[["box-geometry-editor"]],inputs:{model:"model",sub:"sub"},decls:7,vars:14,consts:[[3,"name","sub"],[3,"name","model","modelChange"]],template:function(t,i){1&t&&(F(0,"component-editor",0)(1,"float-property",1),Y("modelChange",function(o){return i.model.parameters.width=o})("modelChange",function(){return i.apply()}),B(),F(2,"float-property",1),Y("modelChange",function(o){return i.model.parameters.height=o})("modelChange",function(){return i.apply()}),B(),F(3,"float-property",1),Y("modelChange",function(o){return i.model.parameters.depth=o})("modelChange",function(){return i.apply()}),B(),F(4,"integer-property",1),Y("modelChange",function(o){return i.model.parameters.widthSegments=o})("modelChange",function(){return i.apply()}),B(),F(5,"integer-property",1),Y("modelChange",function(o){return i.model.parameters.heightSegments=o})("modelChange",function(){return i.apply()}),B(),F(6,"integer-property",1),Y("modelChange",function(o){return i.model.parameters.depthSegments=o})("modelChange",function(){return i.apply()}),B()()),2&t&&(S("name",i.model.type)("sub",i.sub),A(1),S("name","Width")("model",i.model.parameters.width),A(1),S("name","Height")("model",i.model.parameters.height),A(1),S("name","Depth")("model",i.model.parameters.depth),A(1),S("name","Width Segments")("model",i.model.parameters.widthSegments),A(1),S("name","Height Segments")("model",i.model.parameters.heightSegments),A(1),S("name","Depth Segments")("model",i.model.parameters.depthSegments))},directives:[zr,Une,Gne],encapsulation:2}),n})(),s0=(()=>{class n{constructor(){this.sub=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["not-found-editor"]],inputs:{type:"type",sub:"sub"},decls:5,vars:7,consts:[[1,"d-flex","flex-column","justify-content-center","text-muted","fst-italic"],[1,"alert","alert-warning","d-flex","align-items-center","p-2"],[1,"fa-solid","fa-warning","fa-fw"],[1,"text-center","align-self-center","ms-1"]],template:function(t,i){1&t&&(F(0,"div",0)(1,"div",1),he(2,"i",2),F(3,"div",3),Rt(4),B()()()),2&t&&(A(1),Ze("me-1",i.sub)("my-2",i.sub)("m-3",!i.sub),A(3),Jo("Editor for ",i.type," not found"))},encapsulation:2}),n})();function Wne(n,e){if(1&n&&(qt(0),F(1,"property",12)(2,"td",13)(3,"div"),Rt(4),B()()(),Yt()),2&n){const t=e.$implicit,i=H(2);A(1),S("name",t),A(3),Yp("",i.model.attributes[t].itemSize,", ",i.model.attributes[t].count,"")}}function $ne(n,e){if(1&n&&(F(0,"inspector-table",10)(1,"tbody"),W(2,Wne,5,3,"ng-container",11),B()()),2&n){const t=H();S("border",!1),A(2),S("ngForOf",t.attributeKeys)}}function qne(n,e){1&n&&tn(0)}function Yne(n,e){if(1&n&&he(0,"box-geometry-editor",14),2&n){const t=H();S("model",t.asBoxGeometry)("sub",t.sub)}}function Zne(n,e){if(1&n&&he(0,"not-found-editor",15),2&n){const t=H();S("type",t.model.type)("sub",t.sub)}}let mk=(()=>{class n{constructor(){this.sub=!1}get attributeCount(){return Object.keys(this.model.attributes).length}get attributeKeys(){return Object.keys(this.model.attributes)}get asBoxGeometry(){return this.model}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["geometry-editor"]],inputs:{model:"model",sub:"sub"},decls:12,vars:13,consts:[[3,"name","sub"],[3,"name","model","readonly"],[3,"name","model","modelChange"],[3,"name","canExpand"],["colSpan","3",1,"text-right"],["nested-content",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"model","sub",4,"ngSwitchCase"],[3,"type","sub",4,"ngSwitchDefault"],[3,"border"],[4,"ngFor","ngForOf"],[3,"name"],["colSpan","3"],[3,"model","sub"],[3,"type","sub"]],template:function(t,i){1&t&&(F(0,"component-editor",0),he(1,"string-property",1),F(2,"string-property",2),Y("modelChange",function(o){return i.model.name=o}),B(),F(3,"property",3)(4,"td",4)(5,"div"),Rt(6),B()(),W(7,$ne,3,2,"ng-template",5),B()(),qt(8,6),W(9,qne,1,0,"ng-container",7),W(10,Yne,1,2,"box-geometry-editor",8),W(11,Zne,1,2,"not-found-editor",9),Yt()),2&t&&(S("name","BufferGeometry")("sub",i.sub),A(1),S("name","UUID")("model",i.model.uuid)("readonly",!0),A(1),S("name","Name")("model",i.model.name),A(1),S("name","Attributes")("canExpand",!0),A(3),Ui(i.attributeCount),A(2),S("ngSwitch",i.model.type),A(1),S("ngSwitchCase","BufferGeometry"),A(1),S("ngSwitchCase","BoxGeometry"))},directives:[zr,zf,yr,pd,Uf,Ri,hl,dh,jne,bg,s0],encapsulation:2}),n})();function Xne(n,e){1&n&&he(0,"geometry-editor",12),2&n&&S("model",H(2).model)("sub",!0)}const Kne=function(){return["geometry"]};function Jne(n,e){if(1&n){const t=nt();F(0,"tr")(1,"td",1)(2,"inspector-table",2)(3,"tbody")(4,"property",3)(5,"td",4)(6,"div",5)(7,"button",6),Y("click",function(){return ge(t),H().pick()}),he(8,"i",7),B(),F(9,"input",8),Y("dndDrop",function(r){return ge(t),H().onDrop(r)}),B(),F(10,"button",9),Y("click",function(){return ge(t),H().inspect()}),he(11,"i",10),B()()(),W(12,Xne,1,2,"ng-template",11),B()()()()()}if(2&n){const t=H();A(2),S("border",!1),A(2),S("name",t.name)("canExpand",!0),A(5),S("value",t.model.name?t.model.name:"("+t.model.type+")")("dndDropzone",Xr(7,Kne))("dndEffectAllowed","link"),A(3),S("editor",!0)}}let Qne=(()=>{class n extends dr{constructor(t,i,r){super(t),this.engine=i,this.resources=r,this.setGeometry=new Ne}pick(){}inspect(){this.engine.setSelection([this.model])}onDrop(t){const i=this.resources.findGeometry(t.data);i&&this.setGeometry.emit(i)}}return n.\u0275fac=function(t){return new(t||n)(k($n),k(ar),k(vf))},n.\u0275cmp=He({type:n,selectors:[["geometry-property"]],inputs:{model:"model"},outputs:{setGeometry:"setGeometry"},features:[lt],decls:2,vars:0,consts:[["template",""],["colSpan","6",1,"p-0"],[3,"border"],[3,"name","canExpand"],["colSpan","3"],[1,"d-flex","flex-nowrap","input-group","input-group-sm","xs"],["type","button","title","Pick",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-arrow-pointer","fa-fw","fa-xs"],["type","text","readonly","",1,"form-control",3,"value","dndDropzone","dndEffectAllowed","dndDrop"],["type","button","title","Inspect",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-circle-info","fa-fw","fa-xs"],["nested-content","",3,"editor"],[3,"model","sub"]],template:function(t,i){1&t&&W(0,Jne,13,8,"ng-template",null,0,st)},directives:[Uf,yr,La,pd,mk],encapsulation:2}),n})();function eie(n,e){if(1&n){const t=nt();F(0,"property",1)(1,"td",2)(2,"div",3)(3,"input",4),Y("ngModelChange",function(r){return ge(t),H().model=r})("ngModelChange",function(){return ge(t),H().onValueChange()}),B()()(),F(4,"td",5)(5,"div",3),he(6,"input",6),B()()()}if(2&n){const t=H();S("name",t.name),A(3),Zr("min",t.min),Zr("max",t.max),Zr("step",t.step),S("ngModel",t.model),A(3),S("value",t.model)}}let a0=(()=>{class n extends dr{constructor(){super(...arguments),this.min=0,this.max=100,this.step=1,this.modelChange=new Ne}onValueChange(){this.modelChange.emit(this.model)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275cmp=He({type:n,selectors:[["range-property"]],inputs:{min:"min",max:"max",step:"step",model:"model"},outputs:{modelChange:"modelChange"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name"],["colSpan","2",1,"w-100","align-middle"],[1,"input-group","input-group-sm","xs"],["type","range",1,"form-range",3,"min","max","step","ngModel","ngModelChange"],[1,"align-middle"],["type","text","readonly","",1,"form-control",2,"width","50px",3,"value"]],template:function(t,i){1&t&&W(0,eie,7,6,"ng-template",null,0,st)},directives:[yr,gx,ss,ko,co],encapsulation:2}),n})();function tie(n,e){if(1&n&&(F(0,"option",6),Rt(1),B()),2&n){const t=e.$implicit;S("value",t.value),A(1),Ui(t.key)}}function nie(n,e){if(1&n){const t=nt();F(0,"property",1)(1,"td",2)(2,"div",3)(3,"select",4),Y("ngModelChange",function(r){return ge(t),H().model=r})("ngModelChange",function(){return ge(t),H().onValueChange()}),W(4,tie,2,2,"option",5),B()()()()}if(2&n){const t=H();S("name",t.name),A(3),S("ngModel",t.model),A(1),S("ngForOf",t.options)}}let _k=(()=>{class n extends dr{constructor(){super(...arguments),this.modelChange=new Ne}ngOnInit(){super.ngOnInit(),this.options=Object.entries(this.type).map(([t,i])=>({key:t,value:i})).filter(t=>"string"!=typeof t.value)}onValueChange(){this.modelChange.emit(this.model)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=On(n)))(i||n)}}(),n.\u0275cmp=He({type:n,selectors:[["enum-property"]],inputs:{type:"type",model:"model"},outputs:{modelChange:"modelChange"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name"],["colSpan","3"],[1,"input-group","input-group-sm","xs"],[1,"form-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,i){1&t&&W(0,nie,5,3,"ng-template",null,0,st)},directives:[yr,L_,ko,co,Ri,H2,z2],encapsulation:2}),n})(),iie=(()=>{class n{constructor(){this.sub=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["mesh-basic-material-editor"]],inputs:{model:"model",sub:"sub"},decls:5,vars:14,consts:[[3,"name","sub"],[3,"name","model","modelChange"],[3,"name","model","max","step","modelChange"]],template:function(t,i){1&t&&(F(0,"component-editor",0)(1,"color-property",1),Y("modelChange",function(o){return i.model.color=o}),B(),F(2,"boolean-property",1),Y("modelChange",function(o){return i.model.wireframe=o}),B(),F(3,"range-property",2),Y("modelChange",function(o){return i.model.reflectivity=o}),B(),F(4,"range-property",2),Y("modelChange",function(o){return i.model.refractionRatio=o}),B()()),2&t&&(S("name",i.model.type)("sub",i.sub),A(1),S("name","Color")("model",i.model.color),A(1),S("name","Wireframe")("model",i.model.wireframe),A(1),S("name","Reflectivity")("model",i.model.reflectivity)("max",1)("step",.01),A(1),S("name","Refraction Ratio")("model",i.model.refractionRatio)("max",1)("step",.01))},directives:[zr,Gf,o0,a0],encapsulation:2}),n})(),rie=(()=>{class n{constructor(){this.sub=!1}get combineType(){return s_}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["mesh-phong-material-editor"]],inputs:{model:"model",sub:"sub"},decls:12,vars:31,consts:[[3,"name","sub"],[3,"name","model","modelChange"],[3,"name","model","max","step","modelChange"],[3,"name","type","model","modelChange"]],template:function(t,i){1&t&&(F(0,"component-editor",0)(1,"color-property",1),Y("modelChange",function(o){return i.model.color=o}),B(),F(2,"color-property",1),Y("modelChange",function(o){return i.model.emissive=o}),B(),F(3,"color-property",1),Y("modelChange",function(o){return i.model.specular=o}),B(),F(4,"range-property",2),Y("modelChange",function(o){return i.model.shininess=o}),B(),F(5,"boolean-property",1),Y("modelChange",function(o){return i.model.flatShading=o}),B(),F(6,"boolean-property",1),Y("modelChange",function(o){return i.model.wireframe=o}),B(),F(7,"boolean-property",1),Y("modelChange",function(o){return i.model.vertexColors=o}),B(),F(8,"boolean-property",1),Y("modelChange",function(o){return i.model.fog=o}),B(),F(9,"enum-property",3),Y("modelChange",function(o){return i.model.combine=o}),B(),F(10,"range-property",2),Y("modelChange",function(o){return i.model.reflectivity=o}),B(),F(11,"range-property",2),Y("modelChange",function(o){return i.model.refractionRatio=o}),B()()),2&t&&(S("name",i.model.type)("sub",i.sub),A(1),S("name","Color")("model",i.model.color),A(1),S("name","Emissive")("model",i.model.emissive),A(1),S("name","Specular")("model",i.model.specular),A(1),S("name","Shininess")("model",i.model.shininess)("max",100)("step",1),A(1),S("name","Flat Shading")("model",i.model.flatShading),A(1),S("name","Wireframe")("model",i.model.wireframe),A(1),S("name","Vertex Colors")("model",i.model.vertexColors),A(1),S("name","Fog")("model",i.model.fog),A(1),S("name","Combine")("type",i.combineType)("model",i.model.combine),A(1),S("name","Reflectivity")("model",i.model.reflectivity)("max",1)("step",.01),A(1),S("name","Refraction Ratio")("model",i.model.refractionRatio)("max",1)("step",.01))},directives:[zr,Gf,a0,o0,_k],encapsulation:2}),n})();function oie(n,e){if(1&n&&he(0,"mesh-basic-material-editor",8),2&n){const t=H();S("model",t.asMeshBasicMaterial)("sub",t.sub)}}function sie(n,e){if(1&n&&he(0,"mesh-phong-material-editor",8),2&n){const t=H();S("model",t.asMeshPhongMaterial)("sub",t.sub)}}function aie(n,e){if(1&n&&he(0,"not-found-editor",9),2&n){const t=H();S("type",t.model.type)("sub",t.sub)}}let yk=(()=>{class n{constructor(){this.sub=!1}get sideType(){return a_}get asMeshBasicMaterial(){return this.model}get asMeshPhongMaterial(){return this.model}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["material-editor"]],inputs:{model:"model",sub:"sub"},decls:14,vars:29,consts:[[3,"name","sub"],[3,"name","model","readonly"],[3,"name","model","modelChange"],[3,"name","model","max","step","modelChange"],[3,"name","model","type","modelChange"],[3,"ngSwitch"],[3,"model","sub",4,"ngSwitchCase"],[3,"type","sub",4,"ngSwitchDefault"],[3,"model","sub"],[3,"type","sub"]],template:function(t,i){1&t&&(F(0,"component-editor",0),he(1,"string-property",1),F(2,"string-property",2),Y("modelChange",function(o){return i.model.name=o}),B(),F(3,"boolean-property",2),Y("modelChange",function(o){return i.model.visible=o}),B(),F(4,"boolean-property",2),Y("modelChange",function(o){return i.model.transparent=o}),B(),F(5,"range-property",3),Y("modelChange",function(o){return i.model.opacity=o}),B(),F(6,"boolean-property",2),Y("modelChange",function(o){return i.model.depthTest=o}),B(),F(7,"boolean-property",2),Y("modelChange",function(o){return i.model.depthWrite=o}),B(),F(8,"range-property",3),Y("modelChange",function(o){return i.model.alphaTest=o}),B(),F(9,"enum-property",4),Y("modelChange",function(o){return i.model.side=o}),B()(),qt(10,5),W(11,oie,1,2,"mesh-basic-material-editor",6),W(12,sie,1,2,"mesh-phong-material-editor",6),W(13,aie,1,2,"not-found-editor",7),Yt()),2&t&&(S("name","Material")("sub",i.sub),A(1),S("name","UUID")("model",i.model.uuid)("readonly",!0),A(1),S("name","Name")("model",i.model.name),A(1),S("name","Visible")("model",i.model.visible),A(1),S("name","Transparent")("model",i.model.transparent),A(1),S("name","Opacity")("model",i.model.opacity)("max",1)("step",.01),A(1),S("name","Depth Test")("model",i.model.depthTest),A(1),S("name","Depth Write")("model",i.model.depthWrite),A(1),S("name","Alpha Test")("model",i.model.alphaTest)("max",1)("step",.01),A(1),S("name","Side")("model",i.model.side)("type",i.sideType),A(1),S("ngSwitch",i.model.type),A(1),S("ngSwitchCase","MeshBasicMaterial"),A(1),S("ngSwitchCase","MeshPhongMaterial"))},directives:[zr,zf,o0,a0,_k,hl,dh,iie,rie,bg,s0],encapsulation:2}),n})();function lie(n,e){if(1&n){const t=nt();F(0,"button",12),Y("click",function(){return ge(t),H(2).convertToArray()}),he(1,"i",13),B()}}const cie=function(){return["material"]};function uie(n,e){if(1&n){const t=nt();F(0,"td",4)(1,"div",5),W(2,lie,2,0,"button",6),F(3,"button",7),Y("click",function(){return ge(t),H().pick()}),he(4,"i",8),B(),F(5,"input",9),Y("dndDrop",function(r){return ge(t),H().onDrop(r)}),B(),F(6,"button",10),Y("click",function(){const o=ge(t).$implicit;return H().inspect(o)}),he(7,"i",11),B()()()}if(2&n){const t=e.$implicit,i=e.index;A(2),S("ngIf",-1===i),A(3),S("value",t.name?t.name:"("+t.type+")")("dndDropzone",Xr(4,cie))("dndEffectAllowed","link")}}function die(n,e){1&n&&tn(0)}function hie(n,e){1&n&&he(0,"material-editor",17),2&n&&S("model",H().$implicit)("sub",!0)}const fie=function(n,e){return{$implicit:n,index:e}};function pie(n,e){if(1&n&&(F(0,"property",14),W(1,die,1,0,"ng-container",15),W(2,hie,1,2,"ng-template",16),B()),2&n){const t=e.$implicit,i=e.index,r=e.name;H();const o=gt(1);S("name",r)("canExpand",!0),A(1),S("ngTemplateOutlet",o)("ngTemplateOutletContext",Mo(5,fie,t,i)),A(1),S("editor",!0)}}function gie(n,e){1&n&&tn(0)}const vk=function(n,e,t){return{$implicit:n,index:e,name:t}};function mie(n,e){if(1&n&&(qt(0),W(1,gie,1,0,"ng-container",15),Yt()),2&n){const t=e.$implicit,i=e.index;H(3);const r=gt(3);A(1),S("ngTemplateOutlet",r)("ngTemplateOutletContext",Ar(2,vk,t,i,"Item "+(i+1)))}}function _ie(n,e){if(1&n&&(F(0,"inspector-table",27)(1,"tbody"),W(2,mie,2,6,"ng-container",28),B()()),2&n){const t=H().$implicit;S("border",!1),A(2),S("ngForOf",t)}}function yie(n,e){if(1&n){const t=nt();F(0,"property",18)(1,"td",4)(2,"div",5)(3,"button",19),Y("click",function(){return ge(t),H().convertToSingle()}),he(4,"i",20),B(),F(5,"button",21),Y("click",function(){return ge(t),H().removeEnd()}),he(6,"i",22),B(),he(7,"input",23),F(8,"button",24),Y("click",function(){return ge(t),H().appendEnd()}),he(9,"i",25),B()()(),W(10,_ie,3,2,"ng-template",26),B()}if(2&n){const t=e.$implicit;S("name",H().name)("canExpand",!0)("expanded",!0),A(5),S("disabled",1==t.length),A(2),S("value",t.length)}}function vie(n,e){1&n&&tn(0)}function bie(n,e){if(1&n&&(qt(0),W(1,vie,1,0,"ng-container",15),Yt()),2&n){const t=H(2),i=gt(3);A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ar(2,vk,t.model,-1,t.name))}}function wie(n,e){1&n&&tn(0)}const xie=function(n){return{$implicit:n}};function Mie(n,e){if(1&n&&W(0,wie,1,0,"ng-container",15),2&n){const t=H(2);S("ngTemplateOutlet",gt(5))("ngTemplateOutletContext",Ai(2,xie,t.array))}}function Die(n,e){if(1&n&&(F(0,"tr")(1,"td",29)(2,"inspector-table",27)(3,"tbody"),W(4,bie,2,6,"ng-container",30),W(5,Mie,1,4,"ng-template",null,31,st),B()()()()),2&n){const t=gt(6),i=H();A(2),S("border",!1),A(2),S("ngIf",i.isSingle)("ngIfElse",t)}}let Sie=(()=>{class n extends dr{constructor(t,i,r){super(t),this.engine=i,this.resources=r,this.setMaterial=new Ne}get isSingle(){return this.model instanceof Ln}get array(){return this.model}pick(){}inspect(t){this.engine.setSelection([t])}convertToArray(){this.setMaterial.emit([this.model])}convertToSingle(){this.setMaterial.emit(this.array[0])}removeEnd(){this.setMaterial.emit(this.array.slice(0,-1))}appendEnd(){this.setMaterial.emit([...this.array,this.resources.defaultMaterial])}onDrop(t){const i=this.resources.findMaterial(t.data);i&&this.setMaterial.emit(i)}}return n.\u0275fac=function(t){return new(t||n)(k($n),k(ar),k(vf))},n.\u0275cmp=He({type:n,selectors:[["material-property"]],inputs:{model:"model"},outputs:{setMaterial:"setMaterial"},features:[lt],decls:8,vars:0,consts:[["editor",""],["single",""],["multiple",""],["template",""],["colSpan","3"],[1,"flex-nowrap","input-group","input-group-sm","xs"],["type","button","class","btn btn-outline-secondary px-1 py-0","title","Convert to Array",3,"click",4,"ngIf"],["type","button","title","Pick",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-arrow-pointer","fa-fw","fa-xs"],["type","text","readonly","",1,"form-control",3,"value","dndDropzone","dndEffectAllowed","dndDrop"],["type","button","title","Inspect",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-circle-info","fa-fw","fa-xs"],["type","button","title","Convert to Array",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-asterisk","fa-fw","fa-xs"],[3,"name","canExpand"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["nested-content","",3,"editor"],[3,"model","sub"],[3,"name","canExpand","expanded"],["type","button","title","Convert to Single",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-1","fa-fw","fa-xs"],["type","button","title","Remove from End",1,"btn","btn-outline-secondary","px-1","py-0",3,"disabled","click"],[1,"fa-solid","fa-minus","fa-fw","fa-xs"],["type","text","readonly","",1,"form-control",3,"value"],["type","button","title","Append to End",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-plus","fa-fw","fa-xs"],["nested-content",""],[3,"border"],[4,"ngFor","ngForOf"],["colSpan","6",1,"p-0"],[4,"ngIf","ngIfElse"],["notSingle",""]],template:function(t,i){1&t&&(W(0,uie,8,5,"ng-template",null,0,st),W(2,pie,3,8,"ng-template",null,1,st),W(4,yie,11,5,"ng-template",null,2,st),W(6,Die,7,3,"ng-template",null,3,st))},directives:[Yn,La,yr,gr,pd,yk,Uf,Ri],encapsulation:2}),n})(),Eie=(()=>{class n{constructor(t){this.engine=t}setGeometry(t){this.engine.setGeometry(this.model,"geometry",this.model.geometry,t)}setMaterial(t){console.error("this requires proper tracking!"),this.model.material=t}}return n.\u0275fac=function(t){return new(t||n)(k(ar))},n.\u0275cmp=He({type:n,selectors:[["mesh-editor"]],inputs:{model:"model"},decls:3,vars:5,consts:[[3,"name"],[3,"name","model","setGeometry"],[3,"name","model","setMaterial"]],template:function(t,i){1&t&&(F(0,"component-editor",0)(1,"geometry-property",1),Y("setGeometry",function(o){return i.setGeometry(o)}),B(),F(2,"material-property",2),Y("setMaterial",function(o){return i.setMaterial(o)}),B()()),2&t&&(S("name",i.model.type),A(1),S("name","Geometry")("model",i.model.geometry),A(1),S("name","Material")("model",i.model.material))},directives:[zr,Qne,Sie],encapsulation:2}),n})(),Cie=(()=>{class n{constructor(){this.sub=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["directional-light-editor"]],inputs:{model:"model",sub:"sub"},decls:1,vars:2,consts:[[3,"name","sub"]],template:function(t,i){1&t&&he(0,"component-editor",0),2&t&&S("name",i.model.type)("sub",i.sub)},directives:[zr],encapsulation:2}),n})();function Tie(n,e){1&n&&he(0,"directional-light-editor",5),2&n&&S("model",H().asDirectionalLight)}function Aie(n,e){if(1&n&&he(0,"not-found-editor",6),2&n){const t=H();S("type",t.model.type)("sub",t.sub)}}let Iie=(()=>{class n{constructor(){this.sub=!1}get asDirectionalLight(){return this.model}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["light-editor"]],inputs:{model:"model",sub:"sub"},decls:6,vars:8,consts:[[3,"name","sub"],[3,"name","model","modelChange"],[3,"ngSwitch"],[3,"model",4,"ngSwitchCase"],[3,"type","sub",4,"ngSwitchDefault"],[3,"model"],[3,"type","sub"]],template:function(t,i){1&t&&(F(0,"component-editor",0)(1,"color-property",1),Y("modelChange",function(o){return i.model.color=o}),B(),F(2,"range-property",1),Y("modelChange",function(o){return i.model.intensity=o}),B()(),qt(3,2),W(4,Tie,1,1,"directional-light-editor",3),W(5,Aie,1,2,"not-found-editor",4),Yt()),2&t&&(S("name","Light")("sub",i.sub),A(1),S("name","Color")("model",i.model.color),A(1),S("name","Intensity")("model",i.model.intensity),A(1),S("ngSwitch",i.model.type),A(1),S("ngSwitchCase","DirectionalLight"))},directives:[zr,Gf,a0,hl,dh,Cie,bg,s0],encapsulation:2}),n})();function Rie(n,e){if(1&n){const t=nt();F(0,"button",8),Y("click",function(){return ge(t),H(3).pause()}),he(1,"i",9),B()}}function Nie(n,e){if(1&n){const t=nt();F(0,"button",10),Y("click",function(){return ge(t),H(3).play()}),he(1,"i",11),B()}}function Pie(n,e){if(1&n&&(qt(0),F(1,"div",4),W(2,Rie,2,0,"button",5),W(3,Nie,2,0,"button",6),he(4,"input",7),B(),Yt()),2&n){const t=H(2);A(2),S("ngIf",1===t.mixer.timeScale),A(1),S("ngIf",0===t.mixer.timeScale),A(1),S("value",t.mixer.time)}}function Oie(n,e){1&n&&(qt(0),F(1,"div",12)(2,"button",13),Rt(3,"Create Mixer"),B()(),Yt())}function Fie(n,e){if(1&n&&(F(0,"property",1)(1,"td",2),W(2,Pie,5,3,"ng-container",3),W(3,Oie,4,0,"ng-container",3),B()()),2&n){const t=H();S("name",t.name),A(2),S("ngIf",t.mixer),A(1),S("ngIf",!t.mixer)}}let kie=(()=>{class n extends dr{constructor(t){super(t)}get mixer(){return this.model.userData.mixer}pause(){this.mixer.timeScale=0}play(){this.mixer.timeScale=1}}return n.\u0275fac=function(t){return new(t||n)(k($n))},n.\u0275cmp=He({type:n,selectors:[["animation-mixer-property"]],inputs:{model:"model"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name"],["colSpan","3"],[4,"ngIf"],[1,"flex-nowrap","input-group","input-group-sm","xs"],["type","button","class","btn btn-outline-secondary flex-grow px-1 py-0","title","Pause",3,"click",4,"ngIf"],["type","button","class","btn btn-outline-secondary flex-grow px-1 py-0","title","Play",3,"click",4,"ngIf"],["type","text","readonly","",1,"form-control",3,"value"],["type","button","title","Pause",1,"btn","btn-outline-secondary","flex-grow","px-1","py-0",3,"click"],[1,"fa-solid","fa-pause","fa-fw","fa-xs"],["type","button","title","Play",1,"btn","btn-outline-secondary","flex-grow","px-1","py-0",3,"click"],[1,"fa-solid","fa-play","fa-fw","fa-xs"],[1,"flex-nowrap","btn-group","btn-group-sm","xs","w-100"],["type","button",1,"btn","btn-outline-secondary","flex-grow","p-1","fs-xxs"]],template:function(t,i){1&t&&W(0,Fie,4,3,"ng-template",null,0,st)},directives:[yr,Yn],encapsulation:2}),n})();const Lie=["createItem","","getItemName",""];function Bie(n,e){1&n&&tn(0)}const Vie=function(n,e){return{$implicit:n,index:e}};function Hie(n,e){if(1&n&&W(0,Bie,1,0,"ng-container",11),2&n){const t=H(),i=t.$implicit,r=t.index;S("ngTemplateOutlet",H().editor.template)("ngTemplateOutletContext",Mo(2,Vie,i,r))}}const Uie=function(n){return[n]};function zie(n,e){if(1&n){const t=nt();F(0,"property",2)(1,"td",3)(2,"div",4)(3,"button",5),Y("click",function(){return ge(t),H().pick()}),he(4,"i",6),B(),F(5,"input",7),Y("dndDrop",function(r){const s=ge(t).index;return H().onDrop(r,s)}),B(),F(6,"button",8),Y("click",function(){const o=ge(t).$implicit;return H().inspect(o)}),he(7,"i",9),B()()(),W(8,Hie,1,5,"ng-template",10),B()}if(2&n){const t=e.$implicit,i=e.name,r=H();S("name",i)("canExpand",!0),A(5),S("value",r.getItemName(t))("dndDropzone",Ai(6,Uie,r.dropType))("dndEffectAllowed","link"),A(3),S("editor",!0)}}function Gie(n,e){1&n&&tn(0)}const jie=function(n,e,t){return{$implicit:n,index:e,name:t}};function Wie(n,e){if(1&n&&(qt(0),W(1,Gie,1,0,"ng-container",11),Yt()),2&n){const t=e.$implicit,i=e.index;H(3);const r=gt(1);A(1),S("ngTemplateOutlet",r)("ngTemplateOutletContext",Ar(2,jie,t,i,"Item "+(i+1)))}}function $ie(n,e){if(1&n&&(F(0,"inspector-table",19)(1,"tbody"),W(2,Wie,2,6,"ng-container",20),B()()),2&n){const t=H(2);S("border",!1),A(2),S("ngForOf",t.model)}}function qie(n,e){if(1&n){const t=nt();F(0,"property",12)(1,"td",3)(2,"div",4)(3,"button",13),Y("click",function(){return ge(t),H().removeEnd()}),he(4,"i",14),B(),he(5,"input",15),F(6,"button",16),Y("click",function(){return ge(t),H().appendEnd()}),he(7,"i",17),B()()(),W(8,$ie,3,2,"ng-template",18),B()}if(2&n){const t=H();S("name",t.name)("expanded",!0),A(3),S("disabled",t.model.length<=0),A(2),S("value",t.model.length),A(3),S("show",t.model.length>0)}}let bk=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(k(Tn))},n.\u0275dir=me({type:n,selectors:[["","item-editor",""]]}),n})(),Yie=(()=>{class n extends dr{constructor(t,i){super(i),this.engine=t,this.modelChange=new Ne,this.itemRemoving=new Ne,this.itemAppending=new Ne}removeEnd(){this.itemRemoving.emit(this.model[this.model.length-1]),this.modelChange.emit(this.model.slice(0,-1))}appendEnd(){const t=this.createItem();this.itemAppending.emit(t),this.modelChange.emit([...this.model,t])}pick(){}inspect(t){this.engine.setSelection([t])}onDrop(t,i){console.log("ArrayPropertyEditor.onDrop",t,i)}}return n.\u0275fac=function(t){return new(t||n)(k(ar),k($n))},n.\u0275cmp=He({type:n,selectors:[["array-property","createItem","","getItemName",""]],contentQueries:function(t,i,r){if(1&t&&An(r,bk,7),2&t){let o;xt(o=Mt())&&(i.editor=o.first)}},inputs:{model:"model",dropType:"dropType",createItem:"createItem",getItemName:"getItemName"},outputs:{modelChange:"modelChange",itemRemoving:"itemRemoving",itemAppending:"itemAppending"},features:[lt],attrs:Lie,decls:4,vars:0,consts:[["single",""],["template",""],[3,"name","canExpand"],["colSpan","3"],[1,"flex-nowrap","input-group","input-group-sm","xs"],["type","button","title","Pick",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-arrow-pointer","fa-fw","fa-xs"],["type","text","readonly","",1,"form-control",3,"value","dndDropzone","dndEffectAllowed","dndDrop"],["type","button","title","Inspect",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-circle-info","fa-fw","fa-xs"],["nested-content","",3,"editor"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"name","expanded"],["type","button","title","Remove from End",1,"btn","btn-outline-secondary","px-1","py-0",3,"disabled","click"],[1,"fa-solid","fa-minus","fa-fw","fa-xs"],["type","text","readonly","",1,"form-control",3,"value"],["type","button","title","Append to End",1,"btn","btn-outline-secondary","px-1","py-0",3,"click"],[1,"fa-solid","fa-plus","fa-fw","fa-xs"],["nested-content","",3,"show"],[3,"border"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(W(0,zie,9,8,"ng-template",null,0,st),W(2,qie,9,5,"ng-template",null,1,st))},directives:[yr,La,pd,gr,Uf,Ri],encapsulation:2}),n})(),Zie=(()=>{class n{constructor(){this.sub=!1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["animation-clip-editor"]],inputs:{model:"model",sub:"sub"},decls:3,vars:7,consts:[[3,"name","sub"],[3,"name","model","readonly"],[3,"name","model","modelChange"]],template:function(t,i){1&t&&(F(0,"component-editor",0),he(1,"string-property",1),F(2,"string-property",2),Y("modelChange",function(o){return i.model.name=o}),B()()),2&t&&(S("name","AnimationClip")("sub",i.sub),A(1),S("name","UUID")("model",i.model.uuid)("readonly",!0),A(1),S("name","Name")("model",i.model.name))},directives:[zr,zf],encapsulation:2}),n})();function Xie(n,e){1&n&&he(0,"animation-clip-editor",3),2&n&&S("model",e.$implicit)("sub",!0)}function Kie(n,e){if(1&n){const t=nt();F(0,"array-property",1),Y("modelChange",function(r){return ge(t),H().model.animations=r}),W(1,Xie,1,2,"ng-template",2),B()}if(2&n){const t=H();S("name","Clips")("model",t.model.animations)("createItem",t.createClip)("getItemName",t.getClipName)("dropType","clip")}}let Jie=(()=>{class n extends dr{constructor(t){super(t)}createClip(){return new Ra("",0,[])}getClipName(t){return t.name?t.name:"(Empty)"}}return n.\u0275fac=function(t){return new(t||n)(k($n))},n.\u0275cmp=He({type:n,selectors:[["animations-property"]],inputs:{model:"model"},features:[lt],decls:2,vars:0,consts:[["template",""],[3,"name","model","createItem","getItemName","dropType","modelChange"],["item-editor",""],[3,"model","sub"]],template:function(t,i){1&t&&W(0,Kie,2,5,"ng-template",null,0,st)},directives:[Yie,bk,Zie],encapsulation:2}),n})(),Qie=(()=>{class n{createClip(){return new Ra("",0,[])}getClipName(t){return t.name?t.name:"(Empty)"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["animations-editor"]],inputs:{model:"model"},decls:3,vars:4,consts:[[3,"name"],[3,"name","model"],[3,"model"]],template:function(t,i){1&t&&(F(0,"component-editor",0),he(1,"animation-mixer-property",1)(2,"animations-property",2),B()),2&t&&(S("name","Animations"),A(1),S("name","Mixer")("model",i.model),A(1),S("model",i.model))},directives:[zr,kie,Jie],encapsulation:2}),n})();function ere(n,e){1&n&&he(0,"scene-editor",5),2&n&&S("model",H().asScene)}function tre(n,e){1&n&&he(0,"mesh-editor",5),2&n&&S("model",H().asMesh)}function nre(n,e){1&n&&he(0,"light-editor",5),2&n&&S("model",H().asLight)}let ire=(()=>{class n{get isScene(){return this.model instanceof Pl}get asScene(){return this.model}get isMesh(){return this.model instanceof we}get asMesh(){return this.model}get isLight(){return this.model instanceof Ro}get asLight(){return this.model}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["object3d-editor"]],inputs:{model:"model"},decls:11,vars:18,consts:[[3,"name"],[3,"name","model","readonly"],[3,"name","model","modelChange"],[3,"name","model"],[3,"model",4,"ngIf"],[3,"model"]],template:function(t,i){1&t&&(F(0,"component-editor",0),he(1,"string-property",1),F(2,"string-property",2),Y("modelChange",function(o){return i.model.name=o}),B(),F(3,"boolean-property",2),Y("modelChange",function(o){return i.model.visible=o}),B(),he(4,"vector3-property",3)(5,"vector3-property",3)(6,"vector3-property",3),B(),W(7,ere,1,1,"scene-editor",4),W(8,tre,1,1,"mesh-editor",4),W(9,nre,1,1,"light-editor",4),he(10,"animations-editor",5)),2&t&&(S("name","Object3D"),A(1),S("name","UUID")("model",i.model.uuid)("readonly",!0),A(1),S("name","Name")("model",i.model.name),A(1),S("name","Visible")("model",i.model.visible),A(1),S("name","Position")("model",i.model.position),A(1),S("name","Rotation")("model",i.model.rotation),A(1),S("name","Scale")("model",i.model.scale),A(1),S("ngIf",i.isScene),A(1),S("ngIf",i.isMesh),A(1),S("ngIf",i.isLight),A(1),S("model",i.model))},directives:[zr,zf,o0,Rne,Yn,Vne,Eie,Iie,Qie],encapsulation:2}),n})();function rre(n,e){1&n&&he(0,"object3d-editor",4),2&n&&S("model",H().model)}function ore(n,e){1&n&&he(0,"geometry-editor",4),2&n&&S("model",H(2).model)}function sre(n,e){if(1&n&&W(0,ore,1,1,"geometry-editor",0),2&n){const t=H(),i=gt(4);S("ngIf",t.isGeometry)("ngIfElse",i)}}function are(n,e){1&n&&he(0,"material-editor",4),2&n&&S("model",H(2).model)}function lre(n,e){if(1&n&&W(0,are,1,1,"material-editor",0),2&n){const t=H(),i=gt(6);S("ngIf",t.isMaterial)("ngIfElse",i)}}function cre(n,e){1&n&&he(0,"not-found-editor",5),2&n&&S("type",H().model.type)}let ure=(()=>{class n{get isObject3D(){return this.model instanceof Dt}get isGeometry(){return this.model instanceof je}get isMaterial(){return this.model instanceof Ln}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["inspector"]],inputs:{model:"model"},decls:7,vars:2,consts:[[3,"model",4,"ngIf","ngIfElse"],["notObject",""],["notGeometry",""],["notFound",""],[3,"model"],[3,"type"]],template:function(t,i){if(1&t&&(W(0,rre,1,1,"object3d-editor",0),W(1,sre,1,2,"ng-template",null,1,st),W(3,lre,1,2,"ng-template",null,2,st),W(5,cre,1,1,"ng-template",null,3,st)),2&t){const r=gt(2);S("ngIf",i.isObject3D)("ngIfElse",r)}},directives:[Yn,ire,mk,yk,s0],encapsulation:2}),n})();function dre(n,e){if(1&n&&(F(0,"div",3)(1,"div",4),Rt(2),B()()),2&n){const t=H();A(2),Jo("",t.selection.length," items selected")}}function hre(n,e){if(1&n&&(qt(0),he(1,"inspector",5),Yt()),2&n){const t=H();A(1),S("model",t.selection[0])}}let fre=(()=>{class n{constructor(t){this.engine=t}ngOnInit(){this.selectionSub=this.engine.selection$.subscribe(t=>this.onSelectionUpdated(t))}ngOnDestroy(){this.selectionSub.unsubscribe()}onSelectionUpdated(t){this.selection=t,console.warn("Editors are retaining state from previous selections!")}}return n.\u0275fac=function(t){return new(t||n)(k(ar))},n.\u0275cmp=He({type:n,selectors:[["inspector-view"]],decls:4,vars:2,consts:[["multiple",""],[1,"w-100","h-100","fs-xs","overflow-y-only","bg-light"],[4,"ngIf","ngIfElse"],[1,"d-flex","h-100","text-muted","fst-italic","bg-white"],[1,"w-100","text-center","align-self-center"],[3,"model"]],template:function(t,i){if(1&t&&(W(0,dre,3,1,"ng-template",null,0,st),F(2,"div",1),W(3,hre,2,1,"ng-container",2),B()),2&t){const r=gt(1);A(3),S("ngIf",1===i.selection.length)("ngIfElse",r)}},directives:[Yn,ure],encapsulation:2}),n})();function pre(n,e){if(1&n){const t=nt();F(0,"div",9),Y("click",function(r){const s=ge(t).$implicit;return H().selectResource(r,s.resource)}),F(1,"div",10)(2,"span",11),Rt(3),B(),he(4,"icon",12),B(),F(5,"div",13),Rt(6),B()()}if(2&n){const t=e.$implicit,i=e.selected,r=H();Ze("bg-primary",i)("text-white",i),S("dndDraggable",t.resource.uuid)("dndType",r.type)("dndEffectAllowed","link"),A(1),Ze("bg-white",!i),A(2),Ui(t.count),A(1),S("type","component")("name",t.resource.type)("margin",!1),A(2),Jo(" ",t.resource.name?t.resource.name:"("+t.resource.type+")"," ")}}function gre(n,e){1&n&&tn(0)}const mre=function(n,e){return{$implicit:n,selected:e}};function _re(n,e){if(1&n&&(qt(0),W(1,gre,1,0,"ng-container",16),Yt()),2&n){const t=e.$implicit,i=H(2),r=gt(1);A(1),S("ngTemplateOutlet",r)("ngTemplateOutletContext",Mo(2,mre,t,i.selection.includes(t.resource)))}}function yre(n,e){if(1&n&&(F(0,"div",14),W(1,_re,2,5,"ng-container",15),B()),2&n){const t=e.$implicit;A(1),S("ngForOf",t)}}const vre=function(n,e,t){return{"bg-primary":n,"bg-white":e,"text-white":t}};function bre(n,e){if(1&n){const t=nt();F(0,"div",17),Y("click",function(){const o=ge(t).$implicit;return H().selectType(o.type)}),Rt(1),B()}if(2&n){const t=e.$implicit,i=H();Ds(Ar(3,vre,t.type===i.type,t.type!==i.type,t.type===i.type)),A(1),Jo(" ",t.name," ")}}function wre(n,e){1&n&&tn(0)}const wk=function(n){return{$implicit:n}};function xre(n,e){if(1&n&&(qt(0),W(1,wre,1,0,"ng-container",16),Yt()),2&n){const t=H(),i=gt(3);A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ai(2,wk,t.geometries))}}function Mre(n,e){1&n&&tn(0)}function Dre(n,e){if(1&n&&(qt(0),W(1,Mre,1,0,"ng-container",16),Yt()),2&n){const t=H(),i=gt(3);A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Ai(2,wk,t.materials))}}let Sre=(()=>{class n{constructor(t,i){this.engine=t,this.resources=i,this.type="geometry",this.types=[{name:"Geometry",type:"geometry"},{name:"Material",type:"material"},{name:"Texture",type:"texture"}]}ngOnInit(){this.selectionSub=this.engine.selection$.subscribe(t=>this.selection=t),this.geometriesSub=this.resources.geometries$.subscribe(t=>this.geometries=t),this.materialsSub=this.resources.materials$.subscribe(t=>this.materials=t)}ngOnDestroy(){this.selectionSub.unsubscribe(),this.geometriesSub.unsubscribe(),this.materialsSub.unsubscribe()}selectType(t){this.type!=t&&(this.type=t)}selectResource(t,i){t.preventDefault(),t.stopPropagation(),this.engine.setSelection([i]),i instanceof je&&Oo.deconstruct(i)}deselect(){this.engine.setSelection([])}}return n.\u0275fac=function(t){return new(t||n)(k(ar),k(vf))},n.\u0275cmp=He({type:n,selectors:[["resources-view"]],decls:13,vars:5,consts:[["file",""],["list",""],["direction","horizontal"],[1,"overflow-hidden",3,"size"],[1,"h-100","w-100","overflow-y-only","bg-light","fs-xs"],[1,"border-bottom"],["class","d-flex text-nowrap selectable ps-3","style","cursor: pointer;",3,"class","click",4,"ngFor","ngForOf"],[1,"h-100","w-100","overflow-y-only","bg-light",3,"click"],[4,"ngIf"],[1,"d-flex","flex-column","align-items-center","selectable","m-3",2,"min-width","100px","max-width","100px","min-height","75px","max-height","75px","cursor","pointer",3,"dndDraggable","dndType","dndEffectAllowed","click"],[1,"d-flex","align-items-center","justify-content-center","border","rounded","m-2","position-relative",2,"width","50px","height","50px"],[1,"position-absolute","top-0","start-100","translate-middle","badge","rounded-pill","bg-secondary"],[1,"fs-xl",3,"type","name","margin"],[1,"text-wrap","text-truncate"],[1,"d-flex","flex-wrap","justify-content-center","fs-xs"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"d-flex","text-nowrap","selectable","ps-3",2,"cursor","pointer",3,"click"]],template:function(t,i){1&t&&(W(0,pre,7,14,"ng-template",null,0,st),W(2,yre,2,1,"ng-template",null,1,st),F(4,"as-split",2)(5,"as-split-area",3)(6,"div",4)(7,"div",5),W(8,bre,2,7,"div",6),B()()(),F(9,"as-split-area",3)(10,"div",7),Y("click",function(){return i.deselect()}),W(11,xre,2,4,"ng-container",8),W(12,Dre,2,4,"ng-container",8),B()()()),2&t&&(A(5),S("size",35),A(3),S("ngForOf",i.types),A(1),S("size",65),A(2),S("ngIf","geometry"===i.type),A(1),S("ngIf","material"===i.type))},directives:[D_,Q_,Ri,gr,n0,Gx,Yn],encapsulation:2}),n})();const Ere=function(n,e,t){return{"bg-primary":n,"bg-white":e,"text-white":t}};let Cre=(()=>{class n{constructor(t){this.engine=t,this.expanded=!1}ngOnInit(){this.expanded=Oo.getProperty(this.node,"autoExpand",this.expanded)}toggleExpanded(t){this.prevent(t),this.expanded=!this.expanded}select(t){this.prevent(t),this.engine.setSelection([this.node])||this.engine.focus(this.node)}prevent(t){t.preventDefault(),t.stopPropagation()}closeDropdowns(t){this.prevent(t);for(let i of this.nodeDDs.toArray().reverse())i.close()}blur(t){t.blur()}createBox(){const t=new In(1,1,1),i=[new io({color:14869477})],r=new we(t,i);r.name="Box",this.engine.import(r,this.node),this.engine.setSelection([t])}delete(){null!==this.node.parent&&this.node.removeFromParent()}}return n.\u0275fac=function(t){return new(t||n)(k(ar))},n.\u0275cmp=He({type:n,selectors:[["scene-node"]],viewQuery:function(t,i){if(1&t&&Gi(Yl,5),2&t){let r;xt(r=Mt())&&(i.nodeDDs=r)}},inputs:{node:"node",depth:"depth",selected:"selected"},decls:19,vars:17,consts:[[1,"d-flex","text-nowrap","selectable",3,"click"],[3,"click"],[1,"fa-solid","fa-caret-down","fa-fw"],[1,"fa-solid","fa-caret-right","fa-fw"],[3,"type","name"],[1,"me-1"],["ngbDropdown","","container","body","autoClose","outside",1,"d-inline-block","ms-auto",3,"click"],["ngbDropdownToggle","","title","Actions",1,"d-none","fa-solid","fa-gears","fa-fw"],["ngbDropdownMenu","",1,"xs","fs-xs",3,"click"],["ngbDropdown","",3,"openChange"],["ngbDropdownItem","","ngbDropdownToggle","",1,"py-1","px-2",3,"click"],["innerDD",""],["ngbDropdownMenu","",1,"xs","fs-xs"],["ngbDropdownItem","",1,"py-1","px-2",3,"click"]],template:function(t,i){if(1&t){const r=nt();F(0,"div",0),Y("click",function(s){return i.select(s)}),F(1,"span",1),Y("click",function(s){return i.toggleExpanded(s)}),he(2,"i",2)(3,"i",3),B(),he(4,"icon",4),F(5,"span",5),Rt(6),B(),F(7,"div",6),Y("click",function(s){return i.prevent(s)}),he(8,"i",7),F(9,"div",8),Y("click",function(s){return i.closeDropdowns(s)}),F(10,"div",9),Y("openChange",function(){ge(r);const s=gt(12);return i.blur(s)}),F(11,"button",10,11),Y("click",function(s){return i.prevent(s)}),Rt(13,"Create"),B(),F(14,"div",12)(15,"button",13),Y("click",function(){return i.createBox()}),Rt(16,"Box"),B()()(),F(17,"button",13),Y("click",function(){return i.delete()}),Rt(18,"Delete"),B()()()()}2&t&&(Ds(Ar(13,Ere,i.selected,!i.selected,i.selected)),A(1),al("margin-left",16*i.depth,"px"),Ze("invisible",0===i.node.children.length),A(1),Ze("d-none",!i.expanded),A(1),Ze("d-none",i.expanded),A(1),S("type","component")("name",i.node.type),A(2),Ui(i.node.name?i.node.name:"("+i.node.type+")"))},directives:[Q_,Yl,Vx,X_,Z_],encapsulation:2}),n})();function Tre(n,e){1&n&&tn(0)}const Are=function(n,e,t){return{$implicit:n,depth:e,selected:t}};function Ire(n,e){if(1&n&&(qt(0),W(1,Tre,1,0,"ng-container",8),Yt()),2&n){const t=e.$implicit,i=H().depth,r=H(),o=gt(1);A(1),S("ngTemplateOutlet",o)("ngTemplateOutletContext",Ar(2,Are,t,i+1,r.selection.includes(t)))}}function Rre(n,e){if(1&n&&(he(0,"scene-node",4,5),F(2,"span",6),W(3,Ire,2,6,"ng-container",7),B()),2&n){const t=e.$implicit,i=e.depth,r=e.selected,o=gt(1);S("node",t)("depth",i)("selected",r),A(2),S("hidden",!o.expanded),A(1),S("ngForOf",t.children)}}function Nre(n,e){1&n&&tn(0)}const Pre=function(n,e){return{$implicit:n,depth:0,selected:e}};function Ore(n,e){if(1&n&&(qt(0),W(1,Nre,1,0,"ng-container",8),Yt()),2&n){const t=H(),i=gt(1);A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Mo(2,Pre,t.scene,t.selection.includes(t.scene)))}}let Fre=(()=>{class n{constructor(t){this.engine=t}ngOnInit(){this.sceneSub=this.engine.scene$.subscribe(t=>this.onSceneUpdated(t)),this.selectionSub=this.engine.selection$.subscribe(t=>this.onSelectionUpdated(t))}ngOnDestroy(){this.sceneSub.unsubscribe(),this.selectionSub.unsubscribe()}onSceneUpdated(t){this.scene=t}onSelectionUpdated(t){this.selection=t}deselect(){this.engine.setSelection([])}onDragover(){}onDrop(t){this.engine.tryImportDroppedAsync(t)}}return n.\u0275fac=function(t){return new(t||n)(k(ar))},n.\u0275cmp=He({type:n,selectors:[["scene-tree-view"]],decls:5,vars:3,consts:[["tree",""],["dndDropzone","",1,"h-100","w-100","overflow-y-only","bg-light","fs-xs",3,"dndAllowExternal","dndEffectAllowed","click","dndDragover","dndDrop"],[1,"border-bottom"],[4,"ngIf"],[3,"node","depth","selected"],["item",""],[3,"hidden"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){1&t&&(W(0,Rre,4,5,"ng-template",null,0,st),F(2,"div",1),Y("click",function(){return i.deselect()})("dndDragover",function(){return i.onDragover()})("dndDrop",function(o){return i.onDrop(o)}),F(3,"div",2),W(4,Ore,2,5,"ng-container",3),B()()),2&t&&(A(2),S("dndAllowExternal",!0)("dndEffectAllowed","copy"),A(2),S("ngIf",i.scene))},directives:[Cre,Ri,gr,La,Yn],encapsulation:2}),n})();const xk={type:"change"},Wx={type:"start"},Mk={type:"end"};class kre extends _a{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new M,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(I){I.addEventListener("keydown",Ht),this._domElementKeyEvents=I},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(xk),i.update(),o=r.NONE},this.update=function(){const I=new M,pe=(new Jt).setFromUnitVectors(e.up,new M(0,1,0)),Ge=pe.clone().invert(),De=new M,V=new Jt,xe=2*Math.PI;return function(){const tt=i.object.position;I.copy(tt).sub(i.target),I.applyQuaternion(pe),a.setFromVector3(I),i.autoRotate&&o===r.NONE&&G(function C(){return 2*Math.PI/60/60*i.autoRotateSpeed}()),i.enableDamping?(a.theta+=l.theta*i.dampingFactor,a.phi+=l.phi*i.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Pe=i.minAzimuthAngle,$e=i.maxAzimuthAngle;return isFinite(Pe)&&isFinite($e)&&(Pe<-Math.PI?Pe+=xe:Pe>Math.PI&&(Pe-=xe),$e<-Math.PI?$e+=xe:$e>Math.PI&&($e-=xe),a.theta=Pe<=$e?Math.max(Pe,Math.min($e,a.theta)):a.theta>(Pe+$e)/2?Math.max(Pe,a.theta):Math.min($e,a.theta)),a.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(i.minDistance,Math.min(i.maxDistance,a.radius)),!0===i.enableDamping?i.target.addScaledVector(u,i.dampingFactor):i.target.add(u),I.setFromSpherical(a),I.applyQuaternion(Ge),tt.copy(i.target).add(I),i.object.lookAt(i.target),!0===i.enableDamping?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,u.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(d||De.distanceToSquared(i.object.position)>s||8*(1-V.dot(i.object.quaternion))>s)&&(i.dispatchEvent(xk),De.copy(i.object.position),V.copy(i.object.quaternion),d=!1,!0)}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",J),i.domElement.removeEventListener("pointerdown",fe),i.domElement.removeEventListener("pointercancel",rt),i.domElement.removeEventListener("wheel",jt),i.domElement.removeEventListener("pointermove",Be),i.domElement.removeEventListener("pointerup",Ee),null!==i._domElementKeyEvents&&i._domElementKeyEvents.removeEventListener("keydown",Ht)};const i=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=r.NONE;const s=1e-6,a=new SP,l=new SP;let c=1;const u=new M;let d=!1;const h=new re,f=new re,g=new re,p=new re,m=new re,y=new re,_=new re,v=new re,b=new re,w=[],D={};function T(){return Math.pow(.95,i.zoomSpeed)}function G(I){l.theta-=I}function O(I){l.phi-=I}const x=function(){const I=new M;return function(Ge,De){I.setFromMatrixColumn(De,0),I.multiplyScalar(-Ge),u.add(I)}}(),N=function(){const I=new M;return function(Ge,De){!0===i.screenSpacePanning?I.setFromMatrixColumn(De,1):(I.setFromMatrixColumn(De,0),I.crossVectors(i.object.up,I)),I.multiplyScalar(Ge),u.add(I)}}(),q=function(){const I=new M;return function(Ge,De){const V=i.domElement;if(i.object.isPerspectiveCamera){I.copy(i.object.position).sub(i.target);let be=I.length();be*=Math.tan(i.object.fov/2*Math.PI/180),x(2*Ge*be/V.clientHeight,i.object.matrix),N(2*De*be/V.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(x(Ge*(i.object.right-i.object.left)/i.object.zoom/V.clientWidth,i.object.matrix),N(De*(i.object.top-i.object.bottom)/i.object.zoom/V.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function L(I){i.object.isPerspectiveCamera?c/=I:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*I)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function j(I){i.object.isPerspectiveCamera?c*=I:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/I)),i.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function z(I){h.set(I.clientX,I.clientY)}function U(I){p.set(I.clientX,I.clientY)}function Le(){1===w.length?h.set(w[0].pageX,w[0].pageY):h.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function Ie(){1===w.length?p.set(w[0].pageX,w[0].pageY):p.set(.5*(w[0].pageX+w[1].pageX),.5*(w[0].pageY+w[1].pageY))}function te(){const I=w[0].pageX-w[1].pageX,pe=w[0].pageY-w[1].pageY,Ge=Math.sqrt(I*I+pe*pe);_.set(0,Ge)}function Qe(I){if(1==w.length)f.set(I.pageX,I.pageY);else{const Ge=We(I);f.set(.5*(I.pageX+Ge.x),.5*(I.pageY+Ge.y))}g.subVectors(f,h).multiplyScalar(i.rotateSpeed);const pe=i.domElement;G(2*Math.PI*g.x/pe.clientHeight),O(2*Math.PI*g.y/pe.clientHeight),h.copy(f)}function _e(I){if(1===w.length)m.set(I.pageX,I.pageY);else{const pe=We(I);m.set(.5*(I.pageX+pe.x),.5*(I.pageY+pe.y))}y.subVectors(m,p).multiplyScalar(i.panSpeed),q(y.x,y.y),p.copy(m)}function it(I){const pe=We(I),Ge=I.pageX-pe.x,De=I.pageY-pe.y,V=Math.sqrt(Ge*Ge+De*De);v.set(0,V),b.set(0,Math.pow(v.y/_.y,i.zoomSpeed)),L(b.y),_.copy(v)}function fe(I){!1!==i.enabled&&(0===w.length&&(i.domElement.setPointerCapture(I.pointerId),i.domElement.addEventListener("pointermove",Be),i.domElement.addEventListener("pointerup",Ee)),function de(I){w.push(I)}(I),"touch"===I.pointerType?function P(I){switch(Oe(I),w.length){case 1:switch(i.touches.ONE){case 0:if(!1===i.enableRotate)return;Le(),o=r.TOUCH_ROTATE;break;case 1:if(!1===i.enablePan)return;Ie(),o=r.TOUCH_PAN;break;default:o=r.NONE}break;case 2:switch(i.touches.TWO){case 2:if(!1===i.enableZoom&&!1===i.enablePan)return;(function pt(){i.enableZoom&&te(),i.enablePan&&Ie()})(),o=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function ze(){i.enableZoom&&te(),i.enableRotate&&Le()})(),o=r.TOUCH_DOLLY_ROTATE;break;default:o=r.NONE}break;default:o=r.NONE}o!==r.NONE&&i.dispatchEvent(Wx)}(I):function Ke(I){let pe;switch(I.button){case 0:pe=i.mouseButtons.LEFT;break;case 1:pe=i.mouseButtons.MIDDLE;break;case 2:pe=i.mouseButtons.RIGHT;break;default:pe=-1}switch(pe){case 1:if(!1===i.enableZoom)return;(function $(I){_.set(I.clientX,I.clientY)})(I),o=r.DOLLY;break;case 0:if(I.ctrlKey||I.metaKey||I.shiftKey){if(!1===i.enablePan)return;U(I),o=r.PAN}else{if(!1===i.enableRotate)return;z(I),o=r.ROTATE}break;case 2:if(I.ctrlKey||I.metaKey||I.shiftKey){if(!1===i.enableRotate)return;z(I),o=r.ROTATE}else{if(!1===i.enablePan)return;U(I),o=r.PAN}break;default:o=r.NONE}o!==r.NONE&&i.dispatchEvent(Wx)}(I))}function Be(I){!1!==i.enabled&&("touch"===I.pointerType?function E(I){switch(Oe(I),o){case r.TOUCH_ROTATE:if(!1===i.enableRotate)return;Qe(I),i.update();break;case r.TOUCH_PAN:if(!1===i.enablePan)return;_e(I),i.update();break;case r.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;(function ne(I){i.enableZoom&&it(I),i.enablePan&&_e(I)})(I),i.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;(function oe(I){i.enableZoom&&it(I),i.enableRotate&&Qe(I)})(I),i.update();break;default:o=r.NONE}}(I):function qe(I){if(!1!==i.enabled)switch(o){case r.ROTATE:if(!1===i.enableRotate)return;!function X(I){f.set(I.clientX,I.clientY),g.subVectors(f,h).multiplyScalar(i.rotateSpeed);const pe=i.domElement;G(2*Math.PI*g.x/pe.clientHeight),O(2*Math.PI*g.y/pe.clientHeight),h.copy(f),i.update()}(I);break;case r.DOLLY:if(!1===i.enableZoom)return;!function ee(I){v.set(I.clientX,I.clientY),b.subVectors(v,_),b.y>0?L(T()):b.y<0&&j(T()),_.copy(v),i.update()}(I);break;case r.PAN:if(!1===i.enablePan)return;!function se(I){m.set(I.clientX,I.clientY),y.subVectors(m,p).multiplyScalar(i.panSpeed),q(y.x,y.y),p.copy(m),i.update()}(I)}}(I))}function Ee(I){Me(I),0===w.length&&(i.domElement.releasePointerCapture(I.pointerId),i.domElement.removeEventListener("pointermove",Be),i.domElement.removeEventListener("pointerup",Ee)),i.dispatchEvent(Mk),o=r.NONE}function rt(I){Me(I)}function jt(I){!1===i.enabled||!1===i.enableZoom||o!==r.NONE||(I.preventDefault(),i.dispatchEvent(Wx),function ie(I){I.deltaY<0?j(T()):I.deltaY>0&&L(T()),i.update()}(I),i.dispatchEvent(Mk))}function Ht(I){!1===i.enabled||!1===i.enablePan||function Ae(I){let pe=!1;switch(I.code){case i.keys.UP:q(0,i.keyPanSpeed),pe=!0;break;case i.keys.BOTTOM:q(0,-i.keyPanSpeed),pe=!0;break;case i.keys.LEFT:q(i.keyPanSpeed,0),pe=!0;break;case i.keys.RIGHT:q(-i.keyPanSpeed,0),pe=!0}pe&&(I.preventDefault(),i.update())}(I)}function J(I){!1!==i.enabled&&I.preventDefault()}function Me(I){delete D[I.pointerId];for(let pe=0;pe<w.length;pe++)if(w[pe].pointerId==I.pointerId)return void w.splice(pe,1)}function Oe(I){let pe=D[I.pointerId];void 0===pe&&(pe=new re,D[I.pointerId]=pe),pe.set(I.pageX,I.pageY)}function We(I){return D[(I.pointerId===w[0].pointerId?w[1]:w[0]).pointerId]}i.domElement.addEventListener("contextmenu",J),i.domElement.addEventListener("pointerdown",fe),i.domElement.addEventListener("pointercancel",rt),i.domElement.addEventListener("wheel",jt,{passive:!1}),this.update()}}const Jl=new class HZ{constructor(e,t,i=0,r=1/0){this.ray=new Il(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new x1,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return _w(e,this,i,t),i.sort(DP),i}intersectObjects(e,t=!0,i=[]){for(let r=0,o=e.length;r<o;r++)_w(e[r],this,i,t);return i.sort(DP),i}},vr=new M,Wa=new M,Pn=new Jt,Dk={X:new M(1,0,0),Y:new M(0,1,0),Z:new M(0,0,1)},$x={type:"change"},Sk={type:"mouseDown"},Ek={type:"mouseUp",mode:null},Ck={type:"objectChange"};class Tk extends Dt{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new Nk;this._gizmo=i,this.add(i);const r=new Pk;this._plane=r,this.add(r);const o=this;function s(_,v){let b=v;Object.defineProperty(o,_,{get:function(){return void 0!==b?b:v},set:function(w){b!==w&&(b=w,r[_]=w,i[_]=w,o.dispatchEvent({type:_+"-changed",value:w}),o.dispatchEvent($x))}}),o[_]=v,r[_]=v,i[_]=v}s("camera",e),s("object",void 0),s("enabled",!0),s("axis",null),s("mode","translate"),s("translationSnap",null),s("rotationSnap",null),s("scaleSnap",null),s("space","world"),s("size",1),s("dragging",!1),s("showX",!0),s("showY",!0),s("showZ",!0);const a=new M,l=new M,c=new Jt,u=new Jt,d=new M,h=new Jt,f=new M,g=new M,p=new M,y=new M;s("worldPosition",a),s("worldPositionStart",l),s("worldQuaternion",c),s("worldQuaternionStart",u),s("cameraPosition",d),s("cameraQuaternion",h),s("pointStart",f),s("pointEnd",g),s("rotationAxis",p),s("rotationAngle",0),s("eye",y),this._offset=new M,this._startNorm=new M,this._endNorm=new M,this._cameraScale=new M,this._parentPosition=new M,this._parentQuaternion=new Jt,this._parentQuaternionInv=new Jt,this._parentScale=new M,this._worldScaleStart=new M,this._worldQuaternionInv=new Jt,this._worldScale=new M,this._positionStart=new M,this._quaternionStart=new Jt,this._scaleStart=new M,this._getPointer=Lre.bind(this),this._onPointerDown=Vre.bind(this),this._onPointerHover=Bre.bind(this),this._onPointerMove=Hre.bind(this),this._onPointerUp=Ure.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;Jl.setFromCamera(e,this.camera);const t=qx(this._gizmo.picker[this.mode],Jl);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){Jl.setFromCamera(e,this.camera);const t=qx(this._plane,Jl,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,Sk.mode=this.mode,this.dispatchEvent(Sk)}}pointerMove(e){const t=this.axis,i=this.mode,r=this.object;let o=this.space;if("scale"===i?o="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(o="world"),void 0===r||null===t||!1===this.dragging||-1!==e.button)return;Jl.setFromCamera(e,this.camera);const s=qx(this._plane,Jl,!0);if(s){if(this.pointEnd.copy(s.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===o&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===o&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===o&&(r.position.applyQuaternion(Pn.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),"world"===o&&(r.parent&&r.position.add(vr.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(vr.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Wa.set(a,a,a)}else vr.copy(this.pointStart),Wa.copy(this.pointEnd),vr.applyQuaternion(this._worldQuaternionInv),Wa.applyQuaternion(this._worldQuaternionInv),Wa.divide(vr),-1===t.search("X")&&(Wa.x=1),-1===t.search("Y")&&(Wa.y=1),-1===t.search("Z")&&(Wa.z=1);r.scale.copy(this._scaleStart).multiply(Wa),this.scaleSnap&&(-1!==t.search("X")&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);const a=20/this.worldPosition.distanceTo(vr.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(vr.copy(this.rotationAxis).cross(this.eye))*a):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(Dk[t]),vr.copy(Dk[t]),"local"===o&&vr.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(vr.cross(this.eye).normalize())*a),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===o&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(Pn.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(Pn.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent($x),this.dispatchEvent(Ck)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(Ek.mode=this.mode,this.dispatchEvent(Ek)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){!this.enabled||this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent($x),this.dispatchEvent(Ck),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Jl}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}update(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}}function Lre(n){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:n.button};{const e=this.domElement.getBoundingClientRect();return{x:(n.clientX-e.left)/e.width*2-1,y:-(n.clientY-e.top)/e.height*2+1,button:n.button}}}function Bre(n){if(this.enabled)switch(n.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(n))}}function Vre(n){!this.enabled||(document.pointerLockElement||this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(n)),this.pointerDown(this._getPointer(n)))}function Hre(n){!this.enabled||this.pointerMove(this._getPointer(n))}function Ure(n){!this.enabled||(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(n)))}function qx(n,e,t){const i=e.intersectObject(n,!0);for(let r=0;r<i.length;r++)if(i[r].object.visible||t)return i[r];return!1}Tk.prototype.isTransformControls=!0;const l0=new kr,_n=new M(0,1,0),Ak=new M(0,0,0),Ik=new ye,c0=new Jt,u0=new Jt,us=new M,Rk=new ye,jf=new M(1,0,0),Ql=new M(0,1,0),Wf=new M(0,0,1),d0=new M,$f=new M,qf=new M;class Nk extends Dt{constructor(){super(),this.type="TransformControlsGizmo";const e=new io({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new vi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const r=t.clone();r.opacity=.5;const o=e.clone();o.color.setHex(16711680);const s=e.clone();s.color.setHex(65280);const a=e.clone();a.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const u=e.clone();u.color.setHex(255),u.opacity=.5;const d=e.clone();d.opacity=.25;const h=e.clone();h.color.setHex(16776960),h.opacity=.25,e.clone().color.setHex(16776960);const g=e.clone();g.color.setHex(7895160);const p=new li(0,.04,.1,12);p.translate(0,.05,0);const m=new In(.08,.08,.08);m.translate(0,.04,0);const y=new je;y.setAttribute("position",new Fe([0,0,0,1,0,0],3));const _=new li(.0075,.0075,.5,3);function v(j,z){const $=new Gs(j,.0075,3,64,z*Math.PI*2);return $.rotateY(Math.PI/2),$.rotateX(Math.PI/2),$}_.translate(0,.25,0);const w={X:[[new we(p,o),[.5,0,0],[0,0,-Math.PI/2]],[new we(p,o),[-.5,0,0],[0,0,Math.PI/2]],[new we(_,o),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new we(p,s),[0,.5,0]],[new we(p,s),[0,-.5,0],[Math.PI,0,0]],[new we(_,s)]],Z:[[new we(p,a),[0,0,.5],[Math.PI/2,0,0]],[new we(p,a),[0,0,-.5],[-Math.PI/2,0,0]],[new we(_,a),null,[Math.PI/2,0,0]]],XYZ:[[new we(new zs(.1,0),d.clone()),[0,0,0]]],XY:[[new we(new In(.15,.15,.01),u.clone()),[.15,.15,0]]],YZ:[[new we(new In(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new we(new In(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},D={X:[[new we(new li(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new we(new li(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new we(new li(.2,0,.6,4),i),[0,.3,0]],[new we(new li(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new we(new li(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new we(new li(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new we(new zs(.2,0),i)]],XY:[[new we(new In(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new we(new In(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new we(new In(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},C={START:[[new we(new zs(.01,2),r),null,null,null,"helper"]],END:[[new we(new zs(.01,2),r),null,null,null,"helper"]],DELTA:[[new qi(function b(){const j=new je;return j.setAttribute("position",new Fe([0,0,0,1,1,1],3)),j}(),r),null,null,null,"helper"]],X:[[new qi(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new qi(y,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new qi(y,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},T={XYZE:[[new we(v(.5,1),g),null,[0,Math.PI/2,0]]],X:[[new we(v(.5,.5),o)]],Y:[[new we(v(.5,.5),s),null,[0,0,-Math.PI/2]]],Z:[[new we(v(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new we(v(.75,1),h),null,[0,Math.PI/2,0]]]},G={AXIS:[[new qi(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},O={XYZE:[[new we(new Vu(.25,10,8),i)]],X:[[new we(new Gs(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new we(new Gs(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new we(new Gs(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new we(new Gs(.75,.1,2,24),i)]]},x={X:[[new we(m,o),[.5,0,0],[0,0,-Math.PI/2]],[new we(_,o),[0,0,0],[0,0,-Math.PI/2]],[new we(m,o),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new we(m,s),[0,.5,0]],[new we(_,s)],[new we(m,s),[0,-.5,0],[0,0,Math.PI]]],Z:[[new we(m,a),[0,0,.5],[Math.PI/2,0,0]],[new we(_,a),[0,0,0],[Math.PI/2,0,0]],[new we(m,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new we(new In(.15,.15,.01),u),[.15,.15,0]]],YZ:[[new we(new In(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new we(new In(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new we(new In(.1,.1,.1),d.clone())]]},N={X:[[new we(new li(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new we(new li(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new we(new li(.2,0,.6,4),i),[0,.3,0]],[new we(new li(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new we(new li(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new we(new li(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new we(new In(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new we(new In(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new we(new In(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new we(new In(.2,.2,.2),i),[0,0,0]]]},q={X:[[new qi(y,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new qi(y,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new qi(y,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function L(j){const z=new Dt;for(const $ in j)for(let U=j[$].length;U--;){const X=j[$][U][0].clone(),ee=j[$][U][1],se=j[$][U][2],ie=j[$][U][3],Ae=j[$][U][4];X.name=$,X.tag=Ae,ee&&X.position.set(ee[0],ee[1],ee[2]),se&&X.rotation.set(se[0],se[1],se[2]),ie&&X.scale.set(ie[0],ie[1],ie[2]),X.updateMatrix();const Le=X.geometry.clone();Le.applyMatrix4(X.matrix),X.geometry=Le,X.renderOrder=1/0,X.position.set(0,0,0),X.rotation.set(0,0,0),X.scale.set(1,1,1),z.add(X)}return z}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=L(w)),this.add(this.gizmo.rotate=L(T)),this.add(this.gizmo.scale=L(x)),this.add(this.picker.translate=L(D)),this.add(this.picker.rotate=L(O)),this.add(this.picker.scale=L(N)),this.add(this.helper.translate=L(C)),this.add(this.helper.rotate=L(G)),this.add(this.helper.scale=L(q)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const i="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:u0;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let o=0;o<r.length;o++){const s=r[o];let a;s.visible=!0,s.rotation.set(0,0,0),s.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),s.scale.set(1,1,1).multiplyScalar(a*this.size/4),"helper"!==s.tag?(s.quaternion.copy(i),"translate"===this.mode||"scale"===this.mode?("X"===s.name&&Math.abs(_n.copy(jf).applyQuaternion(i).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Y"===s.name&&Math.abs(_n.copy(Ql).applyQuaternion(i).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Z"===s.name&&Math.abs(_n.copy(Wf).applyQuaternion(i).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XY"===s.name&&Math.abs(_n.copy(Wf).applyQuaternion(i).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"YZ"===s.name&&Math.abs(_n.copy(jf).applyQuaternion(i).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XZ"===s.name&&Math.abs(_n.copy(Ql).applyQuaternion(i).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1)):"rotate"===this.mode&&(c0.copy(i),_n.copy(this.eye).applyQuaternion(Pn.copy(i).invert()),-1!==s.name.search("E")&&s.quaternion.setFromRotationMatrix(Ik.lookAt(this.eye,Ak,Ql)),"X"===s.name&&(Pn.setFromAxisAngle(jf,Math.atan2(-_n.y,_n.z)),Pn.multiplyQuaternions(c0,Pn),s.quaternion.copy(Pn)),"Y"===s.name&&(Pn.setFromAxisAngle(Ql,Math.atan2(_n.x,_n.z)),Pn.multiplyQuaternions(c0,Pn),s.quaternion.copy(Pn)),"Z"===s.name&&(Pn.setFromAxisAngle(Wf,Math.atan2(_n.y,_n.x)),Pn.multiplyQuaternions(c0,Pn),s.quaternion.copy(Pn))),s.visible=s.visible&&(-1===s.name.indexOf("X")||this.showX),s.visible=s.visible&&(-1===s.name.indexOf("Y")||this.showY),s.visible=s.visible&&(-1===s.name.indexOf("Z")||this.showZ),s.visible=s.visible&&(-1===s.name.indexOf("E")||this.showX&&this.showY&&this.showZ),s.material._color=s.material._color||s.material.color.clone(),s.material._opacity=s.material._opacity||s.material.opacity,s.material.color.copy(s.material._color),s.material.opacity=s.material._opacity,this.enabled&&this.axis&&(s.name===this.axis||this.axis.split("").some(function(l){return s.name===l}))&&(s.material.color.setHex(16776960),s.material.opacity=1)):(s.visible=!1,"AXIS"===s.name?(s.position.copy(this.worldPositionStart),s.visible=!!this.axis,"X"===this.axis&&(Pn.setFromEuler(l0.set(0,0,0)),s.quaternion.copy(i).multiply(Pn),Math.abs(_n.copy(jf).applyQuaternion(i).dot(this.eye))>.9&&(s.visible=!1)),"Y"===this.axis&&(Pn.setFromEuler(l0.set(0,0,Math.PI/2)),s.quaternion.copy(i).multiply(Pn),Math.abs(_n.copy(Ql).applyQuaternion(i).dot(this.eye))>.9&&(s.visible=!1)),"Z"===this.axis&&(Pn.setFromEuler(l0.set(0,Math.PI/2,0)),s.quaternion.copy(i).multiply(Pn),Math.abs(_n.copy(Wf).applyQuaternion(i).dot(this.eye))>.9&&(s.visible=!1)),"XYZE"===this.axis&&(Pn.setFromEuler(l0.set(0,Math.PI/2,0)),_n.copy(this.rotationAxis),s.quaternion.setFromRotationMatrix(Ik.lookAt(Ak,_n,Ql)),s.quaternion.multiply(Pn),s.visible=this.dragging),"E"===this.axis&&(s.visible=!1)):"START"===s.name?(s.position.copy(this.worldPositionStart),s.visible=this.dragging):"END"===s.name?(s.position.copy(this.worldPosition),s.visible=this.dragging):"DELTA"===s.name?(s.position.copy(this.worldPositionStart),s.quaternion.copy(this.worldQuaternionStart),vr.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),vr.applyQuaternion(this.worldQuaternionStart.clone().invert()),s.scale.copy(vr),s.visible=this.dragging):(s.quaternion.copy(i),s.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(s.visible=-1!==this.axis.search(s.name))))}super.updateMatrixWorld(e)}}Nk.prototype.isTransformControlsGizmo=!0;class Pk extends we{constructor(){super(new Su(1e5,1e5,2,2),new io({visible:!1,wireframe:!0,side:2,transparent:!0,opacity:.1,toneMapped:!1})),this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),d0.copy(jf).applyQuaternion("local"===t?this.worldQuaternion:u0),$f.copy(Ql).applyQuaternion("local"===t?this.worldQuaternion:u0),qf.copy(Wf).applyQuaternion("local"===t?this.worldQuaternion:u0),_n.copy($f),this.mode){case"translate":case"scale":switch(this.axis){case"X":_n.copy(this.eye).cross(d0),us.copy(d0).cross(_n);break;case"Y":_n.copy(this.eye).cross($f),us.copy($f).cross(_n);break;case"Z":_n.copy(this.eye).cross(qf),us.copy(qf).cross(_n);break;case"XY":us.copy(qf);break;case"YZ":us.copy(d0);break;case"XZ":_n.copy(qf),us.copy($f);break;case"XYZ":case"E":us.set(0,0,0)}break;default:us.set(0,0,0)}0===us.length()?this.quaternion.copy(this.cameraQuaternion):(Rk.lookAt(vr.set(0,0,0),us,_n),this.quaternion.setFromRotationMatrix(Rk)),super.updateMatrixWorld(e)}}Pk.prototype.isTransformControlsPlane=!0;var Yf=function(){var n=0,e=document.createElement("div");function t(u){return e.appendChild(u.dom),u}function i(u){for(var d=0;d<e.children.length;d++)e.children[d].style.display=d===u?"block":"none";n=u}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(u){u.preventDefault(),i(++n%e.children.length)},!1);var r=(performance||Date).now(),o=r,s=0,a=t(new Yf.Panel("FPS","#0ff","#002")),l=t(new Yf.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=t(new Yf.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:e,addPanel:t,showPanel:i,begin:function(){r=(performance||Date).now()},end:function(){s++;var u=(performance||Date).now();if(l.update(u-r,200),u>=o+1e3&&(a.update(1e3*s/(u-o),100),o=u,s=0,c)){var d=performance.memory;c.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return u},update:function(){r=this.end()},domElement:e,setMode:i}};Yf.Panel=function(n,e,t){var i=1/0,r=0,o=Math.round,s=o(window.devicePixelRatio||1),a=80*s,l=48*s,c=3*s,u=2*s,d=3*s,h=15*s,f=74*s,g=30*s,p=document.createElement("canvas");p.width=a,p.height=l,p.style.cssText="width:80px;height:48px";var m=p.getContext("2d");return m.font="bold "+9*s+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=t,m.fillRect(0,0,a,l),m.fillStyle=e,m.fillText(n,c,u),m.fillRect(d,h,f,g),m.fillStyle=t,m.globalAlpha=.9,m.fillRect(d,h,f,g),{dom:p,update:function(y,_){i=Math.min(i,y),r=Math.max(r,y),m.fillStyle=t,m.globalAlpha=1,m.fillRect(0,0,a,h),m.fillStyle=e,m.fillText(o(y)+" "+n+" ("+o(i)+"-"+o(r)+")",c,u),m.drawImage(p,d+s,h,f-s,g,d,h,f-s,g),m.fillRect(d+f-s,h,s,g),m.fillStyle=t,m.globalAlpha=.9,m.fillRect(d+f-s,h,s,o((1-y/_)*g))}}};const zre=Yf,Gre=["container"],jre=["canvas"];function Wre(n,e){if(1&n){const t=nt();qt(0),F(1,"button",18),Y("click",function(){const o=ge(t).$implicit;return H().setTransformMode(o.mode)}),he(2,"i",19),B(),Yt()}if(2&n){const t=e.$implicit,i=H();A(1),Ze("active",i.transformMode===t.mode),Zr("title",t.title),A(1),S("ngClass",t.icon)}}let $re=(()=>{class n{constructor(t){this.engine=t,this.mixers=[],this.transformMode="translate",this.transformTools=[{mode:"translate",icon:"fa-up-down-left-right",title:"Translate"},{mode:"rotate",icon:"fa-rotate",title:"Rotate"},{mode:"scale",icon:"fa-vector-square",title:"Scale"}]}get container(){return this.containerRef.nativeElement}get canvas(){return this.canvasRef.nativeElement}ngOnInit(){this.importSub=this.engine.import$.subscribe(t=>this.onImport(t)),this.layoutUpdatedSub=this.engine.layoutUpdated$.subscribe(()=>this.onLayoutUpdated()),this.focusSub=this.engine.focus$.subscribe(t=>this.onFocus(t)),this.selectionSub=this.engine.selection$.subscribe(t=>this.onSelectionUpdated(t))}ngOnDestroy(){var t,i,r;this.importSub.unsubscribe(),this.layoutUpdatedSub.unsubscribe(),this.focusSub.unsubscribe(),this.selectionSub.unsubscribe(),null===(t=this.orbit)||void 0===t||t.dispose(),null===(i=this.transform)||void 0===i||i.dispose(),null===(r=this.renderer)||void 0===r||r.dispose()}ngAfterViewInit(){setTimeout(()=>this.createThreeObjects(),0)}setTransformMode(t){var i;t!==this.transformMode&&(this.transformMode=t,null===(i=this.transform)||void 0===i||i.setMode(t))}onCanvasClick(){console.warn("enable canvas clicks to deselect current selection, unless orbit controls or transform controls are being used")}onImport(t){var i;(null!==(i=t.parent)&&void 0!==i?i:this.scene).add(this.collectMixers(t.node))}collectMixers(t){var i;if((null===(i=t.animations)||void 0===i?void 0:i.length)>0){const r=new MP(t);r.clipAction(t.animations[0]).play(),t.userData.mixer=r,this.mixers.push(r)}return t}onLayoutUpdated(){const t=this.container.clientWidth,i=this.container.clientHeight;this.camera.aspect=t/i,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,i)}onFocus(t){Oo.fitCameraToSelection(this.camera,this.orbit,[t])||Oo.moveCameraToObject(this.camera,this.orbit,t)}onSelectionUpdated(t){var i;this.canTransform(t)?this.transform.attach(t[0]):null===(i=this.transform)||void 0===i||i.detach()}canTransform(t){return this.transform&&1==t.length&&t[0]instanceof Dt&&null!=t[0].parent&&t[0]!==this.transform&&!Oo.isAncestor(this.transform,t[0])}createThreeObjects(){this.camera=new yi(50,this.canvas.clientWidth/this.canvas.clientHeight),this.camera.name="Scene Camera",this.camera.position.set(-2,2,4),this.transform=new Tk(this.camera,this.canvas),this.transform.name="Transform Controls",this.transform.addEventListener("dragging-changed",r=>this.orbit.enabled=!r.value),this.gizmos=new Pl,this.gizmos.name="Gizmos Scene",this.gizmos.add(this.transform),this.light=new Km,this.light.name="Scene Light",this.light.intensity=1.5,this.light.position.set(10,10,5),this.renderer=new lN({canvas:this.canvas,alpha:!0}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.orbit=new kre(this.camera,this.canvas),this.orbit.minDistance=1,this.stats=zre(),this.stats.dom.style.position="absolute",this.container.appendChild(this.stats.dom),this.scene=new Pl,this.scene.name="Default Scene",this.scene.background=new ve(10066329),this.scene.add(this.gizmos),this.scene.add(this.light),this.clock=new vP;const i=this;(function r(){requestAnimationFrame(r);const o=i.clock.getDelta();i.renderer.render(i.scene,i.camera),i.stats.update(),i.mixers.forEach(s=>s.update(o*s.timeScale))})(),this.engine.setScene(this.scene),this.engine.importFileAsync("./assets/Samba Dancing.fbx")}}return n.\u0275fac=function(t){return new(t||n)(k(ar))},n.\u0275cmp=He({type:n,selectors:[["scene-view"]],viewQuery:function(t,i){if(1&t&&(Gi(Gre,5),Gi(jre,5)),2&t){let r;xt(r=Mt())&&(i.containerRef=r.first),xt(r=Mt())&&(i.canvasRef=r.first)}},decls:22,vars:4,consts:[[1,"d-flex","flex-column","h-100","w-100"],[1,"flex-shrink-1","border-secondary","border-bottom"],["role","toolbar",1,"btn-toolbar"],["role","group",1,"btn-group","btn-group-sm","xs","m-1"],[4,"ngFor","ngForOf"],[1,"h-100","w-100","position-relative","overflow-hidden"],["container",""],[2,"width","100%","height","100%",3,"click"],["canvas",""],[1,"d-flex-shrink-1","d-flex","text-nowrap","bg-light","fs-xs","border-top","fst-italic","text-muted"],[1,"ms-auto",2,"cursor","default"],[1,"mx-2"],["title","Geometries",1,"mx-2"],[1,"fa-solid","fa-cubes","fa-fw","me-1"],["title","Textures",1,"mx-2"],[1,"fa-solid","fa-images","fa-fw","me-1"],["title","Shader Programs",1,"mx-2"],[1,"fa-solid","fa-code","fa-fw","me-1"],["type","button",1,"btn","btn-secondary","p-1",3,"title","click"],[1,"fa-solid","fa-fw",3,"ngClass"]],template:function(t,i){if(1&t&&(F(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),W(4,Wre,3,4,"ng-container",4),B()()(),F(5,"div",5,6)(7,"canvas",7,8),Y("click",function(){return i.onCanvasClick()}),B()(),F(9,"div",9)(10,"div",10)(11,"span",11),Rt(12,"memory:"),B(),F(13,"span",12),he(14,"i",13),Rt(15),B(),F(16,"span",14),he(17,"i",15),Rt(18),B(),F(19,"span",16),he(20,"i",17),Rt(21),B()()()()),2&t){let r,o,s;A(4),S("ngForOf",i.transformTools),A(11),Ui(null!==(r=null==i.renderer||null==i.renderer.info||null==i.renderer.info.memory?null:i.renderer.info.memory.geometries)&&void 0!==r?r:0),A(3),Ui(null!==(o=null==i.renderer||null==i.renderer.info||null==i.renderer.info.memory?null:i.renderer.info.memory.textures)&&void 0!==o?o:0),A(3),Ui(null!==(s=null==i.renderer||null==i.renderer.info||null==i.renderer.info.programs?null:i.renderer.info.programs.length)&&void 0!==s?s:0)}},directives:[Ri,vg],encapsulation:2}),n})(),qre=(()=>{class n{constructor(){this.root=new r0(new jx(new r0(new Ga([new Bf("Hierarchy",Fre)]),35,new Ga([new Bf("Scene",$re,!1)]),65),80,new Ga([new Bf("Resources",Sre,!1),new Bf("Animation",yne,!1)]),20),75,new Ga([new Bf("Inspector",fre)]),25)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["engine"]],decls:1,vars:1,consts:[[3,"root"]],template:function(t,i){1&t&&he(0,"split-content",0),2&t&&S("root",i.root)},directives:[cne],styles:["engine div.selectable:not(.bg-primary):not(.badge):hover{background-color:#e2e3e5!important}engine div.selectable:hover .dropdown-toggle,engine div.selectable .dropdown.show .dropdown-toggle{display:inline-block!important}\n"],encapsulation:2}),n})();const Yre=["editor"],Ok="MONACO_PATH";let Fk=(()=>{class n{constructor(t,i){this.ngZone=t,this.monacoPathConfig=i,this.isMonacoLoaded$=new kn(!1),this._monacoPath="assets/monaco-editor/min/vs",window.monacoEditorAlreadyInitialized?t.run(()=>this.isMonacoLoaded$.next(!0)):(window.monacoEditorAlreadyInitialized=!0,this.monacoPathConfig&&(this.monacoPath=this.monacoPathConfig),this.loadMonaco())}set monacoPath(t){t&&(this._monacoPath=t)}loadMonaco(){const t=()=>{let s=this._monacoPath;window.amdRequire=window.require;const a=!!this.nodeRequire,l=s.includes("http");a&&(window.require=this.nodeRequire,l||(s=window.require("path").resolve(window.__dirname,this._monacoPath))),window.amdRequire.config({paths:{vs:s}}),window.amdRequire(["vs/editor/editor.main"],()=>{this.ngZone.run(()=>this.isMonacoLoaded$.next(!0))},c=>console.error("Error loading monaco-editor: ",c))};if(window.amdRequire)return t();window.require&&(this.addElectronFixScripts(),this.nodeRequire=window.require);const o=document.createElement("script");o.type="text/javascript",o.src=`${this._monacoPath}/loader.js`,o.addEventListener("load",t),document.body.appendChild(o)}addElectronFixScripts(){const t=document.createElement("script"),i=document.createTextNode("self.module = undefined;"),r=document.createTextNode("self.process.browser = true;");t.appendChild(i),t.appendChild(r),document.body.appendChild(t)}}return n.\u0275fac=function(t){return new(t||n)(ke(an),ke(Ok,8))},n.\u0275prov=Ye({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),kk=(()=>{class n{constructor(t){this.monacoLoader=t,this.init=new Ne,this.onTouched=()=>{},this.onErrorStatusChange=()=>{},this.propagateChange=()=>{}}get model(){return this.editor&&this.editor.getModel()}get modelMarkers(){return this.model&&monaco.editor.getModelMarkers({resource:this.model.uri})}ngOnInit(){this.monacoLoader.isMonacoLoaded$.pipe(nr(t=>t),ui(1)).subscribe(()=>{this.initEditor()})}ngOnChanges(t){if(this.editor&&t.options&&!t.options.firstChange){const i=t.options.currentValue,{language:r,theme:o}=i,s=function Xk(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]])}return t}(i,["language","theme"]),{language:a,theme:l}=t.options.previousValue;a!==r&&monaco.editor.setModelLanguage(this.editor.getModel(),this.options&&this.options.language?this.options.language:"text"),l!==o&&monaco.editor.setTheme(o),this.editor.updateOptions(s)}if(this.editor&&t.uri){const i=t.uri.currentValue,r=t.uri.previousValue;if(r&&!i||!r&&i||i&&r&&i.path!==r.path){const o=this.editor.getValue();let s;this.modelUriInstance&&this.modelUriInstance.dispose(),i&&(s=monaco.editor.getModels().find(a=>a.uri.path===i.path)),this.modelUriInstance=s||monaco.editor.createModel(o,this.options.language||"text",this.uri),this.editor.setModel(this.modelUriInstance)}}}writeValue(t){this.value=t,this.editor&&t?this.editor.setValue(t):this.editor&&this.editor.setValue("")}registerOnChange(t){this.propagateChange=t}registerOnTouched(t){this.onTouched=t}validate(){return this.parsedError?{monaco:{value:this.parsedError.split("|")}}:null}registerOnValidatorChange(t){this.onErrorStatusChange=t}initEditor(){const t={value:[this.value].join("\n"),language:"text",automaticLayout:!0,scrollBeyondLastLine:!1,theme:"vc"};this.editor=monaco.editor.create(this.editorContent.nativeElement,this.options?Object.assign(Object.assign({},t),this.options):t),this.registerEditorListeners(),this.init.emit(this.editor)}registerEditorListeners(){this.editor.onDidChangeModelContent(()=>{this.propagateChange(this.editor.getValue())}),this.editor.onDidChangeModelDecorations(()=>{const t=this.modelMarkers.map(({message:r})=>r).join("|");this.parsedError!==t&&(this.parsedError=t,this.onErrorStatusChange())}),this.editor.onDidBlurEditorText(()=>{this.onTouched()})}ngOnDestroy(){this.editor&&this.editor.dispose()}}return n.\u0275fac=function(t){return new(t||n)(k(Fk))},n.\u0275cmp=He({type:n,selectors:[["ngx-monaco-editor"]],viewQuery:function(t,i){if(1&t&&Gi(Yre,7),2&t){let r;xt(r=Mt())&&(i.editorContent=r.first)}},inputs:{options:"options",uri:"uri"},outputs:{init:"init"},features:[dn([{provide:Vr,useExisting:Vt(()=>n),multi:!0},{provide:Oi,useExisting:Vt(()=>n),multi:!0}]),Bi],decls:4,vars:0,consts:[["fxFlex","",1,"editor-container"],["container",""],[1,"monaco-editor"],["editor",""]],template:function(t,i){1&t&&(F(0,"div",0,1),he(2,"div",2,3),B())},styles:[".monaco-editor[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0}.editor-container[_ngcontent-%COMP%]{overflow:hidden;position:relative;display:table;width:100%;height:100%;min-width:0}"],changeDetection:0}),n})(),Zre=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[]]}),n})();class Lk{constructor(e,t,i,r){this.children=[],this.filesystem=e,this.isDirectory=i,this.isFile=!i,this._name=t,this.parent=r}get fullPath(){return this._fullPath}set fullPath(e){const t=this.fullPath;this._fullPath=e,t&&t!==this.fullPath&&this.filesystem.onEntryMoved(this,t)}get name(){return this._name}set name(e){this._name=e,this.updateFullPath()}get uri(){return"file://"+this.fullPath}get parent(){return this._parent}set parent(e){if(e instanceof qa)throw Error(`file ${e.name} cannot be a parent`);if(e&&e.uri===this.uri)throw Error(`file ${e.name} cannot be parent of self`);if(e&&this.isDescendant(e.uri))throw Error(`${this.name} cannot be a child of descendant ${e.name}`);this.parent&&this.parent.children.splice(this.parent.children.indexOf(this),1),this._parent=e,this.parent&&this.parent.children.push(this),this.updateFullPath()}getParent(e,t){try{e&&e(this.parent)}catch(i){i instanceof DOMException&&t&&t(i)}}updateFullPath(){this.fullPath=this.getFullPath()}rename(e){this.name=e}delete(){if(!parent)throw Error("cannot delete root entry");this.parent=void 0}getFullPath(){return this.parent?(0,Fo.join)(this.parent.fullPath,this.name):"/"}*getParents(){for(let e=this._parent;e;e=e._parent)yield e}*getDescendants(){for(const e of this.children){yield e;for(const t of e.getDescendants())yield t}}*traverse(){yield this;for(const e of this.children){yield e;for(const t of e.getDescendants())yield t}}isDescendant(e){for(const t of this.getDescendants())if(t.uri===e)return!0;return!1}}class $a extends Lk{constructor(e,t,i){super(e,t,!0,i)}createReader(){throw new Error("Method not implemented.")}getDirectory(e,t,i,r){throw new Error("Method not implemented.")}getFile(e,t,i,r){throw new Error("Method not implemented.")}}class Xre{constructor(e){this.name="",this.webkitRelativePath="",this.type="",this.buffer=(new TextEncoder).encode(e),this.lastModified=(new Date).getTime()}get size(){return this.buffer.byteLength}arrayBuffer(){return Promise.resolve(this.buffer)}slice(e,t,i){const r=e?this.buffer.slice(e,t):this.buffer;return new Blob([r])}stream(){return this.toReadableStream(this.buffer)}toReadableStream(e){return new ReadableStream({start(t){t.enqueue(e),t.close()}})}text(){return Promise.resolve((new TextDecoder).decode(this.buffer))}}class qa extends Lk{constructor(e,t,i,r){super(e,t,!1,i),this.content=null!=r?r:""}file(e,t){e&&e(new Xre(this.content))}}class Kre{constructor(e){this.entryMovedSource$=new Ft,this.entryMoved$=this.entryMovedSource$.asObservable(),this.name=e,this.root=new $a(this,"")}createFile(e,t){const i=(0,Fo.dirname)(e),r=(0,Fo.basename)(e),o=this.getEntryByFullPath(i);if(o instanceof $a)return new qa(this,this.findNextName(o,r),o,t);throw Error(`could not find directory ${i}`)}createDirectory(e){const t=this.getEntryByFullPath(e);if(t){if(t instanceof $a)return t;throw Error(`${e} is a file`)}const i=(0,Fo.dirname)(e),r=this.getEntryByFullPath(i);if(r){if(r instanceof $a){const o=(0,Fo.basename)(e);return new $a(this,this.findNextName(r,o,!1),r)}throw Error(`${i} is not a directory`)}throw Error(`could not find directory ${i}`)}findNextName(e,t,i=!0){let r=t,o=0;for(;e.children.some(s=>s.name===r);)r=this.appendNextName(t,o,i),o++;return r}appendNextName(e,t,i=!0){if(i){const r=e.lastIndexOf(".");if(-1!==r)return`${e.substring(0,r)}${t}.${e.substring(r+1)}`}return e+t}getEntryByFullPath(e){for(const t of this.root.traverse())if(t.fullPath===e)return t}getEntryByUri(e){for(const t of this.root.traverse())if(t.uri===e)return t}isValidName(e){return!(e.trim()!==e||!e)&&e===(0,Fo.basename)(e)}tryRename(e,t){if(this.isValidName(t)){const i=e.parent;if(i instanceof $a){const r=(0,Fo.join)(i.fullPath,t);for(const o of i.getDescendants())if(o!==e&&o.fullPath===r)return!1;return!0}}return!1}onEntryMoved(e,t){this.entryMovedSource$.next({entry:e,prevFullPath:t});for(const i of e.children)i.updateFullPath()}}let Zf=(()=>{class n{constructor(){this.draggingFsSource$=new kn(""),this.draggingFsOverSource$=new kn(""),this.selectEntrySource$=new Ft,this.openExistingFileSource$=new Ft,this.deleteEntrySource$=new Ft,this.newFileSource$=new Ft,this.newDirectorySource$=new Ft,this.entryRenamedSource$=new Ft,this.startRenamingSource$=new Ft,this.draggingFs$=this.draggingFsSource$.asObservable(),this.draggingFsOver$=this.draggingFsOverSource$.asObservable(),this.selectEntry$=this.selectEntrySource$.asObservable(),this.openExistingFile$=this.openExistingFileSource$.asObservable(),this.deleteEntry$=this.deleteEntrySource$.asObservable(),this.newFile$=this.newFileSource$.asObservable(),this.newDirectory$=this.newDirectorySource$.asObservable(),this.entryRenamed$=this.entryRenamedSource$.asObservable(),this.startRenaming$=this.startRenamingSource$.asObservable()}setDraggingFs(t){this.draggingFsSource$.next(t)}setDraggingFsOver(t){this.draggingFsOverSource$.next(t)}selectEntry(t){this.selectEntrySource$.next(t)}openExistingFile(t){this.openExistingFileSource$.next(t)}deleteEntry(t){this.deleteEntrySource$.next(t)}createNewFile(t){this.newFileSource$.next(t)}createNewDirectory(t){this.newDirectorySource$.next(t)}entryRenamed(t,i,r,o){this.entryRenamedSource$.next({entry:t,name:i,isNew:r,success:o})}startRenaming(t){this.startRenamingSource$.next(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Ye({token:n,factory:n.\u0275fac}),n})();const Jre=["container"];function Qre(n,e){if(1&n&&(qt(0),he(1,"div",9)(2,"div",10),Yt()),2&n){const t=H();A(1),Ze("d-none",!t.expanded),A(1),Ze("d-none",t.expanded)}}function eoe(n,e){1&n&&he(0,"div",11)}function toe(n,e){if(1&n){const t=nt();F(0,"div",12),Y("click",function(r){return ge(t),H().createFile(r)}),B()}}function noe(n,e){if(1&n){const t=nt();F(0,"div",13),Y("click",function(r){return ge(t),H().createDirectory(r)}),B()}}function ioe(n,e){if(1&n){const t=nt();F(0,"div",14),Y("click",function(r){return ge(t),H().startRenaming(r)}),B()}}function roe(n,e){if(1&n){const t=nt();F(0,"div",15),Y("click",function(r){return ge(t),H().deleteEntry(r)}),B()}}let Bk=(()=>{class n{constructor(t){this.ide=t,this.expanded=!1}onItemClick(){this.ide.selectEntry(this.node),this.node.isDirectory&&(this.expanded=!this.expanded)}setDraggingFs(t){this.ide.setDraggingFs(t)}createFile(t){t.preventDefault(),t.stopPropagation(),this.expanded=!0,this.ide.createNewFile(this.node)}createDirectory(t){t.preventDefault(),t.stopPropagation(),this.expanded=!0,this.ide.createNewDirectory(this.node)}startRenaming(t){t.preventDefault(),t.stopPropagation(),this.ide.startRenaming(this.node)}deleteEntry(t){t.preventDefault(),t.stopPropagation(),this.getDeleteConfirmation()&&this.ide.deleteEntry(this.node)}getDeleteConfirmation(){return this.node instanceof $a?confirm(`Are you sure you want to delete the '${this.node.name}' directory?`):confirm(`Are you sure you want to delete the file '${this.node.name}'?`)}focus(){this.container.nativeElement.focus()}}return n.\u0275fac=function(t){return new(t||n)(k(Zf))},n.\u0275cmp=He({type:n,selectors:[["file-node"]],viewQuery:function(t,i){if(1&t&&Gi(Jre,7),2&t){let r;xt(r=Mt())&&(i.container=r.first)}},inputs:{node:"node",depth:"depth",selected:"selected"},decls:12,vars:14,consts:[["tabIndex","0",1,"d-flex","align-items-center","ide-tree-item","text-nowrap","selectable",3,"dndDraggable","dndEffectAllowed","dndType","click","dndStart","dndEnd"],["container",""],[4,"ngIf"],["class","codicon codicon-question",4,"ngIf"],[1,"ms-auto"],["class","codicon codicon-new-file selectable rounded hoverable align-middle","title","New File",3,"click",4,"ngIf"],["class","codicon codicon-new-folder selectable rounded hoverable align-middle","title","New Folder",3,"click",4,"ngIf"],["class","codicon codicon-tag selectable rounded hoverable align-middle","title","Rename",3,"click",4,"ngIf"],["class","codicon codicon-trash selectable rounded hoverable align-middle","title","Delete",3,"click",4,"ngIf"],[1,"codicon","codicon-chevron-down"],[1,"codicon","codicon-chevron-right"],[1,"codicon","codicon-question"],["title","New File",1,"codicon","codicon-new-file","selectable","rounded","hoverable","align-middle",3,"click"],["title","New Folder",1,"codicon","codicon-new-folder","selectable","rounded","hoverable","align-middle",3,"click"],["title","Rename",1,"codicon","codicon-tag","selectable","rounded","hoverable","align-middle",3,"click"],["title","Delete",1,"codicon","codicon-trash","selectable","rounded","hoverable","align-middle",3,"click"]],template:function(t,i){1&t&&(F(0,"div",0,1),Y("click",function(){return i.onItemClick()})("dndStart",function(){return i.setDraggingFs(i.node.uri)})("dndEnd",function(){return i.setDraggingFs("")}),he(2,"span"),W(3,Qre,3,4,"ng-container",2),W(4,eoe,1,0,"div",3),F(5,"div"),Rt(6),B(),he(7,"div",4),W(8,toe,1,0,"div",5),W(9,noe,1,0,"div",6),W(10,ioe,1,0,"div",7),W(11,roe,1,0,"div",8),B()),2&t&&(Ze("selected",i.selected),S("dndDraggable",i.node.uri)("dndEffectAllowed","move")("dndType","fs"),A(2),al("margin-left",8*i.depth,"px"),A(1),S("ngIf",i.node.isDirectory),A(1),S("ngIf",!i.node.isDirectory),A(2),Ui(i.node.name?i.node.name:i.node.filesystem.name),A(2),S("ngIf",i.node.isDirectory),A(1),S("ngIf",i.node.isDirectory),A(1),S("ngIf",i.node.parent),A(1),S("ngIf",i.node.parent))},directives:[D_,Yn],encapsulation:2}),n})(),ooe=(()=>{class n{constructor(t){this.el=t}ngAfterViewInit(){setTimeout(()=>this.el.nativeElement.focus(),0)}}return n.\u0275fac=function(t){return new(t||n)(k(Kt))},n.\u0275dir=me({type:n,selectors:[["","autofocus",""]]}),n})();const soe=["container"];let aoe=(()=>{class n{constructor(t){this.ide=t,this.canceled=!1}ngOnInit(){this.value=this.isNew?"":this.node.name?this.node.name:this.node.filesystem.name}onFocus(){if(this.node instanceof qa){const t=this.value.lastIndexOf(".");if(-1!==t)return void this.container.nativeElement.setSelectionRange(0,t)}this.container.nativeElement.select()}finish(){if(this.canceled)this.ide.entryRenamed(this.node,this.value,this.isNew,!1);else{const t=this.fs.tryRename(this.node,this.value);t&&this.node.rename(this.value),this.ide.entryRenamed(this.node,this.value,this.isNew,t)}}blur(){this.container.nativeElement.blur()}cancel(){this.canceled=!0}}return n.\u0275fac=function(t){return new(t||n)(k(Zf))},n.\u0275cmp=He({type:n,selectors:[["rename-node"]],viewQuery:function(t,i){if(1&t&&Gi(soe,7),2&t){let r;xt(r=Mt())&&(i.container=r.first)}},inputs:{fs:"fs",node:"node",depth:"depth",isNew:"isNew"},decls:6,vars:3,consts:[["tabIndex","0",1,"d-flex","align-items-center","ide-tree-item","text-nowrap","selectable"],[1,"codicon","codicon-question"],[1,"flex-grow-1","me-1"],["type","text",1,"renamer","w-100",2,"height","20px",3,"ngModel","autofocus","ngModelChange","blur","keyup.enter","keyup.escape","focus"],["container",""]],template:function(t,i){1&t&&(F(0,"div",0),he(1,"span")(2,"div",1),F(3,"div",2)(4,"input",3,4),Y("ngModelChange",function(o){return i.value=o})("blur",function(){return i.finish()})("keyup.enter",function(){return i.blur()})("keyup.escape",function(){return i.cancel()})("focus",function(){return i.onFocus()}),B()()()),2&t&&(A(1),al("margin-left",8*i.depth,"px"),A(3),S("ngModel",i.value))},directives:[ss,ko,co,ooe],encapsulation:2}),n})();function loe(n,e){1&n&&tn(0)}const coe=function(){return["fs"]},h0=function(n,e,t){return{$implicit:n,depth:e,selected:t}};function uoe(n,e){if(1&n){const t=nt();F(0,"div",5),Y("dndDragover",function(r){const s=ge(t).$implicit;return H().setDraggingFsOver(r,s)})("dndDrop",function(r){const s=ge(t).$implicit;return H().onFsDrop(r,s)}),W(1,loe,1,0,"ng-container",4),B()}if(2&n){const t=e.$implicit,i=e.depth,r=e.selected,o=H(),s=gt(3);Ze("dropping",o.draggingFsOver===t.uri),S("dndDropzone",Xr(6,coe))("dndEffectAllowed","move"),A(1),S("ngTemplateOutlet",s)("ngTemplateOutletContext",Ar(7,h0,t,i,r))}}function doe(n,e){if(1&n&&(qt(0),he(1,"rename-node",11),Yt()),2&n){const t=H(),i=t.$implicit,r=t.depth,o=H();A(1),S("fs",o.fs)("node",i)("depth",r)("isNew",o.isNew)}}function hoe(n,e){1&n&&tn(0)}function foe(n,e){if(1&n&&(qt(0),W(1,hoe,1,0,"ng-container",4),Yt()),2&n){const t=e.$implicit,i=H().depth,r=H(),o=gt(5);A(1),S("ngTemplateOutlet",o)("ngTemplateOutletContext",Ar(2,h0,t,i+1,r.selectedEntry===t))}}function poe(n,e){if(1&n&&(W(0,doe,2,4,"ng-container",6),he(1,"file-node",7,8),F(3,"span",9),W(4,foe,2,6,"ng-container",10),B()),2&n){const t=e.$implicit,i=e.depth,r=e.selected,o=gt(2),s=H();S("ngIf",s.renaming===t.uri),A(1),S("hidden",s.renaming===t.uri)("node",t)("depth",i)("selected",r),A(2),S("hidden",!o.expanded),A(1),S("ngForOf",s.sortedChildren(t))}}function goe(n,e){1&n&&tn(0)}function moe(n,e){if(1&n&&(qt(0),W(1,goe,1,0,"ng-container",4),Yt()),2&n){const t=H(),i=t.$implicit,r=t.depth,o=t.selected;H();const s=gt(1);A(1),S("ngTemplateOutlet",s)("ngTemplateOutletContext",Ar(2,h0,i,r,o))}}function _oe(n,e){1&n&&tn(0)}function yoe(n,e){if(1&n&&(qt(0),W(1,_oe,1,0,"ng-container",4),Yt()),2&n){const t=H(),i=t.$implicit,r=t.depth,o=t.selected;H();const s=gt(3);A(1),S("ngTemplateOutlet",s)("ngTemplateOutletContext",Ar(2,h0,i,r,o))}}function voe(n,e){if(1&n&&(W(0,moe,2,6,"ng-container",6),W(1,yoe,2,6,"ng-container",6)),2&n){const t=e.$implicit;S("ngIf",t.isDirectory),A(1),S("ngIf",!t.isDirectory)}}function boe(n,e){1&n&&tn(0)}const woe=function(n,e){return{$implicit:n,depth:0,selected:e}};let Vk=(()=>{class n{constructor(t){this.ide=t,this.renamingChange=new Ne,this.isNew=!1}ngOnInit(){this.draggingFsSub=this.ide.draggingFs$.subscribe(t=>this.draggingFs=t),this.draggingFsOverSub=this.ide.draggingFsOver$.subscribe(t=>this.draggingFsOver=t),this.selectEntrySub=this.ide.selectEntry$.subscribe(t=>this.onSelectEntry(t)),this.newFileSub=this.ide.newFile$.subscribe(t=>this.onNewFile(t)),this.newDirectorySub=this.ide.newDirectory$.subscribe(t=>this.onNewDirectory(t)),this.startRenamingSub=this.ide.startRenaming$.subscribe(t=>this.onStartRenaming(t)),this.entryRenamedSub=this.ide.entryRenamed$.subscribe(t=>this.onEntryRenamed(t))}ngOnDestroy(){this.draggingFsSub.unsubscribe(),this.draggingFsOverSub.unsubscribe(),this.selectEntrySub.unsubscribe(),this.newFileSub.unsubscribe(),this.newDirectorySub.unsubscribe(),this.startRenamingSub.unsubscribe(),this.entryRenamedSub.unsubscribe()}onNewFile(t){const i=this.fs.createFile((0,Fo.join)(t.fullPath,"New File.txt"));this.isNew=!0,this.onStartRenaming(i)}onNewDirectory(t){const i=this.fs.createDirectory((0,Fo.join)(t.fullPath,"New Folder"));this.isNew=!0,this.onStartRenaming(i)}onStartRenaming(t){this.renamingChange.emit(t.uri),this.prevSelectedEntry=this.selectedEntry,this.selectedEntry=void 0}onEntryRenamed({entry:t,isNew:r,success:o}){if(this.isNew=!1,this.renamingChange.emit(""),this.selectedEntry=this.prevSelectedEntry,this.prevSelectedEntry=void 0,r&&(o?t instanceof qa&&this.ide.openExistingFile(t):this.ide.deleteEntry(t)),this.selectedEntry){const s=this.nodes.find(a=>a.node===this.selectedEntry);s&&setTimeout(()=>s.focus(),0)}}onSelectEntry(t){this.selectedEntry=t,this.selectedEntry&&this.selectedEntry instanceof qa&&this.ide.openExistingFile(this.selectedEntry)}setDraggingFsOver(t,i){var r;if(this.draggingFs){const o=this.fs.getEntryByUri(this.draggingFs);if(o&&(null===(r=o.parent)||void 0===r?void 0:r.uri)!==i.uri&&o.uri!==i.uri&&!o.isDescendant(i.uri))return void this.ide.setDraggingFsOver(i.uri)}this.ide.setDraggingFsOver("")}onTabSelected(t){if(t)for(const i of t.getParents()){const r=this.nodes.find(o=>o.node.uri===i.uri);r&&(r.expanded=!0)}this.selectedEntry=t}onFsDrop(t,i){if(this.draggingFsOver&&(this.ide.setDraggingFsOver(""),this.ide.setDraggingFs(""),t.data)){const r=this.fs.getEntryByUri(t.data);r&&(r.parent=i)}}sortedChildren(t){return t.children.map(i=>({node:i,isRenaming:this.isNew&&this.renaming===i.uri})).sort((i,r)=>+r.node.isDirectory-+i.node.isDirectory||+r.isRenaming-+i.isRenaming||i.node.name.localeCompare(r.node.name)).map(i=>i.node)}}return n.\u0275fac=function(t){return new(t||n)(k(Zf))},n.\u0275cmp=He({type:n,selectors:[["file-tree"]],viewQuery:function(t,i){if(1&t&&Gi(Bk,5),2&t){let r;xt(r=Mt())&&(i.nodes=r)}},inputs:{fs:"fs",renaming:"renaming"},outputs:{renamingChange:"renamingChange"},decls:8,vars:5,consts:[["directory",""],["entry",""],["tree",""],[1,"h-100","w-100","overflow-y-only","fs-xs","ide-tree-list","hover-parent","mouse-support"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"dndDropzone","dndEffectAllowed","dndDragover","dndDrop"],[4,"ngIf"],[3,"hidden","node","depth","selected"],["item",""],[3,"hidden"],[4,"ngFor","ngForOf"],[3,"fs","node","depth","isNew"]],template:function(t,i){if(1&t&&(W(0,uoe,2,11,"ng-template",null,0,st),W(2,poe,5,7,"ng-template",null,1,st),W(4,voe,2,2,"ng-template",null,2,st),F(6,"div",3),W(7,boe,1,0,"ng-container",4),B()),2&t){const r=gt(5);A(7),S("ngTemplateOutlet",r)("ngTemplateOutletContext",Mo(2,woe,i.fs.root,i.selectedEntry===i.fs.root))}},directives:[La,gr,Yn,aoe,Bk,Ri],encapsulation:2}),n})();function xoe(n,e){1&n&&he(0,"div",18)}const Moe=function(){return["tab"]};function Doe(n,e){if(1&n){const t=nt();qt(0),F(1,"div",19),Y("click",function(){const o=ge(t).$implicit;return H().setEditor(o)})("dndDragover",function(){const o=ge(t).$implicit;return H().onTabDragover(o.file.uri)})("dndDrop",function(r){const s=ge(t).$implicit;return H().onTabDrop(r,s.file.uri)}),he(2,"div",20),F(3,"span"),Rt(4),B(),F(5,"div",21),Y("click",function(r){const s=ge(t).$implicit;return H().closeTab(r,s)}),B()(),he(6,"div",22),Yt()}if(2&n){const t=e.$implicit,i=H();A(1),Ze("selected",i.currentModel===t.options.model)("dropping",i.draggingTabOver===t.file.uri),Zr("title",t.file.fullPath),S("dndDraggable",t.file.uri)("dndEffectAllowed","move")("dndType","tab")("dndDropzone",Xr(10,Moe)),A(3),Ui(t.file.name)}}function Soe(n,e){if(1&n){const t=nt();F(0,"ngx-monaco-editor",24),Y("init",function(r){return ge(t),H(2).onEditorInit(r)}),B()}if(2&n){const t=e.$implicit;S("hidden",H(2).currentModel!==t.options.model)("options",t.options)}}function Eoe(n,e){if(1&n&&(qt(0),W(1,Soe,1,2,"ngx-monaco-editor",23),Yt()),2&n){const t=H();A(1),S("ngForOf",t.models)}}function Coe(n,e){if(1&n&&(F(0,"div",26),Rt(1),B()),2&n){const t=H().$implicit;A(1),Yp("Ln ",t.lineNumber,", Col ",t.column,"")}}function Toe(n,e){1&n&&W(0,Coe,2,2,"div",25),2&n&&S("ngIf",e.$implicit)}function Aoe(n,e){1&n&&tn(0)}const Ioe=function(n){return{$implicit:n}};function Roe(n,e){if(1&n&&(W(0,Aoe,1,0,"ng-container",27),F(1,"div",26),Rt(2),B(),F(3,"div"),Rt(4),B()),2&n){const t=e.$implicit,i=H();S("ngTemplateOutlet",gt(16))("ngTemplateOutletContext",Ai(4,Ioe,t.getPosition())),A(2),Ui("\n"===(null==i.currentModel?null:i.currentModel.getEOL())?"LF":"CRLF"),A(2),Ui(null==i.currentModel?null:i.currentModel.getLanguageId())}}function Noe(n,e){1&n&&tn(0)}const Poe=function(n,e){return{$implicit:n,model:e}};function Ooe(n,e){if(1&n&&(qt(0),W(1,Noe,1,0,"ng-container",27),Yt()),2&n){const t=H(),i=gt(18);A(1),S("ngTemplateOutlet",i)("ngTemplateOutletContext",Mo(2,Poe,t.currentEditor.editor,t.currentModel))}}let Foe=(()=>{class n{constructor(t,i,r){this.rin=t,this.monacoLoaderService=i,this.ide=r,this.viewStateMap=new Map,this.fs=new Kre("memory"),this.models=[]}ngOnInit(){this.openExistingFileSub=this.ide.openExistingFile$.subscribe(t=>this.onOpenExistingFile(t)),this.deleteEntrySub=this.ide.deleteEntry$.subscribe(t=>this.onDeleteEntry(t)),this.entryeMovedSub=this.fs.entryMoved$.subscribe(t=>this.onEntryMoved(t)),this.monacoSub=this.monacoLoaderService.isMonacoLoaded$.pipe(nr(t=>t),ui(1)).subscribe(()=>{this.monaco=window.monaco,this.themeSub=this.rin.theme$.subscribe(t=>this.monaco.editor.setTheme(t)),this.fs.createDirectory("/testing"),this.createAndOpenFile("/foo.js",'function x() {\nconsole.log("Hello world!");\n}')})}ngOnDestroy(){var t;this.openExistingFileSub.unsubscribe(),this.deleteEntrySub.unsubscribe(),this.entryeMovedSub.unsubscribe(),this.monacoSub.unsubscribe(),null===(t=this.themeSub)||void 0===t||t.unsubscribe()}onOpenExistingFile(t){const i=this.models.find(r=>r.file.uri===t.uri);this.setEditor(i||this.createModel(t))}onDeleteEntry(t){if(t instanceof $a)for(const i of t.getDescendants())i instanceof qa&&this.removeModelIfExists(i);else t instanceof qa&&this.removeModelIfExists(t);t.delete()}removeModelIfExists(t){const i=this.models.find(r=>r.file.uri===t.uri);i&&this.removeModel(i)}resetDragging(){this.onTabDragover(""),this.ide.setDraggingFsOver("")}onTabDragover(t){this.draggingTabOver=t}onTabDrop(t,i){if(this.onTabDragover(""),t.data&&t.data!==i){const r=this.models.findIndex(s=>s.file.uri===t.data),o=this.models.findIndex(s=>s.file.uri===i);if(-1!==r&&-1!==o){const s=this.models[r];this.models.splice(r,1),this.models.splice(o,0,s)}}}setEditor(t){t?(this.currentModel=t.options.model,this.currentEditor=this.editors.find(i=>i.model===t.options.model),this.tree.onTabSelected(t.file)):(this.currentModel=void 0,this.currentEditor=void 0,this.tree.onTabSelected(void 0))}onEditorInit(t){const i=t.onDidFocusEditorWidget(()=>this.onEditorFocus(t)),r=t.onDidDispose(()=>{i.dispose(),r.dispose()}),o=t.getModel();if(o){const s=o.uri.toString(),a=this.viewStateMap.get(s);a&&(this.viewStateMap.delete(s),t.restoreViewState(a)),this.currentModel===o&&setTimeout(()=>this.currentEditor=this.editors.find(l=>l.model===o),0)}}onEditorFocus(t){const i=this.models.find(r=>r.options.model===t.getModel());i&&this.setEditor(i)}closeTab(t,i){t.preventDefault(),t.stopPropagation(),this.removeModel(i)}createNew(){this.createAndOpenFile("/untitled.js","")}createAndOpenFile(t,i){const r=this.fs.createFile(t,i);this.setEditor(this.createModel(r))}createModel(t){const i=this.createEditorModel(t,t.content);return this.models.push(i),i}createEditorModel(t,i,r){const o=this.monaco.Uri.file(t.fullPath);return{file:t,options:{theme:this.rin.theme,model:this.monaco.editor.createModel(i,r,o)}}}removeModel(t,i=!0){var r;const o=this.models.indexOf(t);return null===(r=t.options.model)||void 0===r||r.dispose(),this.models.splice(o,1),i&&this.currentModel===t.options.model&&this.setEditor(this.models.length>0?this.models[0]:void 0),o}onEntryMoved(t){const i=t.entry;if(i instanceof qa){const r=this.models.findIndex(o=>o.file===i);if(-1!==r){const o=this.models[r],s=o.options.model;if(s){const a=this.editors.find(l=>l.model===s);if(a){const l=a.editor.saveViewState();l&&this.viewStateMap.set(i.uri,l);const c=this.createEditorModel(i,s.getValue(),s.getLanguageId());this.removeModel(o,!1),this.models.splice(r,0,c),this.currentModel===o.options.model&&this.setEditor(c)}}}}}}return n.\u0275fac=function(t){return new(t||n)(k($b),k(Fk),k(Zf))},n.\u0275cmp=He({type:n,selectors:[["ide"]],viewQuery:function(t,i){if(1&t&&(Gi(Vk,7),Gi(kk,5)),2&t){let r;xt(r=Mt())&&(i.tree=r.first),xt(r=Mt())&&(i.editors=r)}},decls:23,vars:8,consts:[["dndDropzone","",1,"d-flex","flex-column","monaco-editor","h-100","w-100","overflow-hidden",3,"dndDragover"],[1,"h-100","w-100"],["direction","horizontal"],[3,"size"],[3,"renaming","fs","renamingChange"],[1,"position-relative",3,"size"],["class","position-absolute top-0 end-0 bottom-0 start-0","style","z-index: 10;",4,"ngIf"],[1,"d-flex","flex-column","h-100","w-100","overflow-hidden"],[1,"flex-shrink-1"],[1,"d-flex","ide-tabs","mouse-support","xs","fs-xs"],[4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","ide-tab-item","selectable","p-2",3,"click"],[1,"codicon","codicon-add"],[4,"ngIf"],["position",""],["status",""],[1,"d-flex","align-items-centerflex-shrink-1","bg-primary","text-white","fs-xs","p-1"],[1,"ms-auto"],[1,"position-absolute","top-0","end-0","bottom-0","start-0",2,"z-index","10"],[1,"d-flex","align-items-center","ide-tab-item","selectable","hover-parent","p-2",3,"title","dndDraggable","dndEffectAllowed","dndType","dndDropzone","click","dndDragover","dndDrop"],[1,"codicon","codicon-question","me-1"],[1,"codicon","codicon-close","selectable","rounded","hoverable","ms-1",2,"padding","2px",3,"click"],[1,"ide-tab-item-separator",2,"width","1px"],[3,"hidden","options","init",4,"ngFor","ngForOf"],[3,"hidden","options","init"],["class","me-3",4,"ngIf"],[1,"me-3"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){1&t&&(F(0,"div",0),Y("dndDragover",function(){return i.resetDragging()}),F(1,"div",1)(2,"as-split",2)(3,"as-split-area",3)(4,"file-tree",4),Y("renamingChange",function(o){return i.renaming=o}),B()(),F(5,"as-split-area",5),W(6,xoe,1,0,"div",6),F(7,"div",7)(8,"div",8)(9,"div",9),W(10,Doe,7,11,"ng-container",10),F(11,"div",11),Y("click",function(){return i.createNew()}),he(12,"div",12),B()()(),F(13,"div",1),W(14,Eoe,2,1,"ng-container",13),B()()()()(),W(15,Toe,1,1,"ng-template",null,14,st),W(17,Roe,5,6,"ng-template",null,15,st),F(19,"div",16)(20,"div",17),Rt(21,"\xa0"),B(),W(22,Ooe,2,5,"ng-container",13),B()()),2&t&&(A(3),S("size",25),A(1),S("renaming",i.renaming)("fs",i.fs),A(1),S("size",75),A(1),S("ngIf",i.renaming),A(4),S("ngForOf",i.models),A(4),S("ngIf",i.monaco),A(8),S("ngIf",i.currentModel&&i.currentEditor))},directives:[La,n0,Gx,Vk,Yn,Ri,D_,kk,gr],styles:[".ide-tree-list{background-color:var(--vscode-editorWidget-background);color:var(--vscode-editorWidget-foreground)}.ide-tree-list .codicon{padding:2px;margin-right:2px}.ide-tree-item{padding-top:2px;padding-bottom:2px}.ide-tree-item:not(.selected):hover{background-color:var(--vscode-list-hoverBackground)}.ide-tree-item.selected{background-color:var(--vscode-list-inactiveSelectionBackground)}.ide-tree-item.selected:focus{background-color:var(--vscode-list-activeSelectionBackground);color:var(--vscode-list-activeSelectionForeground);outline:1px solid var(--vscode-list-focusOutline);outline-offset:-1px}.ide-tree-list .dropping,.ide-tree-list .dropping .ide-tree-item{background-color:var(--vscode-list-dropBackground);color:var(--vscode-editorWidget-foreground)}.ide-tree-item input.renamer{background-color:var(--vscode-input-background);color:var(--vscode-input-foreground);border:1px solid var(--vscode-inputOption-activeBorder);outline:1px solid var(--vscode-list-focusOutline)}.ide-tabs{background-color:var(--vscode-editorWidget-background);color:var(--vscode-list-deemphasizedForeground)}.ide-tab-item-separator{background-color:var(--vscode-textCodeBlock-background)}.ide-tab-item{background-color:var(--vscode-list-hoverBackground)}.ide-tab-item.selected{background-color:var(--vscode-editor-background);color:var(--vscode-menu-foreground)}.ide-tab-item.dropping{background-color:var(--vscode-list-dropBackground)}.hover-parent:not(.selected) .hoverable{visibility:hidden}.hover-parent:hover .hoverable{visibility:visible}.codicon.selectable:hover{background-color:var(--vscode-list-dropBackground)}.ide-tree-list .selected .codicon.selectable:hover{color:var(--vscode-editorWidget-foreground)}\n"],encapsulation:2}),n})();const koe=[{path:"",redirectTo:"engine",pathMatch:"full"},{path:"engine",component:(()=>{class n{constructor(t,i){this.rin=t,this.engine=i,this.state="engine"}ngOnInit(){this.themeSub=this.rin.theme$.subscribe(t=>this.theme=t)}ngOnDestroy(){this.themeSub.unsubscribe()}setState(t){this.state=t}toggleTheme(){this.theme="vs"===this.theme?"vs-dark":"vs",this.rin.theme=this.theme}onWindowResized(){this.engine.updateLayout()}onDrop(t){console.log("LayoutComponent.onDrop",t)}}return n.\u0275fac=function(t){return new(t||n)(k($b),k(ar))},n.\u0275cmp=He({type:n,selectors:[["layout"]],decls:11,vars:8,consts:[["dndDropzone","",1,"d-flex","vh-100",3,"dndAllowExternal","resize","dndDrop"],[1,"d-flex","flex-column","flex-shrink-1","border-end"],[1,"layout-icon","d-flex","align-items-center","justify-content-center","selectable",3,"click"],[1,"fa-solid","fa-copy","fa-fw","fa-2xl"],[1,"fa-solid","fa-cube","fa-fw","fa-2xl"],[1,"mt-auto","layout-icon","d-flex","align-items-center","justify-content-center","selectable",3,"click"],[1,"border","p-1","rounded","swatch",3,"ngClass"],[1,"h-100","w-100","overflow-hidden"],[3,"hidden"]],template:function(t,i){1&t&&(F(0,"div",0),Y("resize",function(){return i.onWindowResized()},!1,PD)("dndDrop",function(o){return i.onDrop(o)}),F(1,"div",1)(2,"div",2),Y("click",function(){return i.setState("ide")}),he(3,"i",3),B(),F(4,"div",2),Y("click",function(){return i.setState("engine")}),he(5,"i",4),B(),F(6,"div",5),Y("click",function(){return i.toggleTheme()}),he(7,"div",6),B()(),F(8,"div",7),he(9,"engine",8)(10,"ide",8),B()()),2&t&&(S("dndAllowExternal",!0),A(2),Ze("selected","ide"===i.state),A(2),Ze("selected","engine"===i.state),A(3),S("ngClass","theme-"+i.theme),A(2),S("hidden","engine"!==i.state),A(1),S("hidden","ide"!==i.state))},directives:[La,vg,qre,Foe],styles:['.layout-icon[_ngcontent-%COMP%]{width:50px;height:50px;position:relative}.layout-icon[_ngcontent-%COMP%]:not(.selected):hover{background-color:var(--bs-gray-300)}.layout-icon.selected[_ngcontent-%COMP%]{color:var(--bs-primary)}.layout-icon.selected[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;bottom:0;left:0;right:0;border-left:4px solid var(--bs-primary)}.swatch[_ngcontent-%COMP%]{width:30px;height:30px}.swatch.theme-vs[_ngcontent-%COMP%]{background-color:var(--bs-light)}.swatch.theme-vs-dark[_ngcontent-%COMP%]{background-color:var(--bs-dark)}']}),n})()}];let Loe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({imports:[[EI.forRoot(koe,{useHash:!0})],EI]}),n})(),Boe=(()=>{class n{constructor(){this.title="rin-ng"}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=He({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&he(0,"router-outlet")},directives:[Lb],styles:[""]}),n})(),Voe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n}),n.\u0275inj=zt({providers:[$b,Zf,ar,NO,vf,{provide:Ok,useValue:"https://unpkg.com/monaco-editor@0.33.0/min/vs"}],imports:[[_A,J2,Zte,Ote,FX,Zre]]}),n})(),Hoe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=$t({type:n,bootstrap:[Boe]}),n.\u0275inj=zt({providers:[],imports:[[_A,Loe,Voe]]}),n})();(function yG(){RT=!1})(),I8().bootstrapModule(Hoe).catch(n=>console.error(n))},928:yd=>{function br(Mn){if("string"!=typeof Mn)throw new TypeError("Path must be a string. Received "+JSON.stringify(Mn))}function Za(Mn,ce){for(var Ue,ue="",Ve=0,et=-1,It=0,ut=0;ut<=Mn.length;++ut){if(ut<Mn.length)Ue=Mn.charCodeAt(ut);else{if(47===Ue)break;Ue=47}if(47===Ue){if(et!==ut-1&&1!==It)if(et!==ut-1&&2===It){if(ue.length<2||2!==Ve||46!==ue.charCodeAt(ue.length-1)||46!==ue.charCodeAt(ue.length-2))if(ue.length>2){var en=ue.lastIndexOf("/");if(en!==ue.length-1){-1===en?(ue="",Ve=0):Ve=(ue=ue.slice(0,en)).length-1-ue.lastIndexOf("/"),et=ut,It=0;continue}}else if(2===ue.length||1===ue.length){ue="",Ve=0,et=ut,It=0;continue}ce&&(ue.length>0?ue+="/..":ue="..",Ve=2)}else ue.length>0?ue+="/"+Mn.slice(et+1,ut):ue=Mn.slice(et+1,ut),Ve=ut-et-1;et=ut,It=0}else 46===Ue&&-1!==It?++It:It=-1}return ue}var At={resolve:function(){for(var Ve,ce="",ue=!1,et=arguments.length-1;et>=-1&&!ue;et--){var It;et>=0?It=arguments[et]:(void 0===Ve&&(Ve=process.cwd()),It=Ve),br(It),0!==It.length&&(ce=It+"/"+ce,ue=47===It.charCodeAt(0))}return ce=Za(ce,!ue),ue?ce.length>0?"/"+ce:"/":ce.length>0?ce:"."},normalize:function(ce){if(br(ce),0===ce.length)return".";var ue=47===ce.charCodeAt(0),Ve=47===ce.charCodeAt(ce.length-1);return 0===(ce=Za(ce,!ue)).length&&!ue&&(ce="."),ce.length>0&&Ve&&(ce+="/"),ue?"/"+ce:ce},isAbsolute:function(ce){return br(ce),ce.length>0&&47===ce.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var ce,ue=0;ue<arguments.length;++ue){var Ve=arguments[ue];br(Ve),Ve.length>0&&(void 0===ce?ce=Ve:ce+="/"+Ve)}return void 0===ce?".":At.normalize(ce)},relative:function(ce,ue){if(br(ce),br(ue),ce===ue||(ce=At.resolve(ce))===(ue=At.resolve(ue)))return"";for(var Ve=1;Ve<ce.length&&47===ce.charCodeAt(Ve);++Ve);for(var et=ce.length,It=et-Ve,Ue=1;Ue<ue.length&&47===ue.charCodeAt(Ue);++Ue);for(var en=ue.length-Ue,wr=It<en?It:en,Qn=-1,yn=0;yn<=wr;++yn){if(yn===wr){if(en>wr){if(47===ue.charCodeAt(Ue+yn))return ue.slice(Ue+yn+1);if(0===yn)return ue.slice(Ue+yn)}else It>wr&&(47===ce.charCodeAt(Ve+yn)?Qn=yn:0===yn&&(Qn=0));break}var Jf=ce.charCodeAt(Ve+yn);if(Jf!==ue.charCodeAt(Ue+yn))break;47===Jf&&(Qn=yn)}var gs="";for(yn=Ve+Qn+1;yn<=et;++yn)(yn===et||47===ce.charCodeAt(yn))&&(gs+=0===gs.length?"..":"/..");return gs.length>0?gs+ue.slice(Ue+Qn):(47===ue.charCodeAt(Ue+=Qn)&&++Ue,ue.slice(Ue))},_makeLong:function(ce){return ce},dirname:function(ce){if(br(ce),0===ce.length)return".";for(var ue=ce.charCodeAt(0),Ve=47===ue,et=-1,It=!0,Ue=ce.length-1;Ue>=1;--Ue)if(47===(ue=ce.charCodeAt(Ue))){if(!It){et=Ue;break}}else It=!1;return-1===et?Ve?"/":".":Ve&&1===et?"//":ce.slice(0,et)},basename:function(ce,ue){if(void 0!==ue&&"string"!=typeof ue)throw new TypeError('"ext" argument must be a string');br(ce);var Ue,Ve=0,et=-1,It=!0;if(void 0!==ue&&ue.length>0&&ue.length<=ce.length){if(ue.length===ce.length&&ue===ce)return"";var ut=ue.length-1,en=-1;for(Ue=ce.length-1;Ue>=0;--Ue){var wr=ce.charCodeAt(Ue);if(47===wr){if(!It){Ve=Ue+1;break}}else-1===en&&(It=!1,en=Ue+1),ut>=0&&(wr===ue.charCodeAt(ut)?-1==--ut&&(et=Ue):(ut=-1,et=en))}return Ve===et?et=en:-1===et&&(et=ce.length),ce.slice(Ve,et)}for(Ue=ce.length-1;Ue>=0;--Ue)if(47===ce.charCodeAt(Ue)){if(!It){Ve=Ue+1;break}}else-1===et&&(It=!1,et=Ue+1);return-1===et?"":ce.slice(Ve,et)},extname:function(ce){br(ce);for(var ue=-1,Ve=0,et=-1,It=!0,Ue=0,ut=ce.length-1;ut>=0;--ut){var en=ce.charCodeAt(ut);if(47!==en)-1===et&&(It=!1,et=ut+1),46===en?-1===ue?ue=ut:1!==Ue&&(Ue=1):-1!==ue&&(Ue=-1);else if(!It){Ve=ut+1;break}}return-1===ue||-1===et||0===Ue||1===Ue&&ue===et-1&&ue===Ve+1?"":ce.slice(ue,et)},format:function(ce){if(null===ce||"object"!=typeof ce)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof ce);return function Xa(Mn,ce){var ue=ce.dir||ce.root,Ve=ce.base||(ce.name||"")+(ce.ext||"");return ue?ue===ce.root?ue+Ve:ue+Mn+Ve:Ve}("/",ce)},parse:function(ce){br(ce);var ue={root:"",dir:"",base:"",ext:"",name:""};if(0===ce.length)return ue;var It,Ve=ce.charCodeAt(0),et=47===Ve;et?(ue.root="/",It=1):It=0;for(var Ue=-1,ut=0,en=-1,wr=!0,Qn=ce.length-1,yn=0;Qn>=It;--Qn)if(47!==(Ve=ce.charCodeAt(Qn)))-1===en&&(wr=!1,en=Qn+1),46===Ve?-1===Ue?Ue=Qn:1!==yn&&(yn=1):-1!==Ue&&(yn=-1);else if(!wr){ut=Qn+1;break}return-1===Ue||-1===en||0===yn||1===yn&&Ue===en-1&&Ue===ut+1?-1!==en&&(ue.base=ue.name=ce.slice(0===ut&&et?1:ut,en)):(0===ut&&et?(ue.name=ce.slice(1,Ue),ue.base=ce.slice(1,en)):(ue.name=ce.slice(ut,Ue),ue.base=ce.slice(ut,en)),ue.ext=ce.slice(Ue,en)),ut>0?ue.dir=ce.slice(0,ut-1):et&&(ue.dir="/"),ue},sep:"/",delimiter:":",win32:null,posix:null};At.posix=At,yd.exports=At}},yd=>{yd(yd.s=871)}]);