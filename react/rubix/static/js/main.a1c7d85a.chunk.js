(this.webpackJsonprubix=this.webpackJsonprubix||[]).push([[0],{34:function(e,n,t){e.exports=t(44)},38:function(e,n,t){},44:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(26),c=t.n(o),i=(t(38),t(10)),u=t(6),s=t(13),l=t(12),f=t.n(l),m=t(4),p=t(24),h=t(27),b=t(46),w=t(1),d="red",g="orange",v="white",y="blue",x="green",E="yellow",k={right:new w.Vector3(1,0,0),left:new w.Vector3(-1,0,0),up:new w.Vector3(0,1,0),down:new w.Vector3(0,-1,0),front:new w.Vector3(0,0,1),back:new w.Vector3(0,0,-1),zero:new w.Vector3(0,0,0)},A=Object(h.a)((function(e,n){return{ready:!1,cubes:[],animations:[],cache:{mainAnimationId:Object(b.a)(),dummy:new w.Object3D},actions:{init:function(){e({ready:!0,cubes:Array.from(n().utils.generateCubes())}),n().actions.shuffle()},shuffle:function(){for(var e=n().cubes.filter((function(e){return e.arrows.length>0})),t=0;t<500;){var r=e[z(0,e.length)],a=r.arrows[z(0,r.arrows.length)];n().actions.twistCube(r,a.axis,a.positive,!1),t++}},updateCache:function(t){return e({cache:Object(p.a)(Object(p.a)({},n().cache),t)})},addAnimations:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e({animations:[].concat(Object(m.a)(n().animations),r)})},removeAnimation:function(t){return e({animations:n().animations.filter((function(e){return e.uuid!==t}))})},twist:function(e,t,r){if(!n().animations.find((function(e){return e.uuid===n().cache.mainAnimationId}))){var a=n().cubes.find((function(n){return n.uuid===e}));a&&n().actions.twistCube(a,t,r,!0)}},twistCube:function(e,t,r,a){t=t.clone().applyQuaternion(e.rotation).round();var o=[];Math.abs(t.x)>0?o.push.apply(o,Object(m.a)(n().cubes.filter((function(n){return n.rubix.x===e.rubix.x})))):Math.abs(t.y)>0?o.push.apply(o,Object(m.a)(n().cubes.filter((function(n){return n.rubix.y===e.rubix.y})))):Math.abs(t.z)>0&&o.push.apply(o,Object(m.a)(n().cubes.filter((function(n){return n.rubix.z===e.rubix.z}))));var c=n().cache.dummy,i=(r?90:-90)*w.MathUtils.DEG2RAD,u=(new w.Quaternion).setFromAxisAngle(t,i),s=o.map((function(e){return[e.rotation.clone(),R(e,c,t,i),e.rotation]})),l=function(){o.forEach((function(e){e.rubix.applyQuaternion(u).round(),e.stickers.forEach((function(e){return e.rubix.applyQuaternion(u).round()}))})),a&&Array.from(n().utils.getAllFaceColors()).every((function(e){return e.every((function(n){return n.equals(e[0])}))}))&&console.log("win")};a?n().actions.addAnimations({uuid:n().cache.mainAnimationId,duration:250,onFrame:function(e){return s.forEach((function(n){return w.Quaternion.slerp(n[0],n[1],n[2],e)}))},onRest:l}):(s.forEach((function(e){return w.Quaternion.slerp(e[0],e[1],e[2],1)})),l())}},utils:{generateCubes:f.a.mark((function e(){var n,t,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=-1;case 1:if(!(n<=1)){e.next=18;break}t=-1;case 3:if(!(t<=1)){e.next=15;break}r=-1;case 5:if(!(r<=1)){e.next=12;break}if(0===n&&0===t&&0===r){e.next=9;break}return e.next=9,j(n,t,r);case 9:r++,e.next=5;break;case 12:t++,e.next=3;break;case 15:n++,e.next=1;break;case 18:case"end":return e.stop()}}),e)})),getFaceColors:f.a.mark((function e(t){var r,a,o,c,i,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object(s.a)(n().cubes),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=25;break}o=a.value,c=Object(s.a)(o.stickers),e.prev=6,c.s();case 8:if((i=c.n()).done){e.next=15;break}if(u=i.value,!t.equals(u.rubix)){e.next=13;break}return e.next=13,u.color;case 13:e.next=8;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),c.e(e.t0);case 20:return e.prev=20,c.f(),e.finish(20);case 23:e.next=3;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(1),r.e(e.t1);case 30:return e.prev=30,r.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[1,27,30,33],[6,17,20,23]])})),getAllFaceColors:f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Array.from(n().utils.getFaceColors(k.right));case 2:return e.next=4,Array.from(n().utils.getFaceColors(k.left));case 4:return e.next=6,Array.from(n().utils.getFaceColors(k.up));case 6:return e.next=8,Array.from(n().utils.getFaceColors(k.down));case 8:return e.next=10,Array.from(n().utils.getFaceColors(k.front));case 10:return e.next=12,Array.from(n().utils.getFaceColors(k.back));case 12:case"end":return e.stop()}}),e)}))}}})),F=[.9,.9,.9],O=[.75,.75,.75];function j(e,n,t){var r=new w.Vector3(e,n,t),a=[];switch(e){case 1:a.push([d,k.right]);break;case-1:a.push([g,k.left])}switch(n){case 1:a.push([v,k.up]);break;case-1:a.push([y,k.down])}switch(t){case 1:a.push([x,k.front]);break;case-1:a.push([E,k.back])}return C(F,"gray",a,r)}function C(e,n,t,r){var a=Object(b.a)(),o=t.map((function(e){return function(e,n,t){var r=[O[0],O[1],O[2]];switch(t.x){case 1:case-1:r[0]=.05}switch(t.y){case 1:case-1:r[1]=.05}switch(t.z){case 1:case-1:r[2]=.05}var a=C(r,n,[],e.clone().add(t.clone().multiplyScalar(.475)));return a.rubix.copy(t),a}(r,e[0],e[1])})),c=function(e,n,t){var r=[];3===t.length?(r.push.apply(r,Object(m.a)(M(e,n,t[0][1],t[1][1]))),r.push.apply(r,Object(m.a)(M(e,n,t[1][1],t[2][1]))),r.push.apply(r,Object(m.a)(M(e,n,t[0][1],t[2][1])))):2===t.length&&r.push.apply(r,Object(m.a)(M(e,n,t[0][1],t[1][1])));return r}(r,a,t),i=P(e,r),s=Object(u.a)(i,2);return{uuid:a,vertices:s[0],faces:s[1],color:new w.Color(n),stickers:o,arrows:c,rotation:new w.Quaternion(0,0,0,1),rubix:r.clone()}}function M(e,n,t,r){var a=t.clone().multiplyScalar(.6).add(r.clone().multiplyScalar(.6)),o=t.clone().cross(r);return[V(e,n,a,o,r,!0),V(e,n,a,o,t,!1)]}function V(e,n,t,r,a,o){var c=(o?90:-90)*w.MathUtils.DEG2RAD,i=t.clone().applyAxisAngle(r,c),s=e.clone().add(t.clone().add(i.clone().multiplyScalar(.15))),l=P([.2,.2,.2],k.zero,a),f=Object(u.a)(l,2);return{vertices:f[0],faces:f[1],cube:n,axis:r,positive:o,position:s,rotation:(new w.Quaternion).setFromAxisAngle(r,(o?45:-45)*w.MathUtils.DEG2RAD)}}function P(e,n,t){var r=n.x-e[0]/2,a=n.x+e[0]/2,o=n.y-e[1]/2,c=n.y+e[1]/2,i=n.z-e[2]/2,u=n.z+e[2]/2,s=[new w.Vector3(r,o,u),new w.Vector3(r,c,u),new w.Vector3(a,c,u),new w.Vector3(a,o,u),new w.Vector3(r,o,i),new w.Vector3(r,c,i),new w.Vector3(a,c,i),new w.Vector3(a,o,i)],l=[new w.Face3(0,2,1),new w.Face3(0,3,2),new w.Face3(3,6,2),new w.Face3(3,7,6),new w.Face3(4,1,5),new w.Face3(4,0,1),new w.Face3(7,5,6),new w.Face3(7,4,5),new w.Face3(1,6,5),new w.Face3(1,2,6),new w.Face3(4,3,0),new w.Face3(4,7,3)];if(t){var f=s.length,m=(e[0]+e[1]+e[2])/3,p=[];t.x>0&&p.push(3,2,6,7),t.x<0&&p.push(4,5,1,0),t.y>0&&p.push(1,5,6,2),t.y<0&&p.push(4,0,3,7),t.z>0&&p.push(0,1,2,3),t.z<0&&p.push(7,6,5,4),s.push(n.clone().add(t.clone().multiplyScalar(m/2).add(t.clone().multiplyScalar(m)))),l.push(new w.Face3(p[0],p[3],f),new w.Face3(p[1],p[0],f),new w.Face3(p[2],p[1],f),new w.Face3(p[3],p[2],f))}return[s,l]}function R(e,n,t,r){return n.quaternion.copy(e.rotation),n.rotateOnWorldAxis(t,r),n.quaternion.clone()}function z(e,n){return e=Math.ceil(e),n=Math.floor(n),Math.floor(Math.random()*(n-e)+e)}var Q=new w.Color(65535),D=new w.Color(0),G=new w.Color(65280),S=function(e){var n=e.vertices,t=e.faces,a=e.cube,o=e.axis,c=e.positive,u=e.position,s=e.rotation,l=r.useRef(null),f=r.useRef(null),m=r.useRef(null),p=A((function(e){return e.actions})).twist;return console.log("[Arrow] render"),Object(i.c)((function(){l.current.position.copy(u),l.current.quaternion.copy(s)})),r.createElement("mesh",{onPointerMove:function(e){e.stopPropagation(),f.current.color=G},onPointerOut:function(e){e.stopPropagation(),f.current.color=Q},onClick:function(e){e.stopPropagation(),p(a,o,c)},ref:l},r.createElement("geometry",{attach:"geometry",vertices:n,faces:t}),r.createElement("meshBasicMaterial",{ref:f,attach:"material",color:Q}),r.createElement("mesh",null,r.createElement("geometry",{attach:"geometry",vertices:n,faces:t}),r.createElement("meshBasicMaterial",{ref:m,attach:"material",color:D,wireframe:!0})))},q=function e(n){var t=n.vertices,a=n.faces,o=n.color,c=n.stickers,u=n.arrows,s=n.rotation,l=r.useRef(null);return console.log("[Cube] render"),Object(i.c)((function(){l.current.quaternion.copy(s)})),r.createElement("mesh",{onPointerMove:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()},ref:l},r.createElement("geometry",{attach:"geometry",vertices:t,faces:a}),r.createElement("meshBasicMaterial",{attach:"material",color:o}),r.createElement("mesh",{onPointerMove:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()}},r.createElement("geometry",{attach:"geometry",vertices:t,faces:a}),r.createElement("meshBasicMaterial",{attach:"material",color:"black",wireframe:!0})),c.map((function(n){return r.createElement(e,Object.assign({key:n.uuid},n))})),u.map((function(e,n){return r.createElement(S,Object.assign({key:n},e))})))},B=t(32);Object(i.b)({OrbitControls:B.a});var I=function(){var e=r.useRef(null),n=Object(i.d)(),t=n.camera,a=n.gl.domElement;return console.log("[ThreeOrbitControls] const"),Object(i.c)((function(){return e.current.update()})),r.createElement("orbitControls",{ref:e,args:[t,a]})},U=t(33),W=r.memo((function(e){var n=e.uuid,t=e.duration,a=e.onFrame,o=e.onRest,c=e.remove,i=e.children;return console.log("[Animation] const"),Object(U.a)({config:{duration:t},from:{opacity:0},to:{opacity:1},reset:!0,onRest:function(){o&&o(),c&&c(n)},onFrame:function(e){return a(e.opacity)}}),r.useEffect((function(){return console.log("[Animation] mount",n),function(){return console.log("[Animation] unmount",n)}}),[n]),r.createElement(r.Fragment,null,i&&i)})),J=function(){var e=A((function(e){return e.actions})).removeAnimation,n=A((function(e){return e.animations}));return console.log("[GameAnimationPlayer] render"),r.createElement(r.Fragment,null,n.map((function(n){return r.createElement(W,Object.assign({key:n.uuid},n,{remove:e}))})))},L=function(e){var n=e.children;return console.log("[GameCache] render"),r.createElement(r.Fragment,null,n&&n)},N=function(){var e=A((function(e){return e.cubes}));return console.log("[GameCanvas] render"),r.createElement(i.a,{camera:{position:[0,0,5]}},r.createElement("ambientLight",null),r.createElement("pointLight",{position:[10,10,10]}),r.createElement(I,null),r.createElement(J,null),r.createElement(L,null,e.map((function(e){return r.createElement(q,Object.assign({key:e.uuid},e))}))))},T=function(){var e=A((function(e){return e.ready})),n=A((function(e){return e.actions})).init;return console.log("[Game] render"),r.useEffect((function(){return n()}),[n]),r.createElement("div",{className:"vw-100 vh-100"},e&&r.createElement(N,null))};var $=function(){return a.a.createElement(T,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.a1c7d85a.chunk.js.map